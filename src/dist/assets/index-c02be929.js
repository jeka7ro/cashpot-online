import{r as h,a as vs,b as $t}from"./vendor-b69f2a9f.js";import{N as aa,u as Ye,a as ys,L as ws,b as It,R as ks,c as Te,B as Cs}from"./router-c483c27c.js";import{E as Ja,a as Qe,B as it,b as _e,M as Fe,U as xt,G as ct,C as Bt,P as At,A as Ht,T as Gt,F as ge,S as Na,c as st,d as zt,e as lr,f as Lt,g as Ss,h as _s,i as As,j as Pa,X as ve,L as Es,k as at,l as je,D as We,m as ze,I as St,n as _t,o as la,p as Xt,q as Me,r as Ut,s as Ds,t as Ge,u as Ie,v as yt,w as Tr,x as ot,y as tt,R as nr,z as jt,H as zr,J as Fa,K as Wt,N as Ts,O as zs,Q as dt,Z as ra,V as Pr,W as ht,Y as Lr,_ as Ha,$ as Ps,a0 as Wa,a1 as bt,a2 as Ls,a3 as Is,a4 as Os,a5 as Rs,a6 as ut,a7 as Fs,a8 as Ya,a9 as lt,aa as sa,ab as ir,ac as qt,ad as Yt,ae as js,af as Ir,ag as Ms,ah as $s,ai as Bs,aj as ta,ak as Us,al as or,am as Gs,an as cr,ao as Vs,ap as qs,aq as Js,ar as Ft,as as La,at as Hs}from"./icons-f79563f4.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var Or={exports:{}},ka={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ws=h,Ys=Symbol.for("react.element"),Ks=Symbol.for("react.fragment"),Xs=Object.prototype.hasOwnProperty,Zs=Ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qs={key:!0,ref:!0,__self:!0,__source:!0};function Rr(a,s,r){var l,n={},o=null,i=null;r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(i=s.ref);for(l in s)Xs.call(s,l)&&!Qs.hasOwnProperty(l)&&(n[l]=s[l]);if(a&&a.defaultProps)for(l in s=a.defaultProps,s)n[l]===void 0&&(n[l]=s[l]);return{$$typeof:Ys,type:a,key:o,ref:i,props:n,_owner:Zs.current}}ka.Fragment=Ks;ka.jsx=Rr;ka.jsxs=Rr;Or.exports=ka;var Ka=Or.exports;const De=Ka.Fragment,e=Ka.jsx,t=Ka.jsxs;var ja={},dr=vs;ja.createRoot=dr.createRoot,ja.hydrateRoot=dr.hydrateRoot;let el={data:""},tl=a=>{if(typeof window=="object"){let s=(a?a.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(a||document.head).appendChild(s),s.firstChild}return a||el},al=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,rl=/\/\*[^]*?\*\/|  +/g,mr=/\n+/g,Pt=(a,s)=>{let r="",l="",n="";for(let o in a){let i=a[o];o[0]=="@"?o[1]=="i"?r=o+" "+i+";":l+=o[1]=="f"?Pt(i,o):o+"{"+Pt(i,o[1]=="k"?"":s)+"}":typeof i=="object"?l+=Pt(i,s?s.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,c):c?c+" "+u:u)):o):i!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Pt.p?Pt.p(o,i):o+":"+i+";")}return r+(s&&n?s+"{"+n+"}":n)+l},Ct={},Fr=a=>{if(typeof a=="object"){let s="";for(let r in a)s+=r+Fr(a[r]);return s}return a},sl=(a,s,r,l,n)=>{let o=Fr(a),i=Ct[o]||(Ct[o]=(u=>{let x=0,m=11;for(;x<u.length;)m=101*m+u.charCodeAt(x++)>>>0;return"go"+m})(o));if(!Ct[i]){let u=o!==a?a:(x=>{let m,d,g=[{}];for(;m=al.exec(x.replace(rl,""));)m[4]?g.shift():m[3]?(d=m[3].replace(mr," ").trim(),g.unshift(g[0][d]=g[0][d]||{})):g[0][m[1]]=m[2].replace(mr," ").trim();return g[0]})(a);Ct[i]=Pt(n?{["@keyframes "+i]:u}:u,r?"":"."+i)}let c=r&&Ct.g?Ct.g:null;return r&&(Ct.g=Ct[i]),((u,x,m,d)=>{d?x.data=x.data.replace(d,u):x.data.indexOf(u)===-1&&(x.data=m?u+x.data:x.data+u)})(Ct[i],s,l,c),i},ll=(a,s,r)=>a.reduce((l,n,o)=>{let i=s[o];if(i&&i.call){let c=i(r),u=c&&c.props&&c.props.className||/^go/.test(c)&&c;i=u?"."+u:c&&typeof c=="object"?c.props?"":Pt(c,""):c===!1?"":c}return l+n+(i??"")},"");function Ca(a){let s=this||{},r=a.call?a(s.p):a;return sl(r.unshift?r.raw?ll(r,[].slice.call(arguments,1),s.p):r.reduce((l,n)=>Object.assign(l,n&&n.call?n(s.p):n),{}):r,tl(s.target),s.g,s.o,s.k)}let jr,Ma,$a;Ca.bind({g:1});let Et=Ca.bind({k:1});function nl(a,s,r,l){Pt.p=s,jr=a,Ma=r,$a=l}function Ot(a,s){let r=this||{};return function(){let l=arguments;function n(o,i){let c=Object.assign({},o),u=c.className||n.className;r.p=Object.assign({theme:Ma&&Ma()},c),r.o=/ *go\d+/.test(u),c.className=Ca.apply(r,l)+(u?" "+u:""),s&&(c.ref=i);let x=a;return a[0]&&(x=c.as||a,delete c.as),$a&&x[0]&&$a(c),jr(x,c)}return s?s(n):n}}var il=a=>typeof a=="function",va=(a,s)=>il(a)?a(s):a,ol=(()=>{let a=0;return()=>(++a).toString()})(),Mr=(()=>{let a;return()=>{if(a===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");a=!s||s.matches}return a}})(),cl=20,Xa="default",$r=(a,s)=>{let{toastLimit:r}=a.settings;switch(s.type){case 0:return{...a,toasts:[s.toast,...a.toasts].slice(0,r)};case 1:return{...a,toasts:a.toasts.map(i=>i.id===s.toast.id?{...i,...s.toast}:i)};case 2:let{toast:l}=s;return $r(a,{type:a.toasts.find(i=>i.id===l.id)?1:0,toast:l});case 3:let{toastId:n}=s;return{...a,toasts:a.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return s.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(i=>i.id!==s.toastId)};case 5:return{...a,pausedAt:s.time};case 6:let o=s.time-(a.pausedAt||0);return{...a,pausedAt:void 0,toasts:a.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+o}))}}},ua=[],Br={toasts:[],pausedAt:void 0,settings:{toastLimit:cl}},vt={},Ur=(a,s=Xa)=>{vt[s]=$r(vt[s]||Br,a),ua.forEach(([r,l])=>{r===s&&l(vt[s])})},Gr=a=>Object.keys(vt).forEach(s=>Ur(a,s)),dl=a=>Object.keys(vt).find(s=>vt[s].toasts.some(r=>r.id===a)),Sa=(a=Xa)=>s=>{Ur(s,a)},ml={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ul=(a={},s=Xa)=>{let[r,l]=h.useState(vt[s]||Br),n=h.useRef(vt[s]);h.useEffect(()=>(n.current!==vt[s]&&l(vt[s]),ua.push([s,l]),()=>{let i=ua.findIndex(([c])=>c===s);i>-1&&ua.splice(i,1)}),[s]);let o=r.toasts.map(i=>{var c,u,x;return{...a,...a[i.type],...i,removeDelay:i.removeDelay||((c=a[i.type])==null?void 0:c.removeDelay)||(a==null?void 0:a.removeDelay),duration:i.duration||((u=a[i.type])==null?void 0:u.duration)||(a==null?void 0:a.duration)||ml[i.type],style:{...a.style,...(x=a[i.type])==null?void 0:x.style,...i.style}}});return{...r,toasts:o}},hl=(a,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:a,pauseDuration:0,...r,id:(r==null?void 0:r.id)||ol()}),na=a=>(s,r)=>{let l=hl(s,a,r);return Sa(l.toasterId||dl(l.id))({type:2,toast:l}),l.id},$=(a,s)=>na("blank")(a,s);$.error=na("error");$.success=na("success");$.loading=na("loading");$.custom=na("custom");$.dismiss=(a,s)=>{let r={type:3,toastId:a};s?Sa(s)(r):Gr(r)};$.dismissAll=a=>$.dismiss(void 0,a);$.remove=(a,s)=>{let r={type:4,toastId:a};s?Sa(s)(r):Gr(r)};$.removeAll=a=>$.remove(void 0,a);$.promise=(a,s,r)=>{let l=$.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof a=="function"&&(a=a()),a.then(n=>{let o=s.success?va(s.success,n):void 0;return o?$.success(o,{id:l,...r,...r==null?void 0:r.success}):$.dismiss(l),n}).catch(n=>{let o=s.error?va(s.error,n):void 0;o?$.error(o,{id:l,...r,...r==null?void 0:r.error}):$.dismiss(l)}),a};var pl=1e3,xl=(a,s="default")=>{let{toasts:r,pausedAt:l}=ul(a,s),n=h.useRef(new Map).current,o=h.useCallback((d,g=pl)=>{if(n.has(d))return;let _=setTimeout(()=>{n.delete(d),i({type:4,toastId:d})},g);n.set(d,_)},[]);h.useEffect(()=>{if(l)return;let d=Date.now(),g=r.map(_=>{if(_.duration===1/0)return;let p=(_.duration||0)+_.pauseDuration-(d-_.createdAt);if(p<0){_.visible&&$.dismiss(_.id);return}return setTimeout(()=>$.dismiss(_.id,s),p)});return()=>{g.forEach(_=>_&&clearTimeout(_))}},[r,l,s]);let i=h.useCallback(Sa(s),[s]),c=h.useCallback(()=>{i({type:5,time:Date.now()})},[i]),u=h.useCallback((d,g)=>{i({type:1,toast:{id:d,height:g}})},[i]),x=h.useCallback(()=>{l&&i({type:6,time:Date.now()})},[l,i]),m=h.useCallback((d,g)=>{let{reverseOrder:_=!1,gutter:p=8,defaultPosition:N}=g||{},k=r.filter(f=>(f.position||N)===(d.position||N)&&f.height),E=k.findIndex(f=>f.id===d.id),P=k.filter((f,R)=>R<E&&f.visible).length;return k.filter(f=>f.visible).slice(..._?[P+1]:[0,P]).reduce((f,R)=>f+(R.height||0)+p,0)},[r]);return h.useEffect(()=>{r.forEach(d=>{if(d.dismissed)o(d.id,d.removeDelay);else{let g=n.get(d.id);g&&(clearTimeout(g),n.delete(d.id))}})},[r,o]),{toasts:r,handlers:{updateHeight:u,startPause:c,endPause:x,calculateOffset:m}}},bl=Et`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,gl=Et`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fl=Et`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Nl=Ot("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${a=>a.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${bl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${gl} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${a=>a.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${fl} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,vl=Et`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,yl=Ot("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${a=>a.secondary||"#e0e0e0"};
  border-right-color: ${a=>a.primary||"#616161"};
  animation: ${vl} 1s linear infinite;
`,wl=Et`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,kl=Et`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Cl=Ot("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${a=>a.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${wl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${kl} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${a=>a.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Sl=Ot("div")`
  position: absolute;
`,_l=Ot("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Al=Et`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,El=Ot("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Al} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Dl=({toast:a})=>{let{icon:s,type:r,iconTheme:l}=a;return s!==void 0?typeof s=="string"?h.createElement(El,null,s):s:r==="blank"?null:h.createElement(_l,null,h.createElement(yl,{...l}),r!=="loading"&&h.createElement(Sl,null,r==="error"?h.createElement(Nl,{...l}):h.createElement(Cl,{...l})))},Tl=a=>`
0% {transform: translate3d(0,${a*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,zl=a=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${a*-150}%,-1px) scale(.6); opacity:0;}
`,Pl="0%{opacity:0;} 100%{opacity:1;}",Ll="0%{opacity:1;} 100%{opacity:0;}",Il=Ot("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Ol=Ot("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Rl=(a,s)=>{let r=a.includes("top")?1:-1,[l,n]=Mr()?[Pl,Ll]:[Tl(r),zl(r)];return{animation:s?`${Et(l)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Et(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Fl=h.memo(({toast:a,position:s,style:r,children:l})=>{let n=a.height?Rl(a.position||s||"top-center",a.visible):{opacity:0},o=h.createElement(Dl,{toast:a}),i=h.createElement(Ol,{...a.ariaProps},va(a.message,a));return h.createElement(Il,{className:a.className,style:{...n,...r,...a.style}},typeof l=="function"?l({icon:o,message:i}):h.createElement(h.Fragment,null,o,i))});nl(h.createElement);var jl=({id:a,className:s,style:r,onHeightUpdate:l,children:n})=>{let o=h.useCallback(i=>{if(i){let c=()=>{let u=i.getBoundingClientRect().height;l(a,u)};c(),new MutationObserver(c).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[a,l]);return h.createElement("div",{ref:o,className:s,style:r},n)},Ml=(a,s)=>{let r=a.includes("top"),l=r?{top:0}:{bottom:0},n=a.includes("center")?{justifyContent:"center"}:a.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Mr()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...l,...n}},$l=Ca`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,da=16,Bl=({reverseOrder:a,position:s="top-center",toastOptions:r,gutter:l,children:n,toasterId:o,containerStyle:i,containerClassName:c})=>{let{toasts:u,handlers:x}=xl(r,o);return h.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:da,left:da,right:da,bottom:da,pointerEvents:"none",...i},className:c,onMouseEnter:x.startPause,onMouseLeave:x.endPause},u.map(m=>{let d=m.position||s,g=x.calculateOffset(m,{reverseOrder:a,gutter:l,defaultPosition:s}),_=Ml(d,g);return h.createElement(jl,{id:m.id,key:m.id,onHeightUpdate:x.updateHeight,className:m.visible?$l:"",style:_},m.type==="custom"?va(m.message,m):n?n(m):h.createElement(Fl,{toast:m,position:d}))}))},ke=$;const Vr=h.createContext(),Ul=()=>{const a=h.useContext(Vr);if(!a)throw new Error("useTheme must be used within a ThemeProvider");return a},Gl=({children:a})=>{const[s,r]=h.useState(()=>sessionStorage.getItem("theme")||"dark");h.useEffect(()=>{sessionStorage.setItem("theme",s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[s]);const l=()=>{r(n=>n==="light"?"dark":"light")};return e(Vr.Provider,{value:{theme:s,setTheme:r,toggleTheme:l},children:a})};function qr(a,s){return function(){return a.apply(s,arguments)}}const{toString:Vl}=Object.prototype,{getPrototypeOf:Za}=Object,{iterator:_a,toStringTag:Jr}=Symbol,Aa=(a=>s=>{const r=Vl.call(s);return a[r]||(a[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),gt=a=>(a=a.toLowerCase(),s=>Aa(s)===a),Ea=a=>s=>typeof s===a,{isArray:Zt}=Array,Kt=Ea("undefined");function ia(a){return a!==null&&!Kt(a)&&a.constructor!==null&&!Kt(a.constructor)&&mt(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const Hr=gt("ArrayBuffer");function ql(a){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(a):s=a&&a.buffer&&Hr(a.buffer),s}const Jl=Ea("string"),mt=Ea("function"),Wr=Ea("number"),oa=a=>a!==null&&typeof a=="object",Hl=a=>a===!0||a===!1,ha=a=>{if(Aa(a)!=="object")return!1;const s=Za(a);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Jr in a)&&!(_a in a)},Wl=a=>{if(!oa(a)||ia(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},Yl=gt("Date"),Kl=gt("File"),Xl=gt("Blob"),Zl=gt("FileList"),Ql=a=>oa(a)&&mt(a.pipe),en=a=>{let s;return a&&(typeof FormData=="function"&&a instanceof FormData||mt(a.append)&&((s=Aa(a))==="formdata"||s==="object"&&mt(a.toString)&&a.toString()==="[object FormData]"))},tn=gt("URLSearchParams"),[an,rn,sn,ln]=["ReadableStream","Request","Response","Headers"].map(gt),nn=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ca(a,s,{allOwnKeys:r=!1}={}){if(a===null||typeof a>"u")return;let l,n;if(typeof a!="object"&&(a=[a]),Zt(a))for(l=0,n=a.length;l<n;l++)s.call(null,a[l],l,a);else{if(ia(a))return;const o=r?Object.getOwnPropertyNames(a):Object.keys(a),i=o.length;let c;for(l=0;l<i;l++)c=o[l],s.call(null,a[c],c,a)}}function Yr(a,s){if(ia(a))return null;s=s.toLowerCase();const r=Object.keys(a);let l=r.length,n;for(;l-- >0;)if(n=r[l],s===n.toLowerCase())return n;return null}const Mt=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Kr=a=>!Kt(a)&&a!==Mt;function Ba(){const{caseless:a,skipUndefined:s}=Kr(this)&&this||{},r={},l=(n,o)=>{const i=a&&Yr(r,o)||o;ha(r[i])&&ha(n)?r[i]=Ba(r[i],n):ha(n)?r[i]=Ba({},n):Zt(n)?r[i]=n.slice():(!s||!Kt(n))&&(r[i]=n)};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&ca(arguments[n],l);return r}const on=(a,s,r,{allOwnKeys:l}={})=>(ca(s,(n,o)=>{r&&mt(n)?a[o]=qr(n,r):a[o]=n},{allOwnKeys:l}),a),cn=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),dn=(a,s,r,l)=>{a.prototype=Object.create(s.prototype,l),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:s.prototype}),r&&Object.assign(a.prototype,r)},mn=(a,s,r,l)=>{let n,o,i;const c={};if(s=s||{},a==null)return s;do{for(n=Object.getOwnPropertyNames(a),o=n.length;o-- >0;)i=n[o],(!l||l(i,a,s))&&!c[i]&&(s[i]=a[i],c[i]=!0);a=r!==!1&&Za(a)}while(a&&(!r||r(a,s))&&a!==Object.prototype);return s},un=(a,s,r)=>{a=String(a),(r===void 0||r>a.length)&&(r=a.length),r-=s.length;const l=a.indexOf(s,r);return l!==-1&&l===r},hn=a=>{if(!a)return null;if(Zt(a))return a;let s=a.length;if(!Wr(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=a[s];return r},pn=(a=>s=>a&&s instanceof a)(typeof Uint8Array<"u"&&Za(Uint8Array)),xn=(a,s)=>{const l=(a&&a[_a]).call(a);let n;for(;(n=l.next())&&!n.done;){const o=n.value;s.call(a,o[0],o[1])}},bn=(a,s)=>{let r;const l=[];for(;(r=a.exec(s))!==null;)l.push(r);return l},gn=gt("HTMLFormElement"),fn=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,l,n){return l.toUpperCase()+n}),ur=(({hasOwnProperty:a})=>(s,r)=>a.call(s,r))(Object.prototype),Nn=gt("RegExp"),Xr=(a,s)=>{const r=Object.getOwnPropertyDescriptors(a),l={};ca(r,(n,o)=>{let i;(i=s(n,o,a))!==!1&&(l[o]=i||n)}),Object.defineProperties(a,l)},vn=a=>{Xr(a,(s,r)=>{if(mt(a)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const l=a[r];if(mt(l)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},yn=(a,s)=>{const r={},l=n=>{n.forEach(o=>{r[o]=!0})};return Zt(a)?l(a):l(String(a).split(s)),r},wn=()=>{},kn=(a,s)=>a!=null&&Number.isFinite(a=+a)?a:s;function Cn(a){return!!(a&&mt(a.append)&&a[Jr]==="FormData"&&a[_a])}const Sn=a=>{const s=new Array(10),r=(l,n)=>{if(oa(l)){if(s.indexOf(l)>=0)return;if(ia(l))return l;if(!("toJSON"in l)){s[n]=l;const o=Zt(l)?[]:{};return ca(l,(i,c)=>{const u=r(i,n+1);!Kt(u)&&(o[c]=u)}),s[n]=void 0,o}}return l};return r(a,0)},_n=gt("AsyncFunction"),An=a=>a&&(oa(a)||mt(a))&&mt(a.then)&&mt(a.catch),Zr=((a,s)=>a?setImmediate:s?((r,l)=>(Mt.addEventListener("message",({source:n,data:o})=>{n===Mt&&o===r&&l.length&&l.shift()()},!1),n=>{l.push(n),Mt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",mt(Mt.postMessage)),En=typeof queueMicrotask<"u"?queueMicrotask.bind(Mt):typeof process<"u"&&process.nextTick||Zr,Dn=a=>a!=null&&mt(a[_a]),H={isArray:Zt,isArrayBuffer:Hr,isBuffer:ia,isFormData:en,isArrayBufferView:ql,isString:Jl,isNumber:Wr,isBoolean:Hl,isObject:oa,isPlainObject:ha,isEmptyObject:Wl,isReadableStream:an,isRequest:rn,isResponse:sn,isHeaders:ln,isUndefined:Kt,isDate:Yl,isFile:Kl,isBlob:Xl,isRegExp:Nn,isFunction:mt,isStream:Ql,isURLSearchParams:tn,isTypedArray:pn,isFileList:Zl,forEach:ca,merge:Ba,extend:on,trim:nn,stripBOM:cn,inherits:dn,toFlatObject:mn,kindOf:Aa,kindOfTest:gt,endsWith:un,toArray:hn,forEachEntry:xn,matchAll:bn,isHTMLForm:gn,hasOwnProperty:ur,hasOwnProp:ur,reduceDescriptors:Xr,freezeMethods:vn,toObjectSet:yn,toCamelCase:fn,noop:wn,toFiniteNumber:kn,findKey:Yr,global:Mt,isContextDefined:Kr,isSpecCompliantForm:Cn,toJSONObject:Sn,isAsyncFn:_n,isThenable:An,setImmediate:Zr,asap:En,isIterable:Dn};function Ne(a,s,r,l,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),l&&(this.request=l),n&&(this.response=n,this.status=n.status?n.status:null)}H.inherits(Ne,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const Qr=Ne.prototype,es={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{es[a]={value:a}});Object.defineProperties(Ne,es);Object.defineProperty(Qr,"isAxiosError",{value:!0});Ne.from=(a,s,r,l,n,o)=>{const i=Object.create(Qr);H.toFlatObject(a,i,function(m){return m!==Error.prototype},x=>x!=="isAxiosError");const c=a&&a.message?a.message:"Error",u=s==null&&a?a.code:s;return Ne.call(i,c,u,r,l,n),a&&i.cause==null&&Object.defineProperty(i,"cause",{value:a,configurable:!0}),i.name=a&&a.name||"Error",o&&Object.assign(i,o),i};const Tn=null;function Ua(a){return H.isPlainObject(a)||H.isArray(a)}function ts(a){return H.endsWith(a,"[]")?a.slice(0,-2):a}function hr(a,s,r){return a?a.concat(s).map(function(n,o){return n=ts(n),!r&&o?"["+n+"]":n}).join(r?".":""):s}function zn(a){return H.isArray(a)&&!a.some(Ua)}const Pn=H.toFlatObject(H,{},null,function(s){return/^is[A-Z]/.test(s)});function Da(a,s,r){if(!H.isObject(a))throw new TypeError("target must be an object");s=s||new FormData,r=H.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,k){return!H.isUndefined(k[N])});const l=r.metaTokens,n=r.visitor||m,o=r.dots,i=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(s);if(!H.isFunction(n))throw new TypeError("visitor must be a function");function x(p){if(p===null)return"";if(H.isDate(p))return p.toISOString();if(H.isBoolean(p))return p.toString();if(!u&&H.isBlob(p))throw new Ne("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(p)||H.isTypedArray(p)?u&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function m(p,N,k){let E=p;if(p&&!k&&typeof p=="object"){if(H.endsWith(N,"{}"))N=l?N:N.slice(0,-2),p=JSON.stringify(p);else if(H.isArray(p)&&zn(p)||(H.isFileList(p)||H.endsWith(N,"[]"))&&(E=H.toArray(p)))return N=ts(N),E.forEach(function(f,R){!(H.isUndefined(f)||f===null)&&s.append(i===!0?hr([N],R,o):i===null?N:N+"[]",x(f))}),!1}return Ua(p)?!0:(s.append(hr(k,N,o),x(p)),!1)}const d=[],g=Object.assign(Pn,{defaultVisitor:m,convertValue:x,isVisitable:Ua});function _(p,N){if(!H.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+N.join("."));d.push(p),H.forEach(p,function(E,P){(!(H.isUndefined(E)||E===null)&&n.call(s,E,H.isString(P)?P.trim():P,N,g))===!0&&_(E,N?N.concat(P):[P])}),d.pop()}}if(!H.isObject(a))throw new TypeError("data must be an object");return _(a),s}function pr(a){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(l){return s[l]})}function Qa(a,s){this._pairs=[],a&&Da(a,this,s)}const as=Qa.prototype;as.append=function(s,r){this._pairs.push([s,r])};as.toString=function(s){const r=s?function(l){return s.call(this,l,pr)}:pr;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function Ln(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function rs(a,s,r){if(!s)return a;const l=r&&r.encode||Ln;H.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let o;if(n?o=n(s,r):o=H.isURLSearchParams(s)?s.toString():new Qa(s,r).toString(l),o){const i=a.indexOf("#");i!==-1&&(a=a.slice(0,i)),a+=(a.indexOf("?")===-1?"?":"&")+o}return a}class In{constructor(){this.handlers=[]}use(s,r,l){return this.handlers.push({fulfilled:s,rejected:r,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){H.forEach(this.handlers,function(l){l!==null&&s(l)})}}const xr=In,ss={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},On=typeof URLSearchParams<"u"?URLSearchParams:Qa,Rn=typeof FormData<"u"?FormData:null,Fn=typeof Blob<"u"?Blob:null,jn={isBrowser:!0,classes:{URLSearchParams:On,FormData:Rn,Blob:Fn},protocols:["http","https","file","blob","url","data"]},er=typeof window<"u"&&typeof document<"u",Ga=typeof navigator=="object"&&navigator||void 0,Mn=er&&(!Ga||["ReactNative","NativeScript","NS"].indexOf(Ga.product)<0),$n=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Bn=er&&window.location.href||"http://localhost",Un=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:er,hasStandardBrowserEnv:Mn,hasStandardBrowserWebWorkerEnv:$n,navigator:Ga,origin:Bn},Symbol.toStringTag,{value:"Module"})),rt={...Un,...jn};function Gn(a,s){return Da(a,new rt.classes.URLSearchParams,{visitor:function(r,l,n,o){return rt.isNode&&H.isBuffer(r)?(this.append(l,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...s})}function Vn(a){return H.matchAll(/\w+|\[(\w*)]/g,a).map(s=>s[0]==="[]"?"":s[1]||s[0])}function qn(a){const s={},r=Object.keys(a);let l;const n=r.length;let o;for(l=0;l<n;l++)o=r[l],s[o]=a[o];return s}function ls(a){function s(r,l,n,o){let i=r[o++];if(i==="__proto__")return!0;const c=Number.isFinite(+i),u=o>=r.length;return i=!i&&H.isArray(n)?n.length:i,u?(H.hasOwnProp(n,i)?n[i]=[n[i],l]:n[i]=l,!c):((!n[i]||!H.isObject(n[i]))&&(n[i]=[]),s(r,l,n[i],o)&&H.isArray(n[i])&&(n[i]=qn(n[i])),!c)}if(H.isFormData(a)&&H.isFunction(a.entries)){const r={};return H.forEachEntry(a,(l,n)=>{s(Vn(l),n,r,0)}),r}return null}function Jn(a,s,r){if(H.isString(a))try{return(s||JSON.parse)(a),H.trim(a)}catch(l){if(l.name!=="SyntaxError")throw l}return(r||JSON.stringify)(a)}const tr={transitional:ss,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const l=r.getContentType()||"",n=l.indexOf("application/json")>-1,o=H.isObject(s);if(o&&H.isHTMLForm(s)&&(s=new FormData(s)),H.isFormData(s))return n?JSON.stringify(ls(s)):s;if(H.isArrayBuffer(s)||H.isBuffer(s)||H.isStream(s)||H.isFile(s)||H.isBlob(s)||H.isReadableStream(s))return s;if(H.isArrayBufferView(s))return s.buffer;if(H.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(o){if(l.indexOf("application/x-www-form-urlencoded")>-1)return Gn(s,this.formSerializer).toString();if((c=H.isFileList(s))||l.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Da(c?{"files[]":s}:s,u&&new u,this.formSerializer)}}return o||n?(r.setContentType("application/json",!1),Jn(s)):s}],transformResponse:[function(s){const r=this.transitional||tr.transitional,l=r&&r.forcedJSONParsing,n=this.responseType==="json";if(H.isResponse(s)||H.isReadableStream(s))return s;if(s&&H.isString(s)&&(l&&!this.responseType||n)){const i=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(s,this.parseReviver)}catch(c){if(i)throw c.name==="SyntaxError"?Ne.from(c,Ne.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:rt.classes.FormData,Blob:rt.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],a=>{tr.headers[a]={}});const ar=tr,Hn=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Wn=a=>{const s={};let r,l,n;return a&&a.split(`
`).forEach(function(i){n=i.indexOf(":"),r=i.substring(0,n).trim().toLowerCase(),l=i.substring(n+1).trim(),!(!r||s[r]&&Hn[r])&&(r==="set-cookie"?s[r]?s[r].push(l):s[r]=[l]:s[r]=s[r]?s[r]+", "+l:l)}),s},br=Symbol("internals");function ea(a){return a&&String(a).trim().toLowerCase()}function pa(a){return a===!1||a==null?a:H.isArray(a)?a.map(pa):String(a)}function Yn(a){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=r.exec(a);)s[l[1]]=l[2];return s}const Kn=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function Ia(a,s,r,l,n){if(H.isFunction(l))return l.call(this,s,r);if(n&&(s=r),!!H.isString(s)){if(H.isString(l))return s.indexOf(l)!==-1;if(H.isRegExp(l))return l.test(s)}}function Xn(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,l)=>r.toUpperCase()+l)}function Zn(a,s){const r=H.toCamelCase(" "+s);["get","set","has"].forEach(l=>{Object.defineProperty(a,l+r,{value:function(n,o,i){return this[l].call(this,s,n,o,i)},configurable:!0})})}class Ta{constructor(s){s&&this.set(s)}set(s,r,l){const n=this;function o(c,u,x){const m=ea(u);if(!m)throw new Error("header name must be a non-empty string");const d=H.findKey(n,m);(!d||n[d]===void 0||x===!0||x===void 0&&n[d]!==!1)&&(n[d||u]=pa(c))}const i=(c,u)=>H.forEach(c,(x,m)=>o(x,m,u));if(H.isPlainObject(s)||s instanceof this.constructor)i(s,r);else if(H.isString(s)&&(s=s.trim())&&!Kn(s))i(Wn(s),r);else if(H.isObject(s)&&H.isIterable(s)){let c={},u,x;for(const m of s){if(!H.isArray(m))throw TypeError("Object iterator must return a key-value pair");c[x=m[0]]=(u=c[x])?H.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}i(c,r)}else s!=null&&o(r,s,l);return this}get(s,r){if(s=ea(s),s){const l=H.findKey(this,s);if(l){const n=this[l];if(!r)return n;if(r===!0)return Yn(n);if(H.isFunction(r))return r.call(this,n,l);if(H.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=ea(s),s){const l=H.findKey(this,s);return!!(l&&this[l]!==void 0&&(!r||Ia(this,this[l],l,r)))}return!1}delete(s,r){const l=this;let n=!1;function o(i){if(i=ea(i),i){const c=H.findKey(l,i);c&&(!r||Ia(l,l[c],c,r))&&(delete l[c],n=!0)}}return H.isArray(s)?s.forEach(o):o(s),n}clear(s){const r=Object.keys(this);let l=r.length,n=!1;for(;l--;){const o=r[l];(!s||Ia(this,this[o],o,s,!0))&&(delete this[o],n=!0)}return n}normalize(s){const r=this,l={};return H.forEach(this,(n,o)=>{const i=H.findKey(l,o);if(i){r[i]=pa(n),delete r[o];return}const c=s?Xn(o):String(o).trim();c!==o&&delete r[o],r[c]=pa(n),l[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return H.forEach(this,(l,n)=>{l!=null&&l!==!1&&(r[n]=s&&H.isArray(l)?l.join(", "):l)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const l=new this(s);return r.forEach(n=>l.set(n)),l}static accessor(s){const l=(this[br]=this[br]={accessors:{}}).accessors,n=this.prototype;function o(i){const c=ea(i);l[c]||(Zn(n,i),l[c]=!0)}return H.isArray(s)?s.forEach(o):o(s),this}}Ta.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(Ta.prototype,({value:a},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>a,set(l){this[r]=l}}});H.freezeMethods(Ta);const pt=Ta;function Oa(a,s){const r=this||ar,l=s||r,n=pt.from(l.headers);let o=l.data;return H.forEach(a,function(c){o=c.call(r,o,n.normalize(),s?s.status:void 0)}),n.normalize(),o}function ns(a){return!!(a&&a.__CANCEL__)}function Qt(a,s,r){Ne.call(this,a??"canceled",Ne.ERR_CANCELED,s,r),this.name="CanceledError"}H.inherits(Qt,Ne,{__CANCEL__:!0});function is(a,s,r){const l=r.config.validateStatus;!r.status||!l||l(r.status)?a(r):s(new Ne("Request failed with status code "+r.status,[Ne.ERR_BAD_REQUEST,Ne.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Qn(a){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return s&&s[1]||""}function ei(a,s){a=a||10;const r=new Array(a),l=new Array(a);let n=0,o=0,i;return s=s!==void 0?s:1e3,function(u){const x=Date.now(),m=l[o];i||(i=x),r[n]=u,l[n]=x;let d=o,g=0;for(;d!==n;)g+=r[d++],d=d%a;if(n=(n+1)%a,n===o&&(o=(o+1)%a),x-i<s)return;const _=m&&x-m;return _?Math.round(g*1e3/_):void 0}}function ti(a,s){let r=0,l=1e3/s,n,o;const i=(x,m=Date.now())=>{r=m,n=null,o&&(clearTimeout(o),o=null),a(...x)};return[(...x)=>{const m=Date.now(),d=m-r;d>=l?i(x,m):(n=x,o||(o=setTimeout(()=>{o=null,i(n)},l-d)))},()=>n&&i(n)]}const ya=(a,s,r=3)=>{let l=0;const n=ei(50,250);return ti(o=>{const i=o.loaded,c=o.lengthComputable?o.total:void 0,u=i-l,x=n(u),m=i<=c;l=i;const d={loaded:i,total:c,progress:c?i/c:void 0,bytes:u,rate:x||void 0,estimated:x&&c&&m?(c-i)/x:void 0,event:o,lengthComputable:c!=null,[s?"download":"upload"]:!0};a(d)},r)},gr=(a,s)=>{const r=a!=null;return[l=>s[0]({lengthComputable:r,total:a,loaded:l}),s[1]]},fr=a=>(...s)=>H.asap(()=>a(...s)),ai=rt.hasStandardBrowserEnv?((a,s)=>r=>(r=new URL(r,rt.origin),a.protocol===r.protocol&&a.host===r.host&&(s||a.port===r.port)))(new URL(rt.origin),rt.navigator&&/(msie|trident)/i.test(rt.navigator.userAgent)):()=>!0,ri=rt.hasStandardBrowserEnv?{write(a,s,r,l,n,o){const i=[a+"="+encodeURIComponent(s)];H.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),H.isString(l)&&i.push("path="+l),H.isString(n)&&i.push("domain="+n),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(a){const s=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function si(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function li(a,s){return s?a.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):a}function os(a,s,r){let l=!si(s);return a&&(l||r==!1)?li(a,s):s}const Nr=a=>a instanceof pt?{...a}:a;function Vt(a,s){s=s||{};const r={};function l(x,m,d,g){return H.isPlainObject(x)&&H.isPlainObject(m)?H.merge.call({caseless:g},x,m):H.isPlainObject(m)?H.merge({},m):H.isArray(m)?m.slice():m}function n(x,m,d,g){if(H.isUndefined(m)){if(!H.isUndefined(x))return l(void 0,x,d,g)}else return l(x,m,d,g)}function o(x,m){if(!H.isUndefined(m))return l(void 0,m)}function i(x,m){if(H.isUndefined(m)){if(!H.isUndefined(x))return l(void 0,x)}else return l(void 0,m)}function c(x,m,d){if(d in s)return l(x,m);if(d in a)return l(void 0,x)}const u={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:c,headers:(x,m,d)=>n(Nr(x),Nr(m),d,!0)};return H.forEach(Object.keys({...a,...s}),function(m){const d=u[m]||n,g=d(a[m],s[m],m);H.isUndefined(g)&&d!==c||(r[m]=g)}),r}const cs=a=>{const s=Vt({},a);let{data:r,withXSRFToken:l,xsrfHeaderName:n,xsrfCookieName:o,headers:i,auth:c}=s;if(s.headers=i=pt.from(i),s.url=rs(os(s.baseURL,s.url,s.allowAbsoluteUrls),a.params,a.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),H.isFormData(r)){if(rt.hasStandardBrowserEnv||rt.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(H.isFunction(r.getHeaders)){const u=r.getHeaders(),x=["content-type","content-length"];Object.entries(u).forEach(([m,d])=>{x.includes(m.toLowerCase())&&i.set(m,d)})}}if(rt.hasStandardBrowserEnv&&(l&&H.isFunction(l)&&(l=l(s)),l||l!==!1&&ai(s.url))){const u=n&&o&&ri.read(o);u&&i.set(n,u)}return s},ni=typeof XMLHttpRequest<"u",ii=ni&&function(a){return new Promise(function(r,l){const n=cs(a);let o=n.data;const i=pt.from(n.headers).normalize();let{responseType:c,onUploadProgress:u,onDownloadProgress:x}=n,m,d,g,_,p;function N(){_&&_(),p&&p(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let k=new XMLHttpRequest;k.open(n.method.toUpperCase(),n.url,!0),k.timeout=n.timeout;function E(){if(!k)return;const f=pt.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders()),A={data:!c||c==="text"||c==="json"?k.responseText:k.response,status:k.status,statusText:k.statusText,headers:f,config:a,request:k};is(function(U){r(U),N()},function(U){l(U),N()},A),k=null}"onloadend"in k?k.onloadend=E:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(E)},k.onabort=function(){k&&(l(new Ne("Request aborted",Ne.ECONNABORTED,a,k)),k=null)},k.onerror=function(R){const A=R&&R.message?R.message:"Network Error",D=new Ne(A,Ne.ERR_NETWORK,a,k);D.event=R||null,l(D),k=null},k.ontimeout=function(){let R=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||ss;n.timeoutErrorMessage&&(R=n.timeoutErrorMessage),l(new Ne(R,A.clarifyTimeoutError?Ne.ETIMEDOUT:Ne.ECONNABORTED,a,k)),k=null},o===void 0&&i.setContentType(null),"setRequestHeader"in k&&H.forEach(i.toJSON(),function(R,A){k.setRequestHeader(A,R)}),H.isUndefined(n.withCredentials)||(k.withCredentials=!!n.withCredentials),c&&c!=="json"&&(k.responseType=n.responseType),x&&([g,p]=ya(x,!0),k.addEventListener("progress",g)),u&&k.upload&&([d,_]=ya(u),k.upload.addEventListener("progress",d),k.upload.addEventListener("loadend",_)),(n.cancelToken||n.signal)&&(m=f=>{k&&(l(!f||f.type?new Qt(null,a,k):f),k.abort(),k=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const P=Qn(n.url);if(P&&rt.protocols.indexOf(P)===-1){l(new Ne("Unsupported protocol "+P+":",Ne.ERR_BAD_REQUEST,a));return}k.send(o||null)})},oi=(a,s)=>{const{length:r}=a=a?a.filter(Boolean):[];if(s||r){let l=new AbortController,n;const o=function(x){if(!n){n=!0,c();const m=x instanceof Error?x:this.reason;l.abort(m instanceof Ne?m:new Qt(m instanceof Error?m.message:m))}};let i=s&&setTimeout(()=>{i=null,o(new Ne(`timeout ${s} of ms exceeded`,Ne.ETIMEDOUT))},s);const c=()=>{a&&(i&&clearTimeout(i),i=null,a.forEach(x=>{x.unsubscribe?x.unsubscribe(o):x.removeEventListener("abort",o)}),a=null)};a.forEach(x=>x.addEventListener("abort",o));const{signal:u}=l;return u.unsubscribe=()=>H.asap(c),u}},ci=oi,di=function*(a,s){let r=a.byteLength;if(!s||r<s){yield a;return}let l=0,n;for(;l<r;)n=l+s,yield a.slice(l,n),l=n},mi=async function*(a,s){for await(const r of ui(a))yield*di(r,s)},ui=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const s=a.getReader();try{for(;;){const{done:r,value:l}=await s.read();if(r)break;yield l}}finally{await s.cancel()}},vr=(a,s,r,l)=>{const n=mi(a,s);let o=0,i,c=u=>{i||(i=!0,l&&l(u))};return new ReadableStream({async pull(u){try{const{done:x,value:m}=await n.next();if(x){c(),u.close();return}let d=m.byteLength;if(r){let g=o+=d;r(g)}u.enqueue(new Uint8Array(m))}catch(x){throw c(x),x}},cancel(u){return c(u),n.return()}},{highWaterMark:2})},yr=64*1024,{isFunction:ma}=H,hi=(({Request:a,Response:s})=>({Request:a,Response:s}))(H.global),{ReadableStream:wr,TextEncoder:kr}=H.global,Cr=(a,...s)=>{try{return!!a(...s)}catch{return!1}},pi=a=>{a=H.merge.call({skipUndefined:!0},hi,a);const{fetch:s,Request:r,Response:l}=a,n=s?ma(s):typeof fetch=="function",o=ma(r),i=ma(l);if(!n)return!1;const c=n&&ma(wr),u=n&&(typeof kr=="function"?(p=>N=>p.encode(N))(new kr):async p=>new Uint8Array(await new r(p).arrayBuffer())),x=o&&c&&Cr(()=>{let p=!1;const N=new r(rt.origin,{body:new wr,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!N}),m=i&&c&&Cr(()=>H.isReadableStream(new l("").body)),d={stream:m&&(p=>p.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!d[p]&&(d[p]=(N,k)=>{let E=N&&N[p];if(E)return E.call(N);throw new Ne(`Response type '${p}' is not supported`,Ne.ERR_NOT_SUPPORT,k)})});const g=async p=>{if(p==null)return 0;if(H.isBlob(p))return p.size;if(H.isSpecCompliantForm(p))return(await new r(rt.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(H.isArrayBufferView(p)||H.isArrayBuffer(p))return p.byteLength;if(H.isURLSearchParams(p)&&(p=p+""),H.isString(p))return(await u(p)).byteLength},_=async(p,N)=>{const k=H.toFiniteNumber(p.getContentLength());return k??g(N)};return async p=>{let{url:N,method:k,data:E,signal:P,cancelToken:f,timeout:R,onDownloadProgress:A,onUploadProgress:D,responseType:U,headers:j,withCredentials:v="same-origin",fetchOptions:z}=cs(p),S=s||fetch;U=U?(U+"").toLowerCase():"text";let F=ci([P,f&&f.toAbortSignal()],R),I=null;const b=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let y;try{if(D&&x&&k!=="get"&&k!=="head"&&(y=await _(j,E))!==0){let W=new r(N,{method:"POST",body:E,duplex:"half"}),T;if(H.isFormData(E)&&(T=W.headers.get("content-type"))&&j.setContentType(T),W.body){const[Z,se]=gr(y,ya(fr(D)));E=vr(W.body,yr,Z,se)}}H.isString(v)||(v=v?"include":"omit");const L=o&&"credentials"in r.prototype,Y={...z,signal:F,method:k.toUpperCase(),headers:j.normalize().toJSON(),body:E,duplex:"half",credentials:L?v:void 0};I=o&&new r(N,Y);let O=await(o?S(I,z):S(N,Y));const G=m&&(U==="stream"||U==="response");if(m&&(A||G&&b)){const W={};["status","statusText","headers"].forEach(ne=>{W[ne]=O[ne]});const T=H.toFiniteNumber(O.headers.get("content-length")),[Z,se]=A&&gr(T,ya(fr(A),!0))||[];O=new l(vr(O.body,yr,Z,()=>{se&&se(),b&&b()}),W)}U=U||"text";let C=await d[H.findKey(d,U)||"text"](O,p);return!G&&b&&b(),await new Promise((W,T)=>{is(W,T,{data:C,headers:pt.from(O.headers),status:O.status,statusText:O.statusText,config:p,request:I})})}catch(L){throw b&&b(),L&&L.name==="TypeError"&&/Load failed|fetch/i.test(L.message)?Object.assign(new Ne("Network Error",Ne.ERR_NETWORK,p,I),{cause:L.cause||L}):Ne.from(L,L&&L.code,p,I)}}},xi=new Map,ds=a=>{let s=a?a.env:{};const{fetch:r,Request:l,Response:n}=s,o=[l,n,r];let i=o.length,c=i,u,x,m=xi;for(;c--;)u=o[c],x=m.get(u),x===void 0&&m.set(u,x=c?new Map:pi(s)),m=x;return x};ds();const Va={http:Tn,xhr:ii,fetch:{get:ds}};H.forEach(Va,(a,s)=>{if(a){try{Object.defineProperty(a,"name",{value:s})}catch{}Object.defineProperty(a,"adapterName",{value:s})}});const Sr=a=>`- ${a}`,bi=a=>H.isFunction(a)||a===null||a===!1,ms={getAdapter:(a,s)=>{a=H.isArray(a)?a:[a];const{length:r}=a;let l,n;const o={};for(let i=0;i<r;i++){l=a[i];let c;if(n=l,!bi(l)&&(n=Va[(c=String(l)).toLowerCase()],n===void 0))throw new Ne(`Unknown adapter '${c}'`);if(n&&(H.isFunction(n)||(n=n.get(s))))break;o[c||"#"+i]=n}if(!n){const i=Object.entries(o).map(([u,x])=>`adapter ${u} `+(x===!1?"is not supported by the environment":"is not available in the build"));let c=r?i.length>1?`since :
`+i.map(Sr).join(`
`):" "+Sr(i[0]):"as no adapter specified";throw new Ne("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return n},adapters:Va};function Ra(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new Qt(null,a)}function _r(a){return Ra(a),a.headers=pt.from(a.headers),a.data=Oa.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),ms.getAdapter(a.adapter||ar.adapter,a)(a).then(function(l){return Ra(a),l.data=Oa.call(a,a.transformResponse,l),l.headers=pt.from(l.headers),l},function(l){return ns(l)||(Ra(a),l&&l.response&&(l.response.data=Oa.call(a,a.transformResponse,l.response),l.response.headers=pt.from(l.response.headers))),Promise.reject(l)})}const us="1.12.2",za={};["object","boolean","number","function","string","symbol"].forEach((a,s)=>{za[a]=function(l){return typeof l===a||"a"+(s<1?"n ":" ")+a}});const Ar={};za.transitional=function(s,r,l){function n(o,i){return"[Axios v"+us+"] Transitional option '"+o+"'"+i+(l?". "+l:"")}return(o,i,c)=>{if(s===!1)throw new Ne(n(i," has been removed"+(r?" in "+r:"")),Ne.ERR_DEPRECATED);return r&&!Ar[i]&&(Ar[i]=!0,console.warn(n(i," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(o,i,c):!0}};za.spelling=function(s){return(r,l)=>(console.warn(`${l} is likely a misspelling of ${s}`),!0)};function gi(a,s,r){if(typeof a!="object")throw new Ne("options must be an object",Ne.ERR_BAD_OPTION_VALUE);const l=Object.keys(a);let n=l.length;for(;n-- >0;){const o=l[n],i=s[o];if(i){const c=a[o],u=c===void 0||i(c,o,a);if(u!==!0)throw new Ne("option "+o+" must be "+u,Ne.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ne("Unknown option "+o,Ne.ERR_BAD_OPTION)}}const xa={assertOptions:gi,validators:za},Nt=xa.validators;class wa{constructor(s){this.defaults=s||{},this.interceptors={request:new xr,response:new xr}}async request(s,r){try{return await this._request(s,r)}catch(l){if(l instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const o=n.stack?n.stack.replace(/^.+\n/,""):"";try{l.stack?o&&!String(l.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+o):l.stack=o}catch{}}throw l}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=Vt(this.defaults,r);const{transitional:l,paramsSerializer:n,headers:o}=r;l!==void 0&&xa.assertOptions(l,{silentJSONParsing:Nt.transitional(Nt.boolean),forcedJSONParsing:Nt.transitional(Nt.boolean),clarifyTimeoutError:Nt.transitional(Nt.boolean)},!1),n!=null&&(H.isFunction(n)?r.paramsSerializer={serialize:n}:xa.assertOptions(n,{encode:Nt.function,serialize:Nt.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),xa.assertOptions(r,{baseUrl:Nt.spelling("baseURL"),withXsrfToken:Nt.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=o&&H.merge(o.common,o[r.method]);o&&H.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),r.headers=pt.concat(i,o);const c=[];let u=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(r)===!1||(u=u&&N.synchronous,c.unshift(N.fulfilled,N.rejected))});const x=[];this.interceptors.response.forEach(function(N){x.push(N.fulfilled,N.rejected)});let m,d=0,g;if(!u){const p=[_r.bind(this),void 0];for(p.unshift(...c),p.push(...x),g=p.length,m=Promise.resolve(r);d<g;)m=m.then(p[d++],p[d++]);return m}g=c.length;let _=r;for(;d<g;){const p=c[d++],N=c[d++];try{_=p(_)}catch(k){N.call(this,k);break}}try{m=_r.call(this,_)}catch(p){return Promise.reject(p)}for(d=0,g=x.length;d<g;)m=m.then(x[d++],x[d++]);return m}getUri(s){s=Vt(this.defaults,s);const r=os(s.baseURL,s.url,s.allowAbsoluteUrls);return rs(r,s.params,s.paramsSerializer)}}H.forEach(["delete","get","head","options"],function(s){wa.prototype[s]=function(r,l){return this.request(Vt(l||{},{method:s,url:r,data:(l||{}).data}))}});H.forEach(["post","put","patch"],function(s){function r(l){return function(o,i,c){return this.request(Vt(c||{},{method:s,headers:l?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}wa.prototype[s]=r(),wa.prototype[s+"Form"]=r(!0)});const ba=wa;class rr{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const l=this;this.promise.then(n=>{if(!l._listeners)return;let o=l._listeners.length;for(;o-- >0;)l._listeners[o](n);l._listeners=null}),this.promise.then=n=>{let o;const i=new Promise(c=>{l.subscribe(c),o=c}).then(n);return i.cancel=function(){l.unsubscribe(o)},i},s(function(o,i,c){l.reason||(l.reason=new Qt(o,i,c),r(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=l=>{s.abort(l)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new rr(function(n){s=n}),cancel:s}}}const fi=rr;function Ni(a){return function(r){return a.apply(null,r)}}function vi(a){return H.isObject(a)&&a.isAxiosError===!0}const qa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(qa).forEach(([a,s])=>{qa[s]=a});const yi=qa;function hs(a){const s=new ba(a),r=qr(ba.prototype.request,s);return H.extend(r,ba.prototype,s,{allOwnKeys:!0}),H.extend(r,s,null,{allOwnKeys:!0}),r.create=function(n){return hs(Vt(a,n))},r}const Xe=hs(ar);Xe.Axios=ba;Xe.CanceledError=Qt;Xe.CancelToken=fi;Xe.isCancel=ns;Xe.VERSION=us;Xe.toFormData=Da;Xe.AxiosError=Ne;Xe.Cancel=Xe.CanceledError;Xe.all=function(s){return Promise.all(s)};Xe.spread=Ni;Xe.isAxiosError=vi;Xe.mergeConfig=Vt;Xe.AxiosHeaders=pt;Xe.formToJSON=a=>ls(H.isHTMLForm(a)?new FormData(a):a);Xe.getAdapter=ms.getAdapter;Xe.HttpStatusCode=yi;Xe.default=Xe;const ae=Xe,ps=h.createContext(),Rt=()=>{const a=h.useContext(ps);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a},wi=({children:a})=>{const[s,r]=h.useState(null),[l,n]=h.useState(!0),[o,i]=h.useState(()=>sessionStorage.getItem("authToken"));h.useEffect(()=>{o?ae.defaults.headers.common.Authorization=`Bearer ${o}`:delete ae.defaults.headers.common.Authorization},[o]),h.useEffect(()=>{(async()=>{if(o)try{const p=(await ae.get("/api/auth/verify",{timeout:3e4})).data.user;p?r({id:p._id||p.id,username:p.username,email:p.email,fullName:p.fullName||p.full_name||p.username,role:p.role,avatar:p.avatar,status:p.status||"active",permissions:p.permissions||{},lastLogin:new Date().toISOString()}):(console.error("No user data received from verify endpoint"),i(null),r(null))}catch(_){console.error("Auth verification failed:",_),_.code==="ECONNABORTED"&&ke.error("Timeout la verificare autentificare"),sessionStorage.removeItem("authToken"),i(null),r(null)}else window.location.pathname!=="/login"&&window.location.replace("/login");n(!1)})()},[o]);const d={user:s,token:o,loading:l,login:async(g,_)=>{var p,N;try{n(!0);const k=await ae.post("/api/auth/login",{username:g,password:_}),{token:E}=k.data;sessionStorage.setItem("authToken",E),i(E),ae.defaults.headers.common.Authorization=`Bearer ${E}`;const{user:P}=k.data;if(P){const f={id:P._id||P.id,username:P.username,email:P.email,fullName:P.fullName||P.full_name||P.username,role:P.role,avatar:P.avatar,status:P.status||"active",permissions:P.permissions||{},lastLogin:new Date().toISOString()};return r(f),ke.success(`Bun venit, ${f.fullName}!`),{success:!0}}else throw new Error("No user data received after login")}catch(k){const E=((N=(p=k.response)==null?void 0:p.data)==null?void 0:N.message)||"Eroare la autentificare";return ke.error(E),{success:!1,error:E}}finally{n(!1)}},logout:()=>{sessionStorage.removeItem("authToken"),i(null),r(null),delete ae.defaults.headers.common.Authorization,ke.success("V-ați deconectat cu succes!")},clearAuth:()=>{sessionStorage.removeItem("authToken"),i(null),r(null),delete ae.defaults.headers.common.Authorization,window.location.reload()},updateUser:g=>{r(g)},isAuthenticated:!!s};return e(ps.Provider,{value:d,children:a})};ae.defaults.baseURL="https://cashpot-backend.onrender.com";const xs=h.createContext(),ye=()=>{const a=h.useContext(xs);if(!a)throw new Error("useData must be used within DataProvider");return a},ki=({children:a})=>{const[s,r]=h.useState([]),[l,n]=h.useState([]),[o,i]=h.useState([]),[c,u]=h.useState([]),[x,m]=h.useState([]),[d,g]=h.useState([]),[_,p]=h.useState([]),[N,k]=h.useState([]),[E,P]=h.useState([]),[f,R]=h.useState([]),[A,D]=h.useState([]),[U,j]=h.useState([]),[v,z]=h.useState([]),[S,F]=h.useState([]),[I,b]=h.useState([]),[y,L]=h.useState([]),[Y,O]=h.useState([]),[G,C]=h.useState([]),[W,T]=h.useState([]),[Z,se]=h.useState([]),[ne,ce]=h.useState([]),[Ce,Re]=h.useState([]),[Ue,Ve]=h.useState(!1),et={totalCompanies:s.length,totalLocations:l.length,totalProviders:o.length,totalCabinets:x.length,totalGameMixes:d.length,totalSlots:_.length,totalWarehouse:N.length,totalMetrology:E.length,totalJackpots:f.length,totalInvoices:A.length,totalOnjnReports:U.length,totalLegalDocuments:v.length,totalUsers:S.length,totalGames:I.length,totalTasks:Z.length,totalMessages:ne.length,totalNotifications:Ce.length},qe={companies:{state:s,setState:r},locations:{state:l,setState:n},providers:{state:o,setState:i},platforms:{state:c,setState:u},cabinets:{state:x,setState:m},gameMixes:{state:d,setState:g},slots:{state:_,setState:p},warehouse:{state:N,setState:k},metrology:{state:E,setState:P},jackpots:{state:f,setState:R},invoices:{state:A,setState:D},onjnReports:{state:U,setState:j},legalDocuments:{state:v,setState:z},users:{state:S,setState:F},games:{state:I,setState:b},proprietari:{state:y,setState:L},contracts:{state:Y,setState:O},promotions:{state:G,setState:C},approvals:{state:W,setState:T},tasks:{state:Z,setState:se},messages:{state:ne,setState:ce},notifications:{state:Ce,setState:Re}},$e=async()=>{console.log("🚀 Starting to fetch all data in parallel..."),Ve(!0);try{const ie=Object.keys(qe),le=["companies","locations","providers"],be=ie.filter(B=>!le.includes(B)),te=le.map(B=>ae.get(`/api/${B}`,{timeout:3e4}).catch(M=>(console.error(`❌ Error fetching ${B}:`,M),{data:[]})));console.log(`📡 Making ${te.length} priority requests...`),(await Promise.all(te)).forEach((B,M)=>{const w=le[M],V=Array.isArray(B.data)?B.data:[];console.log(`✅ ${w}: ${V.length} items`),qe[w].setState(V)}),console.log("⚡ Priority data loaded!");try{const B=await ae.get("/api/cyber/slots-with-jackpots",{timeout:3e4}),M=Array.isArray(B.data)?B.data:[];console.log(`✅ slots with jackpots: ${M.length} items`),p(M)}catch(B){console.error("❌ Error fetching slots with jackpots, trying regular slots:",B);try{const M=await ae.get("/api/slots",{timeout:3e4}),w=Array.isArray(M.data)?M.data:[];console.log(`✅ slots (fallback): ${w.length} items`),p(w)}catch(M){console.error("❌ Error fetching regular slots, trying local file:",M);try{console.log("🔄 Trying to load slots from local file...");const w=await ae.get("/cyber-slots.json",{timeout:5e3}),V=Array.isArray(w.data)?w.data:[];if(console.log(`✅ slots (local file): ${V.length} items`),V.length>0){p(V),ke.success(`${V.length} sloturi încărcate din fișier local (mod offline)`);return}}catch(w){console.error("❌ Error fetching slots from local file:",w)}console.warn("⚠️ All slot data sources failed, using empty array"),p([])}}const Se=be.map(B=>ae.get(`/api/${B}`,{timeout:3e4}).catch(w=>(console.error(`❌ Error fetching ${B}:`,w),{data:[]})));console.log(`📡 Loading ${Se.length} remaining entities in background...`);const Pe=await Promise.all(Se);Pe.forEach((B,M)=>{const w=be[M],V=Array.isArray(B.data)?B.data:[];console.log(`✅ ${w}: ${V.length} items`),qe[w].setState(V)});const Ee=be.findIndex(B=>B==="promotions");if(Ee!==-1){const B=Pe[Ee];if((Array.isArray(B.data)?B.data:[]).length===0){console.log("🚨 PROMOTIONS EMPTY - trying direct API call...");try{const w=await ae.get("/api/promotions",{timeout:5e3});Array.isArray(w.data)&&w.data.length>0&&(console.log(`✅ Direct promotions fetch: ${w.data.length} items`),C(w.data))}catch(w){console.error("❌ Direct promotions fetch failed:",w)}}}console.log("⚡ All data loaded!")}catch(ie){console.error("Error fetching data:",ie),ke.error("Eroare la încărcarea datelor")}finally{Ve(!1)}};h.useEffect(()=>{console.log("🚀 DataContext useEffect triggered"),$e()},[]);const Ze=async()=>{const ie=new Date,le=new Date().toISOString().split("T")[0],be=new Date(ie);be.setDate(ie.getDate()+(8-ie.getDay())%7);const te=[];for(let B=0;B<5;B++){const M=new Date(be);M.setDate(be.getDate()+B*7),te.push(M.toISOString().split("T")[0])}const oe=new Date(te[4]);oe.setDate(oe.getDate()+7);const Se=oe.toISOString().split("T")[0],Pe=te.map((B,M)=>({amount:"10000",currency:"RON",date:B,winner:""}));return Q("promotions",{name:"Tombola Craiova - Premii Săptămânale",description:"Tombola cu 5 premii săptămânale a câte 10.000 lei fiecare. Extragerea are loc în fiecare luni.",start_date:le,end_date:Se,location:"Craiova",locations:[{location:"Craiova",start_date:le,end_date:Se}],prizes:Pe,status:"Active",notes:"Creat automat pentru testare"})},Q=async(ie,le)=>{try{if(console.log(`🚀 Creating ${ie} with data:`,le),ie==="slots"&&le.items&&Array.isArray(le.items)&&le.items.length>0)try{console.log("🔥 USING OFFLINE MODE FOR SLOTS IMPORT-MARINA");const te=le.items.map(oe=>({...oe,id:oe.id||Date.now()+Math.floor(Math.random()*1e3),created_at:oe.created_at||new Date().toISOString(),last_updated:oe.last_updated||new Date().toISOString(),imported_by:"Offline Import",import_source:"Marina (Offline)"}));return p(oe=>[...te,...oe]),ke.success(`${te.length} sloturi importate cu succes! (Mod offline)`),{success:!0,data:{imported:te.length,slots:te}}}catch(te){console.error("❌ Offline slots import failed:",te)}if(ie==="promotions")try{console.log("🔥 USING DIRECT ENDPOINT FOR PROMOTIONS");const te={name:le.name||"Test Promotion",description:le.description||"Auto-created test promotion",start_date:le.start_date||new Date().toISOString().split("T")[0],end_date:le.end_date||"2025-12-31",location:le.location||(le.locations&&le.locations.length>0?le.locations[0].location:"Default Location"),prizes:JSON.stringify(le.prizes||[]),locations:JSON.stringify(le.locations||[]),status:le.status||"Active",created_by:"Direct API",created_at:new Date().toISOString()};C(oe=>[...oe,te]);try{ae.post("https://cashpot-backend.onrender.com/api/promotions",te).then(oe=>{console.log("✅ Promotion saved to AWS successfully:",oe.data)}).catch(oe=>{console.error("❌ AWS save error:",oe),setTimeout(()=>{console.log("🔄 Retrying AWS save..."),ae.post("https://cashpot-backend.onrender.com/api/promotions",te).then(Se=>{console.log("✅ AWS retry successful:",Se.data)}).catch(Se=>{console.error("❌ AWS retry failed:",Se),setTimeout(()=>{console.log("🔄 Final AWS save attempt..."),ae.post("https://cashpot-backend.onrender.com/api/promotions/direct",te).catch(Pe=>{console.error("❌ All AWS save attempts failed:",Pe)})},3e3)})},2e3)})}catch(oe){console.error("❌ AWS save attempt error:",oe)}return ke.success("Promoție adăugată cu succes!"),{success:!0,data:te}}catch(te){console.error("❌ Direct promotions endpoint failed:",te)}const be=await ae.post(`/api/${ie}`,le);if(be.data){const te=be.data;if(te.compression){const{originalSize:oe,compressedSize:Se,compressionRatio:Pe,savedBytes:Ee}=te.compression,B=(oe/1024/1024).toFixed(2),M=(Se/1024/1024).toFixed(2),w=(Ee/1024).toFixed(2);ke.success(`Adăugat cu succes! PDF comprimat: ${B}MB → ${M}MB (${Pe}% reducere, ${w}KB economisite)`,{duration:6e3})}else ke.success("Adăugat cu succes!");return qe[ie].setState(oe=>[te,...oe]),{success:!0,data:te}}}catch(be){if(console.error(`Error creating ${ie}:`,be),ie==="slots"&&le.items&&Array.isArray(le.items)){console.log("🔄 FALLBACK: Creating offline slots import");const te=le.items.map(oe=>({...oe,id:oe.id||Date.now()+Math.floor(Math.random()*1e3),created_at:oe.created_at||new Date().toISOString(),last_updated:oe.last_updated||new Date().toISOString(),imported_by:"Offline Import Fallback",import_source:"Marina (Offline Fallback)"}));return p(oe=>[...te,...oe]),ke.success(`${te.length} sloturi importate în mod offline! Se vor sincroniza când serverul este disponibil.`),{success:!0,data:{imported:te.length,slots:te}}}if(ie==="promotions"){console.log("🔄 FALLBACK: Creating offline promotion");const te={id:Date.now(),name:le.name||"Offline Promotion",description:le.description||"Created in offline mode",start_date:le.start_date||new Date().toISOString().split("T")[0],end_date:le.end_date||"2025-12-31",location:le.location||(le.locations&&le.locations.length>0?le.locations[0].location:"Default Location"),prizes:le.prizes||[],locations:le.locations||[],status:le.status||"Active",created_by:"Offline Mode",created_at:new Date().toISOString()};C(oe=>[...oe,te]);try{console.log("🚀 Sending to AWS ONLY - NO LOCAL STORAGE"),ae.post("https://cashpot-backend.onrender.com/api/promotions",te).then(oe=>{console.log("✅ Promotion saved to AWS successfully:",oe.data)}).catch(oe=>{console.error("❌ AWS save error:",oe),setTimeout(()=>{console.log("🔄 Retrying AWS save..."),ae.post("https://cashpot-backend.onrender.com/api/promotions",te).then(Se=>{console.log("✅ AWS retry successful:",Se.data)}).catch(Se=>{console.error("❌ AWS retry failed:",Se),setTimeout(()=>{console.log("🔄 Final AWS save attempt..."),ae.post("https://cashpot-backend.onrender.com/api/promotions/direct",te).catch(Pe=>{console.error("❌ All AWS save attempts failed:",Pe),ae.post("https://cashpot-backend-working.onrender.com/api/promotions",te).then(Ee=>{console.log("✅ Alternative AWS endpoint successful:",Ee.data)}).catch(Ee=>{console.error("❌ Alternative AWS endpoint failed:",Ee)})})},3e3)})},2e3)})}catch(oe){console.error("❌ AWS save attempt error:",oe)}return ke.success("Promoție adăugată cu succes! Se sincronizează cu AWS..."),{success:!0,data:te}}return ke.error("Eroare la adăugare!"),{success:!1,error:be.message}}},de=async(ie,le,be)=>{try{const te=await ae.put(`/api/${ie}/${le}`,be);if(te.data){const oe=te.data;if(oe.compression){const{originalSize:Se,compressedSize:Pe,compressionRatio:Ee,savedBytes:B}=oe.compression,M=(Se/1024/1024).toFixed(2),w=(Pe/1024/1024).toFixed(2),V=(B/1024).toFixed(2);ke.success(`Actualizat cu succes! PDF comprimat: ${M}MB → ${w}MB (${Ee}% reducere, ${V}KB economisite)`,{duration:6e3})}else ke.success("Actualizat cu succes!");return qe[ie].setState(Se=>(Se||[]).map(Pe=>Pe.id===le?{...Pe,...oe}:Pe)),{success:!0,data:oe}}}catch(te){return console.error(`Error updating ${ie}:`,te),ke.error("Eroare la actualizare!"),{success:!1,error:te.message}}},ue=async(ie,le,be=!1)=>{try{return await ae.delete(`/api/${ie}/${le}`),qe[ie].setState(te=>te.filter(oe=>oe.id!==le)),be||ke.success("Șters cu succes!"),{success:!0}}catch(te){return console.error(`Error deleting ${ie}:`,te),be||ke.error("Eroare la ștergere!"),{success:!1,error:te.message}}},pe=ie=>{const le=qe[ie].state,be=le.length>0?Object.keys(le[0]||{}):[];let te=`<?xml version="1.0"?>
`;te+=`<?mso-application progid="Excel.Sheet"?>
`,te+=`<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
`,te+=` xmlns:o="urn:schemas-microsoft-com:office:office"
`,te+=` xmlns:x="urn:schemas-microsoft-com:office:excel"
`,te+=` xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
`,te+=` xmlns:html="http://www.w3.org/TR/REC-html40">
`,te+=`<Worksheet ss:Name="Sheet1">
`,te+=`<Table>
`,te+=`<Row>
`(be||[]).forEach(Ee=>{te+=`<Cell><Data ss:Type="String">${Ae(Ee)}</Data></Cell>
`}),te+=`</Row>
`(le||[]).forEach(Ee=>{te+=`<Row>
`(be||[]).forEach(B=>{const M=Ee[B];M==null?te+=`<Cell><Data ss:Type="String"></Data></Cell>
`:typeof M=="number"?te+=`<Cell><Data ss:Type="Number">${M}</Data></Cell>
`:te+=`<Cell><Data ss:Type="String">${Ae(String(M))}</Data></Cell>
`}),te+=`</Row>
`}),te+=`</Table>
`,te+=`</Worksheet>
`,te+="</Workbook>";const oe=new Blob([te],{type:"application/vnd.ms-excel"}),Se=URL.createObjectURL(oe),Pe=document.createElement("a");Pe.href=Se,Pe.download=`${ie}-${new Date().toISOString().split("T")[0]}.xls`,Pe.click(),URL.revokeObjectURL(Se),ke.success("Exportat în Excel cu succes!")},Ae=ie=>String(ie).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),fe={createTestWeeklyTombola:Ze,companies:s,locations:l,providers:o,platforms:c,cabinets:x,gameMixes:d,slots:_,warehouse:N,metrology:E,jackpots:f,invoices:A,onjnReports:U,legalDocuments:v,users:S,games:I,proprietari:y,contracts:Y,promotions:G,approvals:W,tasks:Z,messages:ne,notifications:Ce,loading:Ue,statistics:et,createItem:Q,updateItem:de,deleteItem:ue,exportData:ie=>{pe(ie)},exportToExcel:pe,exportToPDF:ie=>{const le=qe[ie].state,be=le.length>0?Object.keys(le[0]||{}):[];let te=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1 { color: #333; }
          table { border-collapse: collapse; width: 100%; margin-top: 20px; }
          th { background-color: #4CAF50; color: white; padding: 12px; text-align: left; border: 1px solid #ddd; }
          td { padding: 10px; border: 1px solid #ddd; }
          tr:nth-child(even) { background-color: #f2f2f2; }
          .footer { margin-top: 20px; text-align: center; color: #666; font-size: 12px; }
        </style>
      </head>
      <body>
        <h1>Raport ${ie.toUpperCase()}</h1>
        <p>Generat la: ${new Date().toLocaleString("ro-RO")}</p>
        <table>
          <thead>
            <tr>
              ${(be||[]).map(Se=>`<th>${Se}</th>`).join("")}
            </tr>
          </thead>
          <tbody>
    `(le||[]).forEach(Se=>{te+="<tr>"(be||[]).forEach(Pe=>{const Ee=Se[Pe],B=Ee==null?"":typeof Ee=="object"?JSON.stringify(Ee):String(Ee);te+=`<td>${B}</td>`}),te+="</tr>"});te+=`
          </tbody>
        </table>
        <div class="footer">
          Total înregistrări: ${le.length}
        </div>
      </body>
      </html>
    `;const oe=window.open("","","width=1200,height=800");oe.document.write(te),oe.document.close(),setTimeout(()=>{oe.print(),ke.success('PDF generat! Folosește "Salvează ca PDF" în dialogul de printare.')},250)},refreshData:$e};return e(xs.Provider,{value:fe,children:a})},bs=({size:a="lg",text:s="Se încarcă..."})=>t("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[t("div",{className:"relative",children:[e("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"}[a]} border-4 border-slate-200 border-t-blue-600 rounded-full animate-spin`}),e("div",{className:"absolute inset-0 flex items-center justify-center",children:e("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"})})]}),e("p",{className:"mt-4 text-slate-600 font-medium animate-pulse",children:s})]}),Er=({children:a})=>{const{isAuthenticated:s,loading:r}=Rt();return r?e(bs,{}):s?a:e(aa,{to:"/login",replace:!0})},q={DASHBOARD:"dashboard",COMPANIES:"companies",LOCATIONS:"locations",PROVIDERS:"providers",CABINETS:"cabinets",GAME_MIXES:"gameMixes",SLOTS:"slots",WAREHOUSE:"warehouse",METROLOGY:"metrology",JACKPOTS:"jackpots",INVOICES:"invoices",ONJN:"onjn",LEGAL:"legal",USERS:"users",SETTINGS:"settings",CONTRACTS:"contracts",CYBER_IMPORT:"cyberImport",MARKETING:"marketing"},re={VIEW:"view",CREATE:"create",EDIT:"edit",DELETE:"delete",EXPORT:"export",IMPORT:"import"},ga={[q.DASHBOARD]:{label:"📊 Dashboard",actions:[re.VIEW,re.EDIT]},[q.COMPANIES]:{label:"🏢 Companii",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.LOCATIONS]:{label:"📍 Locații",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.PROVIDERS]:{label:"🎮 Furnizori",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.CABINETS]:{label:"🎰 Cabinete",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.GAME_MIXES]:{label:"🎲 Game Mixes",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.SLOTS]:{label:"🍒 Sloturi",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT,re.IMPORT]},[q.WAREHOUSE]:{label:"📦 Depozit",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.METROLOGY]:{label:"⚖️ Metrologie",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.CONTRACTS]:{label:"📄 Contracte",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.INVOICES]:{label:"🧾 Facturi",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.JACKPOTS]:{label:"💰 Jackpot-uri",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE]},[q.ONJN]:{label:"⚖️ ONJN",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.LEGAL]:{label:"📋 Legal",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]},[q.USERS]:{label:"👥 Utilizatori",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE]},[q.SETTINGS]:{label:"⚙️ Setări",actions:[re.VIEW,re.EDIT]},[q.CYBER_IMPORT]:{label:"🔄 Import Cyber",actions:[re.VIEW,re.IMPORT]},[q.MARKETING]:{label:"📢 Marketing & Promoții",actions:[re.VIEW,re.CREATE,re.EDIT,re.DELETE,re.EXPORT]}},Ci={[re.VIEW]:"Vizualizare",[re.CREATE]:"Creare",[re.EDIT]:"Editare",[re.DELETE]:"Ștergere",[re.EXPORT]:"Export",[re.IMPORT]:"Import"},Dr={admin:{...Object.keys(q).reduce((a,s)=>{const r=q[s];return a[r]=ga[r].actions.reduce((l,n)=>(l[n]=!0,l),{}),a},{})},manager:{[q.DASHBOARD]:{view:!0,edit:!0},[q.COMPANIES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0,import:!0},[q.WAREHOUSE]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.METROLOGY]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.CONTRACTS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.INVOICES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.JACKPOTS]:{view:!0,create:!0,edit:!0,delete:!1},[q.ONJN]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.LEGAL]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.USERS]:{view:!0,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!0,edit:!1},[q.CYBER_IMPORT]:{view:!0,import:!0},[q.MARKETING]:{view:!0,create:!0,edit:!0,delete:!1,export:!0}},user:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0,import:!1},[q.WAREHOUSE]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.METROLOGY]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CONTRACTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.INVOICES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LEGAL]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!1,import:!1},[q.MARKETING]:{view:!0,create:!1,edit:!1,delete:!1,export:!0}},marketing:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.PROVIDERS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.CABINETS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.GAME_MIXES]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.SLOTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0,import:!1},[q.WAREHOUSE]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.METROLOGY]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.CONTRACTS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.INVOICES]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.LEGAL]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!1,import:!1},[q.MARKETING]:{view:!0,create:!0,edit:!0,delete:!0,export:!0}},operational:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0,import:!0},[q.WAREHOUSE]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.METROLOGY]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.CONTRACTS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.INVOICES]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LEGAL]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!0,import:!0},[q.MARKETING]:{view:!0,create:!1,edit:!1,delete:!1,export:!0}},financiar:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0,import:!1},[q.WAREHOUSE]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.METROLOGY]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.CONTRACTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.INVOICES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.LEGAL]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!1,import:!1},[q.MARKETING]:{view:!0,create:!1,edit:!1,delete:!1,export:!0}}},gs=(a,s,r)=>!a||!a[s]?!1:a[s][r]===!0,fa=a=>Dr[a]||Dr.user,Oe=({children:a,requiredRole:s,requiredPermission:r,module:l,action:n="view"})=>{const{user:o,loading:i}=Rt();return i?e(bs,{}):o?s&&o.role!==s&&o.role!=="admin"?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:t("div",{className:"text-center p-8",children:[e("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Acces Restricționat"}),e("p",{className:"text-slate-600 mb-6",children:"Nu aveți permisiunea necesară pentru a accesa această pagină."}),e("button",{onClick:()=>window.history.back(),className:"btn-primary",children:"Înapoi"})]})}):r&&l&&!gs(o.permissions,l,n)?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:t("div",{className:"text-center p-8",children:[e("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Permisiune Insuficientă"}),e("p",{className:"text-slate-600 mb-6",children:"Nu aveți permisiunea necesară pentru a accesa această secțiune."}),e("button",{onClick:()=>window.history.back(),className:"btn-primary",children:"Înapoi"})]})}):a:e(aa,{to:"/login",replace:!0})},Si=()=>{var A,D,U,j,v,z,S,F,I,b,y,L,Y,O;const a=Ye(),{login:s,isAuthenticated:r,loading:l}=Rt(),[n,o]=h.useState({username:"",password:""}),[i,c]=h.useState(!1),[u,x]=h.useState(!1),[m,d]=h.useState(!1),[g,_]=h.useState({logo:{type:"upload",url:"",file:null},loginImage:{type:"upload",url:"",file:null},loginButtonColor:{primary:"#FF7A00",secondary:"#FF9500",useGradient:!1},loginPageColor:{primary:"#FFFFFF",secondary:"#F5F5F5",useGradient:!1},loginCardColor:{primary:"#8B5CF6",secondary:"#A855F7",useGradient:!0},loginTextColor:{title:"#1e293b",labels:"#334155",text:"#64748b"},loginTexts:{title:"Welcome Back",emailLabel:"Email Address",passwordLabel:"Password",buttonText:"Sign In to CASHPOT",forgotPassword:"Forgot your password?",termsText:"By signing in, you agree to our Terms of Service and Privacy Policy",joinText:"New to CASHPOT? Create Account",supportText:"Need assistance? Contact our support team"}});h.useEffect(()=>{},[]),h.useEffect(()=>{r&&a("/dashboard",{replace:!0})},[r,a]);const p=G=>{o({...n,[G.target.name]:G.target.value})},N=async G=>{G.preventDefault(),x(!0),(await s(n.username,n.password)).success&&a("/dashboard",{replace:!0}),x(!1)};if(r)return e(aa,{to:"/dashboard",replace:!0});const k=g.logo.file||g.logo.url||"/favicon.svg",E=g.loginImage.file||g.loginImage.url||"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&q=80",P=g.loginButtonColor.useGradient?{background:`linear-gradient(to right, ${g.loginButtonColor.primary}, ${g.loginButtonColor.secondary})`}:{backgroundColor:g.loginButtonColor.primary},f=g.loginPageColor.useGradient?{background:`linear-gradient(to right, ${g.loginPageColor.primary}, ${g.loginPageColor.secondary})`}:{backgroundColor:g.loginPageColor.primary},R=(A=g.loginCardColor)!=null&&A.useGradient?{background:`linear-gradient(to right, ${g.loginCardColor.primary}, ${g.loginCardColor.secondary})`}:{backgroundColor:((D=g.loginCardColor)==null?void 0:D.primary)||"#8B5CF6"};return t("div",{className:"min-h-screen flex",children:[e("div",{className:"w-full lg:w-1/2 flex items-center justify-center pt-16",style:f,children:t("div",{className:"w-full max-w-lg px-8 lg:px-16",children:[t("div",{className:"rounded-2xl shadow-2xl p-16",style:R,children:[t("div",{className:"flex flex-col items-center mb-12",children:[e("img",{src:k,alt:"Logo",className:"h-20 md:h-24 object-contain mb-4",onError:G=>{G.target.src="/favicon.svg"}}),e("h1",{className:"text-2xl md:text-3xl font-bold text-white text-center",children:((U=g.loginTexts)==null?void 0:U.title)||"Welcome Back"}),e("p",{className:"text-white/80 text-center mt-2",children:"Access your CASHPOT dashboard"})]}),t("form",{onSubmit:N,className:"space-y-6",children:[t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-white",children:[((j=g.loginTexts)==null?void 0:j.emailLabel)||"Email",e("span",{className:"text-red-300",children:"*"})]}),e("input",{type:"text",name:"username",value:n.username,onChange:p,className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"your@email.com",required:!0,disabled:u})]}),t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-white",children:[((v=g.loginTexts)==null?void 0:v.passwordLabel)||"Password",e("span",{className:"text-red-300",children:"*"})]}),t("div",{className:"relative",children:[e("input",{type:i?"text":"password",name:"password",value:n.password,onChange:p,className:"w-full px-4 py-3 pr-12 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"••••••••",required:!0,disabled:u}),e("button",{type:"button",onClick:()=>c(!i),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",disabled:u,children:i?e(Ja,{size:20}):e(Qe,{size:20})})]})]}),e("div",{className:"flex items-center justify-between",children:t("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e("input",{type:"checkbox",checked:m,onChange:G=>d(G.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",disabled:u}),e("span",{className:"text-sm text-white font-medium",children:"Remember Password"})]})}),e("button",{type:"submit",disabled:u||l,className:"w-full py-3 rounded-lg text-white font-semibold shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:P,children:u||l?t("div",{className:"flex items-center justify-center space-x-2",children:[e("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e("span",{children:((z=g.loginTexts)==null?void 0:z.buttonText)||"Log In"})]}):((S=g.loginTexts)==null?void 0:S.buttonText)||"Log In"})]})]}),e("div",{className:"mt-8 text-center",children:e("a",{href:"#",className:"text-sm text-orange-500 hover:text-orange-600 font-medium hover:underline",children:((F=g.loginTexts)==null?void 0:F.forgotPassword)||"Forgot Password?"})}),e("div",{className:"mt-6 text-xs text-center",style:{color:((I=g.loginTextColor)==null?void 0:I.text)||"#64748b"},children:((b=g.loginTexts)==null?void 0:b.termsText)||"By clicking login you agree to the terms of the Club Membership Agreement and the Independent Partner Agreement"}),e("div",{className:"mt-4 text-center text-sm",style:{color:((y=g.loginTextColor)==null?void 0:y.text)||"#64748b"},children:e("span",{dangerouslySetInnerHTML:{__html:(((L=g.loginTexts)==null?void 0:L.joinText)||"New to CASHPOT? Create Account").replace(/Create Account/g,'<a href="#" class="text-orange-500 hover:text-orange-600 font-semibold hover:underline">Create Account</a>')}})}),e("div",{className:"mt-4 text-xs text-center",style:{color:((Y=g.loginTextColor)==null?void 0:Y.text)||"#64748b"},children:((O=g.loginTexts)==null?void 0:O.supportText)||"Need help? Contact us at login-support@in.group"})]})}),e("div",{className:"hidden lg:flex lg:w-1/2 items-center justify-center p-8",style:f,children:e("div",{className:"w-full h-full rounded-3xl overflow-hidden shadow-2xl",children:e("img",{src:E,alt:"Login Background",className:"w-full h-full object-cover",onError:G=>{G.target.src="https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&q=80"}})})})]})},he=({children:a})=>{const[s,r]=h.useState(!0),[l,n]=h.useState(new Date),[o,i]=h.useState(!1),{user:c,logout:u}=Rt(),{companies:x,locations:m,providers:d,platforms:g,cabinets:_,gameMixes:p,slots:N,warehouse:k,metrology:E,approvals:P,jackpots:f,invoices:R,onjnReports:A,legalDocuments:D,users:U,promotions:j,tasks:v,messages:z,notifications:S}=ye(),{theme:F,toggleTheme:I}=Ul(),b=ys(),[y,L]=$t.useState({logo:{type:"upload",url:"",file:null},headerColor:{primary:"#2563eb",secondary:"#4f46e5",useGradient:!0},appTitle:"CASHPOT V7",appSubtitle:"Gaming Management System"});$t.useEffect(()=>{Y()},[]);const Y=async()=>{try{const T=await ae.get("/api/auth/verify");if(T.data.success&&T.data.user){const Z=T.data.user.preferences||{};if(Z.appSettings){if(L(Z.appSettings),Z.appSettings.favicon&&Z.appSettings.favicon.file){const se=document.querySelector("link[rel~='icon']");if(se)se.href=Z.appSettings.favicon.file;else{const ne=document.createElement("link");ne.rel="icon",ne.type="image/x-icon",ne.href=Z.appSettings.favicon.file,document.head.appendChild(ne)}}console.log("✅ Loaded app settings in Layout from server");return}}}catch{console.log("⚠️ Could not load settings from server in Layout")}};h.useEffect(()=>{const T=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(T)},[]),h.useEffect(()=>{const T=Z=>{o&&!Z.target.closest(".notification-container")&&i(!1)};return document.addEventListener("click",T),()=>document.removeEventListener("click",T)},[o]);const G=[{id:"dashboard",label:"Dashboard",icon:it,path:"/dashboard",count:null,module:q.DASHBOARD},{id:"companies",label:"Companii",icon:_e,path:"/companies",count:x.length,module:q.COMPANIES},{id:"locations",label:"Locații",icon:Fe,path:"/locations",count:m.length,module:q.LOCATIONS},{id:"providers",label:"Furnizori",icon:xt,path:"/providers",count:d.length,module:q.PROVIDERS},{id:"cabinets",label:"Cabinete",icon:ct,path:"/cabinets",count:_.length,module:q.CABINETS},{id:"game-mixes",label:"Game Mixes",icon:Bt,path:"/game-mixes",count:p.length,module:q.GAME_MIXES},{id:"slots",label:"Sloturi",icon:it,path:"/slots",count:N.length,module:q.SLOTS},{id:"warehouse",label:"Depozit",icon:At,path:"/warehouse",count:k.length,module:q.WAREHOUSE},{id:"metrology",label:"Metrologie CVT",icon:Ht,path:"/metrology",count:E.length,module:q.METROLOGY},{id:"jackpots",label:"Jackpots",icon:Gt,path:"/jackpots",count:f.length,module:q.JACKPOTS},{id:"invoices",label:"Facturi",icon:ge,path:"/invoices",count:R.length,module:q.INVOICES},{id:"onjn-reports",label:"Rapoarte ONJN",icon:Na,path:"/onjn-reports",count:A.length,module:q.ONJN},{id:"legal-documents",label:"Documente Legale",icon:ge,path:"/legal-documents",count:D.length,module:q.LEGAL},{id:"marketing",label:"Marketing",icon:st,path:"/marketing",count:(j==null?void 0:j.length)||0,module:q.MARKETING},{id:"tasks",label:"Sarcini",icon:zt,path:"/tasks",count:(v==null?void 0:v.length)||0},{id:"messages",label:"Mesaje",icon:lr,path:"/messages",count:(z==null?void 0:z.filter(T=>T.recipient_id===(c==null?void 0:c.userId)&&!T.is_read).length)||0},{id:"users",label:"Utilizatori",icon:xt,path:"/users",count:U.length,module:q.USERS,requiresAdmin:!0},{id:"settings",label:"Setări",icon:Lt,path:"/settings",count:null,module:q.SETTINGS}].filter(T=>{if((c==null?void 0:c.role)==="admin")return!0;if(T.requiresAdmin&&(c==null?void 0:c.role)!=="admin")return!1;if(!T.module)return!0;const Z=c!=null&&c.permissions&&Object.keys(c.permissions).length>0?c.permissions:fa(c==null?void 0:c.role);return gs(Z,T.module,"view")});G.find(T=>T.path===b.pathname);const C=S.filter(T=>!T.is_read).length+z.filter(T=>T.recipient_id===(c==null?void 0:c.userId)&&!T.is_read).length,W=F==="dark"?{background:"linear-gradient(to right, #1e293b, #0f172a)"}:y.headerColor.useGradient?{background:`linear-gradient(to right, ${y.headerColor.primary}, ${y.headerColor.secondary})`}:{backgroundColor:y.headerColor.primary};return t("div",{className:"flex h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[e("div",{className:`fixed top-0 left-0 right-0 backdrop-blur-xl border-b text-white px-4 md:px-6 py-2 md:py-3 z-30 shadow-2xl ${F==="dark"?"border-slate-700/50 shadow-slate-900/20":"border-white/20 shadow-blue-500/10"}`,style:W,children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-2 md:space-x-4",children:[e("button",{onClick:()=>r(!s),className:`p-2 rounded-xl transition-all duration-200 hover:shadow-lg ${F==="dark"?"hover:bg-slate-700/80":"hover:bg-slate-100/80"}`,children:e(Ss,{size:20})}),t("div",{className:"flex items-center",children:[y.logo.file||y.logo.url?e("img",{src:y.logo.file||y.logo.url,alt:"Logo",className:"h-8 md:h-12 object-contain",onError:T=>{T.target.style.display="none",T.target.nextSibling.style.display="flex"}}):null,e("div",{className:"w-8 h-8 md:w-12 md:h-12 bg-gradient-to-br from-amber-400 via-orange-500 to-red-500 rounded-2xl flex items-center justify-center shadow-xl shadow-orange-500/30 ring-2 ring-orange-200/50",style:{display:y.logo.file||y.logo.url?"none":"flex"},children:e("span",{className:"text-white font-bold text-base md:text-xl",children:"C"})})]})]}),t("div",{className:"flex items-center space-x-2 md:space-x-4",children:[t("div",{className:"hidden md:block text-right",children:[e("div",{className:"text-white font-semibold text-sm",children:l.toLocaleString("ro-RO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e("div",{className:"text-white/70 text-xs",children:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"🖥️ Local":"☁️ Online"})]}),e("button",{onClick:I,className:"p-2 rounded-xl hover:bg-white/20 transition-all duration-200 hover:shadow-lg group",title:F==="dark"?"Light Mode":"Dark Mode",children:F==="dark"?e(_s,{size:18,className:"group-hover:scale-110 transition-transform text-white"}):e(As,{size:18,className:"group-hover:scale-110 transition-transform text-white"})}),t("div",{className:"relative hidden sm:block notification-container",children:[t("button",{onClick:()=>i(!o),className:"p-2 rounded-xl hover:bg-white/20 transition-all duration-200 hover:shadow-lg group",children:[e(Pa,{size:18,className:"group-hover:scale-110 transition-transform text-white"}),C>0&&e("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-gradient-to-r from-red-500 to-pink-500 rounded-full shadow-lg animate-pulse flex items-center justify-center text-xs text-white font-bold",children:C>99?"99+":C})]}),o&&t("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50 z-50 max-h-96 overflow-hidden",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-6 py-4 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-indigo-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl shadow-lg",children:e(Pa,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-lg font-bold text-white",children:"Notificări"})]}),e("button",{onClick:()=>i(!1),className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-2 transition-all duration-200",children:e(ve,{size:20})})]}),e("div",{className:"max-h-80 overflow-y-auto",children:C===0?t("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:[e("div",{className:"mb-2",children:e(Pa,{size:32,className:"mx-auto text-gray-300 dark:text-gray-600"})}),"Nu ai notificări noi"]}):t("div",{className:"divide-y divide-gray-200/50 dark:divide-slate-700/50",children:[z.filter(T=>T.recipient_id===(c==null?void 0:c.userId)&&!T.is_read).slice(0,5).map(T=>e("div",{className:"p-4 hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 dark:hover:from-blue-900/20 dark:hover:to-indigo-900/20 transition-all duration-200",children:t("div",{className:"text-sm text-gray-900 dark:text-white",children:[t("div",{className:"font-semibold text-blue-600 dark:text-blue-400 mb-1 flex items-center",children:[e(lr,{size:14,className:"mr-2"}),"Mesaj nou"]}),e("div",{className:"text-gray-600 dark:text-gray-300 truncate mb-2",children:T.content}),e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(T.created_at).toLocaleString("ro-RO")})]})},`msg-${T.id}`)),S.filter(T=>!T.is_read).slice(0,5).map(T=>e("div",{className:"p-4 hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 dark:hover:from-blue-900/20 dark:hover:to-indigo-900/20 transition-all duration-200",children:t("div",{className:"text-sm text-gray-900 dark:text-white",children:[e("div",{className:"font-semibold text-indigo-600 dark:text-indigo-400 mb-1",children:T.title}),e("div",{className:"text-gray-600 dark:text-gray-300 mb-2",children:T.content}),e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(T.created_at).toLocaleString("ro-RO")})]})},`notif-${T.id}`))]})}),C>0&&e("div",{className:"p-4 border-t border-gray-200/50 dark:border-slate-700/50 bg-gradient-to-r from-blue-50/30 to-indigo-50/30 dark:from-blue-900/10 dark:to-indigo-900/10",children:e("a",{href:"/messages",className:"block w-full text-center text-sm font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",onClick:()=>i(!1),children:"Vezi toate mesajele →"})})]})]}),t("div",{className:"flex items-center space-x-3 md:space-x-4",children:[c!=null&&c.avatar?e("img",{src:c.avatar,alt:(c==null?void 0:c.fullName)||(c==null?void 0:c.username)||"Admin",className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-white/50 dark:border-slate-500/50 shadow-xl object-cover"}):e("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-semibold text-base md:text-lg border-2 border-white/50 dark:border-slate-500/50 shadow-xl",children:((c==null?void 0:c.fullName)||(c==null?void 0:c.username)||"A").charAt(0).toUpperCase()}),e("div",{className:"text-sm md:text-base hidden sm:block",children:e("div",{className:"font-semibold text-white",children:c?c.fullName||c.username:"Loading..."})})]}),e("button",{onClick:u,className:"p-2 bg-gradient-to-r from-red-500 to-red-600 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-lg hover:shadow-red-500/25 group",children:e(Es,{size:16,className:"group-hover:scale-110 transition-transform"})})]})]})}),e("div",{className:`${s?"w-64 md:w-72":"w-0 md:w-20"} bg-white/70 dark:bg-slate-800/90 backdrop-blur-xl border-r border-white/30 dark:border-slate-700/50 transition-all duration-300 flex flex-col mt-14 md:mt-20 shadow-2xl shadow-slate-500/10 dark:shadow-slate-900/20 fixed md:relative z-20 h-full ${s?"translate-x-0":"-translate-x-full md:translate-x-0"}`,children:e("div",{className:"flex-1 sidebar-scroll p-2 md:p-3",style:{maxHeight:"calc(100vh - 5rem)"},children:e("nav",{className:"space-y-1",children:G.map(T=>{const Z=b.pathname===T.path;return t(ws,{to:T.path,onDoubleClick:()=>r(!s),className:`w-full flex items-center ${s?"justify-between":"justify-center"} p-2 md:p-3 rounded-2xl text-left transition-all duration-200 group ${Z?"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-600 text-white shadow-xl shadow-blue-500/25 ring-2 ring-blue-200/50":"text-slate-700 dark:text-slate-300 hover:bg-white/60 dark:hover:bg-slate-700/60 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]"}`,title:s?"":T.label,children:[t("div",{className:`flex items-center ${s?"space-x-3":"justify-center"}`,children:[e(T.icon,{className:`text-lg md:text-xl transition-transform group-hover:scale-110 ${Z?"drop-shadow-lg":""}`}),s&&e("span",{className:`font-semibold text-sm md:text-base transition-colors ${Z?"text-white":"text-slate-700 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white"}`,children:T.label})]}),s&&T.count!==null&&e("span",{className:`text-xs px-3 md:px-4 py-1.5 md:py-2 rounded-full font-bold transition-all duration-200 ${Z?"bg-white/20 text-white backdrop-blur-sm border border-white/30":"bg-gradient-to-r from-blue-100 to-indigo-100 dark:from-slate-600 dark:to-slate-700 text-blue-700 dark:text-slate-300 group-hover:from-blue-200 group-hover:to-indigo-200 dark:group-hover:from-slate-500 dark:group-hover:to-slate-600"}`,children:T.count})]},T.id)})})})}),s&&e("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-10 md:hidden",onClick:()=>r(!1)}),e("div",{className:"flex-1 flex flex-col overflow-hidden mt-14 md:mt-20 bg-white dark:bg-slate-900 ",children:e("div",{className:"flex-1 overflow-auto p-6 md:p-8 bg-slate-50 dark:bg-slate-900",children:a})})]})},He=({data:a,columns:s,onEdit:r,onDelete:l,onView:n,onViewContracts:o,onViewProprietari:i,onRowClick:c,loading:u=!1,searchTerm:x="",onSearchChange:m,selectedItems:d=[],onSelectAll:g,onSelectItem:_,moduleColor:p="blue"})=>{const[N,k]=h.useState(1),[E,P]=h.useState(""),[f,R]=h.useState("asc"),[A,D]=h.useState(50),U={blue:{header:"from-blue-50/80 to-blue-100/80 dark:from-blue-900/20 dark:to-blue-800/20",text:"text-blue-800 dark:text-blue-200",hover:"hover:bg-blue-100/60 dark:hover:bg-blue-700/30",accent:"text-blue-600"},green:{header:"from-emerald-50/80 to-emerald-100/80 dark:from-emerald-900/20 dark:to-emerald-800/20",text:"text-emerald-800 dark:text-emerald-200",hover:"hover:bg-emerald-100/60 dark:hover:bg-emerald-700/30",accent:"text-emerald-600"},purple:{header:"from-purple-50/80 to-purple-100/80 dark:from-purple-900/20 dark:to-purple-800/20",text:"text-purple-800 dark:text-purple-200",hover:"hover:bg-purple-100/60 dark:hover:bg-purple-700/30",accent:"text-purple-600"},orange:{header:"from-orange-50/80 to-orange-100/80 dark:from-orange-900/20 dark:to-orange-800/20",text:"text-orange-800 dark:text-orange-200",hover:"hover:bg-orange-100/60 dark:hover:bg-orange-700/30",accent:"text-orange-600"},red:{header:"from-red-50/80 to-red-100/80 dark:from-red-900/20 dark:to-red-800/20",text:"text-red-800 dark:text-red-200",hover:"hover:bg-red-100/60 dark:hover:bg-red-700/30",accent:"text-red-600"},indigo:{header:"from-indigo-50/80 to-indigo-100/80 dark:from-indigo-900/20 dark:to-indigo-800/20",text:"text-indigo-800 dark:text-indigo-200",hover:"hover:bg-indigo-100/60 dark:hover:bg-indigo-700/30",accent:"text-indigo-600"},teal:{header:"from-teal-50/80 to-teal-100/80 dark:from-teal-900/20 dark:to-teal-800/20",text:"text-teal-800 dark:text-teal-200",hover:"hover:bg-teal-100/60 dark:hover:bg-teal-700/30",accent:"text-teal-600"},pink:{header:"from-pink-50/80 to-pink-100/80 dark:from-pink-900/20 dark:to-pink-800/20",text:"text-pink-800 dark:text-pink-200",hover:"hover:bg-pink-100/60 dark:hover:bg-pink-700/30",accent:"text-pink-600"}},j=U[p]||U.blue,v=Math.ceil(a.length/A),z=(N-1)*A,S=a.slice(z,z+A),F=b=>{E===b?R(f==="asc"?"desc":"asc"):(P(b),R("asc"))},I=[...S].sort((b,y)=>{if(!E)return 0;const L=b[E]||"",Y=y[E]||"";return f==="asc"?L.toString().localeCompare(Y.toString()):Y.toString().localeCompare(L.toString())});return u?e("div",{className:"card p-8",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 rounded w-1/4"}),e("div",{className:"space-y-3",children:[...Array(5)].map((b,y)=>e("div",{className:"h-16 bg-slate-200 rounded"},y))})]})}):t("div",{className:"card overflow-hidden",children:[e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full min-w-[800px] bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700",children:[e("thead",{className:`table-header bg-gradient-to-r ${j.header}`,children:t("tr",{children:[e("th",{className:"p-6 w-12",children:e("div",{className:"flex items-center justify-center",children:e("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-slate-100 dark:bg-slate-700 border-slate-300 dark:border-slate-600 rounded focus:ring-blue-500 focus:ring-2",checked:S.length>0&&S.every(b=>d.includes(b.id)),onChange:b=>g&&g(b.target.checked)})})}),e("th",{className:`text-left p-6 font-bold ${j.text} text-base uppercase tracking-wider w-16`,children:"#"}),s.map(b=>e("th",{className:`text-left p-6 font-bold ${j.text} text-base uppercase tracking-wider ${b.sortable?`cursor-pointer ${j.hover} transition-colors`:""}`,onClick:()=>b.sortable&&F(b.key),children:t("div",{className:"flex items-center space-x-2",children:[e("span",{children:b.label}),b.sortable&&E===b.key&&e("span",{className:j.accent,children:f==="asc"?"↑":"↓"})]})},b.key)),e("th",{className:`text-left p-6 font-bold ${j.text} text-base uppercase tracking-wider`,children:"Acțiuni"})]})}),e("tbody",{className:"divide-y divide-slate-200/50 dark:divide-slate-700/50",children:I.map((b,y)=>t("tr",{className:`table-row hover:bg-slate-50 dark:hover:bg-slate-750 transition-colors ${c?"cursor-pointer":""}`,onClick:()=>c&&c(b),children:[e("td",{className:"p-6",onClick:L=>L.stopPropagation(),children:e("div",{className:"flex items-center justify-center",children:e("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-slate-100 dark:bg-slate-700 border-slate-300 dark:border-slate-600 rounded focus:ring-blue-500 focus:ring-2 group-hover:bg-blue-50 dark:group-hover:bg-slate-600",checked:d.includes(b.id),onChange:L=>_&&_(b.id,L.target.checked)})})}),e("td",{className:"p-6 text-slate-600 dark:text-slate-400 font-semibold text-base",children:z+y+1}),s.map(L=>e("td",{className:"p-6 text-base font-medium text-slate-700 dark:text-slate-300",children:L.render?L.render(b):b[L.key]},L.key)),(r||l||n||o||i)&&e("td",{className:"p-6",onClick:L=>L.stopPropagation(),children:t("div",{className:"flex flex-col space-y-2",children:[t("div",{className:"flex space-x-2",children:[n&&e("button",{onClick:()=>n(b),className:"p-2 text-blue-600 dark:text-blue-400 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 hover:from-blue-100 hover:to-indigo-100 dark:hover:from-blue-800/40 dark:hover:to-indigo-800/40 rounded-xl shadow-lg hover:shadow-blue-500/25 transition-all duration-200 group/btn",title:"Previzualizează",children:e(Qe,{size:14,className:"group-hover/btn:scale-110 transition-transform"})}),o&&e("button",{onClick:()=>o(b),className:"p-2 text-green-600 dark:text-green-400 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 hover:from-green-100 hover:to-emerald-100 dark:hover:from-green-800/40 dark:hover:to-emerald-800/40 rounded-xl shadow-lg hover:shadow-green-500/25 transition-all duration-200 group/btn",title:"Vezi contracte",children:e(ge,{size:14,className:"group-hover/btn:scale-110 transition-transform"})}),i&&e("button",{onClick:()=>i(b),className:"p-2 text-purple-600 dark:text-purple-400 bg-gradient-to-r from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 hover:from-purple-100 hover:to-violet-100 dark:hover:from-purple-800/40 dark:hover:to-violet-800/40 rounded-xl shadow-lg hover:shadow-purple-500/25 transition-all duration-200 group/btn",title:"Vezi proprietari",children:e(_e,{size:14,className:"group-hover/btn:scale-110 transition-transform"})})]}),t("div",{className:"flex space-x-2",children:[r&&e("button",{onClick:()=>r(b),className:"p-2 text-emerald-600 dark:text-emerald-400 bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/30 dark:to-green-900/30 hover:from-emerald-100 hover:to-green-100 dark:hover:from-emerald-800/40 dark:hover:to-green-800/40 rounded-xl shadow-lg hover:shadow-emerald-500/25 transition-all duration-200 group/btn",title:"Editează",children:e(at,{size:14,className:"group-hover/btn:scale-110 transition-transform"})}),l&&e("button",{onClick:()=>l(b),className:"p-2 text-red-600 dark:text-red-400 bg-gradient-to-r from-red-50 to-pink-50 dark:from-red-900/30 dark:to-pink-900/30 hover:from-red-100 hover:to-pink-100 dark:hover:from-red-800/40 dark:hover:to-pink-800/40 rounded-xl shadow-lg hover:shadow-red-500/25 transition-all duration-200 group/btn",title:"Șterge",children:e(je,{size:14,className:"group-hover/btn:scale-110 transition-transform"})})]})]})})]},b._id||b.id))})]})}),t("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-700 dark:via-slate-800 dark:to-slate-700 px-6 md:px-8 py-4 md:py-6 border-t border-slate-200/50 dark:border-slate-600/50 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[t("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e("span",{className:"text-sm md:text-base font-semibold text-slate-700 dark:text-slate-200",children:"Înregistrări:"}),t("select",{value:A,onChange:b=>{D(Number(b.target.value)),k(1)},className:"border-2 border-slate-200 dark:border-slate-600 rounded-2xl px-4 py-2 text-sm font-medium bg-white/80 dark:bg-slate-700/80 backdrop-blur-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 transition-all duration-200 shadow-lg text-slate-900 dark:text-slate-100",children:[e("option",{value:15,children:"15"}),e("option",{value:25,children:"25"}),e("option",{value:50,children:"50"}),e("option",{value:100,children:"100"}),e("option",{value:200,children:"200"})]}),t("span",{className:"text-sm md:text-base text-slate-600 dark:text-slate-300 font-medium",children:[z+1,"-",Math.min(z+A,a.length)," din ",a.length]})]}),t("div",{className:"flex items-center justify-between sm:justify-start gap-3",children:[e("button",{onClick:()=>k(Math.max(1,N-1)),disabled:N===1,className:"px-4 md:px-6 py-2 md:py-3 border-2 border-slate-200 dark:border-slate-600 rounded-2xl text-sm md:text-base font-bold hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl group text-slate-700 dark:text-slate-200",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Înapoi"})}),e("div",{className:"flex items-center space-x-2",children:t("span",{className:"text-sm md:text-base text-slate-600 dark:text-slate-200 font-bold bg-white/80 dark:bg-slate-800/80 px-4 py-2 rounded-2xl shadow-lg",children:["Pag ",N,"/",v||1]})}),e("button",{onClick:()=>k(Math.min(v,N+1)),disabled:N===v,className:"px-4 md:px-6 py-2 md:py-3 border-2 border-slate-200 dark:border-slate-600 rounded-2xl text-sm md:text-base font-bold hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl group text-slate-700 dark:text-slate-200",children:e("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:"Înainte"})})]})]})]})},kt=({pdfUrl:a,title:s="Document PDF",placeholder:r="Nu există document de afișat",placeholderSubtext:l="Atașează un document PDF pentru vizualizare"})=>a?t("div",{className:"space-y-4",children:[e("div",{className:"aspect-[3/4] bg-white dark:bg-slate-800 rounded-lg border-2 border-slate-200 dark:border-slate-600 overflow-hidden",children:e("iframe",{src:a,className:"w-full h-full",title:s})}),t("div",{className:"flex space-x-3",children:[t("button",{onClick:()=>window.open(a,"_blank"),className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:[e(Qe,{className:"w-4 h-4"}),e("span",{children:"Vizualizează"})]}),t("button",{onClick:()=>window.open(a,"_blank"),className:"flex-1 btn-secondary flex items-center justify-center space-x-2",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Descarcă"})]})]})]}):e("div",{className:"aspect-[3/4] bg-slate-100 dark:bg-slate-700 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 flex items-center justify-center",children:t("div",{className:"text-center text-slate-500 dark:text-slate-400",children:[e(ge,{className:"w-16 h-16 mx-auto mb-2 opacity-50"}),e("p",{className:"text-sm font-medium",children:r}),e("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1",children:l})]})}),_i=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",type:"Furnizor",license:"",email:"",phone:"",address:"",contactPerson:"",status:"Activ",notes:"",cui:"",cuiFile:null,cuiPreview:null});h.useEffect(()=>{a&&n({name:a.name||"",type:a.type||"Furnizor",license:a.license||"",email:a.email||"",phone:a.phone||"",address:a.address||"",contactPerson:a.contact_person||"",status:a.status||"Activ",notes:a.notes||"",cui:a.cui||"",cuiFile:a.cuiFile||null,cuiPreview:a.cuiFile||null})},[a]);const o=m=>{n({...l,[m.target.name]:m.target.value})},i=m=>{const d=m.target.files[0];if(d){const g=new FileReader;g.onload=_=>{const p=_.target.result;n(N=>({...N,cuiFile:p,cuiPreview:p}))},g.readAsDataURL(d)}},c=()=>{window.confirm("Sigur doriți să ștergeți documentul CUI?")&&n(m=>({...m,cuiFile:null,cuiPreview:null}))},u=m=>m?m.includes("data:image")?e(St,{className:"w-4 h-4"}):e(ge,{className:"w-4 h-4"}):e(ge,{className:"w-4 h-4"});return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-purple-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Companie":"Adaugă Companie"}),e("p",{className:"text-blue-100 text-sm font-medium",children:"Completează informațiile despre companie"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault();const d={...l,contact_person:l.contactPerson};delete d.contactPerson,r(d)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Tip Companie *"}),t("select",{name:"type",value:l.type,onChange:o,className:"input-field",required:!0,children:[e("option",{value:"Operator",children:"Operator (Proprietar)"}),e("option",{value:"Furnizor",children:"Furnizor (pentru contracte)"})]}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Operator = compania ta de bază | Furnizor = companii externe pentru contracte"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Nume Companie *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"input-field",placeholder:"ex: BRML Industries SRL",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Număr Licență *"}),e("input",{type:"text",name:"license",value:l.license,onChange:o,className:"input-field",placeholder:"ex: L-2024-001",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Persoană de Contact *"}),e("input",{type:"text",name:"contactPerson",value:l.contactPerson,onChange:o,className:"input-field",placeholder:"ex: Ion Popescu",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Email *"}),e("input",{type:"email",name:"email",value:l.email,onChange:o,className:"input-field",placeholder:"ex: contact@brml.ro",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Telefon *"}),e("input",{type:"tel",name:"phone",value:l.phone,onChange:o,className:"input-field",placeholder:"ex: +40 21 123 4567",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"CUI (Certificat Unic de Înregistrare)"}),e("input",{type:"text",name:"cui",value:l.cui,onChange:o,className:"input-field",placeholder:"ex: RO12345678"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Status"}),t("select",{name:"status",value:l.status,onChange:o,className:"input-field",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Suspendat",children:"Suspendat"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Adresă Completă *"}),e("textarea",{name:"address",value:l.address,onChange:o,className:"input-field min-h-[100px] resize-none",placeholder:"ex: Str. Centrală nr. 1, București, România",required:!0})]}),t("div",{className:"space-y-4",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Document CUI (PDF sau JPG)"}),t("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl p-6 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",children:[e("input",{type:"file",id:"cuiFile",accept:".pdf,.jpg,.jpeg,.png",onChange:i,className:"hidden"}),t("label",{htmlFor:"cuiFile",className:"cursor-pointer flex flex-col items-center space-y-3",children:[e("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white",children:e(ze,{className:"w-6 h-6"})}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:l.cuiFile?"Schimbă documentul":"Încarcă document CUI"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF, JPG, PNG (max 10MB)"})]})]})]}),l.cuiPreview&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-4 border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-2",children:[u(l.cuiFile),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Document CUI"})]}),e("button",{type:"button",onClick:c,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge documentul",children:e(ve,{className:"w-4 h-4"})})]}),l.cuiFile.includes("data:image")?e("div",{className:"aspect-[3/4] bg-white rounded-lg border-2 border-slate-200 overflow-hidden",children:e("img",{src:l.cuiPreview,alt:"CUI Preview",className:"w-full h-full object-contain"})}):e(kt,{pdfUrl:l.cuiPreview,title:`CUI Document ${l.name}`,placeholder:"Documentul CUI nu este disponibil",placeholderSubtext:"Atașează documentul CUI pentru vizualizare"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Note Adiționale"}),e("textarea",{name:"notes",value:l.notes,onChange:o,className:"input-field min-h-[80px] resize-none",placeholder:"Informații suplimentare despre companie..."})]}),t("div",{className:"flex justify-end space-x-4 pt-8 border-t-2 border-slate-200/50 dark:border-slate-700/50 mt-8",children:[e("button",{type:"button",onClick:s,className:"btn-secondary group",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Anulează"})}),e("button",{type:"submit",className:"btn-primary group",children:t("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:[a?"Actualizează":"Adaugă"," Companie"]})})]})]})})]})})},Ai=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-blue-100",children:"Detalii Companie"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Tip Companie"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.type||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_t,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"CUI"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white font-mono",children:a.cui||"N/A"})]}),a.phone&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(la,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Telefon"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.phone})]}),a.email&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Xt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Email"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white break-all",children:a.email})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-6 rounded-xl border border-purple-200 dark:border-purple-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.documents&&Array.isArray(a.documents)&&a.documents.length>0&&t("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-6 rounded-xl border border-amber-200 dark:border-amber-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Documente Atașate"}),e("div",{className:"space-y-2",children:a.documents.map((n,o)=>t("div",{className:"flex items-center justify-between bg-white dark:bg-slate-700 p-3 rounded-lg",children:[t("div",{className:"flex items-center space-x-3",children:[e(ge,{className:"w-5 h-5 text-amber-600"}),e("span",{className:"text-slate-900 dark:text-white",children:n.name||`Document ${o+1}`})]}),e("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Vizualizează"})]},o))})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},Ei=({isOpen:a,onClose:s,onConfirm:r,title:l="Confirmare",message:n,confirmText:o="Confirmă",cancelText:i="Anulează",type:c="danger"})=>{if(!a)return null;const x=(()=>{switch(c){case"danger":return{icon:"text-red-500",button:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"};case"warning":return{icon:"text-yellow-500",button:"bg-yellow-600 hover:bg-yellow-700 text-white",iconBg:"bg-yellow-100"};case"info":return{icon:"text-blue-500",button:"bg-blue-600 hover:bg-blue-700 text-white",iconBg:"bg-blue-100"};default:return{icon:"text-red-500",button:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"}}})();return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[t("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:`p-2 rounded-full ${x.iconBg}`,children:e(Ut,{className:`w-6 h-6 ${x.icon}`})}),e("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:l})]}),e("button",{onClick:s,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(ve,{className:"w-5 h-5 text-slate-500"})})]}),e("div",{className:"p-6",children:e("p",{className:"text-slate-600 dark:text-slate-300 text-base leading-relaxed",children:n})}),t("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-slate-200 dark:border-slate-700",children:[e("button",{onClick:s,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors font-medium",children:i}),e("button",{onClick:()=>{r(),s()},className:`px-6 py-2 rounded-lg font-medium transition-colors ${x.button}`,children:o})]})]})})},ft=({onExportExcel:a,onExportPDF:s,entity:r})=>t("div",{className:"flex items-center space-x-2",children:[t("button",{onClick:a,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors shadow-md hover:shadow-lg",title:"Exportă în Excel",children:[e(Ds,{className:"w-4 h-4"}),e("span",{children:"Excel"})]}),t("button",{onClick:s,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors shadow-md hover:shadow-lg",title:"Exportă în PDF",children:[e(ge,{className:"w-4 h-4"}),e("span",{children:"PDF"})]})]}),Di=()=>{const[a,s]=h.useState({isOpen:!1,title:"",message:"",confirmText:"Confirmă",cancelText:"Anulează",type:"danger",onConfirm:null});return{confirmState:a,confirm:n=>new Promise(o=>{s({isOpen:!0,title:n.title||"Confirmare",message:n.message||"Ești sigur?",confirmText:n.confirmText||"Confirmă",cancelText:n.cancelText||"Anulează",type:n.type||"danger",onConfirm:()=>{o(!0)}})}),close:()=>{s(n=>({...n,isOpen:!1,onConfirm:null}))}}},Ti=()=>{const a=Ye(),{companies:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:o,exportToPDF:i,loading:c}=ye(),{confirmState:u,confirm:x,close:m}=Di(),[d,g]=h.useState(!1),[_,p]=h.useState(null),[N,k]=h.useState(""),[E,P]=h.useState([]),[f,R]=h.useState(!1),[A,D]=h.useState(null),[U,j]=h.useState(!1);h.useEffect(()=>{R(E.length>0)},[E]);const v=s.filter(T=>{var Z,se,ne,ce;return((Z=T.name)==null?void 0:Z.toLowerCase().includes(N.toLowerCase()))||((se=T.license)==null?void 0:se.toLowerCase().includes(N.toLowerCase()))||((ne=T.email)==null?void 0:ne.toLowerCase().includes(N.toLowerCase()))||((ce=T.contact_person)==null?void 0:ce.toLowerCase().includes(N.toLowerCase()))}),z=[{key:"companyInfo",label:"Companie & CUI",sortable:!0,render:T=>{var Z,se,ne,ce;return t("div",{className:"space-y-2",children:[t("div",{className:"flex items-center space-x-3",children:[(Z=T.logo)!=null&&Z.file||(se=T.logo)!=null&&se.url?e("img",{src:T.logo.file||T.logo.url,alt:`${T.name} logo`,className:"w-8 h-8 object-contain rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 p-1 flex-shrink-0",onError:Ce=>{Ce.target.style.display="none",Ce.target.nextSibling.style.display="block"}}):null,e(_e,{className:`w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 ${(ne=T.logo)!=null&&ne.file||(ce=T.logo)!=null&&ce.url?"hidden":""}`}),e("button",{onClick:()=>a(`/companies/${T.id}`),className:"font-bold text-slate-900 dark:text-slate-100 hover:text-blue-700 dark:hover:text-blue-400 transition-colors text-left",children:T.name})]}),T.license&&e("div",{className:"flex items-center space-x-2",children:e("span",{className:"text-blue-800 dark:text-blue-300 text-xs font-bold",children:T.license})}),T.cui&&t("div",{className:"flex items-center space-x-2",children:[t("span",{className:"text-blue-800 dark:text-blue-300 text-xs font-bold",children:["CUI: ",T.cui]}),T.cuiFile&&t("div",{className:"flex items-center space-x-1",children:[e("button",{onClick:()=>window.open(T.cuiFile,"_blank"),className:"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Previzualizează CUI",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const Ce=document.createElement("a");Ce.href=T.cuiFile,Ce.download=`CUI_${T.name||"company"}.${T.cuiFile.includes("data:image")?"jpg":"pdf"}`,Ce.click()},className:"p-1 text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/30 rounded transition-colors",title:"Descarcă CUI",children:e(We,{className:"w-4 h-4"})})]})]})]})}},{key:"contactInfo",label:"Contact",sortable:!0,render:T=>t("div",{className:"space-y-2",children:[T.contact_person&&t("div",{className:"flex items-center space-x-2",children:[e(yt,{className:"w-4 h-4 text-slate-500 dark:text-slate-400 flex-shrink-0"}),e("div",{className:"text-slate-700 dark:text-slate-300 font-medium text-sm",children:T.contact_person})]}),T.phone&&t("div",{className:"flex items-center space-x-2",children:[e(la,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0"}),e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:T.phone})]}),T.email&&t("div",{className:"flex items-center space-x-2",children:[e(Xt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 flex-shrink-0"}),e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:T.email})]})]})},{key:"status",label:"Status",sortable:!0,render:T=>{var ce;const Z=((ce=T.status)==null?void 0:ce.toLowerCase())||"",se=Z==="activ"||Z==="active",ne=Z==="suspendat"||Z==="suspended";return e("span",{className:`px-4 py-2 rounded-2xl text-xs font-bold shadow-lg ${se?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-green-500/25":ne?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-yellow-500/25":"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-red-500/25"}`,children:se?"Activ":ne?"Suspendat":"Inactiv"})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:T=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:T.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:T.created_at?new Date(T.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],S=()=>{p(null),g(!0)},F=T=>{p(T),g(!0)},I=async T=>{await x({title:"Șterge Companie",message:`Sigur doriți să ștergeți compania "${T.name}"?`,type:"danger"})&&await n("companies",T.id)},b=T=>{P(T?v.map(Z=>Z.id):[])},y=(T,Z)=>{P(Z?[...E,T]:E.filter(se=>se!==T))},L=async()=>{if(E.length===0)return;if(await x({title:"Șterge Companiile",message:`Ești sigur că vrei să ștergi ${E.length} companii?`,type:"danger"}))try{for(const Z of E)await n("companies",Z);P([]),R(!1)}catch(Z){console.error("Error bulk deleting companies:",Z)}},Y=()=>{E.length!==0&&console.log("Bulk edit for companies:",E)},O=async T=>{_?await l("companies",_.id,T):await r("companies",T),g(!1),p(null)},G=()=>{try{o("companies")}catch(T){console.error("Error exporting to Excel:",T)}},C=()=>{try{i("companies")}catch(T){console.error("Error exporting to PDF:",T)}},W=()=>{console.log("Import functionality to be implemented")};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Management Companii"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionează companiile de gaming din sistem"})]})]}),t("div",{className:"flex flex-wrap items-center gap-3",children:[t("div",{className:"relative flex-1 min-w-[200px] group",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-400 transition-colors",size:18}),e("input",{type:"text",placeholder:"Caută companii...",value:N,onChange:T=>k(T.target.value),onKeyDown:T=>{if(T.key==="Tab"&&N.length>0){const Z=s.find(se=>{var ne;return(ne=se.name)==null?void 0:ne.toLowerCase().startsWith(N.toLowerCase())});Z&&k(Z.name)}},className:"input-field pl-12 bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:border-blue-500 dark:focus:border-blue-400"}),N.length>0&&e("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg z-10 max-h-48 overflow-y-auto",children:s.filter(T=>{var Z;return(Z=T.name)==null?void 0:Z.toLowerCase().includes(N.toLowerCase())}).slice(0,5).map((T,Z)=>e("button",{onClick:()=>k(T.name),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:T.name},T.id))})]}),t("button",{onClick:W,className:"btn-secondary flex items-center space-x-2",children:[e(ze,{size:16}),e("span",{children:"Importă"})]}),e(ft,{onExportExcel:G,onExportPDF:C,entity:"companies"}),t("div",{className:"flex space-x-3",children:[f&&t(De,{children:[t("button",{onClick:Y,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:L,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:S,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Companie"})]})]})]})]})}),e(He,{data:v,columns:z,onEdit:F,onDelete:I,onRowClick:T=>{D(T),j(!0)},loading:c.companies,searchTerm:N,onSearchChange:k,selectedItems:E,onSelectAll:b,onSelectItem:y,moduleColor:"blue"}),d&&e(_i,{item:_,onClose:()=>{g(!1),p(null)},onSave:O}),e(Ei,{isOpen:u.isOpen,onClose:m,onConfirm:u.onConfirm,title:u.title,message:u.message,confirmText:u.confirmText,cancelText:u.cancelText,type:u.type}),U&&e(Ai,{item:A,onClose:()=>{j(!1),D(null)}})]})})},zi=({item:a,onClose:s,onSave:r})=>{const{companies:l,users:n}=ye(),[o,i]=h.useState({name:"",address:"",company:"",capacity:"",surface:"",planFile:null,status:"Activ",coordinates:"",contact_person:"",notes:""});h.useEffect(()=>{a&&i({name:a.name||"",address:a.address||"",company:a.company||"",capacity:a.capacity||"",surface:a.surface||"",planFile:a.planFile||null,status:a.status||"Activ",coordinates:a.coordinates||"",contact_person:a.contact_person||"",notes:a.notes||""})},[a]);const c=m=>{i({...o,[m.target.name]:m.target.value})},u=m=>{const d=m.target.files[0];d&&i({...o,planFile:d})};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-green-800 to-emerald-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600/20 to-emerald-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-lg",children:e(Fe,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Locație":"Adaugă Locație"}),e("p",{className:"text-green-100 text-sm font-medium",children:"Completează informațiile despre locație"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault(),r(o)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Locație *"}),e("input",{type:"text",name:"name",value:o.name,onChange:c,className:"input-field",placeholder:"ex: Locația Centru",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Companie *"}),t("select",{name:"company",value:o.company,onChange:c,className:"input-field",required:!0,children:[e("option",{value:"",children:"Selectează o companie"}),l.map(m=>e("option",{value:m.name,children:m.name},m.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Persoană de Contact"}),t("select",{name:"contact_person",value:o.contact_person,onChange:c,className:"input-field",children:[e("option",{value:"",children:"Selectează o persoană de contact"}),n.map(m=>t("option",{value:m.full_name||m.username,children:[m.full_name||m.username," (@",m.username,")"]},m.id))]}),e("p",{className:"text-xs text-slate-500",children:"Persoana responsabilă pentru această locație"})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Adresă Completă *"}),e("textarea",{name:"address",value:o.address,onChange:c,className:"input-field min-h-[100px] resize-none",placeholder:"ex: Str. Centrală nr. 1, București, România",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Suprafață (m²) *"}),e("input",{type:"number",name:"surface",value:o.surface,onChange:c,className:"input-field",placeholder:"ex: 150",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Capacitate (calculată din sloturi)"}),t("div",{className:"input-field bg-slate-50 text-slate-600 cursor-not-allowed",children:[o.capacity||0," sloturi"]}),e("p",{className:"text-xs text-slate-500",children:"Capacitatea se calculează automat din numărul de sloturi alocate acestei locații"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status"}),t("select",{name:"status",value:o.status,onChange:c,className:"input-field",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Mentenanță",children:"Mentenanță"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Coordonate (lat, lng)"}),e("input",{type:"text",name:"coordinates",value:o.coordinates,onChange:c,className:"input-field",placeholder:"ex: 44.4268, 26.1025"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Plan Locație"}),t("div",{className:"relative",children:[e("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png,.dwg,.dxf",onChange:u,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),o.planFile&&t("div",{className:"mt-2 text-sm text-green-600 font-medium",children:["✓ Fișier selectat: ",o.planFile.name]})]}),e("p",{className:"text-xs text-slate-500",children:"Formate acceptate: PDF, JPG, PNG, DWG, DXF"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note Adiționale"}),e("textarea",{name:"notes",value:o.notes,onChange:c,className:"input-field min-h-[80px] resize-none",placeholder:"Informații suplimentare despre locație..."})]}),t("div",{className:"flex justify-end space-x-4 pt-8 border-t-2 border-slate-200/50 mt-8",children:[e("button",{type:"button",onClick:s,className:"btn-secondary group",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Anulează"})}),e("button",{type:"submit",className:"btn-primary group",children:t("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:[a?"Actualizează":"Adaugă"," Locație"]})})]})]})})]})})},Pi=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(Fe,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-green-100",children:"Detalii Locație"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Fe,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Adresă"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.address||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Companie"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.company||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Tr,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Suprafață"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.surface?`${a.surface} m²`:"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),a.coordinates&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Coordonate GPS"}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white font-mono",children:a.coordinates})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]}),a.documents&&a.documents.length>0&&t("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-6 rounded-xl border border-amber-200 dark:border-amber-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Documente Atașate"}),e("div",{className:"space-y-2",children:a.documents.map((n,o)=>t("div",{className:"flex items-center justify-between bg-white dark:bg-slate-700 p-3 rounded-lg",children:[t("div",{className:"flex items-center space-x-3",children:[e(ge,{className:"w-5 h-5 text-amber-600"}),e("span",{className:"text-slate-900 dark:text-white",children:n.name})]}),e("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Descarcă"})]},o))})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},Li=({item:a,onClose:s,onSave:r,locationId:l})=>{const{locations:n,proprietari:o}=ye(),[i,c]=h.useState({contract_number:"",title:"",location_id:l||"",proprietar_id:"",type:"Chirie Locație",status:"Active",start_date:"",end_date:"",monthly_rent:"",currency:"RON",deposit:"",payment_terms:"",description:"",contractFile:null,contractPreview:null}),u=()=>{const p=new Date,N=p.getFullYear(),k=String(p.getMonth()+1).padStart(2,"0"),E=String(p.getDate()).padStart(2,"0"),P=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`CT-CH-${N}${k}${E}-${P}`};h.useEffect(()=>{c(a?{contract_number:a.contract_number||"",title:a.title||"",location_id:a.location_id||l||"",proprietar_id:a.proprietar_id||"",type:a.type||"Chirie Locație",status:a.status||"Active",start_date:a.start_date?a.start_date.split("T")[0]:"",end_date:a.end_date?a.end_date.split("T")[0]:"",monthly_rent:a.monthly_rent||"",currency:a.currency||"RON",deposit:a.deposit||"",payment_terms:a.payment_terms||"",description:a.description||"",contractFile:a.contractFile||null,contractPreview:a.contractFile||null}:p=>({...p,contract_number:u()}))},[a,l]);const x=p=>{const{name:N,value:k}=p.target;c(E=>({...E,[N]:k}))},m=p=>{const N=p.target.files[0];if(N){const k=new FileReader;k.onload=E=>{const P=E.target.result;c(f=>({...f,contractFile:P,contractPreview:P}))},k.readAsDataURL(N)}},d=()=>{window.confirm("Sigur doriți să ștergeți fișierul contractului?")&&c(p=>({...p,contractFile:null,contractPreview:null}))},g=p=>p?e(ge,{className:"w-4 h-4"}):e(ge,{className:"w-4 h-4"});return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-green-800 to-emerald-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600/20 to-emerald-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-lg",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Contract":"Adaugă Contract Nou"}),e("p",{className:"text-green-100 text-sm font-medium",children:"Completează informațiile despre contract"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:p=>{p.preventDefault(),r(i)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Număr Contract *"}),t("div",{className:"flex space-x-2",children:[e("input",{type:"text",name:"contract_number",value:i.contract_number,onChange:x,required:!0,className:"flex-1 px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"ex: CT-CH-2024-001"}),!a&&e("button",{type:"button",onClick:()=>c(p=>({...p,contract_number:u()})),className:"px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl transition-colors",title:"Generează număr nou",children:"🔄"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Titlu Contract *"}),e("input",{type:"text",name:"title",value:i.title,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"ex: Contract Chirie Locație București"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Locație *"}),t("select",{name:"location_id",value:i.location_id,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"",children:"Selectează locația"}),n==null?void 0:n.map(p=>e("option",{value:p.id,children:p.name},p.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Proprietar *"}),t("select",{name:"proprietar_id",value:i.proprietar_id,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"",children:"Selectează proprietarul"}),o==null?void 0:o.map(p=>e("option",{value:p.id,children:p.name},p.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Tip Contract *"}),t("select",{name:"type",value:i.type,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"Chirie Locație",children:"Chirie Locație"}),e("option",{value:"Chirie Comercială",children:"Chirie Comercială"}),e("option",{value:"Chirie Industrială",children:"Chirie Industrială"}),e("option",{value:"Chirie Oficiu",children:"Chirie Oficiu"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Status *"}),t("select",{name:"status",value:i.status,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Inactive",children:"Inactiv"}),e("option",{value:"Expired",children:"Expirat"}),e("option",{value:"Pending",children:"În așteptare"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Data Început *"}),e("input",{type:"date",name:"start_date",value:i.start_date,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Data Sfârșit *"}),e("input",{type:"date",name:"end_date",value:i.end_date,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Chiria Lunară *"}),e("input",{type:"number",name:"monthly_rent",value:i.monthly_rent,onChange:x,required:!0,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"0.00"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Depozit Garantie"}),e("input",{type:"number",name:"deposit",value:i.deposit,onChange:x,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"0.00"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Monedă *"}),t("select",{name:"currency",value:i.currency,onChange:x,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"RON",children:"RON"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Termeni de Plată"}),e("input",{type:"text",name:"payment_terms",value:i.payment_terms,onChange:x,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"ex: Lunar, până în data de 5"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Descriere"}),e("textarea",{name:"description",value:i.description,onChange:x,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none",placeholder:"Descrierea contractului..."})]}),t("div",{className:"space-y-4",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Fișier Contract (PDF)"}),t("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl p-6 text-center hover:border-green-400 dark:hover:border-green-500 transition-colors",children:[e("input",{type:"file",id:"contractFile",accept:".pdf",onChange:m,className:"hidden"}),t("label",{htmlFor:"contractFile",className:"cursor-pointer flex flex-col items-center space-y-3",children:[e("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center text-white",children:e(ze,{className:"w-6 h-6"})}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:i.contractFile?"Schimbă contractul":"Încarcă fișier contract"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF (max 10MB)"})]})]})]}),i.contractPreview&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-4 border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-2",children:[g(i.contractFile),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Fișier Contract"})]}),e("button",{type:"button",onClick:d,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge fișierul",children:e(ve,{className:"w-4 h-4"})})]}),e(kt,{pdfUrl:i.contractPreview,title:`Contract ${i.contract_number||i.title}`,placeholder:"Contractul nu este disponibil",placeholderSubtext:"Atașează fișierul contractului pentru vizualizare"})]})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(ge,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Contract"]})]})]})]})})]})})},Ii=({locationId:a,locationName:s})=>{const{contracts:r,createItem:l,updateItem:n,deleteItem:o,loading:i}=ye(),[c,u]=h.useState(!1),[x,m]=h.useState(null),[d,g]=h.useState([]);h.useEffect(()=>{if(r)if(a){const f=r.filter(R=>R.location_id==a);g(f)}else g(r);else g([])},[r,a]);const _=()=>{m(null),u(!0)},p=f=>{console.log("View contract:",f)},N=f=>{console.log("Download contract:",f)},k=f=>{m(f),u(!0)},E=async f=>{window.confirm(`Sigur doriți să ștergeți contractul "${f.contract_number}"?`)&&await o("contracts",f.id)},P=async f=>{x?await n("contracts",x.id,f):await l("contracts",f),u(!1),m(null)};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{children:[t("h3",{className:"text-xl font-bold text-slate-800",children:["Contracte - ",s]}),e("p",{className:"text-slate-600",children:"Gestionează contractele asociate acestei locații"})]}),t("button",{onClick:_,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Contract"})]})]}),e("div",{className:"card overflow-hidden",children:e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100",children:t("tr",{children:[e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Nr. Contract"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Tip Contract"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Perioadă"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Chiria Lunară"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Proprietar"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Acțiuni"})]})}),e("tbody",{className:"divide-y divide-slate-200",children:d.map(f=>t("tr",{className:"table-row hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"font-bold text-slate-900",children:f.contract_number})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-slate-700 font-medium",children:f.title}),e("div",{className:"text-slate-500 text-sm",children:f.type})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"text-slate-600 text-sm",children:[new Date(f.start_date).toLocaleDateString("ro-RO")," - ",new Date(f.end_date).toLocaleDateString("ro-RO")]})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[t("div",{className:"text-slate-700 font-sans",children:[parseFloat(f.monthly_rent||0).toLocaleString("ro-RO")," ",f.currency]}),f.deposit&&t("div",{className:"text-slate-500 text-xs",children:["Depozit: ",parseFloat(f.deposit).toLocaleString("ro-RO")," ",f.currency]})]}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-slate-700 font-medium",children:f.proprietar_name||"N/A"}),f.proprietar_contact&&e("div",{className:"text-slate-500 text-xs",children:f.proprietar_contact})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${f.status==="Active"?"bg-green-100 text-green-800":f.status==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:f.status==="Active"?"Activ":f.status==="Inactive"?"Inactiv":f.status==="Expired"?"Expirat":f.status==="Pending"?"În așteptare":f.status})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>p(f),className:"text-blue-600 hover:text-blue-900 p-1 rounded-lg hover:bg-blue-50 transition-colors",title:"Vezi contract",children:e(Qe,{size:16})}),e("button",{onClick:()=>N(f),className:"text-green-600 hover:text-green-900 p-1 rounded-lg hover:bg-green-50 transition-colors",title:"Descarcă contract",children:e(We,{size:16})}),e("button",{onClick:()=>k(f),className:"text-yellow-600 hover:text-yellow-900 p-1 rounded-lg hover:bg-yellow-50 transition-colors",title:"Editează contract",children:e(at,{size:16})}),e("button",{onClick:()=>E(f),className:"text-red-600 hover:text-red-900 p-1 rounded-lg hover:bg-red-50 transition-colors",title:"Șterge contract",children:e(je,{size:16})})]})})]},f.id))})]})})}),d.length===0&&t("div",{className:"card p-12 text-center",children:[e("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl inline-block mb-6",children:e(ge,{className:"w-16 h-16 text-blue-500 mx-auto"})}),e("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Nu există contracte"}),e("p",{className:"text-slate-600 mb-6",children:"Adaugă primul contract pentru această locație"}),t("button",{onClick:_,className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Contract"})]})]}),c&&e(Li,{item:x,onClose:()=>{u(!1),m(null)},onSave:P,locationId:a})]})},Oi=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",contact_person:"",email:"",phone:"",address:"",cnp_cui:"",type:"Persoana Fizica",status:"Activ",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",contact_person:a.contact_person||"",email:a.email||"",phone:a.phone||"",address:a.address||"",cnp_cui:a.cnp_cui||"",type:a.type||"Persoana Fizica",status:a.status||"Activ",notes:a.notes||""})},[a]);const o=c=>{const{name:u,value:x}=c.target;n(m=>({...m,[u]:x}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-purple-800 to-violet-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-violet-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl shadow-lg",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Proprietar":"Adaugă Proprietar Nou"}),e("p",{className:"text-purple-100 text-sm font-medium",children:"Completează informațiile despre proprietar"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Nume Proprietar *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: Ion Popescu sau SC Imobiliare SRL"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Persoană de Contact"}),e("input",{type:"text",name:"contact_person",value:l.contact_person,onChange:o,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: Maria Ionescu"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Email"}),e("input",{type:"email",name:"email",value:l.email,onChange:o,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: ion.popescu@email.com"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Telefon"}),e("input",{type:"tel",name:"phone",value:l.phone,onChange:o,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: +40712345678"})]}),t("div",{className:"md:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Adresă"}),e("input",{type:"text",name:"address",value:l.address,onChange:o,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: Str. Mihai Viteazu nr. 10, București"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"CNP / CUI"}),e("input",{type:"text",name:"cnp_cui",value:l.cnp_cui,onChange:o,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: 1234567890123 sau RO12345678"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Tip *"}),t("select",{name:"type",value:l.type,onChange:o,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e("option",{value:"Persoana Fizica",children:"Persoană Fizică"}),e("option",{value:"Persoana Juridica",children:"Persoană Juridică"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:o,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:3,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Note suplimentare despre proprietar..."})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(_e,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Proprietar"]})]})]})]})})]})})},Ri=({locationId:a,locationName:s})=>{const{proprietari:r,createItem:l,updateItem:n,deleteItem:o}=ye(),[i,c]=h.useState(!1),[u,x]=h.useState(null),[m,d]=h.useState(""),g=(r||[]).filter(R=>{var A,D,U,j;return((A=R.name)==null?void 0:A.toLowerCase().includes(m.toLowerCase()))||((D=R.contact_person)==null?void 0:D.toLowerCase().includes(m.toLowerCase()))||((U=R.email)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((j=R.phone)==null?void 0:j.toLowerCase().includes(m.toLowerCase()))}),_=()=>{x(null),c(!0)},p=R=>{console.log("View proprietar:",R)},N=R=>{x(R),c(!0)},k=async R=>{if(window.confirm(`Sigur doriți să ștergeți proprietarul "${R.name}"?`))try{await o("proprietari",R.id)}catch(A){console.error("Error deleting proprietar:",A)}},E=async R=>{try{u?await n("proprietari",u.id,R):await l("proprietari",R),c(!1),x(null)}catch(A){console.error("Error saving proprietar:",A)}},P=R=>{switch(R){case"Persoana Fizica":return"bg-blue-100 text-blue-800";case"Persoana Juridica":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},f=R=>{switch(R){case"Activ":return"bg-green-100 text-green-800";case"Inactiv":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Proprietari"}),t("p",{className:"text-slate-600",children:["Gestionează proprietarii pentru ",s]})]}),t("button",{onClick:_,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Proprietar"})]})]}),t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută proprietari...",value:m,onChange:R=>d(R.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),g.length>0?e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(R=>t("div",{className:"card p-6 hover:shadow-lg transition-all duration-200 group",children:[t("div",{className:"flex items-start justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h3",{className:"font-bold text-slate-800 group-hover:text-blue-700 transition-colors",children:R.name}),e("p",{className:"text-slate-600 text-sm",children:R.contact_person})]})]}),t("div",{className:"flex space-x-1",children:[e("button",{onClick:()=>p(R),className:"p-2 text-slate-400 hover:text-blue-500 transition-colors",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>N(R),className:"p-2 text-slate-400 hover:text-green-500 transition-colors",children:e(at,{className:"w-4 h-4"})}),e("button",{onClick:()=>k(R),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:e(je,{className:"w-4 h-4"})})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[R.email&&t("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[e(Xt,{className:"w-4 h-4"}),e("span",{children:R.email})]}),R.phone&&t("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[e(la,{className:"w-4 h-4"}),e("span",{children:R.phone})]}),R.address&&t("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[e(Fe,{className:"w-4 h-4"}),e("span",{className:"truncate",children:R.address})]})]}),t("div",{className:"flex space-x-2",children:[e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${P(R.type)}`,children:R.type}),e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${f(R.status)}`,children:R.status})]}),R.cnp_cui&&t("div",{className:"text-xs text-slate-500",children:[R.type==="Persoana Fizica"?"CNP:":"CUI:"," ",R.cnp_cui]}),R.notes&&e("div",{className:"text-sm text-slate-600 bg-slate-50 p-2 rounded-lg",children:R.notes})]})]},R.id))}):t("div",{className:"card p-12 text-center",children:[e("div",{className:"p-8 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl inline-block mb-6",children:e(_e,{className:"w-20 h-20 text-blue-500 mx-auto"})}),e("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Nu există proprietari"}),e("p",{className:"text-slate-600 mb-6",children:"Adaugă primul proprietar pentru această locație"}),t("button",{onClick:_,className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Proprietar"})]})]}),i&&e(Oi,{item:u,onClose:()=>{c(!1),x(null)},onSave:E})]})},Fi=()=>{const a=Ye(),{locations:s,contracts:r,slots:l,createItem:n,updateItem:o,deleteItem:i,exportToExcel:c,exportToPDF:u,loading:x}=ye(),[m,d]=h.useState(!1),[g,_]=h.useState(null),[p,N]=h.useState(""),[k,E]=h.useState([]),[P,f]=h.useState(!1),[R,A]=h.useState(!1),[D,U]=h.useState(null),[j,v]=h.useState(!1);h.useEffect(()=>{f(k.length>0)},[k]);const z=ee=>{E(ee?Z.map(me=>me.id):[])},S=(ee,me)=>{E(me?[...k,ee]:k.filter(fe=>fe!==ee))},F=async()=>{k.length!==0&&A(!0)},I=async()=>{try{for(const ee of k)await i("locations",ee);E([]),f(!1),A(!1),$.success(`${k.length} locații șterse cu succes!`)}catch(ee){console.error("Error bulk deleting:",ee),$.error("Eroare la ștergerea locațiilor!")}},b=()=>{k.length!==0&&console.log("Bulk edit for:",k)},[y,L]=h.useState("locations"),[Y,O]=h.useState(null),[G,C]=h.useState(null),[W,T]=h.useState(!1),Z=s.filter(ee=>{var me,fe,ie,le;return((me=ee.name)==null?void 0:me.toLowerCase().includes(p.toLowerCase()))||((fe=ee.address)==null?void 0:fe.toLowerCase().includes(p.toLowerCase()))||((ie=ee.company)==null?void 0:ie.toLowerCase().includes(p.toLowerCase()))||((le=ee.contact_person)==null?void 0:le.toLowerCase().includes(p.toLowerCase()))}),se=ee=>l.filter(fe=>fe.location===ee&&fe.status!=="Depozit").length,ne=ee=>{const me=r.filter(oe=>oe.location_id===ee&&oe.status==="Active");if(me.length===0)return null;const fe=me.sort((oe,Se)=>new Date(Se.end_date)-new Date(oe.end_date))[0];if(!fe.end_date)return null;const ie=new Date,be=new Date(fe.end_date)-ie;return Math.ceil(be/(1e3*60*60*24))},ce=(ee,me)=>{const fe=r.filter(be=>be.location_id===ee&&be.status==="Active");if(fe.length===0||!me)return null;const ie=fe.sort((be,te)=>new Date(te.end_date)-new Date(be.end_date))[0];return ie.monthly_rent?(ie.monthly_rent/me).toFixed(2):null},Ce=[{key:"name",label:"Nume Locație",sortable:!0,render:ee=>t("div",{className:"space-y-1",children:[e("button",{onClick:()=>a(`/locations/${ee.id}`),className:"text-slate-900 dark:text-slate-100 hover:text-green-700 dark:hover:text-green-400 transition-colors text-left font-medium",children:ee.name}),e("div",{className:"text-slate-600 dark:text-slate-400",children:ee.address})]})},{key:"company",label:"Companie",sortable:!0,render:ee=>t("div",{className:"space-y-1",children:[e("span",{className:"text-blue-800 dark:text-blue-300",children:ee.company}),e("div",{className:"flex items-center space-x-2",children:ee.contact_person?t(De,{children:[e("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white shadow-lg",children:ee.contact_person.charAt(0).toUpperCase()}),e("span",{className:"text-slate-700",children:ee.contact_person})]}):e("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"Nu este setată"})})]})},{key:"surface",label:"Suprafață (m²)",sortable:!0,render:ee=>e("div",{className:"text-slate-600",children:ee.surface?`${ee.surface} m²`:"N/A"})},{key:"capacity",label:"Capacitate (Sloturi)",sortable:!0,render:ee=>{const me=se(ee.name);return t("div",{className:"text-slate-600",children:[me," sloturi"]})}},{key:"cost_per_m2",label:"Cost/m²",sortable:!1,render:ee=>{const me=ce(ee.id,ee.surface);return me===null?e("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"N/A"}):t("div",{className:"flex items-center space-x-1",children:[e("span",{className:"text-blue-600 dark:text-blue-400",children:me}),e("span",{className:"text-slate-500 dark:text-slate-400",children:"RON/m²"})]})}},{key:"plan_file",label:"Plan Locație",sortable:!1,render:ee=>e("div",{className:"flex items-center space-x-2",children:ee.plan_file?t(De,{children:[e("button",{onClick:()=>ue(ee),className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",title:"Vizualizează planul",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>Ae(ee),className:"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-300 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",title:"Descarcă planul",children:e(We,{className:"w-4 h-4"})}),e("button",{onClick:()=>pe(ee),className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",title:"Șterge planul",children:e(ve,{className:"w-4 h-4"})})]}):e("span",{className:"text-slate-400 dark:text-slate-500 text-sm italic",children:"Nu există plan"})})},{key:"contract_expiration",label:"Zile Rămase Contract",sortable:!1,render:ee=>{const me=ne(ee.id);if(me===null)return e("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"Fără contract activ"});const fe=me<0,ie=me<=30&&me>=0;return t("div",{className:`flex items-center space-x-1 ${fe?"text-red-600 dark:text-red-400":ie?"text-orange-600 dark:text-orange-400":"text-green-600 dark:text-green-400"}`,children:[e("span",{children:fe?Math.abs(me):me}),e("span",{children:fe?"zile expirat":"zile rămase"})]})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:ee=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:ee.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:ee.created_at?new Date(ee.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Re=()=>{_(null),d(!0)},Ue=ee=>{_(ee),d(!0)},Ve=async ee=>{if(confirm(`Sigur doriți să ștergeți locația "${ee.name}"?`))try{await i("locations",ee.id),$.success("Locația a fost ștearsă cu succes!")}catch{$.error("Eroare la ștergerea locației")}},et=async ee=>{try{if(ee.planFile&&ee.planFile instanceof File){const fe=new FormData;if(Object.keys(ee).forEach(ie=>{ie==="planFile"&&ee[ie]instanceof File?fe.append("planFile",ee[ie]):ie!=="planFile"&&fe.append(ie,ee[ie])}),g){if(!(await fetch(`/api/locations/${g.id}`,{method:"PUT",body:fe})).ok)throw new Error("Failed to update location")}else if(!(await fetch("/api/locations",{method:"POST",body:fe})).ok)throw new Error("Failed to create location")}else{const fe={...ee};if(delete fe.planFile,g){if(!(await fetch(`/api/locations/${g.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)})).ok)throw new Error("Failed to update location")}else if(!(await fetch("/api/locations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)})).ok)throw new Error("Failed to create location")}window.location.reload(),d(!1),_(null),$.success(g?"Locația a fost actualizată cu succes!":"Locația a fost creată cu succes!")}catch(me){console.error("Error saving location:",me),console.error("Error details:",me.message),$.error(`Eroare la salvare locație: ${me.message}`)}},qe=()=>{try{c("locations")}catch(ee){console.error("Error exporting to Excel:",ee)}},$e=()=>{try{u("locations")}catch(ee){console.error("Error exporting to PDF:",ee)}},Ze=()=>{console.log("Import functionality to be implemented")},Q=ee=>{O(ee),L("contracts")},de=ee=>{O(ee),L("proprietari")},ue=ee=>{ee.plan_file&&(C(ee.plan_file),T(!0))},pe=async ee=>{if(window.confirm(`Sigur doriți să ștergeți planul locației "${ee.name}"?`))try{await o("locations",ee.id,{plan_file:null})}catch(me){console.error("Error deleting document:",me)}},Ae=ee=>{if(ee.plan_file){const me=document.createElement("a");me.href=ee.plan_file,me.download=`Plan_${ee.name||"location"}.pdf`,me.click()}};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex space-x-1 bg-slate-100 rounded-xl p-1",children:[e("button",{onClick:()=>L("locations"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${y==="locations"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg shadow-blue-500/25":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(Fe,{size:20}),e("span",{children:"Locații"})]})}),e("button",{onClick:()=>L("contracts"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${y==="contracts"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg shadow-green-500/25":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ge,{size:20}),e("span",{children:"Contracte"})]})}),e("button",{onClick:()=>L("proprietari"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${y==="proprietari"?"bg-gradient-to-r from-purple-500 to-violet-500 text-white shadow-lg shadow-purple-500/25":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(_e,{size:20}),e("span",{children:"Proprietari"})]})})]})}),y==="locations"?t(De,{children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-wrap items-center gap-3",children:[t("div",{className:"relative flex-1 min-w-[200px] group",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-400 transition-colors",size:18}),e("input",{type:"text",placeholder:"Caută locații...",value:p,onChange:ee=>N(ee.target.value),className:"input-field pl-12 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-100 dark:placeholder-slate-400"})]}),t("button",{onClick:Ze,className:"btn-secondary flex items-center space-x-2",children:[e(ze,{size:16}),e("span",{children:"Importă"})]}),e(ft,{onExportExcel:qe,onExportPDF:$e,entity:"locations"}),P&&t(De,{children:[t("button",{onClick:b,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:F,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:()=>a("/slots/cyber-import"),className:"btn-success flex items-center space-x-2",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Import Cyber"})]}),t("button",{onClick:Re,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Locație"})]})]})}),e(He,{data:Z,columns:Ce,onEdit:Ue,onDelete:Ve,onViewContracts:Q,onRowClick:ee=>{U(ee),v(!0)},onViewProprietari:de,loading:x.locations,searchTerm:p,onSearchChange:N,selectedItems:k,onSelectAll:z,onSelectItem:S,moduleColor:"blue"}),Z.length>0&&e("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700",children:t("div",{className:"flex items-center justify-center space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e("span",{className:"text-white font-bold text-sm",children:"📊"})}),e("span",{className:"text-slate-700 dark:text-slate-300 font-medium",children:"Total sloturi în toate locațiile:"})]}),t("div",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg font-bold text-xl",children:[Z.reduce((ee,me)=>ee+se(me.name),0)," sloturi"]})]})}),m&&e(zi,{item:g,onClose:()=>{d(!1),_(null)},onSave:et}),W&&G&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-3xl w-full max-w-6xl h-[90vh] overflow-hidden shadow-2xl",children:[t("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 px-6 py-4 flex justify-between items-center",children:[t("h3",{className:"text-xl font-bold text-white flex items-center",children:[e(ge,{className:"w-6 h-6 mr-2"}),"Vizualizare Plan Locație"]}),e("button",{onClick:()=>{T(!1),C(null)},className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:e(ve,{className:"w-6 h-6"})})]}),e("div",{className:"h-full p-6",children:e(kt,{pdfUrl:G,title:"Plan Locație",placeholder:"Planul locației nu este disponibil",placeholderSubtext:"Atașează planul locației pentru vizualizare"})})]})})]}):y==="contracts"?e(Ii,{locationId:(Y==null?void 0:Y.id)||null,locationName:(Y==null?void 0:Y.name)||"Toate Contractele"}):e(Ri,{locationId:Y==null?void 0:Y.id,locationName:(Y==null?void 0:Y.name)||"Selectați o locație"}),R&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(je,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Șterge ",k.length," Locații"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",k.length," locații selectate? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>A(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",k.length," Locații"]})]})]})}),j&&e(Pi,{item:D,onClose:()=>{v(!1),U(null)}})]})})},ji=()=>{const{id:a}=It(),s=Ye(),{locations:r,contracts:l,slots:n,cabinets:o,companies:i,users:c,loading:u}=ye(),[x,m]=h.useState(null),[d,g]=h.useState("overview");if(h.useEffect(()=>{const f=r.find(R=>R.id===parseInt(a));m(f)},[a,r]),u)return e(he,{children:e("div",{className:"flex items-center justify-center h-screen",children:e("div",{className:"text-xl text-slate-600",children:"Se încarcă..."})})});if(!x)return e(he,{children:e("div",{className:"flex items-center justify-center h-screen",children:e("div",{className:"text-xl text-red-600",children:"Locația nu a fost găsită"})})});const _=l.filter(f=>f.location_id===x.id),p=n.filter(f=>f.location===x.name&&f.status!=="Depozit"),N=o.filter(f=>f.location_id===x.id);i.find(f=>f.name===x.company);const k=_.filter(f=>f.status==="Active"),E=p.length,P=N.length;return e(he,{children:t("div",{className:"p-6 space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>s("/locations"),className:"p-3 bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-800 rounded-2xl hover:from-slate-200 hover:to-slate-300 dark:hover:from-slate-600 dark:hover:to-slate-700 transition-all duration-200 shadow-lg",children:e(tt,{className:"w-5 h-5"})}),t("div",{children:[e("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100",children:x.name}),e("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:x.address})]})]}),e("div",{className:"flex space-x-3",children:t("button",{onClick:()=>s(`/locations/${a}/edit`),className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-emerald-500/25 transition-all duration-200 flex items-center space-x-2",children:[e(at,{className:"w-5 h-5"}),e("span",{children:"Editează"})]})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Contracte Active"}),e("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:k.length})]}),e("div",{className:"p-4 bg-blue-500/10 rounded-2xl",children:e(ge,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})})]})}),e("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Sloturi"}),e("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mt-2",children:E})]}),e("div",{className:"p-4 bg-green-500/10 rounded-2xl",children:e(At,{className:"w-8 h-8 text-green-600 dark:text-green-400"})})]})}),e("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/20 dark:to-violet-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Cabinete"}),e("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400 mt-2",children:P})]}),e("div",{className:"p-4 bg-purple-500/10 rounded-2xl",children:e(_e,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})})]})}),e("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Suprafață"}),t("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-2",children:[x.surface||0," m²"]})]}),e("div",{className:"p-4 bg-orange-500/10 rounded-2xl",children:e(nr,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})})]})})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg overflow-hidden",children:[e("div",{className:"border-b border-slate-200 dark:border-slate-700",children:t("div",{className:"flex space-x-1 p-4",children:[e("button",{onClick:()=>g("overview"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="overview"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:"Prezentare Generală"}),t("button",{onClick:()=>g("contracts"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="contracts"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:["Contracte (",_.length,")"]}),t("button",{onClick:()=>g("slots"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="slots"?"bg-gradient-to-r from-purple-500 to-violet-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:["Sloturi (",E,")"]}),t("button",{onClick:()=>g("cabinets"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="cabinets"?"bg-gradient-to-r from-orange-500 to-amber-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:["Cabinete (",P,")"]})]})}),t("div",{className:"p-6",children:[d==="overview"&&t("div",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Informații Generale"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center space-x-3",children:[e(Fe,{className:"w-5 h-5 text-blue-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Adresă"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:x.address})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(_e,{className:"w-5 h-5 text-green-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Companie"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:x.company})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(nr,{className:"w-5 h-5 text-orange-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Suprafață"}),t("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:[x.surface||0," m²"]})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(xt,{className:"w-5 h-5 text-purple-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Persoană de Contact"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:x.contact_person||"Nu este setată"})]})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Plan Locație"}),x.plan_file?t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center space-x-3",children:[e(ge,{className:"w-5 h-5 text-blue-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Fișier Plan"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Plan disponibil"})]})]}),t("div",{className:"flex space-x-3",children:[t("button",{className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center space-x-2",children:[e(Qe,{className:"w-4 h-4"}),e("span",{children:"Vizualizează"})]}),t("button",{className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center space-x-2",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Descarcă"})]})]})]}):e("p",{className:"text-slate-400 italic",children:"Nu există plan încărcat"})]})]}),x.notes&&t("div",{className:"space-y-3",children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Note"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-xl",children:e("p",{className:"text-slate-700 dark:text-slate-300",children:x.notes})})]})]}),d==="contracts"&&e("div",{className:"space-y-4",children:_.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-green-50/80 to-emerald-50/80 dark:from-green-900/20 dark:to-emerald-800/20",children:t("tr",{children:[e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Număr Contract"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Tip"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Proprietar"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Perioadă"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Chirie Lunară"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Status"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Contract PDF"})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:_.map(f=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e("td",{className:"p-4",children:f.contract_number}),e("td",{className:"p-4",children:f.type}),e("td",{className:"p-4",children:f.proprietar_name}),t("td",{className:"p-4",children:[new Date(f.start_date).toLocaleDateString("ro-RO")," - ",new Date(f.end_date).toLocaleDateString("ro-RO")]}),t("td",{className:"p-4",children:[f.monthly_rent," ",f.currency]}),e("td",{className:"p-4",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${f.status==="Active"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"}`,children:f.status})}),e("td",{className:"p-4",children:f.file_path?t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>window.open(`https://www.w1n.ro${f.file_path}`,"_blank"),className:"p-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",title:"Vizualizează PDF",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const R=document.createElement("a");R.href=`https://www.w1n.ro${f.file_path}`,R.download=`contract-${f.contract_number}.pdf`,R.click()},className:"p-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors",title:"Descarcă PDF",children:e(We,{className:"w-4 h-4"})})]}):e("span",{className:"text-slate-400 italic",children:"N/A"})})]},f.id))})]})}):e("p",{className:"text-slate-400 italic text-center py-8",children:"Nu există contracte pentru această locație"})}),d==="slots"&&e("div",{className:"space-y-4",children:p.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-purple-50/80 to-violet-50/80 dark:from-purple-900/20 dark:to-violet-800/20",children:t("tr",{children:[e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"ID"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Număr Serie"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Denumire"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Furnizor"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Cabinet"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Game Mix"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Data Licență"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Data CVT"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Status"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Tip Proprietate"})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:p.map(f=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e("td",{className:"p-4 font-semibold",children:f.id}),e("td",{className:"p-4 font-semibold",children:f.serial_number}),e("td",{className:"p-4",children:f.name}),e("td",{className:"p-4",children:f.provider}),e("td",{className:"p-4",children:f.cabinet}),e("td",{className:"p-4",children:f.game_mix}),e("td",{className:"p-4",children:f.license_date?new Date(f.license_date).toLocaleDateString("ro-RO"):"N/A"}),e("td",{className:"p-4",children:f.cvt_date?new Date(f.cvt_date).toLocaleDateString("ro-RO"):"N/A"}),e("td",{className:"p-4",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${f.status==="Activ"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"}`,children:f.status})}),e("td",{className:"p-4",children:f.property_type==="Owned"?"Proprietate":"Închiriat"})]},f.id))})]})}):e("p",{className:"text-slate-400 italic text-center py-8",children:"Nu există sloturi în această locație"})}),d==="cabinets"&&e("div",{className:"space-y-4",children:N.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-orange-50/80 to-amber-50/80 dark:from-orange-900/20 dark:to-amber-800/20",children:t("tr",{children:[e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Număr Serie"}),e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Model"}),e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Producător"}),e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Status"})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:N.map(f=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e("td",{className:"p-4 font-semibold",children:f.serial_number}),e("td",{className:"p-4",children:f.model}),e("td",{className:"p-4",children:f.manufacturer}),e("td",{className:"p-4",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${f.status==="Activ"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"}`,children:f.status})})]},f.id))})]})}):e("p",{className:"text-slate-400 italic text-center py-8",children:"Nu există cabinete în această locație"})})]})]})]})})},Mi=({item:a,onClose:s,onSave:r})=>{ye();const[l,n]=h.useState({name:"",contact_person:"",contact:"",phone:"",company:"",status:"Activ",notes:"",logo:{type:"upload",url:"",file:null}});h.useEffect(()=>{a&&n({name:a.name||"",contact_person:a.contact_person||"",contact:a.contact||"",phone:a.phone||"",company:a.company||"",status:a.status||"Activ",notes:a.notes||"",logo:a.logo?typeof a.logo=="object"?a.logo:{type:"upload",url:"",file:null}:{type:"upload",url:"",file:null}})},[a]);const o=m=>{n({...l,[m.target.name]:m.target.value})},i=m=>{n({...l,logo:{...l.logo,type:m}})},c=m=>{n({...l,logo:{...l.logo,url:m}})},u=m=>{const d=m.target.files[0];if(d){const g=new FileReader;g.onloadend=()=>{n({...l,logo:{...l.logo,file:g.result}})},g.readAsDataURL(d)}};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-purple-800 to-violet-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-violet-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl shadow-lg",children:e(xt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Furnizor":"Adaugă Furnizor"}),e("p",{className:"text-purple-100 text-sm font-medium",children:"Completează informațiile despre furnizor"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Furnizor *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"input-field",placeholder:"ex: EGT Digital",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Persoana de Contact *"}),e("input",{type:"text",name:"contact_person",value:l.contact_person,onChange:o,className:"input-field",placeholder:"ex: Ion Popescu",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Companie Furnizor *"}),e("input",{type:"text",name:"company",value:l.company,onChange:o,className:"input-field",placeholder:"Introdu numele companiei",required:!0}),e("p",{className:"text-xs text-slate-500",children:"Compania care deține furnizorul (pentru facturi și contracte)"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Email Contact *"}),e("input",{type:"email",name:"contact",value:l.contact,onChange:o,className:"input-field",placeholder:"ex: contact@egt-digital.com",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Telefon *"}),e("input",{type:"text",name:"phone",value:l.phone,onChange:o,className:"input-field",placeholder:"ex: +40 21 555 1234",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status"}),t("select",{name:"status",value:l.status,onChange:o,className:"input-field",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Suspendat",children:"Suspendat"})]})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Logo Furnizor"}),t("div",{className:"flex space-x-4 mb-4",children:[e("button",{type:"button",onClick:()=>i("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${l.logo.type==="upload"?"bg-purple-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Upload Logo"}),e("button",{type:"button",onClick:()=>i("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${l.logo.type==="link"?"bg-purple-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Link URL"})]}),l.logo.type==="upload"?t("div",{children:[e("input",{type:"file",accept:"image/*",onChange:u,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100"}),l.logo.file&&t("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg flex items-center space-x-4",children:[e("img",{src:l.logo.file,alt:"Logo Preview",className:"h-9 w-9 object-contain rounded"}),e("span",{className:"text-sm text-green-600 font-medium",children:"✓ Logo încărcat"})]})]}):t("div",{children:[e("input",{type:"text",value:l.logo.url,onChange:m=>c(m.target.value),className:"input-field",placeholder:"https://example.com/logo.png"}),l.logo.url&&t("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg flex items-center space-x-4",children:[e("img",{src:l.logo.url,alt:"Logo Preview",className:"h-9 w-9 object-contain rounded"}),e("span",{className:"text-sm text-green-600 font-medium",children:"✓ Logo settat"})]})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note Adiționale"}),e("textarea",{name:"notes",value:l.notes,onChange:o,className:"input-field min-h-[80px] resize-none",placeholder:"Informații suplimentare despre furnizor..."})]}),t("div",{className:"flex justify-end space-x-4 pt-8 border-t-2 border-slate-200/50 mt-8",children:[e("button",{type:"button",onClick:s,className:"btn-secondary group",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Anulează"})}),e("button",{type:"submit",className:"btn-primary group",children:t("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:[a?"Actualizează":"Adaugă"," Furnizor"]})})]})]})})]})})},$i=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-purple-100",children:"Detalii Furnizor"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Companie"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.company||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(yt,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Persoană Contact"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.contact||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(la,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Telefon"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.phone||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Xt,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Email"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white break-all",children:a.email||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ge,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Număr Jocuri"})]}),t("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:[a.games_count||0," jocuri"]})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},Bi=()=>{const{providers:a,games:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:o,exportToPDF:i,loading:c}=ye(),[u,x]=h.useState(!1),[m,d]=h.useState(null),[g,_]=h.useState(""),[p,N]=h.useState([]),[k,E]=h.useState(!1),[P,f]=h.useState(null),[R,A]=h.useState(!1),D=C=>!s||!C?0:s.filter(W=>W.provider&&W.provider.toLowerCase()===C.toLowerCase()).length;h.useEffect(()=>{E(p.length>0)},[p]);const U=C=>{N(C?S.map(W=>W.id):[])},j=(C,W)=>{N(W?[...p,C]:p.filter(T=>T!==C))},v=async()=>{if(p.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${p.length} elemente?`))try{for(const C of p)await n("providers",C);N([]),E(!1)}catch(C){console.error("Error bulk deleting:",C)}},z=()=>{p.length!==0&&console.log("Bulk edit for:",p)},S=a.filter(C=>{var W,T,Z;return((W=C.name)==null?void 0:W.toLowerCase().includes(g.toLowerCase()))||((T=C.contact)==null?void 0:T.toLowerCase().includes(g.toLowerCase()))||((Z=C.contractType)==null?void 0:Z.toLowerCase().includes(g.toLowerCase()))}),F=[{key:"name",label:"Nume Furnizor",sortable:!0,render:C=>{var T,Z,se;const W=((T=C.logo)==null?void 0:T.file)||((Z=C.logo)==null?void 0:Z.url);return t("div",{className:"flex items-center space-x-3",children:[W?e("img",{src:W,alt:C.name,className:"w-9 h-9 rounded-full object-cover border-2 border-slate-200 bg-white shadow-md",onError:ne=>{ne.target.style.display="none",ne.target.nextSibling.style.display="flex"}}):null,e("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-purple-500 to-violet-500 flex items-center justify-center text-white font-bold shadow-lg",style:{display:W?"none":"flex"},children:((se=C.name)==null?void 0:se.charAt(0))||"F"}),e("div",{className:"font-bold text-slate-900 dark:text-slate-100 group-hover:text-purple-700 dark:group-hover:text-purple-400 transition-colors",children:C.name})]})}},{key:"company",label:"Companie",sortable:!0,render:C=>e("span",{className:"text-slate-800 font-medium text-base",children:C.company||"N/A"})},{key:"contact",label:"Contact",sortable:!0,render:C=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:C.contact}),e("div",{className:"text-slate-600 font-medium text-base",children:C.phone})]})},{key:"games_count",label:"Nr. Jocuri",sortable:!0,render:C=>{const W=D(C.name);return t("span",{className:"text-slate-800 font-medium text-base",children:[W," jocuri"]})}},{key:"status",label:"Status",sortable:!0,render:C=>{var Z;const W=((Z=C.status)==null?void 0:Z.toLowerCase())||"",T=W==="activ"||W==="active";return e("span",{className:`px-4 py-2 rounded-2xl text-base font-medium shadow-lg ${T?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-green-500/25":"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-red-500/25"}`,children:T?"Activ":"Inactiv"})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:C=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:C.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:C.created_at?new Date(C.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],I=()=>{d(null),x(!0)},b=C=>{d(C),x(!0)},y=async C=>{window.confirm(`Sigur doriți să ștergeți furnizorul "${C.name}"?`)&&await n("providers",C.id)},L=async C=>{m?await l("providers",m.id,C):await r("providers",C),x(!1),d(null)},Y=()=>{try{o("providers")}catch(C){console.error("Error exporting to Excel:",C)}},O=()=>{try{i("providers")}catch(C){console.error("Error exporting to PDF:",C)}},G=()=>{console.log("Import functionality to be implemented")};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-wrap items-center gap-3",children:[t("div",{className:"relative flex-1 min-w-[200px] group",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-400 transition-colors",size:18}),e("input",{type:"text",placeholder:"Caută furnizori...",value:g,onChange:C=>_(C.target.value),onKeyDown:C=>{if(C.key==="Tab"&&g.length>0){const W=a.find(T=>{var Z;return(Z=T.name)==null?void 0:Z.toLowerCase().startsWith(g.toLowerCase())});W&&_(W.name)}},className:"input-field pl-12"}),g.length>0&&e("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg z-10 max-h-48 overflow-y-auto",children:a.filter(C=>{var W,T;return((W=C.name)==null?void 0:W.toLowerCase().includes(g.toLowerCase()))||((T=C.contact)==null?void 0:T.toLowerCase().includes(g.toLowerCase()))}).slice(0,5).map((C,W)=>e("button",{onClick:()=>_(C.name),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:C.name},C.id))})]}),t("button",{onClick:G,className:"btn-secondary flex items-center space-x-2",children:[e(ze,{size:16}),e("span",{children:"Importă"})]}),e(ft,{onExportExcel:Y,onExportPDF:O,entity:"providers"}),k&&t(De,{children:[t("button",{onClick:z,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:v,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:I,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Furnizor"})]})]})}),e(He,{data:S,columns:F,loading:c.providers,searchTerm:g,onSearchChange:_,onEdit:b,onDelete:y,onRowClick:C=>{f(C),A(!0)},selectedItems:p,onSelectAll:U,onSelectItem:j,moduleColor:"blue"}),u&&e(Mi,{item:m,onClose:()=>{x(!1),d(null)},onSave:L}),R&&e($i,{item:P,onClose:()=>{A(!1),f(null)}})]})})},Ui=({item:a,onClose:s,onSave:r})=>{const{providers:l,platforms:n}=ye(),[o,i]=h.useState({provider:"",name:"",model:"",platform:"",status:"Activ",notes:""});h.useEffect(()=>{a&&i({provider:a.provider||"",name:a.name||"",model:a.model||"",platform:a.platform||"",status:a.status||"Activ",notes:a.notes||""})},[a]);const c=x=>{x.preventDefault(),r(o)},u=x=>{const{name:m,value:d}=x.target;i(g=>({...g,[m]:d}))};return e("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[t("div",{className:"sticky top-0 bg-gradient-to-r from-purple-600 via-purple-700 to-violet-600 text-white px-8 py-6 flex items-center justify-between rounded-t-3xl shadow-lg",children:[e("h2",{className:"text-2xl font-bold flex items-center",children:a?"Editează Cabinet":"Adaugă Cabinet Nou"}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-all duration-200 hover:scale-110",children:e(ve,{size:24})})]}),t("form",{onSubmit:c,className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:o.provider,onChange:u,className:"input-field",required:!0,children:[e("option",{value:"",children:"Selectează furnizor"}),l==null?void 0:l.map(x=>e("option",{value:x.name,children:x.name},x.id))]}),e("p",{className:"text-xs text-slate-500",children:"Furnizorul cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Cabinet *"}),e("input",{type:"text",name:"name",value:o.name,onChange:u,className:"input-field",placeholder:"Ex: Cabinet Premium 01",required:!0}),e("p",{className:"text-xs text-slate-500",children:"Numele cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Model"}),e("input",{type:"text",name:"model",value:o.model,onChange:u,className:"input-field",placeholder:"Ex: Deluxe 2024"}),e("p",{className:"text-xs text-slate-500",children:"Modelul cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Platformă *"}),t("select",{name:"platform",value:o.platform,onChange:u,className:"input-field",required:!0,children:[e("option",{value:"",children:"Selectează platformă"}),n==null?void 0:n.map(x=>e("option",{value:x.name,children:x.name},x.id))]}),e("p",{className:"text-xs text-slate-500",children:"Platforma tehnică a cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status *"}),t("select",{name:"status",value:o.status,onChange:u,className:"input-field",required:!0,children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Mentenanță",children:"Mentenanță"})]}),e("p",{className:"text-xs text-slate-500",children:"Statusul actual"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note Adiționale"}),e("textarea",{name:"notes",value:o.notes,onChange:u,className:"input-field min-h-[100px] resize-none",placeholder:"Informații suplimentare despre cabinet..."}),e("p",{className:"text-xs text-slate-500",children:"Observații și detalii adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary px-8",children:"Anulează"}),e("button",{type:"submit",className:"btn-primary px-8",children:a?"Actualizează Cabinet":"Adaugă Cabinet"})]})]})]})})},Gi=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(ct,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name||a.model}),e("p",{className:"text-cyan-100",children:"Detalii Cabinet"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Furnizor"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.provider_name||a.provider||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ct,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Model"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.model||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(jt,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Platformă"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.platform_name||a.platform||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},fs=({item:a,onClose:s,onSave:r})=>{const{providers:l}=ye(),[n,o]=h.useState({name:"",serial_numbers:"",provider_id:"",avatar_url:"",avatar_file:"",status:"Active",notes:""}),[i,c]=h.useState(null);h.useEffect(()=>{a&&(o({name:a.name||"",serial_numbers:a.serial_numbers||"",provider_id:a.provider_id||"",avatar_url:a.avatar_url||"",avatar_file:a.avatar_file||"",status:a.status||"Active",notes:a.notes||""}),a.avatar_url?c(a.avatar_url):a.avatar_file&&a.avatar_file!=="{}"?c(a.avatar_file):c(null))},[a]);const u=g=>{g.preventDefault(),r(n)},x=g=>{const{name:_,value:p}=g.target;o(N=>({...N,[_]:p}))},m=g=>{const _=g.target.files[0];if(_){const p=new FileReader;p.onload=N=>{const k=N.target.result;o(E=>({...E,avatar_file:k,avatar_url:""})),c(k)},p.readAsDataURL(_)}},d=g=>{o(_=>({..._,avatar_url:g.target.value,avatar_file:""})),g.target.value?c(g.target.value):c(null)};return e("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t("div",{className:"bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[t("div",{className:"sticky top-0 bg-gradient-to-r from-teal-600 via-cyan-600 to-blue-600 text-white px-8 py-6 flex items-center justify-between rounded-t-3xl shadow-lg",children:[e("h2",{className:"text-2xl font-bold flex items-center",children:a?"Editează Platformă":"Adaugă Platformă Nouă"}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-all duration-200 hover:scale-110",children:e(ve,{size:24})})]}),t("form",{onSubmit:u,className:"p-6",children:[t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Platformă *"}),e("input",{type:"text",name:"name",value:n.name,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",placeholder:"Ex: Android 10 Pro",required:!0})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor"}),t("select",{name:"provider_id",value:n.provider_id,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",children:[e("option",{value:"",children:"Selectează furnizor"}),l.map(g=>e("option",{value:g.id,children:g.name},g.id))]})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Avatar Platformă"}),t("div",{className:"space-y-3",children:[i&&e("div",{className:"flex justify-center",children:e("img",{src:i,alt:"Preview",className:"w-20 h-20 rounded-xl object-cover border-2 border-slate-200 shadow-sm"})}),e("input",{type:"url",name:"avatar_url",value:n.avatar_url,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",placeholder:"https://example.com/avatar.png"}),e("div",{className:"relative",children:e("input",{type:"file",name:"avatar_file",onChange:m,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100",accept:"image/*"})})]})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:n.status,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",required:!0,children:[e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"})]})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:n.notes,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm resize-none",placeholder:"Informații adiționale despre platformă...",rows:3})]})]}),t("div",{className:"mt-6 space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numere Seriale *"}),e("textarea",{name:"serial_numbers",value:n.serial_numbers,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm text-sm resize-none",placeholder:`Introdu numerele seriale, separate prin virgulă sau pe rânduri diferite:
SN001, SN002, SN003
sau:
SN001
SN002
SN003`,rows:4,required:!0}),t("div",{className:"flex items-center space-x-2 text-xs text-slate-500",children:[e("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-50 text-blue-700",children:"💡 Exemplu: SN12345, SN12346, SN12347"}),e("span",{children:"sau pe rânduri separate"})]})]}),t("div",{className:"flex justify-end space-x-3 pt-4 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-2.5 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-xl transition-all duration-200 font-medium",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl hover:from-cyan-600 hover:to-blue-600 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:a?"Actualizează":"Adaugă Platformă"})]})]})]})})},Vi=({locationId:a,locationName:s,hideSearchAndAdd:r=!1})=>{const{platforms:l,createItem:n,updateItem:o,deleteItem:i}=ye(),[c,u]=h.useState(!1),[x,m]=h.useState(null),[d,g]=h.useState(""),_=l.filter(D=>{var U,j,v,z;return((U=D.name)==null?void 0:U.toLowerCase().includes(d.toLowerCase()))||((j=D.type)==null?void 0:j.toLowerCase().includes(d.toLowerCase()))||((v=D.status)==null?void 0:v.toLowerCase().includes(d.toLowerCase()))||((z=D.description)==null?void 0:z.toLowerCase().includes(d.toLowerCase()))}),p=()=>{m(null),u(!0)},N=D=>{console.log("View platform:",D)},k=D=>{m(D),u(!0)},E=async D=>{if(window.confirm(`Sigur doriți să ștergeți platforma "${D.name}"?`))try{await i("platforms",D.id)}catch(U){console.error("Error deleting platform:",U)}},P=async D=>{try{x?await o("platforms",x.id,D):await n("platforms",D),u(!1),m(null)}catch(U){console.error("Error saving platform:",U)}},f=D=>{switch(D){case"Gaming":return"bg-purple-100 text-purple-800";case"Server":return"bg-blue-100 text-blue-800";case"Workstation":return"bg-green-100 text-green-800";case"Terminal":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},R=D=>{switch(D){case"Active":return"bg-green-100 text-green-800";case"Inactive":return"bg-red-100 text-red-800";case"Maintenance":return"bg-yellow-100 text-yellow-800";case"Offline":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},A=D=>{switch(D){case"Gaming":return e(jt,{className:"w-6 h-6 text-white"});case"Server":return e(Fa,{className:"w-6 h-6 text-white"});case"Workstation":return e(zr,{className:"w-6 h-6 text-white"});case"Terminal":return e(jt,{className:"w-6 h-6 text-white"});default:return e(jt,{className:"w-6 h-6 text-white"})}};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Platforme"}),e("p",{className:"text-slate-600",children:a?`Gestionează platformele pentru ${s}`:"Toate platformele din sistem"})]}),!r&&t("button",{onClick:p,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Platformă"})]})]}),!r&&t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută platforme...",value:d,onChange:D=>g(D.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),_.length>0?e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(D=>t("div",{className:"card p-6 hover:shadow-lg transition-all duration-200 group",children:[t("div",{className:"flex items-start justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-xl",children:A(D.type)}),t("div",{children:[e("h3",{className:"font-bold text-slate-800 group-hover:text-purple-700 transition-colors",children:D.name}),e("p",{className:"text-slate-600 text-sm",children:D.type})]})]}),t("div",{className:"flex space-x-1",children:[e("button",{onClick:()=>N(D),className:"p-2 text-slate-400 hover:text-blue-500 transition-colors",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>k(D),className:"p-2 text-slate-400 hover:text-green-500 transition-colors",children:e(at,{className:"w-4 h-4"})}),e("button",{onClick:()=>E(D),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:e(je,{className:"w-4 h-4"})})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[D.description&&e("div",{className:"text-sm text-slate-600",children:D.description}),D.specifications&&t("div",{className:"text-xs text-slate-500",children:[e("strong",{children:"Specs:"})," ",D.specifications]}),D.location&&t("div",{className:"text-xs text-slate-500",children:[e("strong",{children:"Locație:"})," ",D.location]})]}),t("div",{className:"flex space-x-2",children:[e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${f(D.type)}`,children:D.type}),e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${R(D.status)}`,children:D.status==="Active"?"Activ":D.status==="Inactive"?"Inactiv":D.status==="Maintenance"?"În mentenanță":D.status==="Offline"?"Offline":D.status})]}),D.notes&&e("div",{className:"text-sm text-slate-600 bg-slate-50 p-2 rounded-lg",children:D.notes})]})]},D.id))}):t("div",{className:"card p-12 text-center",children:[e("div",{className:"p-6 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-3xl inline-block mb-6",children:e(jt,{className:"w-16 h-16 text-purple-500 mx-auto"})}),e("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Nu există platforme"}),e("p",{className:"text-slate-600 mb-6",children:a?"Adaugă prima platformă pentru această locație":"Nu există platforme în sistem"}),!r&&t("button",{onClick:p,className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Platformă"})]})]}),c&&e(fs,{item:x,onClose:()=>{u(!1),m(null)},onSave:P})]})},qi=()=>{const{cabinets:a,platforms:s,providers:r,createItem:l,updateItem:n,deleteItem:o,exportData:i,loading:c}=ye(),[u,x]=h.useState(!1),[m,d]=h.useState(!1),[g,_]=h.useState(null),[p,N]=h.useState(""),[k,E]=h.useState([]),[P,f]=h.useState(!1),[R,A]=h.useState(!1),[D,U]=h.useState(null),[j,v]=h.useState(!1),[z,S]=h.useState(""),[F,I]=h.useState(""),[b,y]=h.useState(!0),[L,Y]=h.useState(!1);h.useEffect(()=>{f(k.length>0)},[k]);const O=Q=>{E(Q?Re.map(de=>de.id):[])},G=(Q,de)=>{E(de?[...k,Q]:k.filter(ue=>ue!==Q))},C=async()=>{k.length!==0&&A(!0)},W=async()=>{A(!1);const Q=k.length;let de=0,ue=0;try{const pe=$.loading(`Șterg ${Q} elemente...`,{duration:1/0}),Ae=5;for(let ee=0;ee<k.length;ee+=Ae){const fe=k.slice(ee,ee+Ae).map(async le=>{try{await o("cabinets",le,!0),de++}catch(be){ue++,console.error(`Error deleting cabinet ${le}:`,be)}});await Promise.all(fe);const ie=Math.min(ee+Ae,Q);$.loading(`Șterg ${Q} elemente... (${ie}/${Q})`,{id:pe})}$.dismiss(pe),ue===0?$.success(`✅ ${de} elemente șterse cu succes!`,{duration:5e3}):de>0?$.success(`⚠️ ${de} elemente șterse, ${ue} erori`,{duration:5e3}):$.error(`❌ Eroare la ștergerea tuturor ${Q} elemente`,{duration:5e3}),E([]),f(!1)}catch(pe){console.error("Error bulk deleting:",pe),$.error("Eroare la ștergerea elementelor!"),A(!1)}},T=()=>{k.length!==0&&console.log("Bulk edit for:",k)},Z=()=>{N(""),S(""),I(""),y(!0)},se=()=>[...new Set(a.map(Q=>Q.provider).filter(Boolean))],ne=()=>[...new Set(a.map(Q=>Q.platform).filter(Boolean))],[ce,Ce]=h.useState("cabinets"),Re=a.filter(Q=>{var me,fe,ie,le,be,te;const de=((me=Q.name)==null?void 0:me.toLowerCase().includes(p.toLowerCase()))||((fe=Q.provider)==null?void 0:fe.toLowerCase().includes(p.toLowerCase()))||((ie=Q.model)==null?void 0:ie.toLowerCase().includes(p.toLowerCase()))||((le=Q.platform)==null?void 0:le.toLowerCase().includes(p.toLowerCase())),ue=!z||Q.provider===z,pe=!F||Q.platform===F,Ae=((be=Q.status)==null?void 0:be.toLowerCase())==="activ"||((te=Q.status)==null?void 0:te.toLowerCase())==="active";return de&&ue&&pe&&(b||Ae)});s!=null&&s.filter(Q=>{var de,ue;return((de=Q.name)==null?void 0:de.toLowerCase().includes(p.toLowerCase()))||((ue=Q.serial_numbers)==null?void 0:ue.toLowerCase().includes(p.toLowerCase()))});const Ue=[{key:"name",label:"Nume Cabinet",sortable:!0,render:Q=>t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white font-bold shadow-lg",children:e(ct,{className:"w-4 h-4 text-white"})}),e("div",{className:"font-bold text-slate-900",children:Q.name})]})},{key:"provider",label:"Furnizor",sortable:!0,render:Q=>{var pe;const ue=(Ae=>{if(Ae.provider_logo)try{const ee=typeof Ae.provider_logo=="string"?JSON.parse(Ae.provider_logo):Ae.provider_logo;return ee.file||ee.url||ee}catch{return Ae.provider_logo}return null})(Q);return t("div",{className:"flex items-center space-x-3",children:[ue?e("img",{src:ue,alt:Q.provider_name||Q.provider,className:"w-8 h-8 rounded-full object-cover border-2 border-slate-200 bg-white shadow-md",onError:Ae=>{Ae.target.style.display="none",Ae.target.nextSibling.style.display="flex"}}):null,e("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-violet-500 flex items-center justify-center text-white font-bold shadow-lg",style:{display:ue?"none":"flex"},children:((pe=Q.provider_name||Q.provider)==null?void 0:pe.charAt(0))||"F"}),e("span",{className:"text-slate-800 font-medium text-base",children:Q.provider_name||Q.provider||"N/A"})]})}},{key:"model",label:"Model",sortable:!0},{key:"platform",label:"Platformă",sortable:!0,render:Q=>{const ue=(pe=>pe.platform_avatar_url&&pe.platform_avatar_url.trim()!==""?pe.platform_avatar_url:pe.platform_avatar_file&&pe.platform_avatar_file!=="{}"&&pe.platform_avatar_file.trim()!==""?pe.platform_avatar_file:null)(Q);return t("div",{className:"flex items-center space-x-3",children:[ue?e("img",{src:ue,alt:Q.platform_name||Q.platform,className:"w-[60px] h-[30px] object-contain",onError:pe=>{pe.target.style.display="none",pe.target.nextSibling.style.display="flex"}}):null,e("div",{className:`w-[60px] h-[30px] rounded flex items-center justify-center text-white font-bold shadow-sm ${ue?"bg-white border border-slate-200":"bg-gradient-to-br from-cyan-500 to-blue-500"}`,style:{display:ue?"none":"flex"},children:e(jt,{className:`w-5 h-5 ${ue?"text-slate-600":"text-white"}`})}),e("span",{className:"text-slate-800 font-medium text-base",children:Q.platform_name||Q.platform||"N/A"})]})}},{key:"status",label:"Status",sortable:!0,render:Q=>{var ue,pe;const de=((ue=Q.status)==null?void 0:ue.toLowerCase())==="activ"||((pe=Q.status)==null?void 0:pe.toLowerCase())==="active";return e("span",{className:`px-4 py-2 rounded-2xl text-base font-medium shadow-lg ${de?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-green-500/25":"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-red-500/25"}`,children:de?"Activ":"Inactiv"})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:Q=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:Q.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:Q.created_at?new Date(Q.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];h.useState({});const Ve=()=>{_(null),x(!0)},et=()=>{_(null),d(!0)},qe=Q=>{_(Q),ce==="cabinets"?x(!0):d(!0)},$e=async Q=>{const de=ce==="cabinets"?"cabinets":"platforms";g?await n(de,g.id,Q):await l(de,Q),x(!1),d(!1)},Ze=async Q=>{const de=ce==="cabinets"?"cabinets":"platforms",ue=typeof Q=="object"?Q.id:Q;window.confirm(`Sigur vrei să ștergi acest ${ce==="cabinets"?"cabinet":"platformă"}?`)&&await o(de,ue)};return t(he,{children:[t("div",{className:"space-y-6",children:[e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 bg-slate-100 rounded-xl p-1",children:[e("button",{onClick:()=>{Ce("cabinets"),N("")},className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${ce==="cabinets"?"bg-gradient-to-r from-purple-500 to-violet-500 text-white shadow-lg shadow-purple-500/25 scale-105":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ct,{size:20}),e("span",{children:"CABINETE"}),e("span",{className:`px-2 py-1 rounded-full text-xs ${ce==="cabinets"?"bg-white/20":"bg-slate-200 text-slate-700"}`,children:a.length})]})}),e("button",{onClick:()=>{Ce("platforms"),N("")},className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${ce==="platforms"?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/25 scale-105":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(jt,{size:20}),e("span",{children:"PLATFORME"}),e("span",{className:`px-2 py-1 rounded-full text-xs ${ce==="platforms"?"bg-white/20":"bg-slate-200 text-slate-700"}`,children:(s==null?void 0:s.length)||0})]})})]})}),e("div",{className:"card p-6",children:t("div",{className:"space-y-4",children:[t("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e("div",{className:"flex-1 max-w-md",children:t("div",{className:"relative",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400",size:20}),e("input",{type:"text",placeholder:`Caută ${ce==="cabinets"?"cabinete":"platforme"}...`,value:p,onChange:Q=>N(Q.target.value),onKeyDown:Q=>{if(Q.key==="Tab"&&p.length>0)if(ce==="cabinets"){const de=a.find(ue=>{var pe,Ae;return((pe=ue.name)==null?void 0:pe.toLowerCase().startsWith(p.toLowerCase()))||((Ae=ue.provider)==null?void 0:Ae.toLowerCase().startsWith(p.toLowerCase()))});de&&N(de.name||de.provider)}else{const de=s==null?void 0:s.find(ue=>{var pe;return(pe=ue.name)==null?void 0:pe.toLowerCase().startsWith(p.toLowerCase())});de&&N(de.name)}},className:"input-field pl-12"}),p.length>0&&e("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg z-10 max-h-48 overflow-y-auto",children:ce==="cabinets"?e(De,{children:a.filter(Q=>{var de,ue;return((de=Q.name)==null?void 0:de.toLowerCase().includes(p.toLowerCase()))||((ue=Q.provider)==null?void 0:ue.toLowerCase().includes(p.toLowerCase()))}).slice(0,5).map((Q,de)=>e("button",{onClick:()=>N(Q.name||Q.provider),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:Q.name||Q.provider},Q.id))}):e(De,{children:s==null?void 0:s.filter(Q=>{var de;return(de=Q.name)==null?void 0:de.toLowerCase().includes(p.toLowerCase())}).slice(0,5).map((Q,de)=>e("button",{onClick:()=>N(Q.name),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:Q.name},Q.id))})})]})}),t("div",{className:"flex gap-3",children:[t("button",{onClick:()=>Y(!L),className:`btn-secondary flex items-center space-x-2 ${L?"bg-blue-500 text-white":""}`,children:[e(Wt,{size:18}),e("span",{children:"Filtre"})]}),t("button",{onClick:()=>i(ce==="cabinets"?"cabinets":"platforms"),className:"btn-secondary flex items-center space-x-2",children:[e(We,{size:18}),e("span",{className:"hidden sm:inline",children:"Export"})]}),P&&ce==="cabinets"&&t(De,{children:[t("button",{onClick:C,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(je,{className:"w-4 h-4"}),t("span",{children:["Șterge (",k.length,")"]})]}),t("button",{onClick:T,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]})]}),t("button",{onClick:ce==="cabinets"?Ve:et,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:ce==="cabinets"?"Adaugă Cabinet":"Adaugă Platformă"})]})]})]}),L&&ce==="cabinets"&&e("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Furnizor"}),t("select",{value:z,onChange:Q=>S(Q.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e("option",{value:"",children:"Toate furnizorii"}),se().map(Q=>e("option",{value:Q,children:Q},Q))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Platformă"}),t("select",{value:F,onChange:Q=>I(Q.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e("option",{value:"",children:"Toate platformele"}),ne().map(Q=>e("option",{value:Q,children:Q},Q))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Status"}),e("div",{className:"flex items-center space-x-3",children:t("button",{onClick:()=>y(!b),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ${b?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200"}`,children:[b?e(Qe,{className:"w-4 h-4"}):e(Ja,{className:"w-4 h-4"}),e("span",{className:"font-medium",children:b?"Arată toate":"Doar active"})]})})]}),e("div",{className:"flex items-end",children:t("button",{onClick:Z,className:"w-full px-4 py-2 bg-slate-200 dark:bg-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors flex items-center justify-center space-x-2",children:[e(ve,{className:"w-4 h-4"}),e("span",{children:"Resetează"})]})})]})})]})}),ce==="cabinets"?t("div",{className:"card p-6",children:[t("div",{className:"mb-4 flex items-center justify-between",children:[t("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Afișez ",Re.length," din ",a.length," cabinete",!b&&e("span",{className:"ml-2 px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 rounded-full text-xs",children:"Doar active"})]}),(z||F||p)&&e("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Filtre active"})]}),e(He,{data:Re,columns:Ue,onEdit:qe,onDelete:Ze,onRowClick:Q=>{U(Q),v(!0)},loading:c,selectedItems:k,onSelectAll:O,onSelectItem:G,moduleColor:"blue"})]}):e(Vi,{locationId:null,locationName:"Toate Platformele",hideSearchAndAdd:!0})]}),u&&e(Ui,{item:g,onClose:()=>x(!1),onSave:$e}),m&&e(fs,{item:g,onClose:()=>d(!1),onSave:$e}),j&&e(Gi,{item:D,onClose:()=>{v(!1),U(null)}}),R&&e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:t("div",{className:"p-6",children:[t("div",{className:"flex items-center space-x-4 mb-4",children:[e("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 rounded-full",children:e(je,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:["Șterge ",k.length," Elemente"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",k.length," elemente selectate? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>A(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:W,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",k.length," Elemente"]})]})]})})})]})},Ji=({item:a,onClose:s,onSave:r})=>{const{providers:l}=ye(),[n,o]=h.useState({name:"",provider:"",games:"",rtp:"",denomination:.01,max_bet:"",gaming_places:1,status:"Active",notes:""});h.useEffect(()=>{if(a){let x="";try{if(typeof a.games=="string"){const m=JSON.parse(a.games);x=Array.isArray(m)?m.join(`
`):""}else Array.isArray(a.games)&&(x=a.games.join(`
`))}catch(m){console.error("Error parsing games:",m),x=""}o({name:a.name||"",provider:a.provider||"",games:x,rtp:a.rtp||"",denomination:a.denomination||.01,max_bet:a.max_bet||"",gaming_places:a.gaming_places||1,status:a.status||"Active",notes:a.notes||""})}},[a]);const i=x=>{const{name:m,value:d}=x.target;o(g=>({...g,[m]:d}))},c=()=>n.games.trim()?n.games.split(`
`).filter(x=>x.trim()).length:0;return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-indigo-800 to-blue-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 to-blue-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl shadow-lg",children:e(Bt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Game Mix":"Adaugă Game Mix"}),e("p",{className:"text-indigo-100 text-sm font-medium",children:"Completează informațiile despre game mix"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:x=>{x.preventDefault();const m=n.games.split(`
`).map(g=>g.trim()).filter(g=>g.length>0),d={...n,games:m,rtp:n.rtp?parseFloat(n.rtp):null,denomination:n.denomination?parseFloat(n.denomination):.01,max_bet:n.max_bet?parseFloat(n.max_bet):null,gaming_places:n.gaming_places?parseInt(n.gaming_places):1};console.log("🎮 GameMix submitData:",d),r(d)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Game Mix *"}),e("input",{type:"text",name:"name",value:n.name,onChange:i,className:"input-field",placeholder:"ex: Mix Clasice Novomatic",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Furnizor"}),t("select",{name:"provider",value:n.provider,onChange:i,className:"input-field",children:[e("option",{value:"",children:"Selectează furnizor"}),l==null?void 0:l.map(x=>e("option",{value:x.name,children:x.name},x.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"RTP (%)"}),e("input",{type:"number",step:"0.01",name:"rtp",value:n.rtp,onChange:i,className:"input-field",placeholder:"ex: 96.5"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status *"}),t("select",{name:"status",value:n.status,onChange:i,className:"input-field",required:!0,children:[e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Jocuri în Mix"}),t("div",{className:"flex items-center space-x-3 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200",children:[e("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white font-bold shadow-lg",children:c()}),t("div",{children:[t("div",{className:"font-bold text-slate-900",children:[c()," jocuri"]}),e("div",{className:"text-sm text-slate-500",children:"în acest mix"})]})]})]})]}),e("div",{className:"space-y-4",children:t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Jocuri în Mix"}),e("textarea",{name:"games",value:n.games,onChange:i,className:"input-field",rows:6,placeholder:`Introdu numele jocurilor, separate pe rânduri diferite:
Book of Ra
Sizzling Hot
Lucky Lady Charm
Dolphins Pearl`}),t("div",{className:"flex items-center space-x-2 text-xs text-slate-500",children:[e("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-green-50 text-green-700",children:"💡 Exemplu: Un joc pe fiecare rând"}),e("span",{className:"text-slate-400",children:"•"}),t("span",{children:[c()," jocuri adăugate"]})]})]})}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Configurație Tehnică"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Denomination"}),e("input",{type:"number",step:"0.01",name:"denomination",value:n.denomination,onChange:i,className:"input-field",placeholder:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Max Bet"}),e("input",{type:"number",step:"0.01",name:"max_bet",value:n.max_bet,onChange:i,className:"input-field",placeholder:"100.00"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Gaming Places"}),e("input",{type:"number",name:"gaming_places",value:n.gaming_places,onChange:i,className:"input-field",placeholder:"1"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:n.notes,onChange:i,className:"input-field",rows:3,placeholder:"Note adiționale despre acest game mix..."})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(Bt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Game Mix"]})]})]})]})})]})})},Hi=({item:a,onClose:s})=>a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-orange-600 to-amber-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(Bt,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-orange-100",children:"Detalii Game Mix"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Furnizor"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.provider||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ct,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Cabinet"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.cabinet||"N/A"})]}),a.version&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(At,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Versiune"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white font-mono",children:a.version})]}),a.gaming_places&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(At,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Gaming Places"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.gaming_places})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null,Wi=()=>{const a=Ye();ye();const[s,r]=h.useState([]),[l,n]=h.useState(!1),[o,i]=h.useState(""),[c,u]=h.useState(""),[x,m]=h.useState(""),[d,g]=h.useState(""),[_,p]=h.useState("grid"),[N,k]=h.useState("name"),E=[{game_id:"00000004-0000-5000-9000-000000000001",name:"10 Burning Heart",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"fruits",volatility:"low - medium",lines:10,layout:"5x3",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000001.png"},{game_id:"00000004-0000-5000-9000-000000000002",name:"100 Burning Hot",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"fruits",volatility:"medium",lines:100,layout:"5x4",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000002.png"},{game_id:"00000004-0000-5000-9000-000000000003",name:"100 Cats",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"animals and nature and wildlife",volatility:"low - medium",lines:100,layout:"5x4",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000003.png"},{game_id:"00000004-0000-5000-9000-000000000005",name:"2 Dragons",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"dragons and mythical creatures;asian cultures;oriental and asian prosperity",volatility:"high",lines:20,layout:"5x3",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000005.png"},{game_id:"00000004-0000-5000-9000-000000000099",name:"Mini Burning Hot",provider:"Egypt Quest",provider_id:"00000555-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"n/a",mechanic:"n/a",theme:"n/a",volatility:"n/a",lines:5,layout:"n/a",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000099.png"}];h.useEffect(()=>{P()},[]);const P=async()=>{n(!0);try{const S=await fetch("/api/games");if(!S.ok)throw new Error("Failed to load games");const F=await S.json();r(F)}catch(S){console.error("Error loading games:",S),r(E)}finally{n(!1)}},f=[...new Set(s.map(S=>S.provider))],R=[...new Set(s.map(S=>S.volatility).filter(S=>S&&S!=="n/a"))];[...new Set(s.map(S=>S.theme).filter(S=>S&&S!=="n/a"))];const A=s.filter(S=>{const F=S.name.toLowerCase().includes(o.toLowerCase()),I=!c||S.provider===c,b=!x||S.volatility===x,y=!d||S.theme.includes(d);return F&&I&&b&&y}),D=[...A].sort((S,F)=>{switch(N){case"provider":return S.provider.localeCompare(F.provider);case"volatility":const I={low:1,"low - medium":2,medium:3,high:4};return(I[S.volatility]||5)-(I[F.volatility]||5);default:return S.name.localeCompare(F.name)}}),U=S=>{switch(S){case"low":return"bg-green-100 text-green-800";case"low - medium":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=S=>{switch(S){case"low":return e(dt,{className:"w-3 h-3"});case"low - medium":return e(ra,{className:"w-3 h-3"});case"medium":return e(Pr,{className:"w-3 h-3"});case"high":return e(ra,{className:"w-3 h-3"});default:return e(dt,{className:"w-3 h-3"})}};return t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(ct,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Biblioteca Jocuri"}),e("p",{className:"text-slate-600",children:"Toate jocurile disponibile de la toți furnizorii"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>{console.log("Export games library")},className:"btn-secondary flex items-center space-x-2",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Exportă"})]}),t("button",{onClick:()=>{console.log("Import games from Google Sheets")},className:"btn-primary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă din Sheets"})]})]})]})}),t("div",{className:"card p-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t("div",{className:"lg:col-span-2 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută jocuri...",value:o,onChange:S=>i(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),t("select",{value:c,onChange:S=>u(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"",children:"Toți furnizorii"}),f.map(S=>e("option",{value:S,children:S},S))]}),t("select",{value:x,onChange:S=>m(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"",children:"Toate volatilitățile"}),R.map(S=>e("option",{value:S,children:S},S))]}),t("select",{value:N,onChange:S=>k(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"name",children:"Sortare: Nume"}),e("option",{value:"provider",children:"Sortare: Furnizor"}),e("option",{value:"volatility",children:"Sortare: Volatilitate"})]})]}),t("div",{className:"flex items-center justify-between mt-4",children:[e("div",{className:"flex items-center space-x-2",children:t("span",{className:"text-sm text-slate-600",children:[A.length," jocuri din ",s.length," total"]})}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>p("grid"),className:`p-2 rounded-lg transition-colors ${_==="grid"?"bg-purple-100 text-purple-600":"text-slate-400 hover:text-slate-600"}`,children:e(Ts,{className:"w-4 h-4"})}),e("button",{onClick:()=>p("list"),className:`p-2 rounded-lg transition-colors ${_==="list"?"bg-purple-100 text-purple-600":"text-slate-400 hover:text-slate-600"}`,children:e(zs,{className:"w-4 h-4"})})]})]})]}),e("div",{className:"card p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):A.length===0?t("div",{className:"text-center py-12",children:[e(ct,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există jocuri"}),e("p",{className:"text-slate-500",children:"Importă jocurile din Google Sheets pentru a începe"})]}):e("div",{className:_==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4":"space-y-4",children:D.map(S=>_==="grid"?e("div",{className:"group cursor-pointer",onClick:()=>a(`/games/${S.game_id}`),children:t("div",{className:"bg-white rounded-xl border border-slate-200 p-3 hover:shadow-lg transition-all duration-200 hover:scale-105",children:[t("div",{className:"w-full h-64 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-lg mb-3 overflow-hidden flex items-center justify-center",children:[e("img",{src:S.image_url,alt:S.name,className:"max-w-full max-h-full object-contain group-hover:scale-105 transition-transform duration-300",style:{imageRendering:"crisp-edges"},onError:F=>{F.target.style.display="none",F.target.nextSibling.style.display="flex"}}),e("div",{className:"w-full h-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",style:{display:"none"},children:e(ct,{className:"w-8 h-8 text-purple-400"})})]}),t("div",{className:"space-y-2",children:[e("h3",{className:"font-semibold text-slate-800 text-sm line-clamp-2 group-hover:text-purple-600 transition-colors",children:S.name}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded-full",children:S.provider}),S.volatility&&S.volatility!=="n/a"&&t("span",{className:`text-xs px-2 py-1 rounded-full flex items-center space-x-1 ${U(S.volatility)}`,children:[j(S.volatility),e("span",{children:S.volatility})]})]}),S.lines&&S.lines!=="n/a"&&t("div",{className:"text-xs text-slate-500",children:[S.lines," linii • ",S.layout]})]})]})},S.game_id):t("div",{className:"flex items-center space-x-4 p-4 bg-white rounded-xl border border-slate-200 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>a(`/games/${S.game_id}`),children:[t("div",{className:"w-20 h-20 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-lg overflow-hidden flex-shrink-0 flex items-center justify-center",children:[e("img",{src:S.image_url,alt:S.name,className:"max-w-full max-h-full object-contain",style:{imageRendering:"crisp-edges"},onError:F=>{F.target.style.display="none",F.target.nextSibling.style.display="flex"}}),e("div",{className:"w-full h-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",style:{display:"none"},children:e(ct,{className:"w-6 h-6 text-purple-400"})})]}),t("div",{className:"flex-1 min-w-0",children:[e("h3",{className:"font-semibold text-slate-800 group-hover:text-purple-600 transition-colors",children:S.name}),e("p",{className:"text-sm text-slate-500 truncate",children:S.theme}),t("div",{className:"flex items-center space-x-2 mt-1",children:[e("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded-full",children:S.provider}),S.volatility&&S.volatility!=="n/a"&&t("span",{className:`text-xs px-2 py-1 rounded-full flex items-center space-x-1 ${U(S.volatility)}`,children:[j(S.volatility),e("span",{children:S.volatility})]}),S.lines&&S.lines!=="n/a"&&t("span",{className:"text-xs text-slate-500",children:[S.lines," linii"]})]})]}),e("button",{onClick:F=>{F.stopPropagation(),a(`/games/${S.game_id}`)},className:"p-2 text-slate-400 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:e(Qe,{className:"w-4 h-4"})})]},S.game_id))})})]})},Yi=()=>{const{gameMixes:a,createItem:s,updateItem:r,deleteItem:l,refreshData:n}=ye(),[o,i]=h.useState("mixes"),[c,u]=h.useState(!1),[x,m]=h.useState(null),[d,g]=h.useState(""),[_,p]=h.useState("all"),[N,k]=h.useState([]),[E,P]=h.useState(!1),[f,R]=h.useState(null),[A,D]=h.useState(!1);h.useEffect(()=>{P(N.length>0)},[N]);const U=()=>{m(null),u(!0)},j=O=>{m(O),u(!0)},v=()=>{u(!1),m(null)},z=async O=>{try{console.log("🎮 GameMixes handleSave:",{selectedItem:x,formData:O}),x?(console.log("🎮 Updating game mix:",x.id,O),await r("gameMixes",x.id,O)):(console.log("🎮 Creating game mix:",O),await s("gameMixes",O)),await n(),v()}catch(G){console.error("Error saving game mix:",G)}},S=async O=>{if(window.confirm("Ești sigur că vrei să ștergi acest game mix?"))try{await l("gameMixes",O)}catch(G){console.error("Error deleting game mix:",G)}},F=O=>{k(O?L.map(G=>G.id):[])},I=(O,G)=>{k(G?[...N,O]:N.filter(C=>C!==O))},b=async()=>{if(N.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${N.length} game mix-uri?`))try{for(const O of N)await l("gameMixes",O);k([]),P(!1)}catch(O){console.error("Error bulk deleting game mixes:",O)}},y=()=>{N.length!==0&&console.log("Bulk edit for:",N)},L=a.filter(O=>{var W,T;const G=((W=O.name)==null?void 0:W.toLowerCase().includes(d.toLowerCase()))||((T=O.provider)==null?void 0:T.toLowerCase().includes(d.toLowerCase())),C=_==="all"||O.status===_;return G&&C}),Y=[{key:"name",label:"Nume Game Mix",sortable:!0,render:O=>t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-red-500 to-pink-500 flex items-center justify-center text-white font-bold shadow-lg",children:e(Bt,{className:"w-5 h-5"})}),t("div",{children:[e("div",{className:"font-bold text-slate-900",children:O.name}),t("div",{className:"text-sm text-slate-500",children:["ID: ",O.id]})]})]})},{key:"provider",label:"Furnizor",sortable:!0,render:O=>e("span",{className:"bg-gradient-to-r from-purple-100 to-violet-100 text-purple-800 px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm",children:O.provider||"N/A"})},{key:"games",label:"Jocuri",render:O=>{const G=typeof O.games=="string"?JSON.parse(O.games):O.games,C=Array.isArray(G)?G.length:0;return t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white font-bold shadow-lg",children:C}),t("span",{className:"text-sm font-medium text-slate-700",children:[C," jocuri"]})]})}},{key:"status",label:"Status",sortable:!0,render:O=>{var W;const G=((W=O.status)==null?void 0:W.toLowerCase())||"";return e("span",{className:`px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ${G==="activ"||G==="active"?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800":"bg-gradient-to-r from-red-100 to-pink-100 text-red-800"}`,children:O.status})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:O=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:O.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:O.created_at?new Date(O.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];return e(he,{children:t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl shadow-lg shadow-red-500/25",children:e(Bt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Game Mixes"}),e("p",{className:"text-slate-600",children:"Gestionează mixurile de jocuri și biblioteca de jocuri"})]})]}),t("div",{className:"flex items-center space-x-3",children:[o==="mixes"&&E&&t(De,{children:[t("button",{onClick:y,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),t("span",{children:["Bulk Edit (",N.length,")"]})]}),t("button",{onClick:b,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),t("span",{children:["Bulk Delete (",N.length,")"]})]})]}),o==="mixes"&&t("button",{onClick:U,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-5 h-5"}),e("span",{children:"Adaugă Game Mix"})]})]})]}),t("div",{className:"flex space-x-1 bg-slate-100 p-1 rounded-lg",children:[t("button",{onClick:()=>i("mixes"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-md transition-all duration-200 ${o==="mixes"?"bg-white text-red-600 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"}`,children:[e(Bt,{className:"w-4 h-4"}),e("span",{className:"font-medium",children:"Game Mixes"})]}),t("button",{onClick:()=>i("games"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-md transition-all duration-200 ${o==="games"?"bg-white text-purple-600 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"}`,children:[e(ct,{className:"w-4 h-4"}),e("span",{className:"font-medium",children:"Biblioteca Jocuri"})]})]})]}),o==="mixes"?t(De,{children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-wrap gap-4 items-center",children:[e("div",{className:"flex-1 min-w-64",children:t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută game mix sau furnizor...",value:d,onChange:O=>g(O.target.value),className:"input-field pl-10"})]})}),t("div",{className:"flex items-center space-x-2",children:[e(Wt,{className:"w-5 h-5 text-slate-500"}),t("select",{value:_,onChange:O=>p(O.target.value),className:"input-field",children:[e("option",{value:"all",children:"Toate statusurile"}),e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"})]})]}),t("div",{className:"flex items-center space-x-2",children:[t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Export"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Import"})]})]})]})}),e("div",{className:"card",children:e(He,{data:L,columns:Y,onEdit:j,onDelete:S,onRowClick:O=>{R(O),D(!0)},searchTerm:d,emptyMessage:"Nu există game mixes în sistem",selectedItems:N,onSelectAll:F,onSelectItem:I,moduleColor:"blue"})})]}):e(Wi,{}),c&&e(Ji,{item:x,onClose:v,onSave:z}),A&&e(Hi,{item:f,onClose:()=>{D(!1),R(null)}})]})})},Ki=({item:a,onClose:s,onSave:r})=>{const{locations:l}=ye(),n=()=>new Date().toISOString().split("T")[0],o=()=>"2025-12-31",i=()=>"2025-12-31",[c,u]=h.useState(()=>{const A=new Date().toISOString().split("T")[0],D="2025-12-31";return{name:"",description:"",start_date:A,end_date:D,location:"",locations:[{location:"",start_date:A,end_date:D}],prizes:[{amount:"",currency:"RON",date:"2025-12-31",winner:""}],status:"Active",notes:"",attachments:[],bannerFile:null,bannerPreview:null,documentsFile:null,documentsPreview:null}});h.useEffect(()=>{if(a){let A=[{amount:"",currency:"RON",date:"",winner:""}];a.prizes?A=typeof a.prizes=="string"?JSON.parse(a.prizes):a.prizes:a.prize_amount&&(A=[{amount:a.prize_amount||"",currency:a.prize_currency||"RON",date:a.prize_date?a.prize_date.split("T")[0]:"",winner:a.winner||""}]);let D=[{location:"",start_date:"",end_date:""}];a.locations?D=typeof a.locations=="string"?JSON.parse(a.locations):a.locations:a.location&&(D=[{location:a.location||"",start_date:a.start_date?a.start_date.split("T")[0]:"",end_date:a.end_date?a.end_date.split("T")[0]:""}]);let U=[];a.attachments&&(U=typeof a.attachments=="string"?JSON.parse(a.attachments):a.attachments),u({name:a.name||a.title||"",description:a.description||"",start_date:a.start_date?a.start_date.split("T")[0]:"",end_date:a.end_date?a.end_date.split("T")[0]:"",location:a.location||"",locations:D.length>0?D:[{location:"",start_date:"",end_date:""}],prizes:A.length>0?A:[{amount:"",currency:"RON",date:"",winner:""}],status:a.status||"Active",notes:a.notes||"",attachments:U||[],bannerFile:a.banner_url||null,bannerPreview:a.banner_url||null,documentsFile:a.documents_url||null,documentsPreview:a.documents_url||null})}else{const A=n(),D=o(),U=i();u({name:"",description:"",start_date:A,end_date:D,location:"",locations:[{location:"",start_date:A,end_date:D}],prizes:[{amount:"",currency:"RON",date:U,winner:""}],status:"Active",notes:"",attachments:[],bannerFile:null,bannerPreview:null,documentsFile:null,documentsPreview:null})}},[a]);const x=A=>{const{name:D,value:U}=A.target;u(j=>({...j,[D]:U}))},m=(A,D,U)=>{u(j=>({...j,locations:j.locations.map((v,z)=>z===A?{...v,[D]:U}:v)}))},d=()=>{const A=n(),D=o();u(U=>({...U,locations:[...U.locations,{location:"",start_date:A,end_date:D}]}))},g=A=>{u(D=>({...D,locations:D.locations.filter((U,j)=>j!==A)}))},_=(A,D,U)=>{const j=[...c.prizes];j[A][D]=U,u(v=>({...v,prizes:j}))},p=()=>{const A=i();u(D=>({...D,prizes:[...D.prizes,{amount:"",currency:"RON",date:A,winner:""}]}))},N=A=>{if(c.prizes.length===1){alert("Trebuie să existe cel puțin un premiu!");return}u(D=>({...D,prizes:D.prizes.filter((U,j)=>j!==A)}))},k=A=>{const D=A.target.files[0];if(D){const U=new FileReader;U.onload=j=>{u(v=>({...v,bannerFile:D,bannerPreview:j.target.result}))},U.readAsDataURL(D)}},E=A=>{const D=A.target.files[0];if(D){const U=new FileReader;U.onload=j=>{u(v=>({...v,documentsFile:D,documentsPreview:j.target.result}))},U.readAsDataURL(D)}},P=()=>{window.confirm("Sigur doriți să ștergeți banner-ul?")&&u(A=>({...A,bannerFile:null,bannerPreview:null}))},f=()=>{window.confirm("Sigur doriți să ștergeți documentele?")&&u(A=>({...A,documentsFile:null,documentsPreview:null}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(st,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editare Promoție":"Promoție Nouă"}),e("p",{className:"text-blue-100 text-sm",children:"Marketing & Tombole"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:A=>{A.preventDefault();const D=c.prizes.filter(z=>z.amount&&parseFloat(z.amount)>0);if(D.length===0){alert("Adaugă cel puțin un premiu cu sumă validă!");return}const U=D.sort((z,S)=>z.date?S.date?new Date(z.date)-new Date(S.date):-1:1),j=new FormData;c.bannerFile&&c.bannerFile instanceof File&&j.append("banner",c.bannerFile),c.documentsFile&&c.documentsFile instanceof File&&j.append("documents",c.documentsFile);const v={...c,prizes:U,banner_url:c.bannerPreview,documents_url:c.documentsPreview};r(v)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(st,{className:"w-4 h-4 inline mr-2"}),"Nume Promoție *"]}),e("input",{type:"text",name:"name",value:c.name,onChange:x,required:!0,placeholder:"Ex: Tombola Paște 2025",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(Fe,{className:"w-4 h-4 inline mr-2"}),"Locații (Multiple săli cu date diferite) *"]}),t("div",{className:"space-y-4",children:[c.locations.map((A,D)=>t("div",{className:"p-4 border border-slate-200 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-800",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Sala ",D+1]}),c.locations.length>1&&e("button",{type:"button",onClick:()=>g(D),className:"text-red-500 hover:text-red-700 transition-colors",children:e(je,{className:"w-4 h-4"})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Locație"}),t("select",{value:A.location,onChange:U=>m(D,"location",U.target.value),required:!0,className:`w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-600 
                                   bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                                   focus:border-blue-500 focus:ring-1 focus:ring-blue-200 transition-all text-sm`,children:[e("option",{value:"",children:"Selectează sala"}),l.map(U=>e("option",{value:U.name,children:U.name},U.id))]})]}),t("div",{children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Data început"}),e("input",{type:"date",value:A.start_date,onChange:U=>m(D,"start_date",U.target.value),className:`w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-600 
                                   bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                                   focus:border-blue-500 focus:ring-1 focus:ring-blue-200 transition-all text-sm`})]}),t("div",{children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Data sfârșit"}),e("input",{type:"date",value:A.end_date,onChange:U=>m(D,"end_date",U.target.value),className:`w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-600 
                                   bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                                   focus:border-blue-500 focus:ring-1 focus:ring-blue-200 transition-all text-sm`})]})]})]},D)),t("button",{type:"button",onClick:d,className:`w-full py-2 px-4 border-2 border-dashed border-slate-300 dark:border-slate-600 
                           rounded-lg text-slate-600 dark:text-slate-400 hover:border-blue-500 
                           hover:text-blue-500 transition-all flex items-center justify-center space-x-2`,children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă altă sală"})]})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Descriere"}),e("textarea",{name:"description",value:c.description,onChange:x,rows:3,placeholder:"Descriere promoție...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-pink-500 focus:ring-2 focus:ring-pink-200 transition-all`})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center",children:[e(_t,{className:"w-5 h-5 mr-2 text-pink-500"}),"Premii (Data Acordare)"]}),t("button",{type:"button",onClick:p,className:`flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-500 
                         text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg`,children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Premiu"})]})]}),e("div",{className:"space-y-4",children:c.prizes.map((A,D)=>t("div",{className:"bg-slate-50 dark:bg-slate-700 p-4 rounded-xl border-2 border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:["Premiu #",D+1]}),c.prizes.length>1&&e("button",{type:"button",onClick:()=>N(D),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900 rounded-lg transition-all",children:e(je,{className:"w-4 h-4"})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Sumă *"}),e("input",{type:"number",value:A.amount||"",onChange:U=>_(D,"amount",U.target.value),required:!0,placeholder:"5000",min:"0",step:"0.01",className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Monedă"}),t("select",{value:A.currency||"RON",onChange:U=>_(D,"currency",U.target.value),className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,children:[e("option",{value:"RON",children:"RON"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Data Acordare *"}),e("input",{type:"date",value:A.date||"",onChange:U=>_(D,"date",U.target.value),required:!0,className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Câștigător"}),e("input",{type:"text",value:A.winner||"",onChange:U=>_(D,"winner",U.target.value),placeholder:"Nume câștigător",className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]})]})]},D))})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("div",{className:"flex items-center justify-between mb-4",children:t("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center",children:[e(St,{className:"w-5 h-5 mr-2 text-blue-500"}),"Banner Promoție"]})}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Imagine Banner (JPG, PNG)"}),e("input",{type:"file",name:"bannerFile",accept:".jpg,.jpeg,.png",onChange:k,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                            bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                            focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all
                            file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold 
                            file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100`})]}),c.bannerPreview&&t("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(St,{className:"w-5 h-5 text-blue-600"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Banner încărcat"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Imagine Banner"})]})]}),e("button",{type:"button",onClick:P,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge banner",children:e(ve,{className:"w-4 h-4"})})]}),e("div",{className:"relative w-full h-40 bg-slate-100 dark:bg-slate-800 rounded-lg overflow-hidden",children:e("img",{src:c.bannerPreview,alt:"Banner Preview",className:"w-full h-full object-contain"})})]})]})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("div",{className:"flex items-center justify-between mb-4",children:t("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center",children:[e(ht,{className:"w-5 h-5 mr-2 text-blue-500"}),"Documente Promoție"]})}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Document (PDF)"}),e("input",{type:"file",name:"documentsFile",accept:".pdf",onChange:E,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                            bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                            focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all
                            file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold 
                            file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100`})]}),c.documentsPreview&&t("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(ht,{className:"w-5 h-5 text-blue-600"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Document încărcat"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF Document"})]})]}),e("button",{type:"button",onClick:f,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge documentul",children:e(ve,{className:"w-4 h-4"})})]}),e(kt,{pdfUrl:c.documentsPreview,title:`Document Promoție ${c.name}`,placeholder:"Documentul nu este disponibil",placeholderSubtext:"Atașează documentul pentru vizualizare"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Status"}),t("select",{name:"status",value:c.status,onChange:x,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                          bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                          focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Completed",children:"Finalizat"}),e("option",{value:"Cancelled",children:"Anulat"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Note"}),e("input",{type:"text",name:"notes",value:c.notes,onChange:x,placeholder:"Note adiționale...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                          bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                          focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t-2 border-slate-200 dark:border-slate-600",children:[e("button",{type:"button",onClick:s,className:`px-6 py-3 rounded-xl border-2 border-slate-300 dark:border-slate-600 
                       text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 
                       transition-all font-medium`,children:"Anulează"}),e("button",{type:"submit",className:`px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl 
                       hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg font-medium`,children:a?"Salvează Modificările":"Creează Promoție"})]})]})]})})},Xi=({item:a,onClose:s})=>{var c;if(!a)return null;let r=[];a.prizes?r=typeof a.prizes=="string"?JSON.parse(a.prizes):a.prizes:a.prize_amount&&(r=[{amount:a.prize_amount,currency:a.prize_currency||"RON",date:a.prize_date,winner:a.winner}]),a.attachments&&(typeof a.attachments=="string"?JSON.parse(a.attachments):a.attachments);const l=u=>{if(!u)return null;const x=new Date,d=new Date(u)-x;return Math.ceil(d/(1e3*60*60*24))},n=u=>{if(!u)return null;const x=new Date,d=new Date(u)-x;return Math.ceil(d/(1e3*60*60*24))},o=l(a.end_date);a.start_date&&a.end_date&&Math.ceil((new Date(a.end_date)-new Date(a.start_date))/(1e3*60*60*24));const i=r.reduce((u,x)=>u+(parseFloat(x.amount)||0),0);return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-cyan-800 to-teal-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-600/20 to-teal-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-cyan-500 to-teal-500 rounded-2xl shadow-lg",children:e(st,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a.name||a.title}),e("p",{className:"text-cyan-100 text-sm font-medium",children:"Detalii Promoție & Premii"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),t("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:[t("div",{className:"space-y-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2",children:"Informații Promoție"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Nume Promoție"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.name||a.title||"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Status"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":a.status==="Completed"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"}`,children:a.status||"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Perioada Desfășurare"}),t("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.start_date?new Date(a.start_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"până la"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.end_date?new Date(a.end_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"}),o!==null&&e("p",{className:`text-sm mt-2 font-semibold ${o>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:o>0?`${o} zile rămase`:"Expirată"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Locație"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.location||"N/A"})})]})]}),a.description&&t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Descriere"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.description})})]})]}),r.length>0&&t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2 mb-6",children:["Premii (",r.length,")"]}),e("div",{className:"space-y-4",children:r.map((u,x)=>{const m=u.date,d=n(m),g=d!==null&&d<0,_=d===0,p=d!==null&&d>0&&d<=7;return e("div",{className:"p-6 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:["Premiu #",x+1]}),t("div",{className:"flex items-center space-x-2",children:[e(_t,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g?"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200":_?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":p?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}`,children:_?"ASTĂZI":p?`${d} zile`:g?"Expirat":"Activ"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Sumă"}),e("div",{className:"p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:t("p",{className:"text-xl font-bold text-slate-900 dark:text-white",children:[parseFloat(u.amount||0).toLocaleString("ro-RO")," ",u.currency||"RON"]})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Data Acordare"}),e("div",{className:"p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:m?new Date(m).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Câștigător"}),e("div",{className:"p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:u.winner?t("div",{className:"flex items-center space-x-2",children:[e(Gt,{className:"w-4 h-4 text-yellow-500"}),e("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:u.winner})]}):e("p",{className:"text-sm text-slate-500 dark:text-slate-400 italic",children:g?"Neacordat":"În așteptare"})})]})]})},x)})}),r.length>1&&e("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg border border-green-200 dark:border-green-800",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e(Lr,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),t("div",{children:[e("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"TOTAL FOND PREMII"}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Suma totală a tuturor premiilor"})]})]}),e("div",{className:"text-right",children:t("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[i.toLocaleString("ro-RO")," ",((c=r[0])==null?void 0:c.currency)||"RON"]})})]})})]}),(a.banner_url||a.documents_url||a.attachments)&&t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2 mb-6",children:"Atașamente"}),a.banner_url&&t("div",{className:"mb-6",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Banner Promoție"}),e("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600 p-4",children:e("div",{className:"relative w-full h-48 bg-white dark:bg-slate-600 rounded-lg overflow-hidden border border-slate-200 dark:border-slate-500",children:e("img",{src:a.banner_url,alt:`Banner pentru ${a.name||a.title}`,className:"w-full h-full object-contain"})})})]}),a.documents_url&&t("div",{className:"mb-6",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Document Promoție"}),e("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600 p-4",children:e(kt,{pdfUrl:a.documents_url,title:`Document Promoție ${a.name||a.title}`,placeholder:"Documentul nu este disponibil",placeholderSubtext:"Nu există document atașat pentru această promoție"})})]}),a.attachments&&Array.isArray(a.attachments)&&a.attachments.length>0&&t("div",{children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Fișiere Atașate"}),e("div",{className:"space-y-3",children:a.attachments.map((u,x)=>t("div",{className:"flex items-center space-x-3 p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:[e(ht,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),t("div",{className:"flex-1",children:[e("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:u.name||`Fișier ${x+1}`}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:u.size?`${(u.size/1024/1024).toFixed(2)} MB`:"Fișier"})]}),e("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors",children:"Vezi"})]},x))})]})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2 mb-6",children:"Informații Suplimentare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Creat de"}),e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Data creării"}),e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})})]}),a.notes&&t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Notițe"}),e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})})]})]})]})]}),e("div",{className:"bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"btn-secondary",children:"Închide"})})]})})},Zi=()=>{const[a,s]=h.useState([]),[r,l]=h.useState(!0);h.useEffect(()=>{n()},[]);const n=async()=>{try{const c=await ae.get("/api/promotions/active");s(c.data)}catch(c){console.error("Error fetching active promotions:",c)}finally{l(!1)}},o=c=>{if(!c)return null;const u=new Date,m=new Date(c)-u;return Math.ceil(m/(1e3*60*60*24))},i=a.reduce((c,u)=>c+(parseFloat(u.prize_amount)||0),0);return r?e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/3"}),e("div",{className:"h-20 bg-slate-200 dark:bg-slate-700 rounded"})]})}):t("div",{className:"card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-800",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-xl shadow-lg",children:e(st,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Promoții Active"}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[a.length," campanii în desfășurare"]})]})]}),t("div",{className:"text-right",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Fond Total"}),t("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[i.toLocaleString("ro-RO")," RON"]})]})]}),a.length===0?t("div",{className:"text-center py-8",children:[e(st,{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e("p",{className:"text-slate-500 dark:text-slate-400",children:"Nu există promoții active"})]}):e("div",{className:"space-y-3",children:a.slice(0,5).map(c=>{const u=o(c.end_date),x=u<=7;return e("div",{className:`p-4 rounded-xl border transition-all hover:shadow-lg cursor-pointer ${x?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600"}`,children:t("div",{className:"flex items-start justify-between",children:[t("div",{className:"flex-1 space-y-2",children:[t("div",{className:"flex items-center space-x-2",children:[e("h4",{className:"font-semibold text-slate-900 dark:text-white",children:c.name}),x&&e(Ut,{className:"w-4 h-4 text-yellow-600"})]}),t("div",{className:"flex items-center space-x-4 text-sm",children:[t("div",{className:"flex items-center space-x-1 text-slate-600 dark:text-slate-400",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:c.location})]}),t("div",{className:"flex items-center space-x-1 text-slate-600 dark:text-slate-400",children:[e(Me,{className:"w-4 h-4"}),e("span",{children:new Date(c.end_date).toLocaleDateString("ro-RO")})]})]}),c.prize_amount&&t("div",{className:"flex items-center space-x-2",children:[e(_t,{className:"w-4 h-4 text-green-500"}),t("span",{className:"font-bold text-green-600 dark:text-green-400",children:[parseFloat(c.prize_amount).toLocaleString("ro-RO")," ",c.prize_currency||"RON"]})]})]}),t("div",{className:"text-right",children:[e("div",{className:`text-2xl font-bold ${x?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:u}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:u===1?"zi rămasă":"zile rămase"})]})]})},c.id)})}),a.length>5&&t("button",{className:"mt-4 w-full py-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-semibold flex items-center justify-center space-x-1",children:[t("span",{children:["Vezi toate (",a.length,")"]}),e(Ha,{className:"w-4 h-4"})]})]})},Qi=()=>{const[a,s]=h.useState([]),[r,l]=h.useState(new Date),[n,o]=h.useState(!0);h.useEffect(()=>{i()},[]);const i=async()=>{try{const _=await ae.get("/api/promotions");s(_.data)}catch(_){console.error("Error fetching promotions:",_)}finally{o(!1)}},c=_=>{const p=_.getFullYear(),N=_.getMonth();return new Date(p,N+1,0).getDate()},u=_=>{const p=_.getFullYear(),N=_.getMonth();return new Date(p,N,1).getDay()},x=_=>a.filter(p=>{const N=new Date(p.start_date),k=new Date(p.end_date),E=new Date(_);return N.setHours(0,0,0,0),k.setHours(0,0,0,0),E.setHours(0,0,0,0),E>=N&&E<=k}),m=()=>{l(new Date(r.getFullYear(),r.getMonth()-1))},d=()=>{l(new Date(r.getFullYear(),r.getMonth()+1))},g=()=>{const _=c(r),p=u(r),N=[];r.toLocaleDateString("ro-RO",{month:"long",year:"numeric"});for(let k=0;k<p;k++)N.push(e("div",{className:"aspect-square"},`empty-${k}`));for(let k=1;k<=_;k++){const E=new Date(r.getFullYear(),r.getMonth(),k),P=x(E),f=E.toDateString()===new Date().toDateString(),R=P.length>0;N.push(t("div",{className:`aspect-square p-2 border border-slate-200 dark:border-slate-700 rounded-lg transition-all ${f?"bg-blue-100 dark:bg-blue-900/30 border-blue-400 dark:border-blue-600":R?"bg-pink-50 dark:bg-pink-900/20 border-pink-300 dark:border-pink-700 hover:bg-pink-100 dark:hover:bg-pink-900/30 cursor-pointer":"hover:bg-slate-50 dark:hover:bg-slate-750"}`,title:P.length>0?P.map(A=>A.name).join(", "):"",children:[e("div",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-1",children:k}),R&&t("div",{className:"space-y-1",children:[P.slice(0,2).map((A,D)=>e("div",{className:"text-[10px] bg-pink-500 text-white px-1 py-0.5 rounded truncate",title:A.name,children:A.name.substring(0,15)},D)),P.length>2&&t("div",{className:"text-[9px] text-pink-600 dark:text-pink-400 font-semibold",children:["+",P.length-2," mai multe"]})]})]},k))}return N};return n?e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/3"}),e("div",{className:"h-64 bg-slate-200 dark:bg-slate-700 rounded"})]})}):t("div",{className:"card p-6",children:[e("div",{className:"flex items-center justify-between mb-6",children:t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl shadow-lg",children:e(Me,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Calendar Promoții"})]})}),t("div",{className:"flex items-center justify-between mb-4",children:[e("button",{onClick:m,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(Ps,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("h4",{className:"text-lg font-semibold text-slate-900 dark:text-white capitalize",children:r.toLocaleDateString("ro-RO",{month:"long",year:"numeric"})}),e("button",{onClick:d,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(Ha,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})})]}),e("div",{className:"grid grid-cols-7 gap-1 mb-4",children:["Du","Lu","Ma","Mi","Jo","Vi","Sâ"].map(_=>e("div",{className:"text-center text-xs font-semibold text-slate-600 dark:text-slate-400 p-2",children:_},_))}),e("div",{className:"grid grid-cols-7 gap-1",children:g()}),t("div",{className:"mt-4 flex items-center justify-center space-x-4 text-xs",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-3 h-3 bg-blue-100 dark:bg-blue-900/30 border border-blue-400 dark:border-blue-600 rounded"}),e("span",{className:"text-slate-600 dark:text-slate-400",children:"Astăzi"})]}),t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-3 h-3 bg-pink-50 dark:bg-pink-900/20 border border-pink-300 dark:border-pink-700 rounded"}),e("span",{className:"text-slate-600 dark:text-slate-400",children:"Cu promoții"})]})]})]})},eo=()=>{const{promotions:a,loading:s,createItem:r,updateItem:l,deleteItem:n,createTestWeeklyTombola:o}=ye(),i=Ye(),[c,u]=h.useState(""),[x,m]=h.useState([]),[d,g]=h.useState(!1),[_,p]=h.useState(!1),[N,k]=h.useState(null),[E,P]=h.useState(!1),[f,R]=h.useState(null);$t.useEffect(()=>{g(x.length>0)},[x]);const A=a.filter(b=>{var L,Y,O;return((L=b.title)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))||((Y=b.name)==null?void 0:Y.toLowerCase().includes(c.toLowerCase()))||((O=b.description)==null?void 0:O.toLowerCase().includes(c.toLowerCase()))}),D=b=>{m(b?A.map(y=>y.id):[])},U=(b,y)=>{m(y?[...x,b]:x.filter(L=>L!==b))},j=()=>{k(null),p(!0)},v=b=>{k(b),p(!0)},z=async b=>{const y=b.title||b.name||"această promoție";window.confirm(`Sigur vrei să ștergi ${y}?`)&&await n("promotions",b.id)},S=async b=>{N?await l("promotions",N.id,b):await r("promotions",b),p(!1),k(null)},F=b=>{const y=new Date;y.setHours(0,0,0,0);const L=b.start_date?new Date(b.start_date):null,Y=b.end_date?new Date(b.end_date):null;if(L&&L.setHours(0,0,0,0),Y&&Y.setHours(0,0,0,0),L&&L>y){const O=Math.ceil((L-y)/864e5);return{text:`Începe în ${O} ${O===1?"zi":"zile"}`,color:"text-blue-600",icon:Me}}if(Y&&Y<y){const O=Math.ceil((y-Y)/864e5);return{text:`Expirat de ${O} ${O===1?"zi":"zile"}`,color:"text-red-600",icon:dt}}if(Y&&Y>=y){const O=Math.ceil((Y-y)/864e5);return{text:`${O} ${O===1?"zi":"zile"} rămase`,color:"text-green-600",icon:dt}}return{text:"-",color:"text-gray-400",icon:dt}},I=[{key:"title",label:"TITLU PROMOȚIE",sortable:!0,render:b=>e("button",{onClick:()=>{R(b),P(!0)},className:"text-blue-600 hover:text-blue-800 font-semibold hover:underline transition-colors",children:b.title||b.name||"Fără titlu"})},{key:"description",label:"DESCRIERE",sortable:!1,render:b=>e("div",{className:"text-sm text-slate-600 dark:text-slate-400 max-w-xs",children:b.description?b.description.length>60?`${b.description.substring(0,60)}...`:b.description:"Fără descriere"})},{key:"dates_period",label:"PERIOADA",sortable:!0,render:b=>t("div",{className:"space-y-1",children:[t("div",{className:"flex items-center text-sm text-slate-700 dark:text-slate-300",children:[e(Me,{className:"w-3.5 h-3.5 mr-1 text-green-600"}),b.start_date?new Date(b.start_date).toLocaleDateString("ro-RO"):"N/A"]}),t("div",{className:"flex items-center text-sm text-slate-700 dark:text-slate-300",children:[e(Me,{className:"w-3.5 h-3.5 mr-1 text-red-600"}),b.end_date?new Date(b.end_date).toLocaleDateString("ro-RO"):"N/A"]})]})},{key:"days_info",label:"ZILE",sortable:!1,render:b=>{const y=F(b),L=y.icon;return t("div",{className:`flex items-center space-x-1 font-medium text-sm ${y.color}`,children:[e(L,{className:"w-4 h-4"}),e("span",{children:y.text})]})}},{key:"status",label:"STATUS",sortable:!0,render:b=>{const y=new Date,L=b.end_date?new Date(b.end_date):null,Y=b.start_date?new Date(b.start_date):null,O=L&&L>=y&&(!Y||Y<=y),G=Y&&Y>y,C=L&&L<y;let W="Inactiv",T="bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300";return O?(W="Activ",T="bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"):G?(W="În așteptare",T="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"):C&&(W="Expirat",T="bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"),e("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${T}`,children:W})}},{key:"rules_document",label:"REGULAMENT",sortable:!1,render:b=>{if(!b.rules_document&&!b.documents_url)return e("div",{className:"text-slate-400 text-sm",children:"-"});const y=b.rules_document||b.documents_url;return e("div",{className:"flex justify-center",children:e("button",{onClick:()=>window.open(y,"_blank"),className:"p-2 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg transition-colors",title:"Vizualizează regulamentul",children:e(Qe,{className:"w-5 h-5"})})})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:b=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:b.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:b.created_at?new Date(b.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(st,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Marketing"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare promoții și campanii"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>i("/marketing-ai"),className:"btn-secondary flex items-center space-x-2",children:[e(Wa,{className:"w-4 h-4"}),e("span",{children:"Analiză AI"})]}),t("button",{onClick:j,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Promoție"})]})]})]})}),e("div",{className:"card p-6",children:e("div",{className:"flex items-center space-x-4",children:t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută în promoții...",value:c,onChange:b=>u(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e(Zi,{}),e(Qi,{})]}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):A.length===0?t("div",{className:"text-center py-12",children:[e(st,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există promoții"}),e("p",{className:"text-slate-500",children:"Adaugă prima promoție pentru a începe"})]}):e(He,{data:A,columns:I,onEdit:v,onDelete:z,searchTerm:c,selectedItems:x,onSelectAll:D,onSelectItem:U,moduleColor:"blue"})}),_&&e(Ki,{item:N,onClose:()=>{p(!1),k(null)},onSave:S}),E&&e(Xi,{item:f,onClose:()=>{P(!1),R(null)}})]})})},to=()=>{const[a,s]=h.useState([]),[r,l]=h.useState([]),[n,o]=h.useState(!0);h.useEffect(()=>{i()},[]);const i=async()=>{try{const x=(await ae.get("/api/promotions/active")).data;s(x);const m=c(x);l(m)}catch(u){console.error("Error fetching promotions:",u)}finally{o(!1)}},c=u=>{const x=[],m=new Map;u.forEach(p=>{const N=new Date(p.start_date),k=new Date(p.end_date);for(let E=new Date(N);E<=k;E.setDate(E.getDate()+1)){const P=E.toISOString().split("T")[0];m.has(P)||m.set(P,[]),m.get(P).push(p)}}),m.forEach((p,N)=>{if(p.length>=2){const k={};p.forEach(E=>{k[E.location]||(k[E.location]=[]),k[E.location].push(E)}),Object.entries(k).forEach(([E,P])=>{P.length>=2&&x.push({type:"critical",icon:Ut,title:"🔴 CONFLICT CRITIC",message:`${P.length} promoții în aceeași zi (${new Date(N).toLocaleDateString("ro-RO")}) la ${E}`,details:P.map(f=>f.name).join(", "),severity:"high"})})}});const d=Array.from(m.keys()).sort();for(let p=0;p<d.length-1;p++){const N=new Date(d[p]),k=new Date(d[p+1]);Math.ceil((k-N)/(1e3*60*60*24))===1&&(m.get(d[p]),m.get(d[p+1]),x.push({type:"warning",icon:Ut,title:"🟡 ZILE CONSECUTIVE",message:`Promoții la 1 zi distanță (${N.toLocaleDateString("ro-RO")} - ${k.toLocaleDateString("ro-RO")})`,details:"Poate obosi audiența",severity:"medium"}))}const g=u.reduce((p,N)=>p+(parseFloat(N.prize_amount)||0),0),_=g/u.length;if(u.length>0){const p={};u.forEach(k=>{p[k.location]=(p[k.location]||0)+1});const N=Object.entries(p).sort((k,E)=>E[1]-k[1])[0];N&&N[1]>=3&&x.push({type:"info",icon:st,title:"📊 ANALIZĂ DISTRIBUȚIE",message:`${N[0]} are cele mai multe promoții (${N[1]})`,details:"Consideră diversificarea pe alte locații",severity:"low"})}if(u.length>0&&g>0&&x.push({type:"success",icon:bt,title:"💰 ANALIZĂ BUGETE",message:`Fond total: ${g.toLocaleString("ro-RO")} RON`,details:`Premiu mediu: ${_.toLocaleString("ro-RO")} RON`,severity:"low"}),u.length>=2){const p=u.flatMap(k=>{const E=new Date(k.start_date),P=new Date(k.end_date);return[E,P]}).sort((k,E)=>k-E),N=Math.max(...p.slice(1).map((k,E)=>Math.ceil((k-p[E])/(1e3*60*60*24))));N>14&&x.push({type:"info",icon:Me,title:"📅 GAP TEMPORAL",message:`Interval de ${N} zile între promoții`,details:"Consideră adăugarea unei promoții intermediare",severity:"low"})}return x.sort((p,N)=>{const k={high:0,medium:1,low:2};return k[p.severity]-k[N.severity]})};return n?e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/2"}),e("div",{className:"h-32 bg-slate-200 dark:bg-slate-700 rounded"})]})}):t("div",{className:"card p-6 bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 border border-purple-200 dark:border-purple-800",children:[t("div",{className:"flex items-center space-x-3 mb-6",children:[e("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-indigo-500 rounded-xl shadow-lg",children:e(Wa,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Analiză AI Marketing"}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[r.length," insight-uri detectate"]})]})]}),r.length===0?t("div",{className:"text-center py-8",children:[e(bt,{className:"w-16 h-16 text-green-500 mx-auto mb-3"}),e("p",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"✅ Totul arată perfect!"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-500 mt-2",children:"Nu sunt detectate conflicte sau probleme"})]}):e("div",{className:"space-y-3",children:r.map((u,x)=>{const m=u.icon;return e("div",{className:`p-4 rounded-xl border ${{critical:"bg-red-50 dark:bg-red-900/20 border-red-300 dark:border-red-700 text-red-700 dark:text-red-400",warning:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700 text-yellow-700 dark:text-yellow-400",info:"bg-blue-50 dark:bg-blue-900/20 border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400",success:"bg-green-50 dark:bg-green-900/20 border-green-300 dark:border-green-700 text-green-700 dark:text-green-400"}[u.type]} transition-all hover:shadow-lg`,children:t("div",{className:"flex items-start space-x-3",children:[e(m,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),t("div",{className:"flex-1",children:[e("h4",{className:"font-semibold text-sm mb-1",children:u.title}),e("p",{className:"text-sm opacity-90 mb-1",children:u.message}),u.details&&e("p",{className:"text-xs opacity-75 italic",children:u.details})]})]})},x)})}),t("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[t("div",{className:"bg-white dark:bg-slate-700 p-4 rounded-xl border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(ra,{className:"w-4 h-4 text-purple-500"}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Promoții Active"})]}),e("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:a.length})]}),t("div",{className:"bg-white dark:bg-slate-700 p-4 rounded-xl border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(Ut,{className:"w-4 h-4 text-red-500"}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Alerte Critice"})]}),e("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:r.filter(u=>u.severity==="high").length})]})]})]})},ao=()=>{const a=Ye();return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:e("div",{className:"flex items-center justify-between",children:t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>a("/marketing"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Înapoi la Marketing",children:e(tt,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(Wa,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Analiză AI Marketing"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Insights și recomandări inteligente pentru campaniile tale"})]})]})})}),e("div",{className:"w-full",children:e(to,{})})]})})},ro=()=>{var j;const{id:a}=It(),s=Ye(),{promotions:r,locations:l,loading:n}=ye(),[o,i]=h.useState(!1),[c,u]=h.useState(!0),[x,m]=h.useState(!1),[d,g]=h.useState(null);h.useEffect(()=>{const v=r==null?void 0:r.find(z=>z.id===parseInt(a));v&&g(v)},[a,r]),h.useEffect(()=>{u(JSON.parse(!1))},[]);const _=v=>{u(v)};if(n)return e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă detaliile promoției..."})]})})});if(!d)return e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e(_t,{className:"w-16 h-16 text-slate-400 dark:text-slate-500 mx-auto mb-4"}),e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Promoția nu a fost găsită"}),e("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Promoția pe care o căutați nu există în sistem."}),t("button",{onClick:()=>s("/marketing"),className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Marketing"})]})]})})});let p=[];d.prizes?p=typeof d.prizes=="string"?JSON.parse(d.prizes):d.prizes:d.prize_amount&&(p=[{amount:d.prize_amount,currency:d.prize_currency||"RON",date:d.prize_date,winner:d.winner}]);let N=[];d.locations?N=typeof d.locations=="string"?JSON.parse(d.locations):d.locations:d.location&&(N=[{location:d.location,start_date:d.start_date,end_date:d.end_date}]);const k=v=>{if(!v)return null;const z=new Date,F=new Date(v)-z;return Math.ceil(F/(1e3*60*60*24))},E=v=>{if(!v)return null;const z=new Date,F=new Date(v)-z;return Math.ceil(F/(1e3*60*60*24))},P=k(d.end_date),f=d.start_date&&d.end_date?Math.ceil((new Date(d.end_date)-new Date(d.start_date))/(1e3*60*60*24)):0,R=p.reduce((v,z)=>v+(parseFloat(z.amount)||0),0),A=v=>{const z=l.find(S=>S.id===v||S.name===v);return z?z.name:v},D=async(v,z)=>{if(v){m(!0);try{const S=new FormData;S.append("file",v),S.append("type",z),S.append("promotion_id",d.id);const F=await ae.post("/api/upload/promotion",S,{headers:{"Content-Type":"multipart/form-data"}});if(F.data.success){$.success(`${z==="banner"?"Banner":"Regulament"} încărcat cu succes!`);const I={...d};z==="banner"?I.banner_path=F.data.file_path:I.regulation_path=F.data.file_path,g(I)}else $.error("Eroare la încărcarea fișierului")}catch(S){console.error("Upload error:",S),$.error("Eroare la încărcarea fișierului")}finally{m(!1)}}},U=async()=>{if(window.confirm("Sigur vrei să ștergi această promoție?"))try{await ae.delete(`/api/promotions/${d.id}`),$.success("Promoție ștearsă cu succes!"),s("/marketing")}catch(v){console.error("Delete error:",v),$.error("Eroare la ștergerea promoției")}};return e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 mb-6",children:e("div",{className:"bg-gradient-to-r from-pink-600 via-rose-600 to-red-600 px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("button",{onClick:()=>s("/marketing"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-white"})}),e("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl",children:e(_t,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h1",{className:"text-2xl font-bold text-white",children:d.name}),e("p",{className:"text-pink-100",children:"Promoție & Premii"})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>i(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Setări",children:e(Lt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>s(`/marketing/${d.id}/edit`),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Editează",children:e(at,{className:"w-5 h-5 text-white"})}),e("button",{onClick:U,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Șterge",children:e(je,{className:"w-5 h-5 text-white"})})]})]})})}),o&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:[e("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Afișare"})}),e("div",{className:"p-6 space-y-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"font-medium text-slate-800 dark:text-slate-200",children:"Afișare automată atașamente"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Afișează automat PDF-urile în pagina de detalii"})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:c,onChange:v=>_(v.target.checked),className:"sr-only peer"}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})}),e("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e("button",{onClick:()=>i(!1),className:"btn-primary",children:"Închide"})})]})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"lg:col-span-2 space-y-6",children:[P!==null&&e("div",{className:`p-6 rounded-xl border-2 ${P>7?"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-300 dark:border-green-700":P>0?"bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-yellow-300 dark:border-yellow-700":"bg-gradient-to-br from-gray-50 to-slate-50 dark:from-gray-900/20 dark:to-slate-900/20 border-gray-300 dark:border-gray-700"}`,children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e(dt,{className:`w-12 h-12 ${P>7?"text-green-500":P>0?"text-yellow-500":"text-gray-500"}`}),t("div",{children:[e("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400",children:"ZILE RĂMASE"}),e("p",{className:`text-4xl font-bold ${P>7?"text-green-600 dark:text-green-400":P>0?"text-yellow-600 dark:text-yellow-400":"text-gray-600 dark:text-gray-400"}`,children:P>0?P:"EXPIRAT"})]})]}),t("div",{className:"text-right",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Durată totală"}),t("p",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:[f," zile"]})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Perioada Desfășurare"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:new Date(d.start_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"})}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400 my-2",children:"până la"}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:new Date(d.end_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"})})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Fe,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),t("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:["Locații (",N.length,")"]})]}),e("div",{className:"space-y-2",children:N.map((v,z)=>t("div",{className:"flex items-center justify-between p-2 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[e("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:A(v.location)}),v.start_date&&v.end_date&&t("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[new Date(v.start_date).toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit"})," - ",new Date(v.end_date).toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit"})]})]},z))})]})]}),p.length>0&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center",children:[e(Lr,{className:"w-6 h-6 mr-3 text-pink-600 dark:text-pink-400"}),"Premii (",p.length,")"]}),p.length>1&&t("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 px-6 py-3 rounded-xl text-white shadow-lg",children:[e("p",{className:"text-sm font-semibold",children:"TOTAL FOND PREMII"}),t("p",{className:"text-2xl font-bold",children:[R.toLocaleString("ro-RO")," ",((j=p[0])==null?void 0:j.currency)||"RON"]})]})]}),e("div",{className:"grid grid-cols-1 gap-4",children:p.map((v,z)=>{const S=v.date,F=E(S),I=F!==null&&F<0,b=F===0,y=F!==null&&F>0&&F<=7;return e("div",{className:`p-4 rounded-xl border-2 ${I?"bg-gradient-to-br from-gray-50 to-slate-100 dark:from-gray-900/20 dark:to-slate-800/20 border-gray-300 dark:border-gray-700":b?"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border-red-400 dark:border-red-700 shadow-xl":y?"bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 border-yellow-400 dark:border-yellow-700":"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-300 dark:border-green-700"}`,children:e("div",{className:"flex items-start justify-between",children:t("div",{className:"flex items-start space-x-4 flex-1",children:[e("div",{className:`p-3 rounded-xl ${I?"bg-gray-200 dark:bg-gray-700":b?"bg-red-200 dark:bg-red-800":y?"bg-yellow-200 dark:bg-yellow-800":"bg-green-200 dark:bg-green-800"}`,children:e(_t,{className:`w-6 h-6 ${I?"text-gray-600 dark:text-gray-300":b?"text-red-600 dark:text-red-300":y?"text-yellow-600 dark:text-yellow-300":"text-green-600 dark:text-green-300"}`})}),t("div",{className:"flex-1",children:[t("div",{className:"flex items-center space-x-3 mb-2",children:[t("h4",{className:"text-lg font-bold text-slate-800 dark:text-white",children:["Premiu #",z+1]}),b&&e("span",{className:"px-3 py-1 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse",children:"ASTĂZI!"}),y&&!b&&t("span",{className:"px-3 py-1 bg-yellow-500 text-white text-xs font-bold rounded-full",children:[F," ZILE"]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-3",children:[t("div",{children:[e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"SUMĂ PREMIU"}),t("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[parseFloat(v.amount||0).toLocaleString("ro-RO")," ",v.currency||"RON"]})]}),t("div",{children:[e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"DATA ACORDARE"}),e("p",{className:"text-base font-semibold text-slate-900 dark:text-white",children:S?new Date(S).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"}),F!==null&&F>0&&!b&&t("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["(peste ",F," ",F===1?"zi":"zile",")"]})]}),t("div",{children:[e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"CÂȘTIGĂTOR"}),v.winner?t("div",{className:"flex items-center space-x-2",children:[e(Gt,{className:"w-5 h-5 text-yellow-500"}),e("p",{className:"text-base font-semibold text-slate-900 dark:text-white",children:v.winner})]}):e("p",{className:"text-base text-slate-500 dark:text-slate-400 italic",children:I?"Neacordat":"În așteptare"})]})]})]})]})})},z)})})]}),d.description&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Descriere Promoție"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:d.description})]}),d.notes&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe Suplimentare"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:d.notes})]})]}),t("div",{className:"space-y-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 flex items-center",children:[e(St,{className:"w-5 h-5 mr-2 text-pink-600 dark:text-pink-400"}),"Banner Promoție"]}),t("label",{className:"btn-secondary cursor-pointer",children:[e(ze,{className:"w-4 h-4 mr-2"}),d.banner_path?"Schimbă":"Încarcă",e("input",{type:"file",accept:"image/*",onChange:v=>D(v.target.files[0],"banner"),className:"hidden",disabled:x})]})]}),d.banner_path?t("div",{className:"space-y-3",children:[e("img",{src:`/uploads/promotions/${d.banner_path}`,alt:"Banner promoție",className:"w-full h-32 object-cover rounded-lg border border-slate-200 dark:border-slate-600"}),t("div",{className:"flex items-center justify-between text-sm text-slate-600 dark:text-slate-400",children:[e("span",{children:"Banner activ"}),t("button",{onClick:()=>window.open(`/uploads/promotions/${d.banner_path}`,"_blank"),className:"flex items-center space-x-1 hover:text-pink-600 dark:hover:text-pink-400",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Deschide"})]})]})]}):t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(Ls,{className:"w-12 h-12 mx-auto mb-2"}),e("p",{children:"Nu există banner"})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-pink-600 dark:text-pink-400"}),"Regulament"]}),t("label",{className:"btn-secondary cursor-pointer",children:[e(ze,{className:"w-4 h-4 mr-2"}),d.regulation_path?"Schimbă":"Încarcă",e("input",{type:"file",accept:".pdf,.doc,.docx",onChange:v=>D(v.target.files[0],"regulation"),className:"hidden",disabled:x})]})]}),d.regulation_path?t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center space-x-2 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[e(ge,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),e("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:d.regulation_path})]}),t("div",{className:"flex items-center justify-between text-sm text-slate-600 dark:text-slate-400",children:[e("span",{children:"Regulament activ"}),t("button",{onClick:()=>window.open(`/uploads/promotions/${d.regulation_path}`,"_blank"),className:"flex items-center space-x-1 hover:text-pink-600 dark:hover:text-pink-400",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Deschide"})]})]}),c&&e("div",{className:"mt-4",children:e(kt,{filePath:`/uploads/promotions/${d.regulation_path}`,title:"Regulament Promoție"})})]}):t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(ge,{className:"w-12 h-12 mx-auto mb-2"}),e("p",{children:"Nu există regulament"})]})]}),(d.created_by||d.created_at)&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"space-y-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),t("p",{className:"text-base font-medium text-slate-900 dark:text-white flex items-center",children:[e(yt,{className:"w-4 h-4 mr-2"}),d.created_by||"N/A"]})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),t("p",{className:"text-base font-medium text-slate-900 dark:text-white flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2"}),d.created_at?new Date(d.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"]})]})]})]})]})]})]})})})},wt=a=>{if(!a)return"N/A";if(!a.includes(" - "))return a;const s=a.split(" - ");return s.length>1?s[1]:a},so=(a,s=[])=>{if(!a)return"N/A";const r=s.find(l=>l.id===a||l.name===a);return wt(r?r.name:a)},lo=()=>{const{gameId:a}=It(),s=Ye(),{slots:r,gameMixes:l,providers:n,companies:o,locations:i,cabinets:c}=ye(),[u,x]=h.useState(null),[m,d]=h.useState(!0),[g,_]=h.useState(null),[p,N]=h.useState([]);h.useEffect(()=>{R(),k()},[a,r,l]);const k=()=>{if(!u||!r||!l)return;const j=[];r.forEach(v=>{if(v.game_mix){const z=l.find(S=>S.name===v.game_mix||S.id===v.game_mix);if(z&&z.games){let S=[];try{S=typeof z.games=="string"?JSON.parse(z.games):z.games}catch{S=[z.games]}S.includes(u.name)&&j.push({...v,gameMixName:z.name,providerName:E(v.provider),locationName:P(v.location),cabinetName:f(v.cabinet)})}}}),N(j)},E=j=>{const v=n==null?void 0:n.find(z=>z.id===j||z.name===j);return v?v.name:j},P=j=>{const v=i==null?void 0:i.find(z=>z.id===j||z.name===j);return v?v.name:j},f=j=>{const v=c==null?void 0:c.find(z=>z.id===j||z.name===j);return v?v.name||v.model:j},R=async()=>{d(!0);try{const j=await fetch(`/api/games/${a}`);if(!j.ok)throw new Error("Game not found");const v=await j.json();x(v),A(v)}catch(j){console.error("Error loading game details:",j)}finally{d(!1)}},A=j=>{const v=r.filter(I=>{if(!I.game_mix)return!1;const b=l.find(L=>L.name===I.game_mix||L.id===I.game_mix);if(!b||!b.games)return!1;let y=[];try{y=typeof b.games=="string"?JSON.parse(b.games):b.games}catch{y=[b.games]}return y.includes(j.name)}),z={};v.forEach(I=>{const b=I.location||"Unknown";z[b]||(z[b]={count:0,cabinets:new Set,gameMixes:new Set,slots:[]}),z[b].count++,z[b].cabinets.add(I.cabinet||"Unknown"),z[b].gameMixes.add(I.game_mix||"None"),z[b].slots.push(I)});const S={};v.forEach(I=>{const b=I.cabinet||"Unknown";S[b]||(S[b]={count:0,locations:new Set,gameMixes:new Set,slots:[]}),S[b].count++,S[b].locations.add(I.location||"Unknown"),S[b].gameMixes.add(I.game_mix||"None"),S[b].slots.push(I)});const F={};v.forEach(I=>{const b=I.game_mix||"None";F[b]||(F[b]={count:0,locations:new Set,cabinets:new Set,slots:[]}),F[b].count++,F[b].locations.add(I.location||"Unknown"),F[b].cabinets.add(I.cabinet||"Unknown"),F[b].slots.push(I)}),_({totalSlots:v.length,uniqueLocations:Object.keys(z).length,uniqueCabinets:Object.keys(S).length,uniqueGameMixes:Object.keys(F).length,locationStats:z,cabinetStats:S,gameMixStats:F,allSlots:v})},D=j=>{switch(j){case"low":return"bg-green-100 text-green-800";case"low - medium":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},U=j=>{switch(j){case"low":return e(dt,{className:"w-4 h-4"});case"low - medium":return e(ra,{className:"w-4 h-4"});case"medium":return e(Pr,{className:"w-4 h-4"});case"high":return e(ra,{className:"w-4 h-4"});default:return e(dt,{className:"w-4 h-4"})}};return m?e(he,{children:e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})})}):u?e(he,{children:t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[e("div",{className:"flex items-center justify-between mb-6",children:t("button",{onClick:()=>s("/game-mixes/games-library"),className:"flex items-center space-x-2 text-slate-600 hover:text-purple-600 transition-colors",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Biblioteca Jocuri"})]})}),t("div",{className:"flex items-start space-x-6",children:[e("div",{className:"flex-shrink-0",children:t("div",{className:"w-40 h-40 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-2xl overflow-hidden shadow-lg flex items-center justify-center",children:[e("img",{src:u.image_url,alt:u.name,className:"max-w-full max-h-full object-contain",style:{imageRendering:"crisp-edges"},onError:j=>{j.target.style.display="none",j.target.nextSibling.style.display="flex"}}),e("div",{className:"w-full h-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",style:{display:"none"},children:e(ct,{className:"w-16 h-16 text-purple-400"})})]})}),t("div",{className:"flex-1",children:[e("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:u.name}),e("p",{className:"text-slate-600 mb-4",children:u.theme}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Furnizor"}),e("div",{className:"font-semibold text-slate-800",children:u.provider})]}),t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Linii"}),e("div",{className:"font-semibold text-slate-800",children:u.lines||"N/A"})]}),t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Layout"}),e("div",{className:"font-semibold text-slate-800",children:u.layout||"N/A"})]}),t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Tip"}),e("div",{className:"font-semibold text-slate-800",children:u.classification})]})]}),u.volatility&&u.volatility!=="n/a"&&t("div",{className:`inline-flex items-center space-x-2 px-4 py-2 rounded-full ${D(u.volatility)}`,children:[U(u.volatility),e("span",{className:"font-medium",children:u.volatility})]})]})]})]}),g&&t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl inline-block mb-4",children:e(it,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:g.totalSlots}),e("p",{className:"text-slate-600",children:"Sloturi totale"})]}),t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl inline-block mb-4",children:e(Fe,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:g.uniqueLocations}),e("p",{className:"text-slate-600",children:"Locații"})]}),t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl inline-block mb-4",children:e(_e,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:g.uniqueCabinets}),e("p",{className:"text-slate-600",children:"Cabinete"})]}),t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl inline-block mb-4",children:e(xt,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:g.uniqueGameMixes}),e("p",{className:"text-slate-600",children:"Game Mixes"})]})]}),g&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[Object.keys(g.locationStats).length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(Fe,{className:"w-5 h-5 text-green-500"}),e("span",{children:"Locații"})]}),e("div",{className:"space-y-3",children:Object.entries(g.locationStats).map(([j,v])=>t("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-green-800 mb-2",children:j}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-green-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-green-800",children:v.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-green-600",children:"Cabinete:"}),e("span",{className:"font-semibold text-green-800",children:v.cabinets.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-green-600",children:"Game Mixes:"}),e("span",{className:"font-semibold text-green-800",children:v.gameMixes.size})]})]})]},j))})]}),Object.keys(g.cabinetStats).length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(_e,{className:"w-5 h-5 text-purple-500"}),e("span",{children:"Cabinete"})]}),e("div",{className:"space-y-3",children:Object.entries(g.cabinetStats).map(([j,v])=>t("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-purple-800 mb-2",children:j}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-purple-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-purple-800",children:v.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-purple-600",children:"Locații:"}),e("span",{className:"font-semibold text-purple-800",children:v.locations.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-purple-600",children:"Game Mixes:"}),e("span",{className:"font-semibold text-purple-800",children:v.gameMixes.size})]})]})]},j))})]}),Object.keys(g.gameMixStats).length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(xt,{className:"w-5 h-5 text-orange-500"}),e("span",{children:"Game Mixes"})]}),e("div",{className:"space-y-3",children:Object.entries(g.gameMixStats).map(([j,v])=>t("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-orange-800 mb-2",children:j}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-orange-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-orange-800",children:v.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-orange-600",children:"Locații:"}),e("span",{className:"font-semibold text-orange-800",children:v.locations.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-orange-600",children:"Cabinete:"}),e("span",{className:"font-semibold text-orange-800",children:v.cabinets.size})]})]})]},j))})]}),g&&g.allSlots.length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(_e,{className:"w-5 h-5 text-blue-500"}),e("span",{children:"Furnizori"})]}),e("div",{className:"space-y-3",children:(()=>{const j={};return g.allSlots.forEach(v=>{v.provider&&(j[v.provider]||(j[v.provider]={count:0,locations:new Set,cabinets:new Set}),j[v.provider].count++,v.location&&j[v.provider].locations.add(v.location),v.cabinet&&j[v.provider].cabinets.add(v.cabinet))}),Object.entries(j).map(([v,z])=>t("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-blue-800 mb-2",children:v}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-blue-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-blue-800",children:z.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-blue-600",children:"Locații:"}),e("span",{className:"font-semibold text-blue-800",children:z.locations.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-blue-600",children:"Cabinete:"}),e("span",{className:"font-semibold text-blue-800",children:z.cabinets.size})]})]})]},v))})()})]})]}),g&&g.allSlots.length>0&&t("div",{className:"card p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-6 flex items-center space-x-2",children:[e(Ht,{className:"w-5 h-5 text-blue-500"}),t("span",{children:["Toate sloturile cu acest joc (",g.allSlots.length,")"]})]}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{children:t("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Serial Number"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Locație"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Furnizor"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Cabinet"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Game Mix"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Status"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Denomination"})]})}),e("tbody",{children:g.allSlots.map(j=>t("tr",{className:"border-b border-slate-100 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700",children:[e("td",{className:"py-3 px-4",children:e("button",{onClick:()=>s(`/slots/${j.id}`),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-semibold hover:underline transition-colors",children:j.serial_number||"N/A"})}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.location||"N/A"}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.provider||"N/A"}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.cabinet||"N/A"}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:wt(j.game_mix_name||j.game_mix)}),e("td",{className:"py-3 px-4",children:e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:j.status||"N/A"})}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.denomination||"N/A"})]},j.id))})]})})]})]})}):e(he,{children:t("div",{className:"text-center py-12",children:[e(ct,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Jocul nu a fost găsit"}),e("button",{onClick:()=>s("/game-mixes/games-library"),className:"btn-primary",children:"Înapoi la Biblioteca Jocuri"})]})})},no=({item:a,onClose:s,onSave:r})=>{const{locations:l,cabinets:n,gameMixes:o,providers:i}=ye(),[c,u]=h.useState({serial_number:"",provider:"",location:"",game:"",cabinet:"",game_mix:"",denomination:.01,max_bet:"",rtp:"",gaming_places:1,manufacture_year:"",commission_date:"",invoice_number:"",status:"Active",notes:""});h.useEffect(()=>{a&&u({serial_number:a.serial_number||"",provider:a.provider||"",location:a.location||"",game:a.game||"",cabinet:a.cabinet||"",game_mix:a.game_mix||"",denomination:a.denomination||.01,max_bet:a.max_bet||"",rtp:a.rtp||"",gaming_places:a.gaming_places||1,manufacture_year:a.manufacture_year||"",commission_date:a.commission_date||"",invoice_number:a.invoice_number||"",status:a.status||"Active",notes:a.notes||""})},[a]);const x=d=>{const{name:g,value:_}=d.target;u(p=>{const N={...p,[g]:_};if(g==="provider")N.cabinet="",N.game_mix="";else if(g==="cabinet"){N.game_mix="";const k=n.find(E=>E.name===_);k&&k.provider&&k.provider!==N.provider&&(N.provider=k.provider)}return N})};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-emerald-800 to-green-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-600/20 to-green-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-emerald-500 to-green-500 rounded-2xl shadow-lg",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Slot":"Adaugă Slot Nou"}),e("p",{className:"text-emerald-100 text-sm font-medium",children:"Completează informațiile despre slot"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:d=>{d.preventDefault(),r(c)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numărul de serie *"}),e("input",{type:"text",name:"serial_number",value:c.serial_number,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Serial number unic",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Locație *"}),t("select",{name:"location",value:c.location,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează locația"}),l==null?void 0:l.map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:c.provider,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),i==null?void 0:i.map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet"}),t("select",{name:"cabinet",value:c.cabinet,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează cabinetul"}),n.filter(d=>!c.provider||d.provider===c.provider).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix"}),t("select",{name:"game_mix",value:c.game_mix,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează game mix-ul"}),o.filter(d=>!(c.provider&&d.provider!==c.provider)).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:c.status,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Inactive",children:"Inactiv"}),e("option",{value:"Maintenance",children:"Mentenanță"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Denomination"}),e("input",{type:"number",step:"0.01",name:"denomination",value:c.denomination,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Max Bet"}),e("input",{type:"number",step:"0.01",name:"max_bet",value:c.max_bet,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Max bet"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"RTP (%)"}),e("input",{type:"number",step:"0.01",name:"rtp",value:c.rtp,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"RTP"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Gaming Places"}),e("input",{type:"number",name:"gaming_places",value:c.gaming_places,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"1"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-slate-700",children:["An Fabricat ",e("span",{className:"text-slate-400 text-xs",children:"(opțional)"})]}),e("input",{type:"number",name:"manufacture_year",value:c.manufacture_year,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"ex: 2020",min:"1990",max:"2030"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-end",children:[t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip proprietate"}),e("input",{type:"text",value:"Se actualizează automat din Facturi",readOnly:!0,disabled:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-100 text-slate-500 cursor-not-allowed"})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-xs font-medium text-slate-600",children:"Data comisionării"}),e("input",{type:"text",value:c.commission_date||"Auto din Comisii",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg bg-slate-100 text-slate-600 cursor-not-allowed",readOnly:!0,disabled:!0})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-xs font-medium text-slate-600",children:"Numărul facturii"}),e("input",{type:"text",value:c.invoice_number||"Se actualizează automat din Facturi",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg bg-slate-100 text-slate-600 cursor-not-allowed",readOnly:!0,disabled:!0})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:c.notes,onChange:x,rows:2,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Note adiționale despre slot"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(it,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Slot"]})]})]})]})})]})})},Tt=({title:a,value:s,icon:r,color:l,change:n,changeType:o,loading:i,size:c="medium",isEditing:u=!1,isVisible:x=!0,onToggleVisibility:m,onToggleSelection:d,onSizeChange:g,isSelected:_=!1,dragHandleProps:p={}})=>{const N={blue:"from-blue-500 to-indigo-500",green:"from-green-500 to-emerald-500",purple:"from-purple-500 to-violet-500",orange:"from-orange-500 to-amber-500",indigo:"from-indigo-500 to-blue-500",emerald:"from-emerald-500 to-green-500",slate:"from-slate-500 to-gray-500",cyan:"from-cyan-500 to-blue-500",yellow:"from-yellow-500 to-orange-500",red:"from-red-500 to-pink-500",gray:"from-gray-500 to-slate-500"},k={xs:{container:"p-3",icon:"w-6 h-6",title:"text-xs",value:"text-lg",change:"text-xs"},small:{container:"p-4",icon:"w-8 h-8",title:"text-sm",value:"text-xl",change:"text-xs"},medium:{container:"p-6",icon:"w-12 h-12",title:"text-base",value:"text-3xl",change:"text-sm"},large:{container:"p-8",icon:"w-16 h-16",title:"text-lg",value:"text-4xl",change:"text-base"},"extra-large":{container:"p-10",icon:"w-20 h-20",title:"text-xl",value:"text-5xl",change:"text-lg"}},E=k[c]||k.medium,P={blue:"shadow-blue-500/25",green:"shadow-green-500/25",purple:"shadow-purple-500/25",orange:"shadow-orange-500/25",indigo:"shadow-indigo-500/25",emerald:"shadow-emerald-500/25",slate:"shadow-slate-500/25",cyan:"shadow-cyan-500/25",yellow:"shadow-yellow-500/25",red:"shadow-red-500/25",gray:"shadow-gray-500/25"};return i?t("div",{className:`card ${E.container} animate-pulse`,children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-24"}),e("div",{className:`${E.icon} bg-slate-200 dark:bg-slate-700 rounded-2xl`})]}),t("div",{className:"space-y-2",children:[e("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded w-16"}),e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-20"})]})]}):t("div",{className:`card ${E.container} hover:shadow-2xl transition-all duration-300 hover:scale-105 group ${_?"ring-2 ring-blue-500":""}`,children:[u&&t("div",{className:"absolute top-2 right-2 flex space-x-1 z-10",children:[e("button",{onClick:m,className:"p-1 rounded bg-white/80 hover:bg-white text-slate-600 hover:text-slate-800 transition-colors",title:x?"Ascunde cardul":"Afișează cardul",children:x?e(Qe,{className:"w-4 h-4"}):e(Ja,{className:"w-4 h-4"})}),e("div",{...p,className:"p-1 rounded bg-white/80 hover:bg-white text-slate-600 hover:text-slate-800 transition-colors cursor-grab active:cursor-grabbing",title:"Trage pentru a reordona",children:e(Is,{className:"w-4 h-4"})})]}),t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:`${E.title} font-bold text-slate-600 dark:text-slate-300 uppercase tracking-wider`,children:a}),e("div",{className:`p-3 rounded-2xl bg-gradient-to-r ${N[l]} shadow-lg ${P[l]}`,children:e(r,{className:`${E.icon} text-white`})})]}),t("div",{className:"space-y-2",children:[e("div",{className:`${E.value} font-bold text-slate-800 dark:text-slate-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors`,children:(s==null?void 0:s.toLocaleString())||0}),n&&t("div",{className:`flex items-center space-x-1 ${E.change} font-semibold ${o==="positive"?"text-green-600":"text-red-600"}`,children:[o==="positive"?e(st,{className:"w-4 h-4"}):e(Os,{className:"w-4 h-4"}),e("span",{children:n}),e("span",{className:"text-slate-500 dark:text-slate-400",children:"vs. luna trecută"})]})]}),u&&g&&e("div",{className:"mt-4 pt-3 border-t border-slate-200 dark:border-slate-700",children:t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Mărime:"}),t("select",{value:c,onChange:f=>g(f.target.value),className:"text-xs bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded px-2 py-1",children:[e("option",{value:"xs",children:"XS"}),e("option",{value:"small",children:"Small"}),e("option",{value:"medium",children:"Medium"}),e("option",{value:"large",children:"Large"}),e("option",{value:"extra-large",children:"XL"})]})]})})]})},io=()=>{const a=Ye(),s=h.useRef(null),[r,l]=h.useState([]),[n,o]=h.useState([]),[i,c]=h.useState([]),[u,x]=h.useState([]),[m,d]=h.useState([]),[g,_]=h.useState([]),[p,N]=h.useState([]),[k,E]=h.useState([]),[P,f]=h.useState([]),[R,A]=h.useState([]),[D,U]=h.useState([]),[j,v]=h.useState(!1),[z,S]=h.useState(""),[F,I]=h.useState(new Set),[b,y]=h.useState(new Set);h.useState(new Set),h.useState(new Set),h.useState(new Set);const[L,Y]=h.useState(!1),[O,G]=h.useState("audit");h.useState(!0);const[C,W]=h.useState({provider:"",cabinet:"",gameMix:"",status:"Active"}),[T,Z]=h.useState({company:"",city:"",status:""}),se=async()=>{var w,V;try{v(!0),$.loading("Conectare la baza de date Cyber...",{id:"cyber-db"});const K=await ae.get("/api/cyber-direct/fetch-yesterday");if(K.data.success){const we=K.data.data;_(we),G("audit"),$.success(`✅ ${we.length} înregistrări din ${K.data.date} încărcate din Cyber DB!`,{id:"cyber-db",duration:5e3}),console.log("✅ Yesterday data from Cyber DB:",we)}else throw new Error(K.data.error||"Eroare la citirea datelor")}catch(K){console.error("❌ Error fetching from Cyber DB:",K),$.error(`Eroare la conectarea la Cyber DB: ${((V=(w=K.response)==null?void 0:w.data)==null?void 0:V.error)||K.message}`,{id:"cyber-db",duration:6e3})}finally{v(!1)}},ne=async()=>{try{v(!0);try{const w=await ae.get("/api/cyber/machine-audit-summaries");_(w.data),console.log("✅ Machine audit summaries loaded from API:",w.data.length);return}catch(w){console.error("❌ API Error fetching machine audit summaries:",w),console.log("🔄 Falling back to local JSON file...")}try{const w=await ae.get("/cyber-data/machine_audit_summaries.json");_(w.data),console.log("✅ Machine audit summaries loaded from local file:",w.data.length),$.success("Date încărcate din fișierul local (mod offline)")}catch(w){console.error("❌ Local file error:",w),_([{serial_number:"100388",location:"Craiova",cabinet:"AMS-ST-50",mix:"Amusebox",producator:"Amusnet",address:"Str. Infratirii, Nr.2",status:"Active",manufacture_year:2025},{serial_number:"149616",location:"București",cabinet:"P42V Curved ST",mix:"Union",producator:"EGT",address:"Sos. Nordului Nr.1",status:"Active",manufacture_year:2024}]),console.log("⚠️ Using sample data as last resort"),$.success("Date de test încărcate (mod offline)")}}catch(w){console.error("❌ Error in fetchMachineAuditSummaries:",w),$.error("Eroare la încărcarea datelor din machine_audit_summaries")}finally{v(!1)}},ce=async()=>{if(window.confirm(`⚠️ ATENȚIE: Sincronizarea Cyber va ȘTERGE toate sloturile existente și va importa din nou!

Dacă vrei să păstrezi sloturile existente, folosește "Import Safe" în loc de "Sincronizează".

Continui cu sincronizarea completă?`))try{$.loading("Sincronizez sloturile din Cyber...",{id:"sync-slots"});try{const V=await ae.post("/api/cyber/sync-slots");if(V.data.success){$.success(`Sincronizare completă! ${V.data.syncedCount} sloturi importate.`,{id:"sync-slots"}),$e();return}else $.error("Eroare la sincronizare: "+V.data.message,{id:"sync-slots"})}catch(V){console.error("❌ API Error syncing Cyber slots:",V);try{console.log("🔄 Falling back to offline Cyber sync mode..."),$.loading("Se încearcă sincronizarea în mod offline...",{id:"sync-slots"});const K=await ae.get("/cyber-slots.json"),we=Array.isArray(K.data)?K.data:[];if(we.length>0){setSlots(we),$.success(`${we.length} sloturi sincronizate în mod offline!`,{id:"sync-slots"}),$e();return}else $.error("Fișierul local nu conține date valide!",{id:"sync-slots"})}catch(K){console.error("❌ Local file error during Cyber sync:",K),$.error("Nu s-a putut încărca fișierul local pentru sincronizare!",{id:"sync-slots"})}}}catch(V){console.error("Error in handleSyncCyberSlots:",V),$.error("Eroare la sincronizarea sloturilor: "+V.message,{id:"sync-slots"})}},Ce=async()=>{const w=window.prompt(`Ce vrei să importezi?

1 - Doar jocurile ACTIVE (recomandat)
2 - Toate jocurile (inclusiv inactive)

Introdu 1 sau 2:`);if(!w||w!=="1"&&w!=="2"){$.error("Operațiune anulată");return}const V=w==="1";try{$.loading(`Importez sloturile ${V?"ACTIVE":"TOATE"} din Cyber...`,{id:"sync-slots-safe"});const K=await ae.post("/api/cyber/sync-slots-safe",{onlyActive:V});K.data.success?($.success(`Import complet! ${K.data.syncedCount} sloturi noi adăugate (${K.data.existingCount} existau deja). + ${K.data.entitiesPopulated.locations} locații + ${K.data.entitiesPopulated.providers} furnizori + ${K.data.entitiesPopulated.cabinets} cabinete + ${K.data.entitiesPopulated.gameMixes} game mixes`,{id:"sync-slots-safe"}),$e()):$.error("Eroare la import: "+K.data.message,{id:"sync-slots-safe"})}catch(K){console.error("Error safe syncing Cyber slots:",K),$.error("Eroare la importul sigur: "+K.message,{id:"sync-slots-safe"})}},Re=async()=>{var w,V;try{$.loading("Sincronizez locațiile din Cyber...",{id:"sync-locations"});const K=await ae.post("/api/cyber/sync-locations");K.data.success?($.success(`Locații sincronizate! ${K.data.syncedCount} locații noi adăugate`,{id:"sync-locations"}),Ze()):$.error("Eroare la sincronizare locații: "+K.data.message,{id:"sync-locations"})}catch(K){console.error("Error syncing locations:",K),$.error("Eroare la sincronizare locații: "+(((V=(w=K.response)==null?void 0:w.data)==null?void 0:V.message)||K.message),{id:"sync-locations"})}},Ue=async()=>{var w,V;try{$.loading("Sincronizez game mixurile din Cyber...",{id:"sync-game-mixes"});const K=await ae.post("/api/cyber/sync-game-mixes");K.data.success?($.success(`Game mixuri sincronizate! ${K.data.syncedCount} game mixuri noi adăugate`,{id:"sync-game-mixes"}),de()):$.error("Eroare la sincronizare game mixuri: "+K.data.message,{id:"sync-game-mixes"})}catch(K){console.error("Error syncing game mixes:",K),$.error("Eroare la sincronizare game mixuri: "+(((V=(w=K.response)==null?void 0:w.data)==null?void 0:V.message)||K.message),{id:"sync-game-mixes"})}},Ve=async()=>{var w,V;try{$.loading("Sincronizez cabinetele din Cyber...",{id:"sync-cabinets"});const K=await ae.post("/api/cyber/sync-cabinets");K.data.success?($.success(`Cabinete sincronizate! ${K.data.syncedCount} cabinete noi adăugate`,{id:"sync-cabinets"}),Q()):$.error("Eroare la sincronizare cabinete: "+K.data.message,{id:"sync-cabinets"})}catch(K){console.error("Error syncing cabinets:",K),$.error("Eroare la sincronizare cabinete: "+(((V=(w=K.response)==null?void 0:w.data)==null?void 0:V.message)||K.message),{id:"sync-cabinets"})}},et=async()=>{var w,V;try{$.loading("Sincronizez furnizorii din Cyber...",{id:"sync-providers"});const K=await ae.post("/api/cyber/sync-providers");K.data.success?($.success(`Furnizori sincronizați! ${K.data.syncedCount} furnizori noi adăugați`,{id:"sync-providers"}),ue()):$.error("Eroare la sincronizare furnizori: "+K.data.message,{id:"sync-providers"})}catch(K){console.error("Error syncing providers:",K),$.error("Eroare la sincronizare furnizori: "+(((V=(w=K.response)==null?void 0:w.data)==null?void 0:V.message)||K.message),{id:"sync-providers"})}},qe=w=>{const V=w.target.files[0];if(!V)return;const K=new FileReader;K.onload=we=>{try{const Je=JSON.parse(we.target.result).map(Be=>({id:Be.id,serial_number:Be.serial_number||Be.slot_id,provider:Be.provider||"N/A",cabinet:Be.cabinet||"N/A",game_mix:wt(Be.game_mix_name||Be.game_mix),status:Be.status||"Active",location:Be.location||"N/A",last_updated:Be.updated_at||Be.created_at,created_at:Be.created_at}));l(Je),N(Je),$.success(`Încărcate ${Je.length} sloturi din fișier`)}catch(Le){console.error("Error parsing JSON:",Le),$.error("Eroare la citirea fișierului. Verifică că este un JSON valid.")}},K.readAsText(V)},$e=async()=>{v(!0);try{const w=await ae.get("/api/cyber/slots",{timeout:3e4}),V=Array.isArray(w.data)?w.data:[];l(V),N(V),$.success(`Încărcate ${V.length} sloturi din Cyber`)}catch(w){console.error("Error fetching Cyber slots from API, loading from JSON file:",w);try{const V=await ae.get("/cyber-slots.json"),K=Array.isArray(V.data)?V.data:[];l(K),N(K),$.success(`Încărcate ${K.length} sloturi din fișierul Cyber`)}catch(V){console.error("Error loading from JSON file, using demo data:",V);const K=[{id:1,serial_number:"149616",provider:"EGT",cabinet:"P42V Curved ST",game_mix:"EGT - Union",status:"Active",location:"Craiova",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-09-30T05:41:41.000Z"},{id:2,serial_number:"149597",provider:"EGT",cabinet:"P 32/32 H ST",game_mix:null,status:"Active",location:"Ploiești",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-09-25T08:14:46.000Z"},{id:3,serial_number:"823642",provider:"Novomatic",cabinet:"FV637C F2",game_mix:null,status:"Inactive",location:"București",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-10-01T10:00:00.000Z"}];l(K),N(K),$.success(`Încărcate ${K.length} sloturi (date demo)`)}}finally{v(!1)}},Ze=async()=>{v(!0);try{const w=await ae.get("/api/cyber/locations",{timeout:3e4}),V=Array.isArray(w.data)?w.data:[];o(V),E(V),$.success(`Încărcate ${V.length} locații din Cyber`)}catch(w){console.error("Error fetching Cyber locations from API, loading from JSON file:",w);try{const V=await ae.get("/cyber-locations.json"),K=Array.isArray(V.data)?V.data:[];o(K),E(K),$.success(`Încărcate ${K.length} locații din fișierul Cyber`)}catch(V){console.error("Error loading from JSON file, using demo data:",V);const K=[{id:1,name:"Craiova",location:"Craiova",address:"Str. Principală 123",city:"Craiova",company:"ENTERTAINMENT SOLUTIONS SRL",surface_area:100,status:"Active",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-01-01T10:00:00.000Z"},{id:2,name:"Ploiești",location:"Ploiești",address:"Bld. Republicii 21",city:"Ploiești",company:"SMARTFLIX SRL",surface_area:80,status:"Active",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-01-01T10:00:00.000Z"},{id:3,name:"București",location:"București",address:"Calea Victoriei 100",city:"București",company:"ENTERTAINMENT SOLUTIONS SRL",surface_area:150,status:"Active",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-01-01T10:00:00.000Z"}];o(K),E(K),$.success(`Încărcate ${K.length} locații (date demo)`)}}finally{v(!1)}},Q=async()=>{v(!0);try{const w=await ae.get("/api/cyber/cabinets",{timeout:3e4}),V=Array.isArray(w.data)?w.data:[];c(V),f(V),$.success(`Încărcate ${V.length} cabinete din Cyber`)}catch(w){console.error("Error fetching Cyber cabinets:",w),$.error("Eroare la încărcarea cabinetelor din Cyber"),c([]),f([])}finally{v(!1)}},de=async()=>{v(!0);try{const w=await ae.get("/api/cyber/game-mixes",{timeout:3e4}),V=Array.isArray(w.data)?w.data:[];x(V),A(V),$.success(`Încărcate ${V.length} game mix-uri din Cyber`)}catch(w){console.error("Error fetching Cyber game mixes:",w),$.error("Eroare la încărcarea game mix-urilor din Cyber"),x([]),A([])}finally{v(!1)}},ue=async()=>{v(!0);try{const w=await ae.get("/api/cyber/providers",{timeout:3e4}),V=Array.isArray(w.data)?w.data:[];d(V),U(V),$.success(`Încărcați ${V.length} furnizori din Cyber`)}catch(w){console.error("Error fetching Cyber providers:",w),$.error("Eroare la încărcarea furnizorilor din Cyber"),d([]),U([])}finally{v(!1)}};h.useEffect(()=>{ne(),$e(),Ze(),Q(),de(),ue()},[]),h.useEffect(()=>{let w=r;z&&(w=w.filter(V=>{var K,we,Le,Je;return((K=V.serial_number)==null?void 0:K.toLowerCase().includes(z.toLowerCase()))||((we=V.provider)==null?void 0:we.toLowerCase().includes(z.toLowerCase()))||((Le=V.cabinet)==null?void 0:Le.toLowerCase().includes(z.toLowerCase()))||((Je=V.game_mix)==null?void 0:Je.toLowerCase().includes(z.toLowerCase()))})),C.provider&&(w=w.filter(V=>V.provider===C.provider)),C.cabinet&&(w=w.filter(V=>V.cabinet===C.cabinet)),C.gameMix&&(w=w.filter(V=>V.game_mix===C.gameMix)),C.status&&(w=w.filter(V=>V.status===C.status)),N(w)},[r,z,C]),h.useEffect(()=>{let w=n;z&&(w=w.filter(V=>{var K,we,Le,Je;return((K=V.name)==null?void 0:K.toLowerCase().includes(z.toLowerCase()))||((we=V.address)==null?void 0:we.toLowerCase().includes(z.toLowerCase()))||((Le=V.city)==null?void 0:Le.toLowerCase().includes(z.toLowerCase()))||((Je=V.company)==null?void 0:Je.toLowerCase().includes(z.toLowerCase()))})),T.company&&(w=w.filter(V=>V.company===T.company)),T.city&&(w=w.filter(V=>V.city===T.city)),T.status&&(w=w.filter(V=>V.status===T.status)),E(w)},[n,z,T]);const pe=w=>Array.isArray(r)?[...new Set(r.map(V=>V[w]).filter(Boolean))]:(console.warn("cyberData is not an array:",r),[]),Ae=w=>Array.isArray(n)?[...new Set(n.map(V=>V[w]).filter(Boolean))]:(console.warn("cyberLocations is not an array:",n),[]),ee=w=>{const V=new Set(F);V.has(w)?V.delete(w):V.add(w),I(V)},me=w=>{const V=new Set(b);V.has(w)?V.delete(w):V.add(w),y(V)},fe=()=>{if(!Array.isArray(p)){console.warn("filteredData is not an array:",p),I(new Set);return}const w=p.map(V=>V.id);I(new Set(w))},ie=()=>{if(!Array.isArray(k)){console.warn("filteredLocations is not an array:",k),y(new Set);return}const w=k.map(V=>V.id);y(new Set(w))},le=()=>{I(new Set)},be=()=>{y(new Set)},te=async()=>{if(F.size===0){$.error("Selectează cel puțin un element pentru import");return}try{if(!Array.isArray(p)){console.warn("filteredData is not an array:",p),$.error("Date invalide pentru import");return}const w=p.filter(K=>F.has(K.id)),V=await ae.post("/api/slots/import-marina",{items:w});$.success(`${V.data.imported} sloturi importate cu succes!`),I(new Set),$e()}catch(w){console.error("Error importing slots:",w),$.error("Eroare la importarea sloturilor")}},oe=async()=>{if(b.size===0){$.error("Selectează cel puțin o locație pentru import");return}try{if(!Array.isArray(k)){console.warn("filteredLocations is not an array:",k),$.error("Date invalide pentru import");return}const w=k.filter(K=>b.has(K.id)),V=await ae.post("/api/locations/import-marina",{items:w});$.success(`${V.data.imported} locații importate cu succes!`),y(new Set),Ze()}catch(w){console.error("Error importing locations:",w),$.error("Eroare la importarea locațiilor")}},Se=async()=>{if(p.length===0){$.error("Nu există date de importat");return}try{const w=await ae.post("/api/slots/import-marina",{items:p});$.success(`${w.data.imported} sloturi importate cu succes!`),I(new Set),$e()}catch(w){console.error("Error importing all slots:",w),$.error("Eroare la importarea sloturilor")}},Pe=async()=>{if(k.length===0){$.error("Nu există locații de importat");return}try{const w=await ae.post("/api/locations/import-marina",{items:k});$.success(`${w.data.imported} locații importate cu succes!`),y(new Set),Ze()}catch(w){console.error("Error importing all locations:",w),$.error("Eroare la importarea locațiilor")}};h.useEffect(()=>{$e(),Ze()},[]);const Ee=[{key:"select",title:"",sortable:!1,render:w=>e("input",{type:"checkbox",checked:F.has(w.id),onChange:()=>ee(w.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})},{key:"serial_number",title:"Serial Number",sortable:!0,render:w=>e("div",{className:"font-mono text-sm font-medium text-slate-800 dark:text-slate-200",children:w.serial_number||"N/A"})},{key:"provider",title:"Provider",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200 font-medium",children:w.provider||"N/A"})},{key:"cabinet",title:"Cabinet",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.cabinet||"N/A"})},{key:"game_mix",title:"Game Mix",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:wt(w.game_mix_name||w.game_mix)})},{key:"status",title:"Status",sortable:!0,render:w=>e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="Active"?"bg-green-100 text-green-800":w.status==="Inactive"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status||"N/A"})},{key:"location",title:"Location",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400",children:w.location||"N/A"})},{key:"address",title:"Adresă",sortable:!0,render:w=>t("div",{className:"text-slate-800 dark:text-slate-200",children:[e("div",{className:"text-sm",children:w.address||"N/A"}),w.city&&e("div",{className:"text-xs text-slate-500",children:w.city})]})},{key:"company",title:"Companie",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.company||"N/A"})},{key:"last_updated",title:"Last Updated",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.last_updated?new Date(w.last_updated).toLocaleDateString("ro-RO"):"N/A"})}],B=[{key:"select",title:"",sortable:!1,render:w=>e("input",{type:"checkbox",checked:F.has(w.serial_number),onChange:()=>ee(w.serial_number),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})},{key:"serial_number",title:"Serial Number",sortable:!0,render:w=>e("div",{className:"font-mono text-sm font-medium text-slate-800 dark:text-slate-200",children:w.serial_number||"N/A"})},{key:"producator",title:"Producător",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200 font-medium",children:w.producator||"N/A"})},{key:"cabinet",title:"Cabinet",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.cabinet||"N/A"})},{key:"mix",title:"Game Mix",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:wt(w.mix)})},{key:"location",title:"Locație",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400",children:w.location||"N/A"})},{key:"address",title:"Adresă",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:e("div",{className:"text-sm",children:w.address||"N/A"})})},{key:"status",title:"Status",sortable:!0,render:w=>e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="Active"?"bg-green-100 text-green-800":w.status==="Inactive"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status||"N/A"})},{key:"manufacture_year",title:"An Fabricat",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.manufacture_year||"N/A"})}],M=[{key:"select",title:"",sortable:!1,render:w=>e("input",{type:"checkbox",checked:b.has(w.id),onChange:()=>me(w.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})},{key:"name",title:"Nume Locație",sortable:!0,render:w=>e("div",{className:"font-medium text-slate-800 dark:text-slate-200",children:w.name||"N/A"})},{key:"address",title:"Adresă",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.address||"N/A"})},{key:"city",title:"Oraș",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.city||"N/A"})},{key:"company",title:"Companie",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200 font-medium",children:w.company||"N/A"})},{key:"surface_area",title:"Suprafață (m²)",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400",children:w.surface_area?`${w.surface_area} m²`:"N/A"})},{key:"status",title:"Status",sortable:!0,render:w=>e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="Active"?"bg-green-100 text-green-800":w.status==="Inactive"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status||"N/A"})},{key:"last_updated",title:"Ultima Actualizare",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.last_updated?new Date(w.last_updated).toLocaleDateString("ro-RO"):"N/A"})}];return e(he,{children:t("div",{className:"p-6 space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>a("/slots"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5"})}),t("div",{children:[t("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 flex items-center space-x-2",children:[e(ot,{className:"w-6 h-6"}),e("span",{children:"Import Cyber"})]}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Importează datele din serverul Cyber"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>{var w;return(w=s.current)==null?void 0:w.click()},className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Rs,{className:"w-4 h-4"}),e("span",{children:"Încarcă JSON"})]}),e("input",{ref:s,type:"file",accept:".json",onChange:qe,className:"hidden"}),O==="audit"&&t("button",{onClick:se,className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg flex items-center space-x-2 transition-all font-medium shadow-lg",disabled:j,children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"📅 Cyber DB (Ieri)"})]}),O==="slots"&&t(De,{children:[t("button",{onClick:Ce,className:"px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Import Safe"})]}),t("button",{onClick:ce,className:"px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Cyber"})]})]}),O==="locations"&&t("button",{onClick:Re,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Locații"})]}),O==="gameMixes"&&t("button",{onClick:Ue,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Game Mixuri"})]}),O==="cabinets"&&t("button",{onClick:Ve,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Cabinete"})]}),O==="providers"&&t("button",{onClick:et,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Furnizori"})]}),t("button",{onClick:()=>{O==="audit"?ne():O==="slots"?$e():O==="locations"?Ze():O==="cabinets"?Q():O==="gameMixes"?de():O==="providers"&&ue()},disabled:j,className:"px-4 py-3 bg-slate-500 hover:bg-slate-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ut,{className:`w-4 h-4 ${j?"animate-spin":""}`}),e("span",{children:"Refresh Cyber DB"})]})]})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:e("div",{className:"border-b border-slate-200 dark:border-slate-700",children:t("nav",{className:"-mb-px flex space-x-8 px-6",children:[t("button",{onClick:()=>G("audit"),className:`py-4 px-1 border-b-2 font-medium text-sm ${O==="audit"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Machine Audit (",g.length,")"]}),t("button",{onClick:()=>G("slots"),className:`py-4 px-1 border-b-2 font-medium text-sm ${O==="slots"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Sloturi (",r.length,")"]}),t("button",{onClick:()=>G("locations"),className:`py-4 px-1 border-b-2 font-medium text-sm ${O==="locations"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Locații (",n.length,")"]}),t("button",{onClick:()=>G("cabinets"),className:`py-4 px-1 border-b-2 font-medium text-sm ${O==="cabinets"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Cabinete (",i.length,")"]}),t("button",{onClick:()=>G("gameMixes"),className:`py-4 px-1 border-b-2 font-medium text-sm ${O==="gameMixes"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Game Mixes (",u.length,")"]}),t("button",{onClick:()=>G("providers"),className:`py-4 px-1 border-b-2 font-medium text-sm ${O==="providers"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Furnizori (",m.length,")"]})]})})}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:O==="audit"?g.length:O==="slots"?r.length:n.length}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total înregistrări"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-blue-600",children:O==="audit"?g.length:O==="slots"?p.length:k.length}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Filtrate"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-green-600",children:O==="audit"||O==="slots"?F.size:b.size}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Selectate"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-purple-600",children:O==="audit"?[...new Set(g.map(w=>w.producator))].length:O==="slots"?pe("provider").length:Ae("company").length}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:O==="audit"?"Producători":O==="slots"?"Provideri":"Companii"})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[t("div",{className:"flex flex-col lg:flex-row gap-4",children:[e("div",{className:"flex-1",children:t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e("input",{type:"text",placeholder:O==="audit"?"Caută după serial, producător, cabinet, locație...":O==="slots"?"Caută după serial, provider, cabinet...":"Caută după nume, adresă, oraș, companie...",value:z,onChange:w=>S(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})}),t("button",{onClick:()=>Y(!L),className:"btn-secondary flex items-center space-x-2",children:[e(Wt,{className:"w-4 h-4"}),e("span",{children:"Filtre"})]})]}),L&&e("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:e("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:O==="slots"?t(De,{children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Provider"}),t("select",{value:C.provider,onChange:w=>W({...C,provider:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("provider").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Cabinet"}),t("select",{value:C.cabinet,onChange:w=>W({...C,cabinet:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("cabinet").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Game Mix"}),t("select",{value:C.gameMix,onChange:w=>W({...C,gameMix:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("game_mix").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Status"}),t("select",{value:C.status,onChange:w=>W({...C,status:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("status").map(w=>e("option",{value:w,children:w},w))]})]})]}):t(De,{children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Companie"}),t("select",{value:T.company,onChange:w=>Z({...T,company:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),Ae("company").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Oraș"}),t("select",{value:T.city,onChange:w=>Z({...T,city:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),Ae("city").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Status"}),t("select",{value:T.status,onChange:w=>Z({...T,status:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),Ae("status").map(w=>e("option",{value:w,children:w},w))]})]}),e("div",{})]})})})]}),t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:O==="audit"||O==="slots"?fe:ie,className:"btn-secondary flex items-center space-x-2",children:[e(bt,{className:"w-4 h-4"}),e("span",{children:"Selectează toate"})]}),t("button",{onClick:O==="audit"||O==="slots"?le:be,className:"btn-secondary flex items-center space-x-2",children:[e(Fs,{className:"w-4 h-4"}),e("span",{children:"Deselectează toate"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:O==="audit"||O==="slots"?te:oe,disabled:O==="audit"||O==="slots"?F.size===0:b.size===0,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(ze,{className:"w-4 h-4"}),t("span",{children:["Importă selectate (",O==="audit"||O==="slots"?F.size:b.size,")"]})]}),t("button",{onClick:O==="audit"||O==="slots"?Se:Pe,disabled:O==="audit"?g.length===0:O==="slots"?p.length===0:k.length===0,className:"btn-success flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(We,{className:"w-4 h-4"}),t("span",{children:["Importă toate (",O==="audit"?g.length:O==="slots"?p.length:k.length,")"]})]})]})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e("tr",{children:(O==="audit"?B:O==="slots"?Ee:M).map(w=>e("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider",children:w.title},w.key))})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:j?e("tr",{children:e("td",{colSpan:(O==="audit"?B:O==="slots"?Ee:M).length,className:"px-6 py-12 text-center",children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ut,{className:"w-5 h-5 animate-spin text-blue-600"}),e("span",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă datele din Cyber..."})]})})}):(O==="audit"?g:O==="slots"?p:k).length===0?e("tr",{children:e("td",{colSpan:(O==="audit"?B:O==="slots"?Ee:M).length,className:"px-6 py-12 text-center",children:e("div",{className:"text-slate-500 dark:text-slate-400",children:O==="audit"?g.length===0?"Nu există date în Machine Audit Summaries":"Nu există rezultate pentru filtrele aplicate":O==="slots"?r.length===0?"Nu există sloturi în Cyber":"Nu există rezultate pentru filtrele aplicate":n.length===0?"Nu există locații în Cyber":"Nu există rezultate pentru filtrele aplicate"})})}):(O==="audit"?g:O==="slots"?p:k).map((w,V)=>e("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700",children:(O==="audit"?B:O==="slots"?Ee:M).map(K=>e("td",{className:"px-6 py-4 whitespace-nowrap",children:K.render?K.render(w):w[K.key]},K.key))},w.id||V))})]})})})]})})},oo=()=>{const{slots:a,invoices:s,warehouse:r,loading:l,createItem:n,updateItem:o,deleteItem:i,exportToExcel:c,exportToPDF:u}=ye(),{user:x}=Rt(),m=Ye(),[d,g]=h.useState(""),[_,p]=h.useState("all"),[N,k]=h.useState("all"),[E,P]=h.useState("all"),[f,R]=h.useState([]),[A,D]=h.useState(!1),[U,j]=h.useState(null),[v,z]=h.useState([]),[S,F]=h.useState(!1),[I,b]=h.useState(!1),[y,L]=h.useState(!1),[Y,O]=h.useState(null);h.useState(!1);const[G,C]=h.useState({totalSlots:!1,activeSlots:!1,inactiveSlots:!1,maintenanceSlots:!1,ownedSlots:!1,rentedSlots:!1}),[W,T]=h.useState([]);h.useEffect(()=>{(async()=>{try{const M=await ae.get("/api/commissions");T(M.data)}catch(M){console.error("Error loading commissions:",M)}})()},[]),h.useEffect(()=>{(async()=>{var M;if(x!=null&&x.id)try{const K=(await ae.get(`/api/users/${x.id}`)).data.preferences||{};(M=K.slots)!=null&&M.cardVisibility&&C(K.slots.cardVisibility)}catch(w){console.error("Error loading slots preferences:",w)}})()},[x==null?void 0:x.id]);const Z=async B=>{if(x!=null&&x.id)try{await ae.put(`/api/users/${x.id}/preferences`,{preferences:{slots:{cardVisibility:B}}})}catch(M){console.error("Error saving slots preferences:",M)}},[se,ne]=h.useState(!1);h.useEffect(()=>{F(v.length>0)},[v]);const ce=B=>{const M={...G,[B]:!G[B]};C(M),Z(M)},Ce=()=>{const B={totalSlots:!0,activeSlots:!0,inactiveSlots:!0,maintenanceSlots:!0,ownedSlots:!0,rentedSlots:!0};C(B),Z(B)},Re=()=>{const B={totalSlots:!1,activeSlots:!1,inactiveSlots:!1,maintenanceSlots:!1,ownedSlots:!1,rentedSlots:!1};C(B),Z(B)},Ue=a.filter(B=>{var Le,Je,Be,nt,Dt;const M=((Le=B.name)==null?void 0:Le.toLowerCase().includes(d.toLowerCase()))||((Je=B.model)==null?void 0:Je.toLowerCase().includes(d.toLowerCase()))||((Be=B.provider)==null?void 0:Be.toLowerCase().includes(d.toLowerCase()))||((nt=B.location)==null?void 0:nt.toLowerCase().includes(d.toLowerCase()))||((Dt=B.serial_number)==null?void 0:Dt.toLowerCase().includes(d.toLowerCase())),w=_==="all"||B.status===_,V=N==="all"||B.provider===N,K=E==="all"||B.property_type===E,we=f.length===0||f.some(Jt=>(B.commission_date?new Date(B.commission_date).toISOString().split("T")[0]:null)===Jt);return M&&w&&V&&K&&we}),Ve=[...new Set(a.map(B=>B.provider).filter(Boolean))],et=a.length,qe=a.filter(B=>B.status==="Active").length,$e=a.filter(B=>B.status==="Inactive").length,Ze=a.filter(B=>B.status==="Maintenance").length,Q=a.filter(B=>B.property_type==="Owned").length,de=a.filter(B=>B.property_type==="Rented").length,ue=[{key:"serial_number",label:"SERIAL NUMBER",sortable:!0,render:B=>e("button",{onClick:()=>m(`/slots/${B.id}`),className:"text-blue-600 hover:text-blue-800 font-semibold text-base hover:underline transition-colors text-left",children:B.serial_number||"N/A"})},{key:"provider",label:"FURNIZOR",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:B.provider||"N/A"})},{key:"location",label:"LOCAȚIE",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:B.location||"N/A"})},{key:"cabinet",label:"CABINET",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:B.cabinet||"N/A"})},{key:"game_mix",label:"GAME MIX",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:wt(B.game_mix_name||B.game_mix)})},{key:"commission_date",label:"DATA COMISIE",sortable:!0,render:B=>{const M=B.commission_date?new Date(B.commission_date):null,w=B.expiry_date?new Date(B.expiry_date):null,V=w?Math.ceil((w-new Date)/(1e3*60*60*24)):null;return e("div",{className:"text-slate-800 font-medium text-base",children:M?t("div",{children:[e("div",{children:M.toLocaleDateString("ro-RO")}),V!==null&&e("div",{className:`text-xs ${V<=0?"text-red-600":V<=30?"text-yellow-600":"text-green-600"}`,children:V<=0?"Expirat":`${V} zile până la expirare`})]}):"N/A"})}},{key:"invoice",label:"FACTURĂ",sortable:!1,render:B=>{const M=s==null?void 0:s.find(w=>{if(!w.serial_number||!B.serial_number)return!1;let V=[];try{typeof w.serial_number=="string"?V=JSON.parse(w.serial_number):Array.isArray(w.serial_number)?V=w.serial_number:V=[w.serial_number]}catch{V=[w.serial_number.toString()]}return V.some(K=>K.toString()===B.serial_number.toString())});return M?e("div",{className:"flex items-center space-x-2",children:e("button",{onClick:()=>m(`/invoices/${M.id}`),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-sm hover:underline transition-colors",children:M.invoice_number})}):e("span",{className:"text-slate-400 dark:text-slate-500 text-sm",children:"-"})}},{key:"status",label:"STATUS",sortable:!0,render:B=>{var K;const M=async()=>{var Be;const we=((Be=B.status)==null?void 0:Be.toLowerCase())||"",Je=we==="activ"||we==="active"?"Inactive":"Active";try{Je==="Inactive"?(await n("warehouse",{serial_number:B.serial_number,provider:B.provider,location:"Depozit",cabinet:B.cabinet,game_mix:B.game_mix,status:"Inactive",notes:"Mutat automat din sloturi când a devenit inactiv"}),await i("slots",B.id),$.success("Slot mutat în Depozit")):(await o("slots",B.id,{...B,status:Je}),$.success(`Status schimbat în ${Je}`))}catch(nt){$.error("Eroare la actualizare status"),console.error("Error updating slot status:",nt)}},w=((K=B.status)==null?void 0:K.toLowerCase())||"",V=w==="activ"||w==="active";return t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:M,className:`relative inline-flex h-5 w-10 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 ${V?"bg-green-500":"bg-gray-300"}`,children:e("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${V?"translate-x-6":"translate-x-1"}`})}),e("span",{className:`text-xs font-bold ${V?"text-green-600":"text-gray-600"}`,children:V?"ON":"OFF"})]})}},{key:"cvt_date",label:"DATA CVT",sortable:!0,render:B=>{const M=B.cvt_date?new Date(B.cvt_date):null,w=M?Math.ceil((M-new Date)/(1e3*60*60*24)):null;return e("div",{className:"text-slate-800 font-medium text-base",children:M?t("div",{children:[e("div",{children:M.toLocaleDateString("ro-RO")}),w!==null&&e("div",{className:`text-xs ${w<=0?"text-red-600":w<=30?"text-yellow-600":"text-green-600"}`,children:w<=0?"Expirat":`${w} zile rămase`})]}):"N/A"})}},{key:"address",label:"ADRESĂ",sortable:!0,render:B=>t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{className:"text-sm",children:B.address||"N/A"}),B.city&&e("div",{className:"text-xs text-slate-500",children:B.city})]})},{key:"jackpot",label:"JACKPOT",sortable:!1,render:B=>B.jackpot_name?t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{className:"text-sm font-semibold text-green-600",children:B.jackpot_name}),e("div",{className:"text-xs text-slate-500",children:B.current_amount?`${B.current_amount.toLocaleString("ro-RO")} RON`:"N/A"}),B.jackpot_type&&e("div",{className:"text-xs text-slate-400",children:B.jackpot_type})]}):e("span",{className:"text-slate-400 dark:text-slate-500 text-sm",children:"-"})}],pe=()=>{j(null),D(!0)},Ae=B=>{j(B),D(!0)},ee=B=>{z(B?Ue.map(M=>M.id):[])},me=(B,M)=>{z(M?[...v,B]:v.filter(w=>w!==B))},fe=async()=>{v.length!==0&&L(!0)},ie=async()=>{L(!1);const B=v.length;let M=0,w=0;const V=[];try{const K=$.loading(`Șterg ${B} sloturi...`,{duration:1/0}),we=10;for(let Le=0;Le<v.length;Le+=we){const Be=v.slice(Le,Le+we).map(async Dt=>{try{await i("slots",Dt,!0),M++}catch(Jt){w++,V.push(`Slot ${Dt}: ${Jt.message}`)}});await Promise.all(Be);const nt=Math.min(Le+we,B);$.loading(`Șterg ${B} sloturi... (${nt}/${B})`,{id:K})}$.dismiss(K),w===0?$.success(`✅ ${M} sloturi șterse cu succes!`,{duration:5e3}):M>0?$.success(`⚠️ ${M} sloturi șterse, ${w} erori`,{duration:5e3}):$.error(`❌ Eroare la ștergerea tuturor ${B} sloturi`,{duration:5e3}),z([]),F(!1)}catch(K){console.error("Error bulk deleting slots:",K),$.error("Eroare la ștergerea sloturilor!"),L(!1)}},le=async()=>{if(!(v.length===0||!window.confirm(`Sigur vrei să muți ${v.length} sloturi selectate în DEPOZIT?

Sloturile vor fi șterse din tabelul Sloturi și mutate în Warehouse.`)))try{$.loading(`Mutare ${v.length} sloturi în depozit...`,{id:"bulk-move"});const M=a.filter(w=>v.includes(w.id));for(const w of M)await n("warehouse",{serial_number:w.serial_number,provider:w.provider,cabinet:w.cabinet,game_mix:w.game_mix,status:"In Depozit",location:"Depozit",notes:`Mutat din ${w.location||"Unknown"} la ${new Date().toLocaleDateString("ro-RO")}`}),await i("slots",w.id);z([]),F(!1),$.success(`${M.length} sloturi mutate în Depozit cu succes!`,{id:"bulk-move"}),await refreshData()}catch(M){console.error("Error moving slots to warehouse:",M),$.error("Eroare la mutarea sloturilor în depozit!",{id:"bulk-move"})}},be=async B=>{O(B),b(!0)},te=async()=>{try{await i("slots",Y),b(!1),O(null),$.success("Slot șters cu succes!")}catch(B){$.error("Eroare la ștergerea slotului"),console.error("Error deleting slot:",B)}},oe=async B=>{try{U?(await o("slots",U.id,B),$.success("Slot actualizat cu succes!")):(await n("slots",B),$.success("Slot adăugat cu succes!")),D(!1),j(null)}catch(M){$.error("Eroare la salvarea slotului"),console.error("Error saving slot:",M)}},Se=()=>{try{c("slots")}catch(B){$.error("Eroare la exportarea în Excel"),console.error("Error exporting to Excel:",B)}},Pe=()=>{try{u("slots")}catch(B){$.error("Eroare la exportarea în PDF"),console.error("Error exporting to PDF:",B)}},Ee=()=>{$.info("Funcționalitatea de import va fi implementată în curând")};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-emerald-500 to-green-500 rounded-2xl shadow-lg shadow-emerald-500/25",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Sloturi"}),e("p",{className:"text-slate-600",children:"Gestionează sloturile de gaming din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>ne(!se),className:"px-4 py-3 bg-slate-500 hover:bg-slate-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Wt,{className:"w-4 h-4"}),e("span",{children:"Setări Carduri"})]}),e(ft,{onExportExcel:Se,onExportPDF:Pe,entity:"slots"}),t("div",{className:"flex space-x-3",children:[S&&t(De,{children:[t("button",{onClick:le,className:"btn-secondary flex items-center space-x-2 bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white",children:[e(At,{className:"w-4 h-4"}),t("span",{children:["Mută în Depozit (",v.length,")"]})]}),t("button",{onClick:fe,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:()=>m("/slots/history"),className:"px-4 py-3 bg-slate-500 hover:bg-slate-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Ya,{className:"w-4 h-4"}),e("span",{children:"Istoric Sloturi"})]}),t("button",{onClick:()=>m("/slots/cyber-import"),className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Import Cyber"})]}),t("button",{onClick:pe,className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Slot"})]})]})]})]})}),se&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:[t("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Carduri"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Selectează ce carduri să afișezi"})]}),t("div",{className:"p-6 space-y-4",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Selectează tot"}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:Ce,className:"text-xs px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",children:"Selectează tot"}),e("button",{onClick:Re,className:"text-xs px-3 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:"Deselectează tot"})]})]}),e("div",{className:"space-y-3",children:[{key:"totalSlots",label:"Total Sloturi"},{key:"activeSlots",label:"Active"},{key:"inactiveSlots",label:"Inactive"},{key:"maintenanceSlots",label:"Mentenanță"},{key:"ownedSlots",label:"Proprietate"},{key:"rentedSlots",label:"Închiriate"}].map(B=>t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:B.label}),e("input",{type:"checkbox",checked:G[B.key],onChange:()=>ce(B.key),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})]},B.key))})]}),e("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e("button",{onClick:()=>ne(!1),className:"btn-primary px-6 py-2",children:"Salvează"})})]})}),G.totalSlots&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e(Tt,{title:"Total Sloturi",value:et,icon:it,color:"blue",trend:null}),G.activeSlots&&e(Tt,{title:"Active",value:qe,icon:bt,color:"green",trend:null}),G.inactiveSlots&&e(Tt,{title:"Inactive",value:$e,icon:lt,color:"red",trend:null}),G.maintenanceSlots&&e(Tt,{title:"Mentenanță",value:Ze,icon:sa,color:"yellow",trend:null})]}),(G.ownedSlots||G.rentedSlots)&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[G.ownedSlots&&e(Tt,{title:"Proprietate",value:Q,icon:bt,color:"emerald",trend:null}),G.rentedSlots&&e(Tt,{title:"Închiriate",value:de,icon:lt,color:"orange",trend:null})]}),e("div",{className:"card p-6",children:t("div",{className:"flex flex-col lg:flex-row items-start lg:items-center space-y-4 lg:space-y-0 lg:space-x-4",children:[t("div",{className:"relative flex-1 lg:max-w-md",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după nume, model, furnizor, locație sau numărul de serie...",value:d,onChange:B=>g(B.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),t("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e(Wt,{className:"w-4 h-4 text-slate-500"}),e("span",{className:"text-sm font-semibold text-slate-700",children:"Filtre:"})]}),t("select",{value:_,onChange:B=>p(B.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",children:[e("option",{value:"all",children:"Toate Statusurile"}),e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"}),e("option",{value:"Maintenance",children:"Mentenanță"})]}),t("select",{value:N,onChange:B=>k(B.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",children:[e("option",{value:"all",children:"Toți Furnizorii"}),Ve.map(B=>e("option",{value:B,children:B},B))]}),t("select",{value:E,onChange:B=>P(B.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",children:[e("option",{value:"all",children:"Toate Tipurile"}),e("option",{value:"Owned",children:"Proprietate"}),e("option",{value:"Rented",children:"Închiriate"})]}),t("select",{value:f.length>0?f[0]:"all",onChange:B=>{B.target.value==="all"?R([]):R([B.target.value])},className:"px-4 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e("option",{value:"all",children:"Toate Comisiile"}),W.map(B=>{const M=new Date(B.commission_date).toISOString().split("T")[0];return t("option",{value:M,children:[B.name," (",new Date(B.commission_date).toLocaleDateString("ro-RO"),")"]},B.id)})]}),t("button",{onClick:Ee,className:"btn-secondary flex items-center space-x-2 text-sm",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})]})}),e("div",{className:"card p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):Ue.length===0?t("div",{className:"text-center py-12",children:[e(it,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există sloturi"}),e("p",{className:"text-slate-500",children:"Adaugă primul slot pentru a începe"})]}):e(He,{data:Ue,columns:ue,onEdit:Ae,onDelete:be,searchTerm:d,onSearchChange:g,selectedItems:v,onSelectAll:ee,onSelectItem:me,moduleColor:"blue"})}),A&&e(no,{item:U,onClose:()=>D(!1),onSave:oe}),I&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(je,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[e("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Șterge Slot"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),e("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:"Ești sigur că vrei să ștergi acest slot? Toate datele asociate vor fi șterse permanent."}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>{b(!1),O(null)},className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),e("button",{onClick:te,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Șterge"})]})]})}),y&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(je,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Șterge ",v.length," Sloturi"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",v.length," sloturi selectate? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>L(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:ie,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",v.length," Sloturi"]})]})]})})]})})},co=()=>{const{id:a}=It(),s=Ye(),{slots:r,locations:l,companies:n,providers:o,cabinets:i,gameMixes:c,platforms:u,metrology:x,invoices:m,jackpots:d,loading:g}=ye();console.log("🔍 useData Debug:",{loading:g,slots:r==null?void 0:r.length,locations:l==null?void 0:l.length,companies:n==null?void 0:n.length,providers:o==null?void 0:o.length,cabinets:i==null?void 0:i.length,gameMixes:c==null?void 0:c.length,platforms:u==null?void 0:u.length,metrology:x==null?void 0:x.length,invoices:m==null?void 0:m.length,jackpots:d==null?void 0:d.length});const[_,p]=h.useState(!1),[N,k]=h.useState(!0),[E,P]=h.useState([]),f=r==null?void 0:r.find(b=>{const y=b.id==a,L=b.serial_number===a;return console.log(`🔍 Checking slot ${b.id}/${b.serial_number} against ${a}: ${y}/${L}`),y||L});console.log("🔍 SlotDetail Debug:",{id:a,idType:typeof a,slotsCount:r==null?void 0:r.length,slot:f,allSlots:r==null?void 0:r.map(b=>({id:b.id,serial_number:b.serial_number}))}),h.useEffect(()=>{k(JSON.parse(!1))},[]),h.useEffect(()=>{(async()=>{if(!(!(f!=null&&f.id)&&!(f!=null&&f.serial_number)))try{const y=await ae.get("/api/slot-history",{params:{slot_id:f.id,limit:3,offset:0}});P(y.data.data||y.data||[])}catch(y){console.error("Error fetching slot history:",y),P([])}})()},[f==null?void 0:f.id,f==null?void 0:f.serial_number]);const R=b=>{k(b)};if(g)return e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă detaliile slotului..."})]})})});const A=b=>{const y=l.find(L=>L.id===b||L.name===b);return y?y.name:b},D=b=>{const y=o.find(L=>L.id===b||L.name===b);return y?y.name:b},U=b=>{const y=i.find(L=>L.id===b);return y?y.name||y.model:b},j=b=>{const y=c.find(L=>L.id===b||L.name===b);return y?y.name:b},v=b=>{const y=c.find(L=>L.id===b||L.name===b);return y&&y.platform?y.platform:"N/A"},z=(x==null?void 0:x.filter(b=>b.serial_number===(f==null?void 0:f.serial_number)))||[],S=(m==null?void 0:m.filter(b=>{if(!b.serial_number||!(f!=null&&f.serial_number))return!1;try{return(typeof b.serial_number=="string"?JSON.parse(b.serial_number):Array.isArray(b.serial_number)?b.serial_number:[b.serial_number]).includes(f.serial_number)}catch{return b.serial_number===f.serial_number}}))||[],F=(d==null?void 0:d.filter(b=>b.slot_id===(f==null?void 0:f.id)))||[],I=S.length>0&&S[0].invoice_type==="Vânzare"?"Owned":"Rented";return f?e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 mb-6",children:e("div",{className:"bg-gradient-to-r from-emerald-800 via-green-800 to-teal-800 px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("button",{onClick:()=>s("/slots"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-white"})}),e("div",{className:"p-2 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[t("h1",{className:"text-2xl font-bold text-white",children:["Slot ",f.serial_number]}),t("p",{className:"text-emerald-100",children:["Serial: ",f.serial_number]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>p(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Setări",children:e(Lt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>s(`/slots/${f.id}/edit`),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Editează",children:e(at,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>{window.confirm("Sigur vrei să ștergi acest slot?")&&($.success("Slot șters cu succes!"),s("/slots"))},className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Șterge",children:e(je,{className:"w-5 h-5 text-white"})})]})]})})}),_&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:[e("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Afișare"})}),e("div",{className:"p-6 space-y-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"font-medium text-slate-800 dark:text-slate-200",children:"Afișare automată atașamente"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Afișează automat PDF-urile în pagina de detalii"})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:N,onChange:b=>R(b.target.checked),className:"sr-only peer"}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})}),e("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e("button",{onClick:()=>p(!1),className:"btn-primary",children:"Închide"})})]})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e("div",{children:t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-3 flex items-center",children:[e(Lt,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Informații Slot"]}),t("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t("div",{className:"space-y-2",children:[t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Serial Number"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:f.serial_number})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Locație"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:A(f.location)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Furnizor"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:D(f.provider)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Cabinet"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:U(f.cabinet)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Platformă"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:v(f.game_mix)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Game Mix"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:j(f.game_mix)})]})]}),t("div",{className:"space-y-2",children:[t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Status"}),e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${f.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:f.status})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Denomination"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:f.denomination||"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"RTP"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:f.rtp||"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Gaming Places"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:f.gaming_places||"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Max Bet"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:f.max_bet||"N/A"})]})]})]}),e("div",{className:"border-t border-slate-200 dark:border-slate-700 my-4"}),t("div",{className:"grid grid-cols-3 gap-4",children:[t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Tip proprietate"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:I})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Data comisionării"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:f.commissioning_date?new Date(f.commissioning_date).toLocaleDateString("ro-RO"):"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Numărul facturii"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:S.length>0?S[0].invoice_number:"N/A"}),S.length>0&&e("button",{onClick:()=>s(`/invoices/${S[0].id}`),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 mt-1",children:"Vezi factura →"})]})]})]})}),f.game_mix&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-3 flex items-center",children:[e(ct,{className:"w-4 h-4 mr-2 text-purple-600"}),"Jocuri din Game Mix"]}),t("div",{className:"p-3 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg border border-purple-200 dark:border-purple-700 mb-3",children:[e("h4",{className:"font-semibold text-purple-800 dark:text-purple-300 text-sm",children:f.game_mix}),e("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Game Mix activ"})]}),(()=>{const b=c.find(y=>y.name===f.game_mix);if(b&&b.games){const y=typeof b.games=="string"?JSON.parse(b.games):b.games;return t("div",{children:[e("div",{className:"mb-2 p-2 bg-gradient-to-r from-purple-100 to-indigo-100 dark:from-purple-900/30 dark:to-indigo-900/30 rounded",children:t("p",{className:"text-xs text-purple-700 dark:text-purple-300",children:[t("strong",{children:[y.length," jocuri"]})," în acest game mix",b.rtp&&t("span",{children:[" • RTP mediu: ",b.rtp,"%"]})]})}),e("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto",children:y.map((L,Y)=>t("div",{className:"p-2 bg-white dark:bg-slate-700 rounded border border-slate-200 dark:border-slate-600",children:[e("p",{className:"font-medium text-slate-800 dark:text-slate-200 text-xs",children:L}),t("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Joc #",Y+1]})]},Y))})]})}return e("p",{className:"text-center py-4 text-slate-500 dark:text-slate-400 text-sm",children:"Nu s-au găsit jocuri pentru acest game mix"})})()]}),F.length>0&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-3 flex items-center",children:[e(it,{className:"w-4 h-4 mr-2 text-yellow-600"}),"Jackpots (",F.length,")"]}),e("div",{className:"space-y-2",children:F.map((b,y)=>e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:b.name}),t("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:[b.amount," ",b.currency]}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:b.triggered_date?`Declanșat: ${new Date(b.triggered_date).toLocaleDateString("ro-RO")}`:"Nu a fost declanșat"})]}),e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${b.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:b.status})]})},y))})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 flex items-center",children:[e(Ya,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Istoric Modificări"]}),e("button",{onClick:()=>s("/slots/history"),className:"text-xs text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-300 font-medium",children:"Vezi toate →"})]}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full text-sm",children:[e("thead",{children:t("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Data"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Câmp"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Valoare veche"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Valoare nouă"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Utilizator"})]})}),e("tbody",{children:E.length===0?e("tr",{children:e("td",{colSpan:"5",className:"px-4 py-3 text-center text-slate-500 dark:text-slate-400",children:"Nu există modificări înregistrate pentru acest slot."})}):E.map((b,y)=>t("tr",{className:"border-b border-slate-100 dark:border-slate-700",children:[e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:new Date(b.created_at).toLocaleDateString("ro-RO")}),e("td",{className:"py-2 px-2",children:e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${b.field_name==="location"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":b.field_name==="status"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":b.field_name==="game_mix"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":b.field_name==="serial_number"?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-400":b.field_name==="provider"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":b.field_name==="cabinet"?"bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-400":"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}`,children:b.field_name})}),e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:b.old_value||"N/A"}),e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:b.new_value||"N/A"}),e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:b.username||"Sistem"})]},b.id||y))})]})}),e("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700",children:t("p",{className:"text-xs text-slate-500 dark:text-slate-400 text-center",children:["Afișate ultimele 3 modificări pentru slot ",f==null?void 0:f.serial_number," •",e("button",{onClick:()=>s("/slots/history"),className:"text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-300 ml-1",children:"Vezi istoricul complet"})]})})]})]}),(z.length>0||S.length>0)&&e("div",{className:"mt-6",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Atașamente (",z.length+S.length,")"]}),N&&e("div",{className:"mb-4",children:t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[z.length>0&&z[0]&&z[0].cvtFile&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg p-3",children:[t("h4",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-orange-600"}),"CVT ",z[0].cvt_number]}),e("div",{className:"h-64 border border-slate-200 dark:border-slate-600 rounded overflow-hidden",children:e("iframe",{src:`http://localhost:5001/api/cvt-pdf/${z[0].id}`,className:"w-full h-full",title:`CVT Document ${z[0].cvt_number}`})})]}),S.length>0&&S[0]&&S[0].file_path&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg p-3",children:[t("h4",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-blue-600"}),"Factură ",S[0].invoice_number]}),e("div",{className:"h-64 border border-slate-200 dark:border-slate-600 rounded overflow-hidden",children:e("iframe",{src:S[0].file_path,className:"w-full h-full",title:`Factură ${S[0].invoice_number}`})})]})]})}),t("div",{className:"space-y-3",children:[z.length>0&&t("div",{children:[t("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-orange-600"}),"Certificat CVT"]}),e("div",{className:"space-y-2",children:z.map((b,y)=>t("div",{className:"p-2 bg-slate-50 dark:bg-slate-700 rounded-lg flex items-center justify-between",children:[t("div",{className:"flex-1",children:[e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:b.cvt_number}),t("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:["CVT: ",new Date(b.cvt_date).toLocaleDateString("ro-RO")," • Expirare: ",b.expiry_date?new Date(b.expiry_date).toLocaleDateString("ro-RO"):"N/A"]})]}),e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${b.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:b.status})]},y))})]}),S.length>0&&t("div",{children:[t("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-blue-600"}),"Facturi"]}),e("div",{className:"space-y-2",children:S.map((b,y)=>t("div",{className:"p-2 bg-slate-50 dark:bg-slate-700 rounded-lg flex items-center justify-between",children:[t("div",{className:"flex-1",children:[e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:b.invoice_number}),t("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:[b.amount," ",b.currency," • ",b.invoice_type]})]}),e("button",{onClick:()=>s(`/invoices/${b.id}`),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-xs",children:"Vezi →"})]},y))})]})]})]})})]})})}):e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă..."})]})})})},mo=()=>{const a=Ye(),{slots:s,users:r,loading:l}=ye(),[n,o]=h.useState([]),[i,c]=h.useState(!0),[u,x]=h.useState(null),[m,d]=h.useState(!1),[g,_]=h.useState({slot_id:"",serial_number:"",field_name:"",user_id:"",username:"",start_date:"",end_date:"",change_type:""}),[p,N]=h.useState({limit:50,offset:0,total:0,currentPage:1,totalPages:1}),[k,E]=h.useState("created_at"),[P,f]=h.useState("DESC"),R=h.useCallback(async()=>{c(!0),x(null);try{const y={...g,limit:p.limit,offset:(p.currentPage-1)*p.limit,sort_by:k,sort_order:P};Object.keys(y).forEach(Y=>{(y[Y]===""||y[Y]===null||y[Y]===void 0)&&delete y[Y]});const L=await ae.get("/api/slot-history",{params:y});o(L.data.data||L.data.history||[]),N(Y=>{var O,G;return{...Y,total:((O=L.data.pagination)==null?void 0:O.total)||L.data.total||0,totalPages:Math.ceil((((G=L.data.pagination)==null?void 0:G.total)||L.data.total||0)/Y.limit)}})}catch(y){console.error("Error fetching slot history:",y),x("Eroare la încărcarea istoricului sloturilor."),$.error("Eroare la încărcarea istoricului sloturilor.")}finally{c(!1)}},[g,p.limit,p.currentPage,k,P]);h.useEffect(()=>{R()},[R]);const A=y=>{const{name:L,value:Y}=y.target;_(O=>({...O,[L]:Y})),N(O=>({...O,currentPage:1,offset:0}))},D=y=>{const L=y.getFullYear(),Y=String(y.getMonth()+1).padStart(2,"0"),O=String(y.getDate()).padStart(2,"0");return`${L}-${Y}-${O}`},U=()=>{if(!g.start_date||!g.end_date)return"all";const y=new Date,L=new Date(y.getFullYear(),y.getMonth(),y.getDate()),Y=D(L);if(g.start_date===Y&&g.end_date===Y)return"today";const O=L.getDay(),G=O===0?-6:1-O,C=new Date(L);C.setDate(L.getDate()+G);const W=new Date(C);if(W.setDate(C.getDate()+6),g.start_date===D(C)&&g.end_date===D(W))return"thisWeek";const T=D(new Date(y.getFullYear(),y.getMonth(),1)),Z=D(new Date(y.getFullYear(),y.getMonth()+1,0));if(g.start_date===T&&g.end_date===Z)return"thisMonth";const se=D(new Date(y.getFullYear(),0,1)),ne=D(new Date(y.getFullYear(),11,31));if(g.start_date===se&&g.end_date===ne)return"thisYear";const ce=D(new Date(y.getFullYear()-1,0,1)),Ce=D(new Date(y.getFullYear()-1,11,31));return g.start_date===ce&&g.end_date===Ce?"lastYear":"custom"},j=y=>{const L=new Date,Y=new Date(L.getFullYear(),L.getMonth(),L.getDate());let O="",G="";switch(y){case"today":O=D(Y),G=D(Y);break;case"thisWeek":const C=new Date(Y),W=Y.getDay(),T=W===0?-6:1-W;C.setDate(Y.getDate()+T),O=D(C);const Z=new Date(C);Z.setDate(C.getDate()+6),G=D(Z);break;case"thisMonth":O=D(new Date(L.getFullYear(),L.getMonth(),1));const se=new Date(L.getFullYear(),L.getMonth()+1,0);G=D(se);break;case"thisYear":O=D(new Date(L.getFullYear(),0,1));const ne=new Date(L.getFullYear(),11,31);G=D(ne);break;case"lastYear":O=D(new Date(L.getFullYear()-1,0,1));const ce=new Date(L.getFullYear()-1,11,31);G=D(ce);break;case"all":O="",G="";break}_(C=>({...C,start_date:O,end_date:G})),N(C=>({...C,currentPage:1,offset:0}))},v=y=>{k===y?f(L=>L==="ASC"?"DESC":"ASC"):(E(y),f("ASC"))},z=y=>{y>0&&y<=p.totalPages&&N(L=>({...L,currentPage:y,offset:(y-1)*L.limit}))},S=(y,L=null)=>{if(L)return L;const Y=s==null?void 0:s.find(O=>O.id===y);return Y?Y.serial_number:"N/A"},F=y=>{const L=r==null?void 0:r.find(Y=>Y.id===y);return L?L.username:"Sistem"},I=y=>{switch(y.toLowerCase()){case"location":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"status":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"game_mix":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400";case"serial_number":return"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-400";case"provider":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"cabinet":return"bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-400";default:return"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}},b=y=>y==null?"N/A":typeof y=="boolean"?y?"Da":"Nu":typeof y=="object"?JSON.stringify(y):String(y);return l||i?e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă istoricul modificărilor..."})]})})}):u?e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("p",{className:"text-red-600 dark:text-red-400 text-lg",children:u}),e("button",{onClick:()=>R(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Reîncearcă"})]})})}):e(he,{children:t("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 bg-white dark:bg-slate-900 rounded-xl shadow-lg min-h-screen",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 flex items-center",children:[e(Ya,{className:"w-6 h-6 mr-3 text-indigo-600"}),"Istoric Modificări Sloturi"]}),t("button",{onClick:()=>a(-1),className:"inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-700 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e(tt,{className:"w-4 h-4 mr-2"}),"Înapoi"]})]}),t("div",{className:"flex items-center gap-3 mb-6",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",name:"serial_number",value:g.serial_number,onChange:A,placeholder:"Caută după număr serie slot...",className:"w-full pl-10 pr-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-800 dark:text-slate-200"})]}),e("button",{onClick:()=>d(!m),className:`p-3 rounded-full transition-all duration-200 shadow-lg hover:shadow-xl ${m?"bg-blue-600 text-white hover:bg-blue-700":"bg-blue-500 text-white hover:bg-blue-600"}`,title:"Filtre",children:e(Wt,{className:"w-5 h-5"})})]}),m&&t("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-lg shadow-inner mb-6",children:[t("div",{className:"mb-4",children:[e("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Filtre rapide:"}),t("div",{className:"flex flex-wrap gap-2",children:[e("button",{onClick:()=>j("today"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${U()==="today"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Azi"}),e("button",{onClick:()=>j("thisWeek"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${U()==="thisWeek"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Săptămâna curentă"}),e("button",{onClick:()=>j("thisMonth"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${U()==="thisMonth"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Luna curentă"}),e("button",{onClick:()=>j("thisYear"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${U()==="thisYear"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Anul curent"}),e("button",{onClick:()=>j("lastYear"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${U()==="lastYear"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Anul precedent"}),e("button",{onClick:()=>j("all"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${U()==="all"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Toate"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[t("div",{children:[e("label",{htmlFor:"serial_number",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Număr Serie Slot"}),e("input",{type:"text",name:"serial_number",id:"serial_number",value:g.serial_number,onChange:A,placeholder:"Caută după număr serie",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"field_name",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Câmp Modificat"}),e("input",{type:"text",name:"field_name",id:"field_name",value:g.field_name,onChange:A,placeholder:"Ex: location, status",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Utilizator"}),e("input",{type:"text",name:"username",id:"username",value:g.username,onChange:A,placeholder:"Nume utilizator",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"change_type",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Tip Modificare"}),t("select",{name:"change_type",id:"change_type",value:g.change_type,onChange:A,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200",children:[e("option",{value:"",children:"Toate"}),e("option",{value:"CREATE",children:"Creare"}),e("option",{value:"UPDATE",children:"Actualizare"}),e("option",{value:"DELETE",children:"Ștergere"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{htmlFor:"start_date",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Data Început"}),e("input",{type:"date",name:"start_date",id:"start_date",value:g.start_date,onChange:A,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"end_date",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Data Sfârșit"}),e("input",{type:"date",name:"end_date",id:"end_date",value:g.end_date,onChange:A,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow border border-slate-200 dark:border-slate-700 flex items-center",children:[e(dt,{className:"w-6 h-6 text-indigo-500 mr-3"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Total Modificări"}),e("p",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:p.total})]})]}),t("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow border border-slate-200 dark:border-slate-700 flex items-center",children:[e(ot,{className:"w-6 h-6 text-green-500 mr-3"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Sloturi Modificate"}),e("p",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:new Set(n.map(y=>y.slot_id)).size})]})]}),t("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow border border-slate-200 dark:border-slate-700 flex items-center",children:[e(yt,{className:"w-6 h-6 text-blue-500 mr-3"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Utilizatori Unici"}),e("p",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:new Set(n.map(y=>y.user_id)).size})]})]})]}),e("div",{className:"overflow-x-auto bg-white dark:bg-slate-800 rounded-lg shadow border border-slate-200 dark:border-slate-700",children:t("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-slate-700",children:[e("thead",{className:"bg-slate-50 dark:bg-slate-700",children:t("tr",{children:[t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>v("created_at"),children:["Data",k==="created_at"&&e("span",{className:"ml-1",children:P==="ASC"?"▲":"▼"})]}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>v("serial_number"),children:["Slot",k==="serial_number"&&e("span",{className:"ml-1",children:P==="ASC"?"▲":"▼"})]}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>v("field_name"),children:["Câmp",k==="field_name"&&e("span",{className:"ml-1",children:P==="ASC"?"▲":"▼"})]}),e("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider",children:"Valoare Veche"}),e("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider",children:"Valoare Nouă"}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>v("username"),children:["Utilizator",k==="username"&&e("span",{className:"ml-1",children:P==="ASC"?"▲":"▼"})]}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>v("change_type"),children:["Tip",k==="change_type"&&e("span",{className:"ml-1",children:P==="ASC"?"▲":"▼"})]})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:n.length===0?e("tr",{children:e("td",{colSpan:"7",className:"px-4 py-4 text-center text-slate-500 dark:text-slate-400",children:"Nu s-au găsit modificări."})}):n.map(y=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700",children:[e("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300",children:new Date(y.created_at).toLocaleString("ro-RO")}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-indigo-600 dark:text-indigo-400",children:e("button",{onClick:()=>a(`/slots/${y.slot_id}`),className:"hover:underline",children:y.slot_serial||S(y.slot_id,y.serial_number)})}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${I(y.field_name)}`,children:y.field_name})}),e("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 max-w-xs truncate",children:b(y.old_value)}),e("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 max-w-xs truncate",children:b(y.new_value)}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300",children:y.username||F(y.user_id)}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${y.change_type==="CREATE"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":y.change_type==="DELETE"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:y.change_type})})]},y.id))})]})}),t("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-700 dark:via-slate-800 dark:to-slate-700 px-6 md:px-8 py-4 md:py-6 border-t border-slate-200/50 dark:border-slate-600/50 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[t("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e("span",{className:"text-sm md:text-base font-semibold text-slate-700 dark:text-slate-200",children:"Înregistrări:"}),t("select",{value:p.limit,onChange:y=>{N(L=>({...L,limit:Number(y.target.value),currentPage:1}))},className:"border-2 border-slate-200 dark:border-slate-600 rounded-2xl px-4 py-2 text-sm font-medium bg-white/80 dark:bg-slate-700/80 backdrop-blur-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 transition-all duration-200 shadow-lg text-slate-900 dark:text-slate-100",children:[e("option",{value:15,children:"15"}),e("option",{value:25,children:"25"}),e("option",{value:50,children:"50"}),e("option",{value:100,children:"100"}),e("option",{value:200,children:"200"})]}),t("span",{className:"text-sm md:text-base text-slate-600 dark:text-slate-300 font-medium",children:[(p.currentPage-1)*p.limit+1,"-",Math.min(p.currentPage*p.limit,p.total)," din ",p.total]})]}),t("div",{className:"flex items-center justify-between sm:justify-start gap-3",children:[e("button",{onClick:()=>z(p.currentPage-1),disabled:p.currentPage===1,className:"relative inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(p.totalPages,10)},(y,L)=>{const Y=L+1;return e("button",{onClick:()=>z(Y),className:`relative inline-flex items-center px-3 py-2 text-sm font-medium ${Y===p.currentPage?"z-10 bg-blue-50 border-blue-500 text-blue-600 dark:bg-blue-900/30 dark:border-blue-600 dark:text-blue-400":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-600"} border rounded-md`,children:Y},Y)})}),e("button",{onClick:()=>z(p.currentPage+1),disabled:p.currentPage===p.totalPages,className:"relative inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Următor"})]})]}),e("div",{className:"mt-6 text-right",children:t("button",{className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e(We,{className:"w-4 h-4 mr-2"}),"Exportă CSV"]})})]})})},uo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",category:"",quantity:"",location:"",status:"Available",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",category:a.category||"",quantity:a.quantity||"",location:a.location||"",status:a.status||"Available",notes:a.notes||""})},[a]);const o=c=>{const{name:u,value:x}=c.target;n(m=>({...m,[u]:x}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-orange-800 to-amber-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-600/20 to-amber-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-amber-500 rounded-2xl shadow-lg",children:e(ir,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Produs":"Adaugă Produs în Depozit"}),e("p",{className:"text-orange-100 text-sm font-medium",children:"Completează informațiile despre produs"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Produs *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Nume produs",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Categorie *"}),e("input",{type:"text",name:"category",value:l.category,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Categoria produsului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cantitate *"}),e("input",{type:"number",name:"quantity",value:l.quantity,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Cantitatea",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Locație *"}),e("input",{type:"text",name:"location",value:l.location,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Locația în depozit",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",required:!0,children:[e("option",{value:"Available",children:"Disponibil"}),e("option",{value:"Out of Stock",children:"Stoc epuizat"}),e("option",{value:"Reserved",children:"Rezervat"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(ir,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Produs"]})]})]})]})})]})})},ho=()=>{const{warehouse:a,slots:s,loading:r,createItem:l,updateItem:n,deleteItem:o,exportToExcel:i,exportToPDF:c}=ye(),[u,x]=h.useState(""),[m,d]=h.useState([]),[g,_]=h.useState(!1),[p,N]=h.useState(!1);h.useEffect(()=>{_(m.length>0)},[m]);const k=G=>{d(G?v.map(C=>C.id):[])},E=(G,C)=>{d(C?[...m,G]:m.filter(W=>W!==G))},P=async()=>{m.length!==0&&N(!0)},f=async()=>{N(!1);const G=m.length;let C=0,W=0;try{const T=$.loading(`Șterg ${G} elemente...`,{duration:1/0}),Z=10;for(let se=0;se<m.length;se+=Z){const ce=m.slice(se,se+Z).map(async Re=>{try{await o("warehouse",Re,!0),C++}catch{W++}});await Promise.all(ce);const Ce=Math.min(se+Z,G);$.loading(`Șterg ${G} elemente... (${Ce}/${G})`,{id:T})}$.dismiss(T),W===0?$.success(`✅ ${C} elemente șterse cu succes!`,{duration:5e3}):C>0?$.success(`⚠️ ${C} elemente șterse, ${W} erori`,{duration:5e3}):$.error(`❌ Eroare la ștergerea tuturor ${G} elemente`,{duration:5e3}),d([]),_(!1)}catch(T){console.error("Error bulk deleting:",T),$.error("Eroare la ștergerea elementelor!"),N(!1)}},R=()=>{m.length!==0&&console.log("Bulk edit for:",m)},[A,D]=h.useState(!1),[U,j]=h.useState(null),v=a.filter(G=>{var C,W,T,Z,se;return((C=G.serial_number)==null?void 0:C.toLowerCase().includes(u.toLowerCase()))||((W=G.provider)==null?void 0:W.toLowerCase().includes(u.toLowerCase()))||((T=G.location)==null?void 0:T.toLowerCase().includes(u.toLowerCase()))||((Z=G.cabinet)==null?void 0:Z.toLowerCase().includes(u.toLowerCase()))||((se=G.game_mix)==null?void 0:se.toLowerCase().includes(u.toLowerCase()))}),z=a.length,S=a.filter(G=>G.status==="Inactive").length,F=[{key:"serial_number",label:"SERIAL NUMBER",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-semibold text-base",children:G.serial_number||"N/A"})},{key:"provider",label:"FURNIZOR",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-medium text-base",children:G.provider||"N/A"})},{key:"location",label:"LOCAȚIE",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-medium text-base",children:G.location||"N/A"})},{key:"cabinet",label:"CABINET",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-medium text-base",children:G.cabinet||"N/A"})},{key:"game_mix",label:"GAME MIX",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-medium text-base",children:wt(G.game_mix_name||G.game_mix)})},{key:"status",label:"STATUS",sortable:!0,render:G=>{var Z;const C=async()=>{var Ce;const se=((Ce=G.status)==null?void 0:Ce.toLowerCase())||"",ce=se==="activ"||se==="active"?"Inactive":"Active";try{ce==="Active"?(await l("slots",{name:"Slot Machine",serial_number:G.serial_number,provider:G.provider,location:"Locație principală",game:"",cabinet:G.cabinet,game_mix:G.game_mix,denomination:.01,max_bet:null,rtp:null,gaming_places:1,property_type:"Owned",commission_date:null,invoice_number:null,status:"Active",notes:"Mutat automat din depozit când a devenit activ"}),await o("warehouse",G.id),$.success("Slot mutat înapoi în sloturi")):(await n("warehouse",G.id,{...G,status:ce}),$.success(`Status schimbat în ${ce}`))}catch(Re){$.error("Eroare la actualizare status"),console.error("Error updating warehouse slot status:",Re)}},W=((Z=G.status)==null?void 0:Z.toLowerCase())||"",T=W==="activ"||W==="active";return t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:C,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 ${T?"bg-green-500":"bg-gray-300"}`,children:e("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${T?"translate-x-9":"translate-x-1"}`})}),e("span",{className:`text-xs font-bold ${T?"text-green-600":"text-gray-600"}`,children:T?"ON":"OFF"})]})}},{key:"created_by",label:"CREAT DE",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-medium text-base",children:G.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:G=>e("div",{className:"text-slate-800 font-medium text-base",children:G.created_at?new Date(G.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"address",label:"ADRESĂ",sortable:!0,render:G=>t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{className:"text-sm",children:G.address||"N/A"}),G.city&&e("div",{className:"text-xs text-slate-500",children:G.city})]})}],I=G=>{j(G),D(!0)},b=async G=>{if(window.confirm("Sigur vrei să ștergi acest slot din depozit?"))try{await o("warehouse",G),$.success("Slot șters din depozit cu succes!")}catch(C){$.error("Eroare la ștergerea slotului"),console.error("Error deleting slot from warehouse:",C)}},y=()=>{j(null),D(!0)},L=async G=>{try{U?(await n("warehouse",U.id,G),$.success("Slot actualizat cu succes!")):(await l("warehouse",G),$.success("Slot adăugat în depozit cu succes!")),D(!1),j(null)}catch(C){$.error("Eroare la salvarea slotului"),console.error("Error saving slot to warehouse:",C)}};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-slate-500 to-gray-500 rounded-2xl shadow-lg shadow-slate-500/25",children:e(At,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Depozit Sloturi"}),e("p",{className:"text-slate-600",children:"Sloturile inactive din depozit"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{i("warehouse")}catch(G){console.error("Error exporting to Excel:",G)}},onExportPDF:()=>{try{c("warehouse")}catch(G){console.error("Error exporting to PDF:",G)}},entity:"warehouse"}),g&&t(De,{children:[t("button",{onClick:R,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:P,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:y,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Slot"})]})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e(Tt,{title:"Total Sloturi",value:z,icon:it,color:"blue",trend:null}),e(Tt,{title:"Inactive",value:S,icon:lt,color:"red",trend:null})]}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după numărul de serie, furnizor, locație, cabinet sau game mix...",value:u,onChange:G=>x(G.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:r?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-500"})}):v.length===0?t("div",{className:"text-center py-12",children:[e(At,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există sloturi în depozit"}),e("p",{className:"text-slate-500",children:"Sloturile inactive vor apărea aici automat"})]}):e(He,{data:v,columns:F,onEdit:I,onDelete:b,searchTerm:u,selectedItems:m,onSelectAll:k,onSelectItem:E,moduleColor:"blue"})}),A&&e(uo,{item:U,onClose:()=>D(!1),onSave:L}),p&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(je,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Șterge ",m.length," Elemente"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",m.length," elemente selectate din depozit? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>N(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",m.length," Elemente"]})]})]})})]})})},po=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState([]),[o,i]=h.useState([]),[c,u]=h.useState([]),[x,m]=h.useState([]),[d,g]=h.useState([]),[_,p]=h.useState([]),[N,k]=h.useState({cvt_number:"",serial_number:"",cvt_type:"Periodică",cvt_date:"",expiry_date:"",issuing_authority:"",provider:"",cabinet:"",game_mix:"",approval_type:"",software:"",cvtFile:null,cvtPreview:null,notes:""});h.useEffect(()=>{if((async()=>{try{const[z,S,F,I,b,y]=await Promise.all([fetch("/api/authorities"),fetch("/api/providers"),fetch("/api/cabinets"),fetch("/api/gameMixes"),fetch("/api/approvals"),fetch("/api/software")]),[L,Y,O,G,C,W]=await Promise.all([z.json(),S.json(),F.json(),I.json(),b.json(),y.json()]);n(Array.isArray(L)?L:[]),i(Array.isArray(Y)?Y:[]),u(Array.isArray(O)?O:[]),m(Array.isArray(G)?G:[]),g(Array.isArray(C)?C:[]),p(Array.isArray(W)?W:[])}catch(z){console.error("Error loading data:",z)}})(),a){const z=S=>{if(!S)return"";const F=new Date(S);return isNaN(F.getTime())?"":F.toISOString().split("T")[0]};k({cvt_number:a.cvt_number||"",serial_number:a.serial_number||"",cvt_type:a.cvt_type||"Periodică",cvt_date:z(a.cvt_date),expiry_date:z(a.expiry_date),issuing_authority:a.issuing_authority||"",provider:a.provider||"",cabinet:a.cabinet||"",game_mix:a.game_mix||"",approval_type:a.approval_type||"",software:a.software||"",cvtFile:a.cvtFile||null,cvtPreview:a.cvtFile||null,notes:a.notes||""})}},[a]);const E=()=>N.provider?c.filter(v=>v.provider===N.provider||v.provider_name===N.provider):c,P=()=>N.provider?x.filter(v=>v.provider===N.provider||v.provider_name===N.provider):x,f=()=>{if(!N.cabinet)return d;const v=c.find(z=>z.name===N.cabinet||z.model===N.cabinet);return v?d.filter(z=>z.cabinet===N.cabinet||z.model===v.model):d},R=()=>{if(!N.game_mix)return _;const v=x.find(z=>z.name===N.game_mix);return v?_.filter(z=>z.game_mix===N.game_mix||z.provider===v.provider):_},A=v=>{const{name:z,value:S}=v.target;k(F=>{const I={...F,[z]:S};if(z==="provider"?(I.cabinet="",I.game_mix="",I.approval_type="",I.software=""):z==="cabinet"?(I.approval_type="",I.software=""):z==="game_mix"&&(I.software=""),(z==="cvt_type"||z==="cvt_date")&&(I.cvt_type==="Periodică"||I.cvt_type==="Inițială")&&I.cvt_date){const b=new Date(I.cvt_date),y=new Date(b);y.setFullYear(y.getFullYear()+1),y.setDate(y.getDate()-1),I.expiry_date=y.toISOString().split("T")[0]}return I})},D=v=>{const z=v.target.files[0];if(z){const S=new FileReader;S.onload=F=>{k(I=>({...I,cvtFile:F.target.result,cvtPreview:F.target.result}))},S.readAsDataURL(z)}},U=()=>{window.confirm("Sigur doriți să ștergeți documentul CVT?")&&k(v=>({...v,cvtFile:null,cvtPreview:null}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-cyan-800 to-teal-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-600/20 to-teal-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-cyan-500 to-teal-500 rounded-2xl shadow-lg",children:e(Ht,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Certificat":"Adaugă Certificat Nou"}),e("p",{className:"text-cyan-100 text-sm font-medium",children:"Completează informațiile despre certificatul de metrologie"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:v=>{v.preventDefault(),r(N)},className:"p-6 space-y-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații CVT"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Număr CVT *"}),e("input",{type:"text",name:"cvt_number",value:N.cvt_number,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Numărul CVT",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Număr de Serie *"}),e("input",{type:"text",name:"serial_number",value:N.serial_number,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Serial number slot",required:!0}),e("p",{className:"text-xs text-slate-500",children:"Numărul de serie care leagă CVT-ul cu slot-ul din aplicație"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip CVT *"}),t("select",{name:"cvt_type",value:N.cvt_type,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0,children:[e("option",{value:"Periodică",children:"Periodică"}),e("option",{value:"Inițială",children:"Inițială"}),e("option",{value:"Reparație",children:"Reparație"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data CVT *"}),e("input",{type:"date",name:"cvt_date",value:N.cvt_date,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data expirării *"}),e("input",{type:"date",name:"expiry_date",value:N.expiry_date,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0,disabled:N.cvt_type==="Periodică"||N.cvt_type==="Inițială"}),N.cvt_type==="Periodică"||N.cvt_type==="Inițială"?e("p",{className:"text-xs text-slate-500",children:"Calculat automat: 1 an - 1 zi"}):e("p",{className:"text-xs text-slate-500",children:"Completează manual pentru Reparație"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Autoritatea emitentă"}),t("select",{name:"issuing_authority",value:N.issuing_authority,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează autoritatea emitentă"}),l.map(v=>e("option",{value:v.name,children:v.name},v.id))]})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații Dispozitiv"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor"}),t("select",{name:"provider",value:N.provider,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează furnizorul"}),o.map(v=>e("option",{value:v.name,children:v.name},v.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet"}),t("select",{name:"cabinet",value:N.cabinet,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!N.provider,children:[e("option",{value:"",children:N.provider?"Selectează cabinetul":"Selectează mai întâi furnizorul"}),E().map(v=>e("option",{value:v.name,children:v.name},v.id))]}),!N.provider&&e("p",{className:"text-xs text-slate-500",children:"Cabinetul depinde de furnizorul selectat"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix"}),t("select",{name:"game_mix",value:N.game_mix,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!N.provider,children:[e("option",{value:"",children:N.provider?"Selectează game mix-ul":"Selectează mai întâi furnizorul"}),P().map(v=>e("option",{value:v.name,children:v.name},v.id))]}),!N.provider&&e("p",{className:"text-xs text-slate-500",children:"Game mix-ul depinde de furnizorul selectat"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Aprobare de Tip"}),t("select",{name:"approval_type",value:N.approval_type,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!N.cabinet,children:[e("option",{value:"",children:N.cabinet?"Selectează aprobarea de tip":"Selectează mai întâi cabinetul"}),f().map(v=>e("option",{value:v.name,children:v.name},v.id))]}),!N.cabinet&&e("p",{className:"text-xs text-slate-500",children:"Aprobarea de tip depinde de cabinetul selectat"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Software"}),t("select",{name:"software",value:N.software,onChange:A,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!N.game_mix,children:[e("option",{value:"",children:N.game_mix?"Selectează software-ul":"Selectează mai întâi game mix-ul"}),R().map(v=>e("option",{value:v.name,children:v.name},v.id))]}),!N.game_mix&&e("p",{className:"text-xs text-slate-500",children:"Software-ul depinde de game mix-ul selectat"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Document CVT (PDF)"}),e("input",{type:"file",name:"cvtFile",accept:".pdf",onChange:D,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100"}),N.cvtPreview&&t("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(ht,{className:"w-5 h-5 text-cyan-600"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:typeof N.cvtPreview=="string"&&N.cvtPreview.includes("data:")?"Document CVT încărcat":"Document CVT existent"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF Document"})]})]}),e("button",{type:"button",onClick:U,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge documentul",children:e(ve,{className:"w-4 h-4"})})]}),e(kt,{pdfUrl:N.cvtPreview,title:`CVT Document ${N.cvt_number}`,placeholder:"Documentul CVT nu este disponibil",placeholderSubtext:"Atașează documentul CVT pentru vizualizare"})]}),e("p",{className:"text-xs text-slate-500",children:"Încărcați documentul CVT în format PDF"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:N.notes,onChange:A,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(Ht,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Certificat"]})]})]})]})})]})})},xo=({item:a,onClose:s})=>{if(!a)return null;const r=a.name&&a.serial_numbers,l=a.name&&(a.provider||a.cabinet)&&!a.serial_numbers&&!a.cvt_number;a.cvt_number,a.software_name,a.authority_name;const o=(()=>{if(!a.expiry_date)return null;const m=new Date,g=new Date(a.expiry_date)-m;return Math.ceil(g/(1e3*60*60*24))})(),i=()=>o===null?"text-slate-400":o<0?"text-red-600":o<=30?"text-orange-600":"text-green-600",c=()=>o===null?"N/A":o<0?`Expirat (${Math.abs(o)} zile)`:`${o} zile rămase`,x=(()=>!r||!a.serial_numbers?[]:typeof a.serial_numbers=="string"?a.serial_numbers.split(",").map(m=>m.trim()).filter(m=>m):Array.isArray(a.serial_numbers)?a.serial_numbers:[])();return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-3xl w-full max-w-6xl max-h-[90vh] overflow-hidden shadow-2xl",children:[t("div",{className:`px-6 py-4 flex justify-between items-center ${l?"bg-gradient-to-r from-green-500 to-emerald-500":r?"bg-gradient-to-r from-blue-500 to-indigo-500":"bg-gradient-to-r from-cyan-500 to-teal-500"}`,children:[t("h3",{className:"text-xl font-bold text-white flex items-center",children:[e(ge,{className:"w-6 h-6 mr-2"}),l?`Detalii Aprobare de Tip - ${a.name}`:r?`Detalii Comisie - ${a.name}`:`Detalii Certificat CVT - ${a.cvt_number}`]}),e("button",{onClick:s,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:e(ve,{className:"w-6 h-6"})})]}),e("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:l?t("div",{className:"space-y-6",children:[t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Informații Aprobare de Tip"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Numele Aprobării"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.name})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Furnizor"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.provider||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Cabinet"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.cabinet||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Game Mix"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:wt(a.game_mix_name||a.game_mix)})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Autoritate Emitentă"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.issuing_authority||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Creat de"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.created_by||"N/A"})]})]})]}),t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Checksums"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"MD5"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:a.checksum_md5||a.checksumMD5||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"SHA256"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:a.checksum_sha256||a.checksumSHA256||"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Note"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:a.notes})]})]}):r?t("div",{className:"space-y-6",children:[t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Informații Comisie"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Numele Comisiei"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.name})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Numărul de Sloturi"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:[x.length," sloturi"]})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Data Comisiei"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.commission_date?new Date(a.commission_date).toLocaleDateString("ro-RO"):"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Data Valabilității"}),t("p",{className:`font-semibold ${i()}`,children:[a.expiry_date?new Date(a.expiry_date).toLocaleDateString("ro-RO"):"N/A",o!==null&&t("span",{className:"ml-2 text-sm",children:["(",c(),")"]})]})]})]})]}),t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[t("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:["Detalii Sloturi (",x.length,")"]}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{children:t("tr",{className:"border-b border-slate-200 dark:border-slate-600",children:[e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Serial Number"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Furnizor"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Cabinet"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Game Mix"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Locație"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Factură"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Data CVT"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Data Comisie"})]})}),e("tbody",{children:x.map((m,d)=>t("tr",{className:"border-b border-slate-100 dark:border-slate-600",children:[e("td",{className:"py-2 text-sm text-slate-800 dark:text-slate-200 font-mono",children:m}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"})]},d))})]})}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"* Detaliile complete vor fi afișate când vor fi conectate cu baza de date de sloturi"})]})]}):t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-6",children:[t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Informații CVT"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Număr CVT"}),e("p",{className:"text-base font-medium text-slate-900",children:a.cvt_number})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Tip CVT"}),e("p",{className:"text-base font-medium text-slate-900",children:a.cvt_type})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Autoritatea Emitentă"}),e("p",{className:"text-base font-medium text-slate-900",children:a.issuing_authority||"N/A"})]})]})]}),t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Informații Dispozitiv"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Furnizor"}),e("p",{className:"text-base font-medium text-slate-900",children:a.provider||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Cabinet"}),e("p",{className:"text-base font-medium text-slate-900",children:a.cabinet||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Game Mix"}),e("p",{className:"text-base font-medium text-slate-900",children:wt(a.game_mix_name||a.game_mix)})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Aprobare de Tip"}),e("p",{className:"text-base font-medium text-slate-900",children:a.approval_type||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Software"}),e("p",{className:"text-base font-medium text-slate-900",children:a.software||"N/A"})]})]})]}),t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Date & Status"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Data CVT"}),t("p",{className:"text-base font-medium text-slate-900 flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2 text-cyan-500"}),a.cvt_date?new Date(a.cvt_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A"]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Data Expirării"}),t("p",{className:"text-base font-medium text-slate-900 flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2 text-orange-500"}),a.expiry_date?new Date(a.expiry_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A"]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Status"}),t("p",{className:`text-base font-bold flex items-center ${i()}`,children:[o!==null&&o>=0?e(bt,{className:"w-4 h-4 mr-2"}):e(lt,{className:"w-4 h-4 mr-2"}),c()]})]})]})]}),a.notes&&t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Note"}),e("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.notes})]})]}),t("div",{className:"space-y-4",children:[t("div",{className:"bg-slate-50 rounded-2xl p-6",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2 mb-4",children:"Document CVT"}),e(kt,{pdfUrl:a.cvtFile||null,title:"CVT Document",placeholder:"Nu există document CVT",placeholderSubtext:"Atașează documentul CVT pentru vizualizare"})]}),t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-3",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Informații Adiționale"}),t("div",{className:"space-y-2",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Creat de"}),e("p",{className:"text-base font-medium text-slate-900",children:a.created_by||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Data creării"}),e("p",{className:"text-base font-medium text-slate-900",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO"):"N/A"})]})]})]})]})]})})]})})},Ns=({item:a,onClose:s,onSave:r})=>{const{providers:l,cabinets:n,gameMixes:o}=ye(),[i,c]=h.useState([]),[u,x]=h.useState([]),[m,d]=h.useState({name:"",provider:"",cabinet:"",gameMix:"",software:"",issuingAuthority:"",checksumMD5:"",checksumSHA256:"",attachments:[],notes:""}),[g,_]=h.useState(!1);h.useEffect(()=>{(async()=>{try{const U=await(await fetch("/api/authorities")).json();c(Array.isArray(U)?U:[]);const v=await(await fetch("/api/software")).json();x(Array.isArray(v)?v:[])}catch(D){console.error("Error loading data:",D)}})(),a&&d({name:a.name||"",provider:a.provider||"",cabinet:a.cabinet||"",gameMix:a.game_mix||a.gameMix||"",software:a.software||"",issuingAuthority:a.issuing_authority||a.issuingAuthority||"",checksumMD5:a.checksum_md5||a.checksumMD5||"",checksumSHA256:a.checksum_sha256||a.checksumSHA256||"",attachments:a.attachments||[],notes:a.notes||""})},[a]);const p=A=>{const{name:D,value:U}=A.target;d(j=>{const v={...j,[D]:U};return D==="provider"&&(v.gameMix="",v.software=""),D==="cabinet"&&(v.software=""),v})},N=o.filter(A=>!(m.provider&&A.provider!==m.provider)),k=async A=>{if(!A||A.length===0)return;_(!0);const D=Array.from(A).map(async U=>{const j=new FormData;j.append("file",U);try{const v=await ae.post("/api/upload",j,{headers:{"Content-Type":"multipart/form-data"}});return{name:U.name,url:v.data.url,size:U.size,type:U.type}}catch(v){return console.error("Upload error:",v),$.error(`Eroare la upload pentru ${U.name}`),null}});try{const j=(await Promise.all(D)).filter(v=>v!==null);d(v=>({...v,attachments:[...v.attachments,...j]})),$.success(`${j.length} fișiere încărcate cu succes`)}catch{$.error("Eroare la încărcarea fișierelor")}finally{_(!1)}},E=A=>{A.preventDefault();const D=A.dataTransfer.files;k(D)},P=A=>{A.preventDefault()},f=A=>{d(D=>({...D,attachments:D.attachments.filter((U,j)=>j!==A)}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(ht,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează Aprobare de Tip":"Adaugă Aprobare de Tip"}),e("p",{className:"text-green-100",children:a?"Modifică datele aprobării":"Adaugă o aprobare de tip nouă"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:A=>{A.preventDefault();const D={name:m.name,provider:m.provider,cabinet:m.cabinet,game_mix:m.gameMix,software:m.software,issuing_authority:m.issuingAuthority,checksum_md5:m.checksumMD5,checksum_sha256:m.checksumSHA256,attachments:m.attachments,notes:m.notes};r(D)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:m.name,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introdu numele aprobării",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:m.provider,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),l.map(A=>e("option",{value:A.name,children:A.name},A.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet *"}),t("select",{name:"cabinet",value:m.cabinet,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează cabinetul"}),n.filter(A=>!m.provider||A.provider===m.provider).map(A=>e("option",{value:A.name,children:A.name},A.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix"}),t("select",{name:"gameMix",value:m.gameMix,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:!m.provider,children:[e("option",{value:"",children:"Selectează game mix-ul"}),N.map(A=>e("option",{value:A.name,children:A.name},A.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Software"}),t("select",{name:"software",value:m.software,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:!m.provider||!m.cabinet,children:[e("option",{value:"",children:"Selectează software-ul"}),u.filter(A=>(!m.provider||A.provider===m.provider)&&(!m.cabinet||A.cabinet===m.cabinet)).map(A=>t("option",{value:A.name,children:[A.name," - ",A.version]},A.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Autoritate emitentă"}),t("select",{name:"issuingAuthority",value:m.issuingAuthority,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează autoritatea"}),i.map(A=>e("option",{value:A.name,children:A.name},A.id))]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Checksum MD5"}),e("input",{type:"text",name:"checksumMD5",value:m.checksumMD5,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introdu checksum MD5"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Checksum SHA256"}),e("input",{type:"text",name:"checksumSHA256",value:m.checksumSHA256,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introdu checksum SHA256"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Atașamente"}),t("div",{onDrop:E,onDragOver:P,className:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-green-500 transition-colors",children:[e(ze,{className:"w-8 h-8 text-slate-400 mx-auto mb-2"}),e("p",{className:"text-slate-600 mb-2",children:"Trage și plasează fișierele aici sau"}),e("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:A=>k(A.target.files),className:"hidden",id:"file-upload"}),t("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 cursor-pointer transition-colors",children:[e(ze,{className:"w-4 h-4 mr-2"}),g?"Se încarcă...":"Selectează fișiere"]}),e("p",{className:"text-xs text-slate-500 mt-2",children:"Suportă: PDF, DOC, DOCX, JPG, PNG"})]}),m.attachments.length>0&&t("div",{className:"mt-4 space-y-2",children:[e("p",{className:"text-sm font-medium text-slate-700",children:"Fișiere atașate:"}),m.attachments.map((A,D)=>t("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t("div",{className:"flex items-center space-x-3",children:[e(ht,{className:"w-5 h-5 text-green-500"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-900",children:A.name}),t("p",{className:"text-xs text-slate-500",children:[(A.size/1024/1024).toFixed(2)," MB"]})]})]}),e("button",{type:"button",onClick:()=>f(D),className:"p-1 text-red-500 hover:text-red-700 transition-colors",children:e(je,{className:"w-4 h-4"})})]},D))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:m.notes,onChange:p,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Adaugă note suplimentare"})]}),t("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg hover:shadow-green-500/25",children:t("div",{className:"flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Salvează"})]})})]})]})]})})},bo=({item:a,onClose:s,onSave:r})=>{ye();const[l,n]=h.useState({name:"",serial_numbers:"",commission_date:"",expiry_date:"",notes:""});h.useEffect(()=>{if(a){const c=u=>{if(!u)return"";try{return new Date(u).toISOString().split("T")[0]}catch{return""}};n({name:a.name||"",serial_numbers:a.serial_numbers||"",commission_date:c(a.commission_date),expiry_date:c(a.expiry_date),notes:a.notes||""})}},[a]);const o=c=>{const{name:u,value:x}=c.target;if(n(m=>({...m,[u]:x})),u==="commission_date"&&x){const m=new Date(x),d=new Date(m);d.setFullYear(d.getFullYear()+1),d.setDate(d.getDate()-1),n(g=>({...g,expiry_date:d.toISOString().split("T")[0]}))}};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(Lt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează Comisie":"Adaugă Comisie"}),e("p",{className:"text-blue-100",children:a?"Modifică datele comisiei":"Adaugă o comisie nouă"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Introdu numele comisiei",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data Comisiei *"}),e("input",{type:"date",name:"commission_date",value:l.commission_date,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data Valabilității *"}),e("input",{type:"date",name:"expiry_date",value:l.expiry_date,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numerele de Serie *"}),e("textarea",{name:"serial_numbers",value:l.serial_numbers,onChange:o,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Introdu numerele de serie separate prin rânduri nouă",required:!0}),e("p",{className:"text-sm text-slate-500",children:"Separă numerele de serie prin rânduri nouă"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Adaugă note suplimentare"})]}),t("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-lg hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg hover:shadow-blue-500/25",children:t("div",{className:"flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Salvează"})]})})]})]})]})})},go=({item:a,onClose:s,onSave:r})=>{const{providers:l,cabinets:n,gameMixes:o,approvals:i}=ye(),[c,u]=h.useState({name:"",provider:"",cabinet:"",game_mix:"",approval:"",version:"",notes:""});h.useEffect(()=>{a&&u({name:a.name||"",provider:a.provider||"",cabinet:a.cabinet||"",game_mix:a.game_mix||"",approval:a.approval||"",version:a.version||"",notes:a.notes||""})},[a]);const x=d=>{const{name:g,value:_}=d.target;u(p=>{const N={...p,[g]:_};return g==="provider"?(N.cabinet="",N.game_mix=""):g==="cabinet"&&(N.game_mix=""),N})};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-purple-500 to-violet-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(sa,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează Software":"Adaugă Software"}),e("p",{className:"text-purple-100",children:a?"Modifică datele software-ului":"Adaugă un software nou"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:d=>{d.preventDefault(),r(c)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:c.name,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Introdu numele software-ului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Versiunea"}),e("input",{type:"text",name:"version",value:c.version,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ex: v1.0.0"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:c.provider,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),l.map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet *"}),t("select",{name:"cabinet",value:c.cabinet,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează cabinetul"}),n.filter(d=>!c.provider||d.provider===c.provider).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix *"}),t("select",{name:"game_mix",value:c.game_mix,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează game mix-ul"}),o.filter(d=>!(c.provider&&d.provider!==c.provider)).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Aprobare de Tip"}),t("select",{name:"approval",value:c.approval,onChange:x,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează aprobarea"}),i.filter(d=>!(c.provider&&d.provider!==c.provider||c.cabinet&&d.cabinet!==c.cabinet)).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:c.notes,onChange:x,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Adaugă note suplimentare"})]}),t("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-violet-500 text-white rounded-lg hover:from-purple-600 hover:to-violet-600 transition-all shadow-lg hover:shadow-purple-500/25",children:t("div",{className:"flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Salvează"})]})})]})]})]})})},fo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",address:"",price_initiala:"",price_reparatie:"",price_periodica:"",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",address:a.address||"",price_initiala:a.price_initiala||"",price_reparatie:a.price_reparatie||"",price_periodica:a.price_periodica||"",notes:a.notes||""})},[a]);const o=c=>{const{name:u,value:x}=c.target;n(m=>({...m,[u]:x}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[t("div",{className:"relative bg-gradient-to-r from-orange-500 to-red-500 p-8 text-white",children:[t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm",children:e(ht,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Autoritatea Emitentă":"Adaugă Autoritate Emitentă"}),e("p",{className:"text-orange-100 text-sm font-medium",children:"Completează informațiile despre autoritatea emitentă"})]})]}),e("button",{onClick:s,className:"absolute top-4 right-4 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații de bază"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Numele autorității",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Adresa"}),e("input",{type:"text",name:"address",value:l.address,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Adresa autorității"})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Prețuri (opțional)"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Preț Inițială (LEI)"}),e("input",{type:"number",name:"price_initiala",value:l.price_initiala,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0",min:"0",step:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Preț Reparație (LEI)"}),e("input",{type:"number",name:"price_reparatie",value:l.price_reparatie,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0",min:"0",step:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Preț Periodică (LEI)"}),e("input",{type:"number",name:"price_periodica",value:l.price_periodica,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0",min:"0",step:"0.01"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[t("button",{type:"button",onClick:s,className:"btn-secondary",children:[e(ve,{className:"w-4 h-4"}),"Anulează"]}),t("button",{type:"submit",className:"btn-primary",children:[e(qt,{className:"w-4 h-4"}),a?"Actualizează":"Adaugă"," Autoritate"]})]})]})})]})})},No=({isOpen:a,onClose:s})=>{const[r,l]=h.useState([]),[n,o]=h.useState(!1),[i,c]=h.useState(null),[u,x]=h.useState(new Date().getMonth()),[m,d]=h.useState(new Date().getFullYear()),g=["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],_=[{id:1,title:"Comisia de Autorizare - Sloturi Electronice",date:"2025-10-15",time:"09:00",location:"București, Bd. Magheru 28-30",type:"Autorizare",status:"Programată",description:"Examinarea cererilor de autorizare pentru sloturi electronice"},{id:2,title:"Comisia de Metrologie - Verificare CVT",date:"2025-10-22",time:"10:30",location:"București, Bd. Magheru 28-30",type:"Metrologie",status:"Programată",description:"Verificarea certificatelor de verificare tehnică"},{id:3,title:"Comisia de Control - Inspecții Teren",date:"2025-11-05",time:"08:00",location:"Cluj-Napoca, Str. Memorandumului 28",type:"Control",status:"Programată",description:"Inspecții de control la operatorii de jocuri de noroc"},{id:4,title:"Comisia de Autorizare - Licențe",date:"2025-11-12",time:"14:00",location:"București, Bd. Magheru 28-30",type:"Autorizare",status:"Programată",description:"Examinarea cererilor de licențiere pentru operatori"}];h.useEffect(()=>{a&&p()},[a,u,m]);const p=async()=>{o(!0),c(null);try{await new Promise(R=>setTimeout(R,1e3));const f=_.filter(R=>{const A=new Date(R.date);return A.getMonth()===u&&A.getFullYear()===m});l(f)}catch(f){c("Eroare la încărcarea calendarului ONJN"),console.error("Error loading ONJN calendar:",f)}finally{o(!1)}},N=f=>{switch(f){case"Programată":return"bg-blue-100 text-blue-800";case"În desfășurare":return"bg-yellow-100 text-yellow-800";case"Finalizată":return"bg-green-100 text-green-800";case"Anulată":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=f=>{switch(f){case"Autorizare":return"bg-purple-100 text-purple-800";case"Metrologie":return"bg-indigo-100 text-indigo-800";case"Control":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},E=f=>new Date(f).toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit",year:"numeric"}),P=f=>f;return a?e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[e("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-xl",children:e(Me,{className:"w-6 h-6"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Calendar ONJN"}),e("p",{className:"text-blue-100",children:"Comisiile organizate de Oficiul Național pentru Jocuri de Noroc"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6"})})]})}),e("div",{className:"p-6 border-b border-gray-200",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Luna:"}),e("select",{value:u,onChange:f=>x(parseInt(f.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:g.map((f,R)=>e("option",{value:R,children:f},R))})]}),t("div",{className:"flex items-center space-x-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Anul:"}),e("select",{value:m,onChange:f=>d(parseInt(f.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[2024,2025,2026].map(f=>e("option",{value:f,children:f},f))})]})]}),t("button",{onClick:p,disabled:n,className:"btn-secondary flex items-center space-x-2",children:[e(ut,{className:`w-4 h-4 ${n?"animate-spin":""}`}),e("span",{children:"Actualizează"})]})]})}),e("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:n?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i?e("div",{className:"flex items-center justify-center py-12",children:t("div",{className:"text-center",children:[e(lt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Eroare la încărcare"}),e("p",{className:"text-gray-500 mb-4",children:i}),e("button",{onClick:p,className:"btn-primary",children:"Încearcă din nou"})]})}):r.length===0?t("div",{className:"text-center py-12",children:[e(Me,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Nu există comisii programate"}),t("p",{className:"text-gray-500",children:["Pentru luna ",g[u]," ",m]})]}):e("div",{className:"space-y-4",children:r.map(f=>e("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:t("div",{className:"flex items-start justify-between",children:[t("div",{className:"flex-1",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:f.title}),e("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${k(f.type)}`,children:f.type}),e("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${N(f.status)}`,children:f.status})]}),e("p",{className:"text-gray-600 mb-4",children:f.description}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{className:"flex items-center space-x-2 text-gray-600",children:[e(Me,{className:"w-4 h-4"}),e("span",{className:"text-sm font-medium",children:E(f.date)})]}),t("div",{className:"flex items-center space-x-2 text-gray-600",children:[e(dt,{className:"w-4 h-4"}),e("span",{className:"text-sm font-medium",children:P(f.time)})]}),t("div",{className:"flex items-center space-x-2 text-gray-600",children:[e(Fe,{className:"w-4 h-4"}),e("span",{className:"text-sm font-medium",children:f.location})]})]})]}),e("button",{onClick:()=>window.open("https://onjn.gov.ro/structura-organizatorica/autorizare/","_blank"),className:"ml-4 p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Vezi pe site-ul ONJN",children:e(Yt,{className:"w-5 h-5"})})]})},f.id))})}),e("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:t("div",{className:"flex items-center justify-between",children:[e("div",{className:"text-sm text-gray-500",children:"Datele sunt preluate de pe site-ul oficial ONJN"}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>window.open("https://onjn.gov.ro/structura-organizatorica/autorizare/","_blank"),className:"btn-secondary flex items-center space-x-2",children:[e(Yt,{className:"w-4 h-4"}),e("span",{children:"Site ONJN"})]}),e("button",{onClick:s,className:"btn-primary",children:"Închide"})]})]})})]})}):null},vo=()=>{const{metrology:a,approvals:s,providers:r,cabinets:l,gameMixes:n,loading:o,createItem:i,updateItem:c,deleteItem:u,exportToExcel:x,exportToPDF:m}=ye(),d=Ye(),[g,_]=h.useState(""),[p,N]=h.useState([]),[k,E]=h.useState(!1),[P,f]=h.useState(null),[R,A]=h.useState(!1),[D,U]=h.useState(null),[j,v]=h.useState(!1),[z,S]=h.useState(null),[F,I]=h.useState([]),[b,y]=h.useState([]),[L,Y]=h.useState([]),[O,G]=h.useState(!1),[C,W]=h.useState(!1),[T,Z]=h.useState(!1),[se,ne]=h.useState(!1),[ce,Ce]=h.useState(null),[Re,Ue]=h.useState(null),[Ve,et]=h.useState(null),[qe,$e]=h.useState(null),[Ze,Q]=h.useState(!1);h.useEffect(()=>{E(p.length>0)},[p]),h.useEffect(()=>{P&&(async()=>{try{if(P==="commissions"){const V=await(await fetch("/api/commissions")).json();I(V)}else if(P==="software"){const V=await(await fetch("/api/software")).json();y(V)}else if(P==="authorities"){const V=await(await fetch("/api/authorities")).json();Y(V)}}catch(w){console.error("Error loading sub-page data:",w)}})()},[P]);const de=a.filter(M=>{var V,K,we;return((V=M.serial_number)==null?void 0:V.toLowerCase().includes(g.toLowerCase()))||((K=M.provider)==null?void 0:K.toLowerCase().includes(g.toLowerCase()))||((we=M.cabinet)==null?void 0:we.toLowerCase().includes(g.toLowerCase()))}),ue=M=>{N(M?de.map(w=>w.id):[])},pe=(M,w)=>{N(w?[...p,M]:p.filter(V=>V!==M))},Ae=()=>{U(null),A(!0)},ee=M=>{U(M),A(!0)},me=async M=>{window.confirm("Sigur vrei să ștergi acest element?")&&await u("metrology",M.id)},fe=async M=>{D?await c("metrology",D.id,M):await i("metrology",M),A(!1),U(null)},ie=async M=>{try{ce?await c("approvals",ce.id,M):await i("approvals",M),G(!1),Ce(null)}catch(w){console.error("Error saving approval:",w)}},le=async M=>{try{const w=Re?`/api/commissions/${Re.id}`:"/api/commissions";if((await fetch(w,{method:Re?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok){W(!1),Ue(null);const Le=await(await fetch("/api/commissions")).json();I(Le)}}catch(w){console.error("Error saving commission:",w)}},be=async M=>{try{const w=Ve?`/api/software/${Ve.id}`:"/api/software";if((await fetch(w,{method:Ve?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok){Z(!1),et(null);const Le=await(await fetch("/api/software")).json();y(Le)}}catch(w){console.error("Error saving software:",w)}};h.useState(!1),h.useState(null);const te=async M=>{try{if((await fetch("/api/authorities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok){const K=await(await fetch("/api/authorities")).json();Y(K),ne(!1)}}catch(w){console.error("Error saving authority:",w)}},oe=[{key:"cvt_number",label:"NUMĂR CVT",sortable:!0,render:M=>e("button",{onClick:()=>{S(M),v(!0)},className:"text-cyan-600 hover:text-cyan-800 font-semibold hover:underline transition-colors",children:M.cvt_number})},{key:"cvt_type",label:"TIP CVT",sortable:!0},{key:"approval_type",label:"APROBARE DE TIP",sortable:!0},{key:"software",label:"SOFTWARE",sortable:!0},{key:"cvt_dates_combined",label:"DATE CVT & EXPIRARE",sortable:!0,render:M=>{const w=M.cvt_date?new Date(M.cvt_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",V=M.expiry_date?new Date(M.expiry_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A";let K="N/A",we="text-green-600 bg-green-50";if(M.expiry_date){const Le=new Date,Be=new Date(M.expiry_date)-Le,nt=Math.ceil(Be/(1e3*60*60*24));nt<0?(we="text-red-600 bg-red-50",K=`Expirat (${Math.abs(nt)} zile)`):nt<=30?(we="text-orange-600 bg-orange-50",K=`${nt} zile`):(we="text-green-600 bg-green-50",K=`${nt} zile`)}return t("div",{className:"space-y-2",children:[t("div",{className:"text-slate-600 text-sm space-y-1",children:[t("div",{children:["CVT: ",w]}),t("div",{children:["Expirare: ",V]})]}),K!=="N/A"&&e("div",{className:`text-sm ${we.split(" ")[0]}`,children:K})]})}},{key:"issuing_authority",label:"AUTORITATEA EMITENTĂ",sortable:!0},{key:"cvtFile",label:"DOCUMENT CVT",sortable:!1,render:M=>e("div",{className:"flex items-center justify-center",children:M.cvtFile?e("button",{onClick:()=>window.open(M.cvtFile,"_blank"),className:"p-2 bg-cyan-50 hover:bg-cyan-100 dark:bg-cyan-900/20 dark:hover:bg-cyan-900/30 text-cyan-600 dark:text-cyan-400 rounded-lg transition-colors",title:"Vizualizează documentul CVT",children:e(Qe,{className:"w-5 h-5"})}):e("span",{className:"text-slate-400 text-sm",children:"-"})})},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Se=[{key:"approval_number",label:"NUMĂR APROBARE",sortable:!0,render:M=>e("button",{onClick:()=>d(`/approval-detail/${M.id}`),className:"text-blue-600 hover:text-blue-800 font-semibold hover:underline transition-colors",children:M.approval_number})},{key:"approval_type",label:"TIP APROBARE",sortable:!0},{key:"provider",label:"FURNIZOR",sortable:!0},{key:"cabinet",label:"CABINET",sortable:!0},{key:"approval_date",label:"DATA APROBARE",sortable:!0,render:M=>e("div",{className:"text-slate-600",children:M.approval_date?new Date(M.approval_date).toLocaleDateString("ro-RO"):"N/A"})},{key:"expiry_date",label:"DATA EXPIRARE",sortable:!0,render:M=>{if(!M.expiry_date)return e("span",{className:"text-slate-400",children:"N/A"});const w=new Date(M.expiry_date),K=w-new Date,we=Math.ceil(K/(1e3*60*60*24));let Le="text-green-600";return we<0?Le="text-red-600":we<=30&&(Le="text-orange-600"),e("div",{className:Le,children:w.toLocaleDateString("ro-RO")})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Pe=[{key:"commission_number",label:"NUMĂR COMISIE",sortable:!0},{key:"members",label:"MEMBRI",sortable:!1,render:M=>{const w=M.members?typeof M.members=="string"?M.members.split(","):M.members:[];return e("div",{className:"text-sm",children:w.length>0?w.join(", "):"N/A"})}},{key:"date_formed",label:"DATA FORMARE",sortable:!0,render:M=>e("div",{className:"text-slate-600",children:M.date_formed?new Date(M.date_formed).toLocaleDateString("ro-RO"):"N/A"})},{key:"status",label:"STATUS",sortable:!0},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Ee=[{key:"software_name",label:"NUME SOFTWARE",sortable:!0},{key:"version",label:"VERSIUNE",sortable:!0},{key:"provider",label:"FURNIZOR",sortable:!0},{key:"release_date",label:"DATA LANSARE",sortable:!0,render:M=>e("div",{className:"text-slate-600",children:M.release_date?new Date(M.release_date).toLocaleDateString("ro-RO"):"N/A"})},{key:"status",label:"STATUS",sortable:!0},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],B=[{key:"authority_name",label:"NUME AUTORITATE",sortable:!0},{key:"contact_person",label:"PERSOANĂ CONTACT",sortable:!0},{key:"contact_email",label:"EMAIL",sortable:!0},{key:"contact_phone",label:"TELEFON",sortable:!0},{key:"address",label:"ADRESĂ",sortable:!0},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];if(!P)return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-2xl shadow-lg shadow-cyan-500/25",children:e(Ht,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Metrologie"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare certificate și verificări tehnice"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>Q(!0),className:"btn-secondary flex items-center space-x-2",children:[e(Me,{className:"w-4 h-4"}),e("span",{children:"Calendar ONJN"})]}),t("button",{onClick:Ae,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă CVT"})]})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>f(null),className:"px-4 py-2 bg-cyan-100 text-cyan-700 rounded-lg font-medium whitespace-nowrap",children:"CVT-uri"}),e("button",{onClick:()=>f("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>f("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>f("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>f("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după număr CVT, furnizor, cabinet...",value:g,onChange:M=>_(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e(ft,{data:de,filename:"metrology",onExportExcel:()=>x(de,"metrology"),onExportPDF:()=>m(de,"metrology")})]})}),e("div",{className:"card p-6",children:o?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"})}):de.length===0?t("div",{className:"text-center py-12",children:[e(Ht,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există certificate"}),e("p",{className:"text-slate-500",children:"Adaugă primul certificat pentru a începe"})]}):e(He,{data:de,columns:oe,onEdit:ee,onDelete:me,searchTerm:g,selectedItems:p,onSelectAll:ue,onSelectItem:pe,moduleColor:"cyan"})}),R&&e(po,{item:D,onClose:()=>{A(!1),U(null)},onSave:fe,providers:r,cabinets:l,gameMixes:n}),j&&e(xo,{item:z,onClose:()=>{v(!1),S(null)}}),Ze&&e(No,{onClose:()=>Q(!1)})]})});if(P==="approvals")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>f(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(ht,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Aprobări de Tip"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare aprobări echipamente"})]})]}),t("button",{onClick:()=>{Ce(null),G(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Aprobare"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>f(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>f("approvals"),className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg font-medium whitespace-nowrap",children:"Aprobări"}),e("button",{onClick:()=>f("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>f("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>f("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:o?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):s.length===0?t("div",{className:"text-center py-12",children:[e(ht,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există aprobări"}),e("p",{className:"text-slate-500",children:"Adaugă prima aprobare pentru a începe"})]}):e(He,{data:s,columns:Se,onEdit:M=>{Ce(M),G(!0)},onDelete:async M=>{window.confirm("Sigur vrei să ștergi această aprobare?")&&await u("approvals",M.id)},moduleColor:"blue"})}),O&&e(Ns,{item:ce,onClose:()=>{G(!1),Ce(null)},onSave:ie,providers:r,cabinets:l})]})});if(P==="commissions")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>f(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(xt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Comisii Metrologie"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare comisii de verificare"})]})]}),t("button",{onClick:()=>{Ue(null),W(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Comisie"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>f(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>f("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>f("commissions"),className:"px-4 py-2 bg-purple-100 text-purple-700 rounded-lg font-medium whitespace-nowrap",children:"Comisii"}),e("button",{onClick:()=>f("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>f("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:o?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):F.length===0?t("div",{className:"text-center py-12",children:[e(xt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există comisii"}),e("p",{className:"text-slate-500",children:"Adaugă prima comisie pentru a începe"})]}):e(He,{data:F,columns:Pe,onEdit:M=>{Ue(M),W(!0)},onDelete:async M=>{if(window.confirm("Sigur vrei să ștergi această comisie?")&&(await fetch(`/api/commissions/${M.id}`,{method:"DELETE"})).ok){const K=await(await fetch("/api/commissions")).json();I(K)}},moduleColor:"purple"})}),C&&e(bo,{item:Re,onClose:()=>{W(!1),Ue(null)},onSave:le})]})});if(P==="software")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>f(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-lg shadow-green-500/25",children:e(Lt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Software Jocuri"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare versiuni software"})]})]}),t("button",{onClick:()=>{et(null),Z(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Software"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>f(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>f("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>f("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>f("software"),className:"px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium whitespace-nowrap",children:"Software"}),e("button",{onClick:()=>f("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:o?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"})}):b.length===0?t("div",{className:"text-center py-12",children:[e(Lt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există software"}),e("p",{className:"text-slate-500",children:"Adaugă primul software pentru a începe"})]}):e(He,{data:b,columns:Ee,onEdit:M=>{et(M),Z(!0)},onDelete:async M=>{if(window.confirm("Sigur vrei să ștergi acest software?")&&(await fetch(`/api/software/${M.id}`,{method:"DELETE"})).ok){const K=await(await fetch("/api/software")).json();y(K)}},moduleColor:"green"})}),T&&e(go,{item:Ve,onClose:()=>{Z(!1),et(null)},onSave:be,providers:r})]})});if(P==="authorities")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>f(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl shadow-lg shadow-orange-500/25",children:e(sa,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Autorități Metrologie"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare autorități de verificare"})]})]}),t("button",{onClick:()=>{$e(null),ne(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Autoritate"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>f(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>f("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>f("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>f("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>f("authorities"),className:"px-4 py-2 bg-orange-100 text-orange-700 rounded-lg font-medium whitespace-nowrap",children:"Autorități"})]})}),e("div",{className:"card p-6",children:o?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):L.length===0?t("div",{className:"text-center py-12",children:[e(sa,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există autorități"}),e("p",{className:"text-slate-500",children:"Adaugă prima autoritate pentru a începe"})]}):e(He,{data:L,columns:B,onEdit:M=>{$e(M),ne(!0)},onDelete:async M=>{if(window.confirm("Sigur vrei să ștergi această autoritate?")&&(await fetch(`/api/authorities/${M.id}`,{method:"DELETE"})).ok){const K=await(await fetch("/api/authorities")).json();Y(K)}},moduleColor:"orange"})}),se&&e(fo,{item:qe,onClose:()=>{ne(!1),$e(null)},onSave:te})]})})},yo=()=>{const{id:a}=It(),s=Ye(),{approvals:r,providers:l,cabinets:n,gameMixes:o,updateItem:i,deleteItem:c}=ye(),[u,x]=h.useState(null),[m,d]=h.useState(!0),[g,_]=h.useState(!1),[p,N]=h.useState(!1),[k,E]=h.useState(!1),[P,f]=h.useState(!0),[R,A]=h.useState([]);h.useEffect(()=>{const F=r.find(I=>I.id===parseInt(a));if(F){if(x(F),F.attachments)try{const I=typeof F.attachments=="string"?JSON.parse(F.attachments):F.attachments;A(Array.isArray(I)?I:[])}catch{A([])}d(!1)}else $.error("Aprobarea nu a fost găsită"),s("/approvals")},[a,r,s]);const D=async()=>{try{await c("approvals",u.id),$.success("Aprobarea a fost ștearsă cu succes"),s("/approvals")}catch{$.error("Eroare la ștergerea aprobării")}},U=async F=>{try{await i("approvals",u.id,F),$.success("Aprobarea a fost actualizată cu succes"),N(!1),x({...u,...F})}catch{$.error("Eroare la actualizarea aprobării")}},j=async F=>{const I=Array.from(F.target.files);for(const b of I){const y=new FormData;y.append("file",b),y.append("entityType","approval"),y.append("entityId",u.id.toString());try{const L=await fetch("/api/upload",{method:"POST",body:y});if(L.ok){const Y=await L.json(),O={id:Date.now()+Math.random(),name:b.name,size:b.size,type:b.type,url:Y.fileUrl,uploaded:!0},G=[...R,O];A(G),await i("approvals",u.id,{attachments:JSON.stringify(G)}),$.success(`${b.name} încărcat cu succes`)}else $.error(`Eroare la încărcarea ${b.name}`)}catch{$.error(`Eroare la încărcarea ${b.name}`)}}},v=async F=>{const I=R.filter(b=>b.id!==F);A(I);try{await i("approvals",u.id,{attachments:JSON.stringify(I)}),$.success("Atașament șters")}catch{$.error("Eroare la ștergerea atașamentului")}},z=F=>{const I=l.find(b=>b.id===F||b.name===F);return I?I.name:F},S=F=>{const I=n.find(b=>b.id===F||b.name===F);return I?I.name:F};return m?e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă..."})]})})}):u?t(he,{children:[e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 mb-6",children:[e("div",{className:"bg-gradient-to-r from-emerald-800 via-green-800 to-teal-800 px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("button",{onClick:()=>s("/approvals"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(tt,{className:"w-5 h-5 text-white"})}),e("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h1",{className:"text-2xl font-bold text-white",children:u.name}),t("p",{className:"text-emerald-100",children:[u.provider," | ",u.cabinet]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>E(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Setări",children:e(Lt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>N(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Editează",children:e(at,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>_(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Șterge",children:e(je,{className:"w-5 h-5 text-white"})})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-6",children:[t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(_e,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Furnizor"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:z(u.provider)||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(sa,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Cabinet"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:S(u.cabinet)||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(At,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Game Mix"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:so(u.game_mix_name||u.game_mix,o)})]}),t("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-4 rounded-lg border border-amber-200 dark:border-amber-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(bt,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Autoritate"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:u.issuing_authority||"N/A"})]})]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"lg:col-span-2 space-y-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(bt,{className:"w-5 h-5 mr-2 text-blue-500"}),"Checksums"]}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"MD5"}),e("div",{className:"mt-1 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:u.checksum_md5||"N/A"})})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"SHA256"}),e("div",{className:"mt-1 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:u.checksum_sha256||"N/A"})})]})]})]}),u.notes&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-green-500"}),"Note"]}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.notes})]})]}),t("div",{className:"space-y-6",children:[P&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ze,{className:"w-5 h-5 mr-2 text-blue-500"}),"Atașamente"]}),t("div",{className:"space-y-4",children:[t("label",{className:"block",children:[e("input",{type:"file",multiple:!0,onChange:j,className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),t("div",{className:"w-full p-4 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg hover:border-green-500 transition-colors cursor-pointer text-center",children:[e(ze,{className:"w-8 h-8 text-slate-400 mx-auto mb-2"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Apasă pentru a adăuga fișiere"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-500",children:"PDF, DOC, JPG, PNG"})]})]}),R.length>0&&e("div",{className:"space-y-2",children:R.map(F=>t("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[t("div",{className:"flex items-center space-x-3 flex-1",children:[e(ge,{className:"w-4 h-4 text-slate-500"}),t("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 truncate",children:F.name}),t("p",{className:"text-xs text-slate-500 dark:text-slate-500",children:[(F.size/1024).toFixed(1)," KB"]})]})]}),t("div",{className:"flex items-center space-x-2",children:[F.url&&e("a",{href:F.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 transition-colors",children:e(We,{className:"w-4 h-4"})}),e("button",{onClick:()=>v(F.id),className:"text-red-500 hover:text-red-700 transition-colors",children:e(je,{className:"w-4 h-4"})})]})]},F.id))})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Metadata"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Creat de"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.created_by||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Creat la"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.created_at?new Date(u.created_at).toLocaleString("ro-RO"):"N/A"})]}),u.updated_at&&t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Actualizat la"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:new Date(u.updated_at).toLocaleString("ro-RO")})]})]})]})]})]})]})}),g&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-md p-6",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-lg",children:e(lt,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Confirmă ștergerea"})]}),t("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:['Ești sigur că vrei să ștergi aprobarea "',u.name,'"? Această acțiune nu poate fi anulată.']}),t("div",{className:"flex space-x-3",children:[e("button",{onClick:()=>_(!1),className:"flex-1 px-4 py-2 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"Anulează"}),e("button",{onClick:D,className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Șterge"})]})]})}),p&&e(Ns,{item:u,onClose:()=>N(!1),onSave:U}),k&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-md p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Vizualizare"}),e("button",{onClick:()=>E(!1),className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e(lt,{className:"w-5 h-5"})})]}),e("div",{className:"space-y-4",children:t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-slate-700 dark:text-slate-300",children:"Afișează Atașamente"}),e("button",{onClick:()=>{f(!P)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${P?"bg-green-600":"bg-slate-300 dark:bg-slate-600"}`,children:e("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${P?"translate-x-6":"translate-x-1"}`})})]})}),e("div",{className:"mt-6 flex justify-end",children:e("button",{onClick:()=>E(!1),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Închide"})})]})})]}):e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e(lt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Aprobarea nu a fost găsită"}),e("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Aprobarea pe care o căutați nu există sau a fost ștearsă."}),e("button",{onClick:()=>s("/approvals"),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-colors",children:"Înapoi la Metrologie"})]})})})},wo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({serial_number:"",jackpot_name:"",jackpot_type:"Progressive",current_amount:0,max_amount:"",progress_percentage:0,status:"Active",winner:"",triggered_date:"",notes:""});h.useEffect(()=>{a&&n({serial_number:a.serial_number||"",jackpot_name:a.jackpot_name||"",jackpot_type:a.jackpot_type||"Progressive",current_amount:a.current_amount||0,max_amount:a.max_amount||"",progress_percentage:a.progress_percentage||0,status:a.status||"Active",winner:a.winner||"",triggered_date:a.triggered_date||"",notes:a.notes||""})},[a]);const o=c=>{const{name:u,value:x}=c.target;n(m=>({...m,[u]:x}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-yellow-800 to-amber-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-600/20 to-amber-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-2xl shadow-lg",children:e(Gt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Jackpot":"Adaugă Jackpot Nou"}),e("p",{className:"text-yellow-100 text-sm font-medium",children:"Completează informațiile despre jackpot"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații de bază"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numărul de serie *"}),e("input",{type:"text",name:"serial_number",value:l.serial_number,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Serial number slot",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Jackpot *"}),e("input",{type:"text",name:"jackpot_name",value:l.jackpot_name,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"ex: Mega Jackpot",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip Jackpot"}),t("select",{name:"jackpot_type",value:l.jackpot_type,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[e("option",{value:"Progressive",children:"Progresiv"}),e("option",{value:"Fixed",children:"Fix"}),e("option",{value:"Mystery",children:"Mystery"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status"}),t("select",{name:"status",value:l.status,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Triggered",children:"Declanșat"}),e("option",{value:"Reset",children:"Resetat"}),e("option",{value:"Maintenance",children:"Mentenanță"})]})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații financiare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Suma curentă"}),e("input",{type:"number",step:"0.01",name:"current_amount",value:l.current_amount,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Suma maximă"}),e("input",{type:"number",step:"0.01",name:"max_amount",value:l.max_amount,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"1000000.00"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Progres (%)"}),e("input",{type:"number",step:"0.01",name:"progress_percentage",value:l.progress_percentage,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații câștigător"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Câștigător"}),e("input",{type:"text",name:"winner",value:l.winner,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Numele câștigătorului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data declanșării"}),e("input",{type:"datetime-local",name:"triggered_date",value:l.triggered_date,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Note adiționale despre jackpot..."})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(Gt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Jackpot"]})]})]})]})})]})})},ko=()=>{const{jackpots:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:o,exportToPDF:i}=ye(),[c,u]=h.useState(""),[x,m]=h.useState([]),[d,g]=h.useState(!1);h.useEffect(()=>{g(x.length>0)},[x]);const _=I=>{m(I?A.map(b=>b.id):[])},p=(I,b)=>{m(b?[...x,I]:x.filter(y=>y!==I))},N=async()=>{if(x.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${x.length} elemente?`))try{for(const I of x)await n("jackpots",I);m([]),g(!1)}catch(I){console.error("Error bulk deleting:",I)}},k=()=>{x.length!==0&&console.log("Bulk edit for:",x)},[E,P]=h.useState(!1),[f,R]=h.useState(null),A=a.filter(I=>{var b,y,L;return((b=I.name)==null?void 0:b.toLowerCase().includes(c.toLowerCase()))||((y=I.game)==null?void 0:y.toLowerCase().includes(c.toLowerCase()))||((L=I.location)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))}),D=[{key:"id",label:"#",sortable:!0},{key:"name",label:"NUME JACKPOT",sortable:!0},{key:"game",label:"JOC",sortable:!0},{key:"amount",label:"SUMA",sortable:!0},{key:"location",label:"LOCAȚIE",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"created_by",label:"CREAT DE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_at?new Date(I.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"actions",label:"ACȚIUNI",sortable:!1}],U=I=>{R(I),P(!0)},j=async I=>{window.confirm("Sigur vrei să ștergi acest jackpot?")&&await n("jackpots",I)},v=()=>{R(null),P(!0)},z=async I=>{f?await l("jackpots",f.id,I):await r("jackpots",I),P(!1),R(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-2xl shadow-lg shadow-yellow-500/25",children:e(Gt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Jackpots"}),e("p",{className:"text-slate-600",children:"Gestionează jackpot-urile din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{o("jackpots")}catch(I){console.error("Error exporting to Excel:",I)}},onExportPDF:()=>{try{i("jackpots")}catch(I){console.error("Error exporting to PDF:",I)}},entity:"jackpots"}),d&&t(De,{children:[t("button",{onClick:k,className:"btn-secondary flex items-center space-x-2",children:[e(Edit,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:N,className:"btn-danger flex items-center space-x-2",children:[e(Trash2,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:v,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Jackpot"})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută jackpot-uri...",value:c,onChange:I=>u(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500"})}):A.length===0?t("div",{className:"text-center py-12",children:[e(Gt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există jackpot-uri"}),e("p",{className:"text-slate-500",children:"Adaugă primul jackpot pentru a începe"})]}):e(He,{data:A,columns:D,onEdit:U,onDelete:j,searchTerm:c,selectedItems:x,onSelectAll:_,onSelectItem:p,moduleColor:"blue"})}),E&&e(wo,{item:f,onClose:()=>P(!1),onSave:z})]})})},Co=({item:a,onClose:s,onSave:r})=>{const{companies:l,locations:n,providers:o}=ye(),[i,c]=h.useState({invoice_number:"",serial_numbers:"",buyer:"",seller:"",type:"Sale",amount:"",currency:"RON",rates:"",locations:[],pdf_file:null});h.useEffect(()=>{a&&c({invoice_number:a.invoice_number||"",serial_numbers:a.serial_number?typeof a.serial_number=="string"?JSON.parse(a.serial_number).join(`
`):a.serial_number.join(`
`):"",buyer:a.company||"",seller:a.seller||"",type:a.invoice_type||"Sale",amount:a.amount||"",currency:a.currency||"RON",rates:a.rates||"",locations:a.location?typeof a.location=="string"?JSON.parse(a.location):a.location:[],pdf_file:a.pdf_file||null})},[a]);const u=m=>{const{name:d,value:g,type:_,checked:p,files:N}=m.target;_==="checkbox"?d==="location"&&c(k=>({...k,locations:p?[...k.locations,g]:k.locations.filter(E=>E!==g)})):c(_==="file"?k=>({...k,[d]:N[0]||null}):k=>({...k,[d]:g}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-indigo-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(js,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Factură":"Adaugă Factură Nouă"}),e("p",{className:"text-blue-100 text-sm font-medium",children:"Completează informațiile despre factură"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault();const d=new FormData;Object.keys(i).forEach(g=>{g==="locations"?d.append(g,JSON.stringify(i[g])):g==="pdf_file"?i[g]&&d.append(g,i[g]):d.append(g,i[g])}),r(d)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Număr Factură *"}),e("input",{type:"text",name:"invoice_number",value:i.invoice_number,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ex: INV-2024-001",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Serii"}),e("textarea",{name:"serial_numbers",value:i.serial_numbers,onChange:u,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Introduceți seriile, câte una pe rând"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cumpărător *"}),t("select",{name:"buyer",value:i.buyer,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează compania"}),l==null?void 0:l.map(m=>e("option",{value:m.name,children:m.name},m.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Vânzător *"}),t("select",{name:"seller",value:i.seller,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),o==null?void 0:o.map(m=>e("option",{value:m.name,children:m.name},m.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip *"}),t("select",{name:"type",value:i.type,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e("option",{value:"Sale",children:"Vânzare"}),e("option",{value:"Rental",children:"Chirie"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Suma *"}),e("input",{type:"number",name:"amount",value:i.amount,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",step:"0.01",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Valută"}),t("select",{name:"currency",value:i.currency,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e("option",{value:"RON",children:"RON"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Rate (opțional)"}),e("input",{type:"text",name:"rates",value:i.rates,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ex: 3 rate de 1000 RON"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"PDF Factură *"}),e("input",{type:"file",name:"pdf_file",onChange:u,accept:".pdf",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),i.pdf_file&&t("p",{className:"text-sm text-green-600",children:["Fișier selectat: ",i.pdf_file.name]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Locații"}),e("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n==null?void 0:n.map(m=>t("label",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",name:"location",value:m.name,checked:i.locations.includes(m.name),onChange:u,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e("span",{className:"text-sm text-slate-700",children:m.name})]},m.id))}),i.locations.length===n.length&&e("p",{className:"text-sm text-blue-600 font-medium",children:"Toate locațiile"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Factură"]})]})]})]})})]})})},So=()=>{const a=Ye(),{invoices:s,loading:r,createItem:l,updateItem:n,deleteItem:o,exportToExcel:i,exportToPDF:c}=ye(),[u,x]=h.useState(""),[m,d]=h.useState([]),[g,_]=h.useState(!1);h.useEffect(()=>{_(m.length>0)},[m]);const p=b=>{d(b?D.map(y=>y.id):[])},N=(b,y)=>{d(y?[...m,b]:m.filter(L=>L!==b))},k=async()=>{if(m.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${m.length} elemente?`))try{for(const b of m)await o("invoices",b);d([]),_(!1)}catch(b){console.error("Error bulk deleting:",b)}},E=()=>{m.length!==0&&console.log("Bulk edit for:",m)},[P,f]=h.useState(!1),[R,A]=h.useState(null),D=s.filter(b=>{var y,L,Y;return((y=b.invoice_number)==null?void 0:y.toLowerCase().includes(u.toLowerCase()))||((L=b.company)==null?void 0:L.toLowerCase().includes(u.toLowerCase()))||((Y=b.status)==null?void 0:Y.toLowerCase().includes(u.toLowerCase()))}),U=[{key:"id",label:"#",sortable:!0},{key:"invoice_number",label:"NUMĂR FACTURĂ",sortable:!0,render:b=>e("button",{onClick:()=>a(`/invoices/${b.id}`),className:"text-blue-600 hover:text-blue-800 font-medium underline",children:b.invoice_number})},{key:"company",label:"COMPANIE",sortable:!0},{key:"amount",label:"SUMA",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"created_by",label:"CREAT DE",sortable:!0,render:b=>e("div",{className:"text-slate-800 font-medium text-base",children:b.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:b=>e("div",{className:"text-slate-800 font-medium text-base",children:b.created_at?new Date(b.created_at).toLocaleDateString("ro-RO"):"N/A"})}],j=b=>{A(b),f(!0)},v=async b=>{window.confirm("Sigur vrei să ștergi această factură?")&&await o("invoices",b)},z=()=>{A(null),f(!0)},S=async b=>{R?await n("invoices",R.id,b):await l("invoices",b),f(!1),A(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl shadow-lg shadow-red-500/25",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Facturi"}),e("p",{className:"text-slate-600",children:"Gestionează facturile din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{i("invoices")}catch(b){console.error("Error exporting to Excel:",b)}},onExportPDF:()=>{try{c("invoices")}catch(b){console.error("Error exporting to PDF:",b)}},entity:"invoices"}),g&&t(De,{children:[t("button",{onClick:E,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:k,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:z,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Factură"})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută facturi...",value:u,onChange:b=>x(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:r?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"})}):D.length===0?t("div",{className:"text-center py-12",children:[e(ge,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există facturi"}),e("p",{className:"text-slate-500",children:"Adaugă prima factură pentru a începe"})]}):e(He,{data:D,columns:U,onEdit:j,onDelete:v,searchTerm:u,selectedItems:m,onSelectAll:p,onSelectItem:N,moduleColor:"blue"})}),P&&e(Co,{item:R,onClose:()=>f(!1),onSave:S})]})})},_o=()=>{const{id:a}=It(),s=Ye(),{slots:r,companies:l,locations:n,providers:o,cabinets:i,gameMixes:c}=ye(),[u,x]=h.useState(null),[m,d]=h.useState(!0);h.useEffect(()=>{g()},[a]);const g=async()=>{try{const E=await fetch(`/api/invoices/${a}`);if(E.ok){const P=await E.json();x(P)}}catch(E){console.error("Error fetching invoice:",E)}finally{d(!1)}},_=E=>r.find(P=>P.serial_number===E)||null,p=()=>{if(u!=null&&u.file_path){const E=document.createElement("a");E.href=u.file_path,E.download=`factura_${u.invoice_number}.pdf`,E.target="_blank",E.click()}};if(m)return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e("p",{className:"mt-4 text-slate-600",children:"Se încarcă..."})]})});if(!u)return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("h1",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Factura nu a fost găsită"}),e("button",{onClick:()=>s("/invoices"),className:"btn-primary",children:"Înapoi la Facturi"})]})});const N=u.serial_number?typeof u.serial_number=="string"?JSON.parse(u.serial_number):u.serial_number:[],k=u.location?typeof u.location=="string"?(()=>{try{const E=JSON.parse(u.location);return typeof E=="string"?JSON.parse(E):E}catch{return[]}})():u.location:[];return e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-8",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 mb-8 overflow-hidden",children:e("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>s("/invoices"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(tt,{className:"w-6 h-6 text-white"})}),e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(ge,{className:"w-8 h-8 text-white"})}),t("div",{children:[t("h1",{className:"text-3xl font-bold text-white mb-1",children:["Factura ",u.invoice_number]}),e("p",{className:"text-blue-100",children:"Detalii complete despre factură"})]})]}),t("button",{onClick:p,className:"btn-primary flex items-center space-x-2",children:[e(We,{className:"w-5 h-5"}),e("span",{children:"Descarcă PDF"})]})]})})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t("div",{className:"lg:col-span-1",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6 mb-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-blue-600"}),"Informații Factură"]}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Număr Factură"}),e("p",{className:"text-slate-800 font-medium",children:u.invoice_number})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Cumpărător"}),e("p",{className:"text-slate-800",children:u.company})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Vânzător"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.invoice_type})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Tip"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.invoice_type})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Suma"}),t("p",{className:"text-slate-800 font-bold text-lg",children:[u.amount," ",u.currency]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Status"}),e("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${u.status==="Paid"?"bg-green-100 text-green-800":u.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:u.status})]}),u.description&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Descriere"}),e("p",{className:"text-slate-800",children:u.description})]})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(Fe,{className:"w-5 h-5 mr-2 text-green-600"}),"Locații"]}),e("div",{className:"space-y-2",children:Array.isArray(k)&&k.length>0?k.map((E,P)=>t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("span",{className:"text-slate-700",children:E})]},P)):e("p",{className:"text-slate-500",children:"Toate locațiile"})})]})]}),t("div",{className:"lg:col-span-2",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6 mb-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-red-600"}),"PDF Factură"]}),e(kt,{pdfUrl:u.file_path,title:`PDF ${u.invoice_number}`,placeholder:"PDF-ul facturii nu este disponibil",placeholderSubtext:"Atașează PDF-ul facturii pentru vizualizare"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(it,{className:"w-5 h-5 mr-2 text-purple-600"}),"Serii Asociate (",N.length,")"]}),N.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-slate-50 border-b border-slate-200",children:t("tr",{children:[e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Serial Number"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Locație"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Furnizor"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Cabinet"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Game Mix"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Status"})]})}),e("tbody",{className:"divide-y divide-slate-200",children:N.map((E,P)=>{const f=_(E);return t("tr",{className:"hover:bg-slate-50",children:[e("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:E}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:f?f.location:"Necunoscută"}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:f?f.provider:"Necunoscut"}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:f?f.cabinet:"Necunoscut"}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:f?f.game_mix:"Necunoscut"}),e("td",{className:"px-4 py-3",children:f?e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.status==="Active"?"bg-green-100 text-green-800":f.status==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:f.status}):e("span",{className:"text-slate-400",children:"N/A"})})]},P)})})]})}):t("div",{className:"text-center py-8 text-slate-500",children:[e(it,{className:"w-12 h-12 mx-auto mb-4 text-slate-300"}),e("p",{children:"Nu există serii asociate cu această factură"})]})]})]})]})]})})})},Ao=()=>{var j,v,z;const{id:a}=It(),s=Ye(),{companies:r,loading:l,updateItem:n,refreshData:o}=ye(),[i,c]=h.useState(null),[u,x]=h.useState(!1),[m,d]=h.useState(!1),[g,_]=h.useState("overview"),[p,N]=h.useState([]),[k,E]=h.useState(!1),[P,f]=h.useState({name:"",type:"Contract",file:null});h.useEffect(()=>{const S=r.find(F=>F.id===parseInt(a));S&&c(S)},[a,r]),h.useEffect(()=>{const S=r.find(F=>F.id===parseInt(a));S&&c(S)},[r,a]);const R=async()=>{if(!(!i||k))try{E(!0);const F=(await ae.get("/api/onjn-operators/stats")).data,b=(await ae.get("/api/brands")).data,y=[],Y=(await ae.get("/api/onjn-operators")).data,O={};Y.forEach(C=>{C.company_name&&(O[C.company_name]||(O[C.company_name]={company_name:C.company_name,total_slots:0,active_slots:0,expired_slots:0,cities:new Set,counties:new Set}),O[C.company_name].total_slots++,C.status==="În exploatare"&&O[C.company_name].active_slots++,C.is_expired&&O[C.company_name].expired_slots++,C.city&&O[C.company_name].cities.add(C.city),C.county&&O[C.company_name].counties.add(C.county))});const G=Object.values(O).filter(C=>C.company_name!==i.name).map(C=>({...C,cities_count:C.cities.size,counties_count:C.counties.size,cities:Array.from(C.cities),counties:Array.from(C.counties)})).sort((C,W)=>W.total_slots-C.total_slots);N(G)}catch(S){console.error("Error loading competitors:",S),$.error("Eroare la încărcarea datelor concurenților!")}finally{E(!1)}};h.useEffect(()=>{g==="competition"&&i&&R()},[g,i]);const A=async S=>{if(S.preventDefault(),!(!P.file||!P.name)){d(!0);try{const F=new FormData;F.append("file",P.file),F.append("name",P.name),F.append("type",P.type);const I=await fetch(`/api/companies/${i.id}/documents`,{method:"POST",body:F});if(I.ok){const b=await I.json();if(c(b),x(!1),f({name:"",type:"Contract",file:null}),b.compression){const{originalSize:y,compressedSize:L,compressionRatio:Y,savedBytes:O}=b.compression,G=(y/1024/1024).toFixed(2),C=(L/1024/1024).toFixed(2),W=(O/1024).toFixed(2);$.success(`Document încărcat cu succes! PDF comprimat: ${G}MB → ${C}MB (${Y}% reducere, ${W}KB economisite)`,{duration:6e3})}else $.success("Document încărcat cu succes!");setTimeout(()=>{o()},500)}}catch(F){console.error("Error uploading document:",F)}finally{d(!1)}}},D=S=>{const F=S.createElement("a");F.href=S.file_path,F.download=S.name,F.target="_blank",F.click()},U=async S=>{if(window.confirm("Sigur vrei să ștergi acest document?"))try{const F=await fetch(`/api/companies/${i.id}/documents/${S}`,{method:"DELETE"});if(F.ok){const I=await F.json();c(I),setTimeout(()=>{o()},500)}}catch(F){console.error("Error deleting document:",F)}};return l?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-300",children:"Se încarcă..."})]})}):i?t(he,{children:[e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-8",children:[t("div",{className:"mb-8",children:[t("button",{onClick:()=>s("/companies"),className:"btn-secondary flex items-center space-x-2 mb-4",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Companii"})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:t("div",{className:"flex items-start justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:i.name}),e("p",{className:"text-slate-600 dark:text-slate-300 text-lg",children:"Detalii complete despre companie"})]})]}),t("button",{onClick:()=>x(!0),className:"btn-primary flex items-center space-x-2",children:[e(ze,{className:"w-5 h-5"}),e("span",{children:"Atașează Document"})]})]})})]}),e("div",{className:"mb-6",children:e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700",children:t("div",{className:"flex border-b border-slate-200 dark:border-slate-700",children:[e("button",{onClick:()=>_("overview"),className:`flex-1 px-6 py-4 text-left font-medium transition-colors ${g==="overview"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:t("div",{className:"flex items-center space-x-2",children:[e(_e,{className:"w-4 h-4"}),e("span",{children:"Prezentare"})]})}),e("button",{onClick:()=>_("competition"),className:`flex-1 px-6 py-4 text-left font-medium transition-colors ${g==="competition"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:t("div",{className:"flex items-center space-x-2",children:[e(st,{className:"w-4 h-4"}),e("span",{children:"Concurență"})]})})]})})}),g==="overview"&&t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t("div",{className:"lg:col-span-1",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6 mb-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(_e,{className:"w-5 h-5 mr-2 text-blue-600"}),"Informații Companie"]}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Nume Companie"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-medium",children:i.name})]}),i.cui&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"CUI"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-medium",children:i.cui}),i.cuiFile&&t("div",{className:"mt-2 flex items-center space-x-2",children:[t("button",{onClick:()=>{if(i.cui_file){const S=document.createElement("a");S.href=i.cui_file,S.download=`CUI-${i.name}.pdf`,S.click()}},className:"inline-flex items-center px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors text-sm font-medium",title:"Previzualizează CUI",children:[e(Qe,{className:"w-4 h-4 mr-1"}),"Vezi Document"]}),t("button",{onClick:()=>{if(i.cui_file){const S=document.createElement("a");S.href=i.cui_file,S.download=`CUI-${i.name}.pdf`,S.click()}},className:"inline-flex items-center px-3 py-1.5 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm font-medium",title:"Descarcă CUI",children:[e(We,{className:"w-4 h-4 mr-1"}),"Descarcă"]})]})]}),i.contact_person&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Persoană de Contact"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(yt,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),i.contact_person]})]}),i.phone&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Telefon"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(la,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),i.phone]})]}),i.email&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Email"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(Xt,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),i.email]})]}),i.address&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Adresă"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(Fe,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),i.address]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Data Creării"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),new Date(i.created_at).toLocaleDateString("ro-RO")]})]}),i.status&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Status"}),e("span",{className:`px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ${i.status==="Active"?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800":"bg-gradient-to-r from-red-100 to-pink-100 text-red-800"}`,children:i.status})]})]})]}),i.notes&&t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-amber-600"}),"Note"]}),e("p",{className:"text-slate-700 dark:text-slate-300 leading-relaxed",children:i.notes})]})]}),e("div",{className:"lg:col-span-2",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-red-600"}),"Documente Atașate"]}),i.documents&&i.documents.length>0||i.cuiFile?t("div",{className:"space-y-6",children:[(i.cuiFile||i.documents&&i.documents.length>0)&&t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-blue-600"}),"Vizualizare Document"]}),e("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg p-4 mb-4",children:e(kt,{pdfUrl:i.cui_file||(i.documents&&((j=i.documents[0])!=null&&j.file_path)?i.documents[0].file_path:null),title:i.cui_file?`CUI Document ${i.name}`:i.documents&&i.documents[0]?`PDF ${i.documents[0].name}`:"Document PDF",placeholder:"Nu există documente de afișat",placeholderSubtext:"Atașează primul document sau CUI pentru a începe"})}),t("div",{className:"flex items-center justify-between",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:i.cuiFile?`Document: CUI ${i.name}`:`Document: ${(v=i.documents[0])==null?void 0:v.name} (${(z=i.documents[0])==null?void 0:z.type})`}),t("button",{onClick:()=>{if(i.cui_file){const S=document.createElement("a");S.href=i.cui_file,S.download=`CUI-${i.name}.pdf`,S.click()}else i.documents&&i.documents[0]&&D(i.documents[0])},className:"btn-primary flex items-center space-x-2",children:[e(We,{className:"w-4 h-4"}),e("span",{children:"Descarcă PDF"})]})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-green-600"}),"Toate Documentele (",i.cuiFile?1:0," + ",i.documents?i.documents.length:0,")"]}),t("div",{className:"space-y-4",children:[i.cuiFile&&e("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e(ge,{className:"w-5 h-5 text-blue-600"})}),t("div",{children:[t("h3",{className:"font-semibold text-slate-800 dark:text-slate-200",children:["CUI ",i.name]}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Document CUI • ",new Date(i.created_at).toLocaleDateString("ro-RO")]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>{const S=document.querySelector("iframe");S&&(S.src=i.cuiFile)},className:"p-2 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:"Vezi în viewer",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const S=document.createElement("a");S.href=i.cuiFile,S.download=`CUI_${i.name||"company"}.pdf`,S.click()},className:"p-2 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors",title:"Descarcă",children:e(We,{className:"w-4 h-4"})})]})]})}),i.documents&&i.documents.map((S,F)=>e("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e(ge,{className:"w-5 h-5 text-red-600"})}),t("div",{children:[e("h3",{className:"font-semibold text-slate-800 dark:text-slate-200",children:S.name}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[S.type," • ",new Date(S.uploadedAt||S.uploaded_at).toLocaleDateString("ro-RO")]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>{const I=document.querySelector("iframe");I&&(I.src=S.url||S.file_path)},className:"p-2 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:"Vezi în viewer",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const I=document.createElement("a");I.href=S.url||S.file_path,I.download=S.name,I.click()},className:"p-2 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors",title:"Descarcă",children:e(We,{className:"w-4 h-4"})}),e("button",{onClick:()=>U(S._id||S.id),className:"p-2 text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 rounded-lg transition-colors",title:"Șterge",children:e(je,{className:"w-4 h-4"})})]})]})},S._id||S.id||F))]})]})]}):t("div",{className:"text-center py-12 text-slate-500",children:[e(ge,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),e("p",{className:"text-lg font-medium mb-2",children:"Nu există documente atașate"}),e("p",{className:"text-sm",children:"Atașează primul document sau CUI pentru a începe"})]})]})})]}),g==="competition"&&e("div",{className:"space-y-6",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl",children:e(st,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Analiză Concurență"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Top companii concurente din piață"})]})]}),t("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:[p.length," companii active"]})]}),k?t("div",{className:"flex items-center justify-center py-12",children:[e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e("span",{className:"ml-3 text-slate-600 dark:text-slate-400",children:"Se încarcă concurenții..."})]}):p.length>0?e("div",{className:"space-y-4",children:p.slice(0,10).map((S,F)=>e("div",{className:"border border-slate-200 dark:border-slate-700 rounded-xl p-4 hover:shadow-md transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-bold text-sm",children:F+1}),t("div",{children:[e("h3",{className:"font-semibold text-slate-800 dark:text-white",children:S.company_name}),t("div",{className:"flex items-center space-x-4 text-sm text-slate-600 dark:text-slate-400",children:[t("span",{className:"flex items-center space-x-1",children:[e(_e,{className:"w-4 h-4"}),t("span",{children:[S.total_slots.toLocaleString("ro-RO")," sloturi"]})]}),t("span",{className:"flex items-center space-x-1",children:[e(st,{className:"w-4 h-4"}),t("span",{children:[S.active_slots.toLocaleString("ro-RO")," active"]})]}),t("span",{className:"flex items-center space-x-1",children:[e(Fe,{className:"w-4 h-4"}),t("span",{children:[S.counties_count," județe"]})]})]})]})]}),t("div",{className:"text-right",children:[t("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[S.cities_count," orașe"]}),e("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:S.expired_slots>0&&`${S.expired_slots} expirate`})]})]})},S.company_name))}):t("div",{className:"text-center py-12 text-slate-500",children:[e(st,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),e("p",{className:"text-lg font-medium mb-2",children:"Nu există date de concurență"}),e("p",{className:"text-sm",children:"Datele vor fi actualizate după sincronizarea ONJN"})]})]})})]})}),u&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-6 w-full max-w-md mx-4",children:[e("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4",children:"Atașează Document"}),t("form",{onSubmit:A,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Nume Document"}),e("input",{type:"text",value:P.name,onChange:S=>f({...P,name:S.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ex: Contract de Colaborare",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Fișier PDF"}),e("input",{type:"file",accept:".pdf",onChange:S=>f({...P,file:S.target.files[0]}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{className:"flex space-x-3 pt-4",children:[e("button",{type:"button",onClick:()=>x(!1),className:"flex-1 btn-secondary",disabled:m,children:"Anulează"}),e("button",{type:"submit",className:"flex-1 btn-primary flex items-center justify-center space-x-2",disabled:m,children:m?t(De,{children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e("span",{children:"Se încarcă..."})]}):t(De,{children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Atașează"})]})})]})]})]})})]}):e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e(_e,{className:"w-16 h-16 text-slate-400 dark:text-slate-500 mx-auto mb-4"}),e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Compania nu a fost găsită"}),e("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Compania pe care o căutați nu există în sistem."}),t("button",{onClick:()=>s("/companies"),className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Companii"})]})]})})})},Eo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",type:"",period:"",status:"Draft",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",type:a.type||"",period:a.period||"",status:a.status||"Draft",notes:a.notes||""})},[a]);const o=c=>{const{name:u,value:x}=c.target;n(m=>({...m,[u]:x}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-indigo-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Raport ONJN":"Adaugă Raport ONJN Nou"}),e("p",{className:"text-blue-100 text-sm font-medium",children:"Completează informațiile despre raportul ONJN"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Raport *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Numele raportului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip *"}),t("select",{name:"type",value:l.type,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează tipul"}),e("option",{value:"Monthly",children:"Lunar"}),e("option",{value:"Quarterly",children:"Trimestrial"}),e("option",{value:"Annual",children:"Anual"}),e("option",{value:"Special",children:"Special"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Perioada *"}),e("input",{type:"text",name:"period",value:l.period,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ex: Ianuarie 2025",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"Draft",children:"Draft"}),e("option",{value:"Submitted",children:"Trimis"}),e("option",{value:"Approved",children:"Aprobat"}),e("option",{value:"Rejected",children:"Respins"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 text-slate-600 hover:text-slate-800 font-semibold transition-colors",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Adaugă"})]})]})]})})]})})},Do=()=>{const{onjnReports:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:o,exportToPDF:i}=ye(),c=Ye(),[u,x]=h.useState(""),[m,d]=h.useState([]),[g,_]=h.useState(!1);h.useEffect(()=>{_(m.length>0)},[m]);const p=b=>{d(b?D.map(y=>y.id):[])},N=(b,y)=>{d(y?[...m,b]:m.filter(L=>L!==b))},k=async()=>{if(m.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${m.length} elemente?`))try{for(const b of m)await n("onjnReports",b);d([]),_(!1)}catch(b){console.error("Error bulk deleting:",b)}},E=()=>{m.length!==0&&console.log("Bulk edit for:",m)},[P,f]=h.useState(!1),[R,A]=h.useState(null),D=a.filter(b=>{var y,L,Y;return((y=b.name)==null?void 0:y.toLowerCase().includes(u.toLowerCase()))||((L=b.type)==null?void 0:L.toLowerCase().includes(u.toLowerCase()))||((Y=b.status)==null?void 0:Y.toLowerCase().includes(u.toLowerCase()))}),U=[{key:"id",label:"#",sortable:!0},{key:"name",label:"NUME RAPORT",sortable:!0},{key:"type",label:"TIP",sortable:!0},{key:"period",label:"PERIOADA",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"created_by",label:"CREAT DE",sortable:!0,render:b=>e("div",{className:"text-slate-800 font-medium text-base",children:b.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:b=>e("div",{className:"text-slate-800 font-medium text-base",children:b.created_at?new Date(b.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"actions",label:"ACȚIUNI",sortable:!1}],j=b=>{A(b),f(!0)},v=async b=>{window.confirm("Sigur vrei să ștergi acest raport ONJN?")&&await n("onjnReports",b)},z=()=>{A(null),f(!0)},S=async b=>{R?await l("onjnReports",R.id,b):await r("onjnReports",b),f(!1),A(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(Na,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Rapoarte ONJN"}),e("p",{className:"text-slate-600",children:"Generează și gestionează rapoartele ONJN"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{o("onjnreports")}catch(b){console.error("Error exporting to Excel:",b)}},onExportPDF:()=>{try{i("onjnreports")}catch(b){console.error("Error exporting to PDF:",b)}},entity:"onjnreports"}),g&&t(De,{children:[t("button",{onClick:E,className:"btn-secondary flex items-center space-x-2",children:[e(Edit,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:k,className:"btn-danger flex items-center space-x-2",children:[e(Trash2,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:z,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Raport"})]})]})]})}),t("div",{className:"card p-6 hover:shadow-xl transition-shadow cursor-pointer",onClick:()=>c("/onjn-operators"),children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl shadow-lg shadow-indigo-500/25",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Operatori ONJN"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"TOȚI operatorii din Registrul Public ONJN (până la 25,000 sloturi)"})]})]}),e(Yt,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})]}),t("div",{className:"mt-4 grid grid-cols-4 gap-4",children:[t("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Total Sloturi"}),e("div",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:"25K+"})]}),t("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"În Exploatare"}),e("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:"Live"})]}),t("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Filtre Avansate"}),e("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"✓"})]}),t("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Auto Refresh"}),e("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:"✓"})]})]})]}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută rapoarte...",value:u,onChange:b=>x(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):D.length===0?t("div",{className:"text-center py-12",children:[e(Na,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există rapoarte ONJN"}),e("p",{className:"text-slate-500",children:"Adaugă primul raport pentru a începe"})]}):e(He,{data:D,columns:U,onEdit:j,onDelete:v,searchTerm:u,selectedItems:m,onSelectAll:p,onSelectItem:N,moduleColor:"blue"})}),P&&e(Eo,{item:R,onClose:()=>f(!1),onSave:S})]})})},To=({stats:a,loading:s,onRefresh:r})=>{var g,_,p,N;const[l,n]=h.useState(null),[o,i]=h.useState(!0),c=a||l,u=s!==void 0?s:o;h.useEffect(()=>{a===void 0&&s===void 0&&x()},[]);const x=async()=>{try{const k=await ae.get("/api/onjn-operators/stats");n(k.data),r&&r()}catch(k){console.error("Error loading stats:",k)}finally{i(!1)}};if(u)return e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-6 bg-slate-200 dark:bg-slate-700 rounded w-3/4"}),e("div",{className:"h-32 bg-slate-200 dark:bg-slate-700 rounded"})]})});if(!c)return null;const m=((g=c.byStatus.find(k=>k.status==="În exploatare"))==null?void 0:g.count)||0;(_=c.byStatus.find(k=>k.status==="Scos din funcțiune"))!=null&&_.count;const d=c.total>0?(m/c.total*100).toFixed(1):0;return t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl shadow-lg shadow-indigo-500/25",children:e(st,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Statistici Generale"})]}),e("button",{onClick:x,disabled:u,className:"p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-lg transition-colors disabled:opacity-50",title:"Actualizează statisticile",children:e(ut,{className:`w-4 h-4 ${u?"animate-spin":""}`})})]}),t("div",{className:"space-y-4",children:[t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/20 dark:to-indigo-900/10 rounded-xl p-4",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("span",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-medium",children:"Total Aparate"}),e(_e,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})]}),e("div",{className:"text-3xl font-bold text-indigo-700 dark:text-indigo-300",children:c.total.toLocaleString("ro-RO")})]}),t("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-900/10 rounded-xl p-4",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("span",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"În Exploatare"}),e(bt,{className:"w-5 h-5 text-green-600 dark:text-green-400"})]}),e("div",{className:"text-3xl font-bold text-green-700 dark:text-green-300",children:m.toLocaleString("ro-RO")}),t("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[d,"% din total"]})]})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-900/10 rounded-xl p-4",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("span",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"Licențe Expirate"}),e(lt,{className:"w-5 h-5 text-red-600 dark:text-red-400"})]}),e("div",{className:"text-3xl font-bold text-red-700 dark:text-red-300",children:c.expired})]}),t("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-900/10 rounded-xl p-4",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("span",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium",children:"Expiră în 30 zile"}),e(Me,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})]}),e("div",{className:"text-3xl font-bold text-orange-700 dark:text-orange-300",children:c.expiringSoon})]})]}),t("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-xl p-4",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("span",{className:"text-sm text-slate-600 dark:text-slate-400 font-medium",children:"Acoperire Geografică"}),e(Fe,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})]}),t("div",{className:"text-2xl font-bold text-slate-700 dark:text-slate-300",children:[c.byCounty.length," județe"]}),t("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Top: ",((p=c.byCounty[0])==null?void 0:p.county)||"N/A"," (",((N=c.byCounty[0])==null?void 0:N.count)||0," aparate)"]})]})]})]})},zo=({operators:a=[],onFilterChange:s,filters:r={}})=>{var _;const[l,n]=h.useState([]),[o,i]=h.useState(!0),[c,u]=h.useState(null);h.useEffect(()=>{a.length>0?d():x()},[a]);const x=async()=>{try{const p=await ae.get("/api/onjn-operators?limit=1000");m(p.data)}catch(p){console.error("Error loading cities:",p),i(!1)}},m=p=>{try{const N={},k={};p.forEach(P=>{var f;if(P.city){let R=P.city,A=P.city;(P.city.toLowerCase().includes("bucurești")||(f=P.county)!=null&&f.toLowerCase().includes("sector")||P.city.toLowerCase().includes("sector"))&&(R="București",A="București",k[P.county||P.city]||(k[P.county||P.city]={sector:P.county||P.city,total:0,active:0}),k[P.county||P.city].total++,P.status==="În exploatare"&&k[P.county||P.city].active++),N[R]||(N[R]={city:A,county:R==="București"?"București":P.county,total:0,active:0,sectors:R==="București"?k:null}),N[R].total++,P.status==="În exploatare"&&N[R].active++}});const E=Object.values(N).sort((P,f)=>f.active!==P.active?f.active-P.active:f.total-P.total).slice(0,10);n(E)}catch(N){console.error("Error processing cities data:",N)}finally{i(!1)}},d=()=>{m(a)};if(o)return e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-6 bg-slate-200 dark:bg-slate-700 rounded w-3/4"}),e("div",{className:"h-32 bg-slate-200 dark:bg-slate-700 rounded"})]})});const g=((_=l[0])==null?void 0:_.total)||1;return t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl shadow-lg shadow-blue-500/25",children:e(Fe,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Top Orașe"})]}),e("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Top 10"})]}),e("div",{className:"space-y-3",children:l.length===0?t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(Fe,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e("p",{children:"Nu există date"})]}):l.map((p,N)=>{const k=p.total/g*100,E=p.total>0?(p.active/p.total*100).toFixed(0):0,P=c===p.city,f=p.sectors&&Object.keys(p.sectors).length>0;return t("div",{className:"relative",children:[t("div",{className:`flex items-center justify-between mb-1 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 rounded-lg p-2 -m-2 ${r.city===p.city?"ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-900/20":""}`,onClick:()=>{f?u(P?null:p.city):s&&s("city",p.city)},children:[t("div",{className:"flex items-center space-x-2",children:[e("span",{className:"text-lg font-bold text-slate-400 dark:text-slate-500 w-6",children:N+1}),t("div",{className:"flex items-center space-x-2",children:[t("div",{children:[e("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:p.city}),e("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:p.county})]}),f&&e("div",{className:"text-slate-400",children:P?e(Ir,{className:"w-4 h-4"}):e(Ha,{className:"w-4 h-4"})})]})]}),t("div",{className:"text-right",children:[e("div",{className:"font-bold text-blue-600 dark:text-blue-400",children:p.total}),t("div",{className:"text-xs text-green-600 dark:text-green-400",children:[p.active," active (",E,"%)"]}),f&&t("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[Object.keys(p.sectors).length," sectoare"]})]})]}),e("div",{className:"h-2 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:e("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full transition-all duration-500",style:{width:`${k}%`}})}),P&&f&&e("div",{className:"mt-3 ml-8 space-y-2 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:Object.values(p.sectors).map((R,A)=>{const D=R.total/p.total*100;return t("div",{className:"text-sm",children:[t("div",{className:"flex items-center justify-between mb-1",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:R.sector})]}),t("div",{className:"text-right",children:[e("span",{className:"font-bold text-blue-600 dark:text-blue-400 text-sm",children:R.total}),t("span",{className:"text-xs text-green-600 dark:text-green-400 ml-2",children:[R.active," active"]})]})]}),e("div",{className:"h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:e("div",{className:"h-full bg-blue-400 rounded-full transition-all duration-500",style:{width:`${D}%`}})})]},R.sector)})})]},p.city)})}),l.length>0&&t("div",{className:"mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[t("div",{className:"flex items-center justify-between text-sm",children:[e("span",{className:"text-slate-600 dark:text-slate-400",children:"Total orașe:"}),e("span",{className:"font-semibold text-slate-800 dark:text-slate-200",children:l.length})]}),t("div",{className:"flex items-center justify-between text-sm mt-2",children:[e("span",{className:"text-slate-600 dark:text-slate-400",children:"Total aparate (top 10):"}),e("span",{className:"font-semibold text-slate-800 dark:text-slate-200",children:l.reduce((p,N)=>p+N.total,0).toLocaleString("ro-RO")})]})]})]})},Po=({operators:a=[],onFilterChange:s,filters:r={}})=>{var d;const[l,n]=h.useState([]),[o,i]=h.useState(!0);h.useEffect(()=>{a.length>0?x():c()},[a]);const c=async()=>{try{const g=await ae.get("/api/onjn-operators?limit=1000");u(g.data)}catch(g){console.error("Error loading counties:",g),i(!1)}},u=g=>{try{const _={};g.forEach(N=>{if(N.county){let k=N.county.trim();(k.toLowerCase().includes("sector")||k.toLowerCase().includes("bucurești"))&&(k="București"),_[k]||(_[k]={county:k,total:0,active:0,cities:new Set}),_[k].total++,N.status==="În exploatare"&&_[k].active++,N.city&&_[k].cities.add(N.city)}});const p=Object.values(_).map(N=>({...N,citiesCount:N.cities.size,cities:Array.from(N.cities)})).sort((N,k)=>k.total-N.total).slice(0,10);n(p)}catch(_){console.error("Error processing counties data:",_)}finally{i(!1)}},x=()=>{u(a)};if(o)return e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-6 bg-slate-200 dark:bg-slate-700 rounded w-3/4"}),e("div",{className:"h-32 bg-slate-200 dark:bg-slate-700 rounded"})]})});const m=((d=l[0])==null?void 0:d.total)||1;return t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl shadow-lg shadow-green-500/25",children:e(Fe,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Top Județe"})]}),e("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Top 10"})]}),e("div",{className:"space-y-3",children:l.length===0?t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(Fe,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e("p",{children:"Nu există date"})]}):l.map((g,_)=>{const p=g.total/m*100,N=g.total>0?(g.active/g.total*100).toFixed(0):0;return t("div",{className:"relative",children:[t("div",{className:`flex items-center justify-between mb-1 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 rounded-lg p-2 -m-2 transition-colors ${r.county===g.county?"ring-2 ring-green-500 bg-green-50 dark:bg-green-900/20":""}`,onClick:()=>{s&&s("county",g.county)},children:[t("div",{className:"flex items-center space-x-2",children:[e("span",{className:"text-lg font-bold text-slate-400 dark:text-slate-500 w-6",children:_+1}),t("div",{children:[e("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:g.county}),t("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center space-x-1",children:[e(Ms,{className:"w-3 h-3"}),t("span",{children:[g.citiesCount," orașe"]})]})]})]}),t("div",{className:"text-right",children:[e("div",{className:"font-bold text-green-600 dark:text-green-400",children:g.total}),t("div",{className:"text-xs text-green-600 dark:text-green-400",children:[g.active," active (",N,"%)"]})]})]}),e("div",{className:"h-2 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:e("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 rounded-full transition-all duration-500",style:{width:`${p}%`}})})]},g.county)})}),l.length>0&&t("div",{className:"mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[t("div",{className:"flex items-center justify-between text-sm",children:[e("span",{className:"text-slate-600 dark:text-slate-400",children:"Total județe:"}),e("span",{className:"font-semibold text-slate-800 dark:text-slate-200",children:l.length})]}),t("div",{className:"flex items-center justify-between text-sm mt-2",children:[e("span",{className:"text-slate-600 dark:text-slate-400",children:"Total aparate (top 10):"}),e("span",{className:"font-semibold text-slate-800 dark:text-slate-200",children:l.reduce((g,_)=>g+_.total,0).toLocaleString("ro-RO")})]})]})]})},Lo=({operators:a=[],onFilterChange:s,filters:r={}})=>{const[l,n]=h.useState([]),[o,i]=h.useState(!0);h.useEffect(()=>{a.length>0?x():c()},[a]);const c=async()=>{try{const g=await ae.get("/api/onjn-operators/stats");if(g.data&&g.data.byBrand){const _=g.data.byBrand.map(p=>({brand:p.brand_name,total:p.count,active:p.count,counties:new Set}));n(_),i(!1)}}catch(g){console.error("Error loading brands:",g),i(!1)}},u=g=>{try{const _={};g.forEach(N=>{const k=N.brand_name||"Necunoscut";_[k]||(_[k]={brand:k,company:N.company_name,total:0,active:0,counties:new Set}),_[k].total++,N.status==="În exploatare"&&_[k].active++,N.county&&_[k].counties.add(N.county)});const p=Object.values(_).map(N=>({...N,counties:N.counties.size})).sort((N,k)=>k.total-N.total).slice(0,8);n(p)}catch(_){console.error("Error loading brands:",_)}finally{i(!1)}},x=()=>{u(a)};if(o)return e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-6 bg-slate-200 dark:bg-slate-700 rounded w-3/4"}),e("div",{className:"h-32 bg-slate-200 dark:bg-slate-700 rounded"})]})});const m=l.reduce((g,_)=>g+_.total,0),d=["from-purple-500 to-pink-500","from-blue-500 to-cyan-500","from-green-500 to-emerald-500","from-orange-500 to-red-500","from-indigo-500 to-purple-500","from-yellow-500 to-orange-500","from-pink-500 to-rose-500","from-cyan-500 to-blue-500"];return t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl shadow-lg shadow-purple-500/25",children:e(_t,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Distribuție Branduri"})]}),e("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Top 8"})]}),e("div",{className:"space-y-4",children:l.length===0?t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(_t,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e("p",{children:"Nu există date"})]}):l.map((g,_)=>{const p=m>0?(g.total/m*100).toFixed(1):0,N=g.total>0?(g.active/g.total*100).toFixed(0):0,k=d[_%d.length];return t("div",{className:"group",children:[t("div",{className:`flex items-center justify-between mb-2 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 rounded-lg p-2 -m-2 transition-colors ${r.brand===g.brand?"ring-2 ring-purple-500 bg-purple-50 dark:bg-purple-900/20":""}`,onClick:()=>{s&&s("brand",g.brand)},children:[t("div",{className:"flex items-center space-x-3 flex-1",children:[e("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${k} flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform`,children:e("span",{className:"text-white font-bold text-sm",children:g.brand.substring(0,2).toUpperCase()})}),t("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:g.brand}),t("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center space-x-2",children:[e("span",{children:g.company}),e("span",{children:"•"}),t("span",{children:[g.counties," județe"]})]})]})]}),t("div",{className:"text-right",children:[e("div",{className:"font-bold text-purple-600 dark:text-purple-400",children:g.total}),t("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[p,"%"]})]})]}),e("div",{className:"flex items-center space-x-2 text-xs ml-13",children:t("div",{className:"flex items-center space-x-1 text-green-600 dark:text-green-400",children:[e($s,{className:"w-3 h-3"}),t("span",{children:[g.active," active (",N,"%)"]})]})}),_<l.length-1&&e("div",{className:"border-t border-slate-100 dark:border-slate-700 mt-3"})]},g.brand)})}),l.length>0&&t("div",{className:"mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[t("div",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:["Cotă de piață (top ",l.length,"):"]}),e("div",{className:"h-3 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden flex",children:l.map((g,_)=>{const p=m>0?g.total/m*100:0,N=d[_%d.length];return e("div",{className:`h-full bg-gradient-to-r ${N} transition-all duration-500 group relative`,style:{width:`${p}%`},title:`${g.brand}: ${p.toFixed(1)}%`,children:e("div",{className:"absolute inset-0 bg-white/20 opacity-0 group-hover:opacity-100 transition-opacity"})},g.brand)})}),t("div",{className:"flex items-center justify-between text-sm mt-3",children:[e("span",{className:"text-slate-600 dark:text-slate-400",children:"Total branduri active:"}),e("span",{className:"font-semibold text-slate-800 dark:text-slate-200",children:l.length})]})]})]})},Io=()=>{var G;const a=Ye(),[s,r]=h.useState([]),[l,n]=h.useState(null),[o,i]=h.useState(!0),[c,u]=h.useState(!1),[x,m]=h.useState(null),[d,g]=h.useState(null),[_,p]=h.useState(null),[N,k]=h.useState(""),[E,P]=h.useState({company:"",brand:"",county:"",city:"",status:"",license:""});h.useEffect(()=>{(async()=>{var W;try{const T=await ae.get("/api/onjn-operators/refresh-status");if(T.data&&T.data.status==="running"){g(T.data),u(!0);const Z=setInterval(()=>{ae.get("/api/onjn-operators/refresh-status").then(se=>{g(se.data),se.data&&(se.data.status==="completed"||se.data.status==="failed")&&(clearInterval(Z),u(!1))}).catch(se=>{var ne;((ne=se.response)==null?void 0:ne.status)!==404&&console.error("Error polling refresh status:",se)})},2e3);p(Z)}}catch(T){((W=T.response)==null?void 0:W.status)!==404&&console.error("Error checking refresh status:",T)}})(),f(),R()},[]);const f=async(C=1e3)=>{try{i(!0);const W=await ae.get(`/api/onjn-operators?limit=${C}`);if(r(W.data),W.data.length>0){const T=W.data.map(Z=>Z.last_scraped_at).filter(Boolean).sort((Z,se)=>new Date(se)-new Date(Z))[0];T&&m(new Date(T))}}catch(W){console.error("Error loading ONJN operators:",W),$.error("Eroare la încărcarea datelor ONJN!")}finally{i(!1)}},R=async()=>{try{const C=await ae.get("/api/onjn-operators/stats");n(C.data)}catch(C){console.error("Error loading stats:",C)}},A=async()=>{var C,W;try{const T=await ae.get("/api/onjn-operators/refresh-status");g(T.data),T.data&&(T.data.status==="completed"||T.data.status==="failed")&&(_&&(clearInterval(_),p(null)),T.data.status==="completed"?($.success(`✅ Sincronizare completă!
${(C=T.data.slotsFound)==null?void 0:C.toLocaleString("ro-RO")} sloturi scanate
${T.data.inserted} adăugate, ${T.data.updated} actualizate`,{id:"refresh",duration:8e3}),await f(),await R()):$.error(`❌ Sincronizare eșuată: ${T.data.currentStep}`,{id:"refresh"}),u(!1))}catch(T){((W=T.response)==null?void 0:W.status)===404?g(Z=>({...Z,currentStep:"Sincronizare în curs... (status endpoint indisponibil)",currentPage:Z!=null&&Z.currentPage?Z.currentPage+1:1})):console.error("Error fetching progress:",T)}},D=async()=>{var C;if(d&&d.status==="running"){$.error("Sincronizare deja în curs. Vă rugăm să așteptați finalizarea.",{id:"refresh-warning"});return}try{u(!0),g({status:"running",currentPage:0,totalPages:500,currentStep:"Pornire sincronizare...",slotsFound:0,inserted:0,updated:0,errors:0,startTime:new Date}),$.loading("Sincronizare ONJN în curs...",{id:"refresh"});const W=await ae.post("/api/onjn-operators/refresh",{companyId:null,maxPages:1200});if(W.data.success){g(Z=>({...Z,currentStep:"Sincronizare în curs...",slotsFound:W.data.scraped||0}));const T=setInterval(A,2e3);p(T),setTimeout(A,500)}}catch(W){console.error("Error starting refresh:",W),((C=W.response)==null?void 0:C.status)===400?$.error("Sincronizare deja în curs. Vă rugăm să așteptați finalizarea.",{id:"refresh"}):$.error("Eroare la pornirea sincronizării ONJN!",{id:"refresh"}),u(!1),g(null)}},U=async()=>{var C,W;if(d&&d.status==="running"){$.error("Import deja în curs. Vă rugăm să așteptați finalizarea.",{id:"import-warning"});return}try{u(!0),g({status:"running",currentPage:0,totalPages:0,currentStep:"Pornire import din JSON...",slotsFound:0,inserted:0,updated:0,errors:0,startTime:new Date}),$.loading("Import din JSON în curs...",{id:"import"});const T=await ae.post("/api/onjn-operators/import-json");if(T.data.success){g(se=>({...se,currentStep:"Import în curs...",slotsFound:T.data.total||0}));const Z=setInterval(A,2e3);p(Z),setTimeout(A,500),$.success(`✅ Import completat!
${T.data.inserted} adăugate, ${T.data.updated} actualizate`,{id:"import",duration:8e3}),await f(),await R(),u(!1)}}catch(T){console.error("Error importing from JSON:",T),((C=T.response)==null?void 0:C.status)===400?$.error("Import deja în curs. Vă rugăm să așteptați finalizarea.",{id:"import"}):((W=T.response)==null?void 0:W.status)===404?$.error("Fișierul JSON nu a fost găsit. Rulați mai întâi scriptul de scraping.",{id:"import"}):$.error("Eroare la importul din JSON!",{id:"import"}),u(!1),g(null)}};h.useEffect(()=>()=>{_&&clearInterval(_)},[_]),h.useEffect(()=>{if(c&&(d==null?void 0:d.status)==="running"){const C=setTimeout(()=>{_&&(clearInterval(_),p(null)),g(W=>({...W,status:"completed",currentStep:"Sincronizare finalizată (timeout automat)"})),u(!1),$.success("Sincronizare completată! (timeout automat)",{id:"refresh",duration:5e3}),f(),R()},9e5);return()=>clearTimeout(C)}},[c,d,_]);const j=(C,W)=>{const Z=E[C]===W;P(se=>{if(se[C]===W){const ne={...se};return delete ne[C],ne}return{...se,[C]:W}}),Z?$.success(`Filtru eliminat: ${C}`,{duration:2e3}):$.success(`Filtru aplicat: ${C} = ${W}`,{duration:2e3})},v=()=>{P({}),$.success("Toate filtrele au fost resetate",{duration:2e3})},z=Object.keys(E).length,S=s.filter(C=>{var Re,Ue,Ve;const W=!N||((Re=C.serial_number)==null?void 0:Re.toLowerCase().includes(N.toLowerCase()))||((Ue=C.slot_address)==null?void 0:Ue.toLowerCase().includes(N.toLowerCase()))||((Ve=C.city)==null?void 0:Ve.toLowerCase().includes(N.toLowerCase())),T=!E.company||C.company_name===E.company,Z=!E.brand||C.brand_name===E.brand,se=!E.county||C.county===E.county,ne=!E.city||C.city===E.city,ce=!E.status||C.status===E.status,Ce=!E.license||C.license_number===E.license;return W&&T&&Z&&se&&ne&&ce&&Ce}),F=[...new Set(s.map(C=>C.company_name).filter(Boolean))].sort(),I=[...new Set(s.map(C=>C.brand_name).filter(Boolean))].sort(),b=[...new Set(s.map(C=>C.county).filter(Boolean))].sort();[...new Set(s.map(C=>C.city).filter(Boolean))].sort();const y=[...new Set(s.map(C=>C.license_number).filter(Boolean))].sort(),L=F.map(C=>{const W=S.filter(ne=>ne.company_name===C),T=[...new Set(W.map(ne=>ne.brand_name).filter(Boolean))],Z=[...new Set(W.map(ne=>ne.city).filter(Boolean))],se=Z.map(ne=>{const ce=W.filter(Ce=>Ce.city===ne);return{location:ne,slots:ce.length}});return{company:C,totalSlots:W.length,brandsCount:T.length,locationsCount:Z.length,brands:T,locations:Z,slotsPerLocation:se.sort((ne,ce)=>ce.slots-ne.slots)}}).sort((C,W)=>W.totalSlots-C.totalSlots),Y={total:S.length,byStatus:[{status:"În exploatare",count:S.filter(C=>C.status==="În exploatare").length},{status:"Scos din funcțiune",count:S.filter(C=>C.status==="Scos din funcțiune").length},{status:"Suspendat",count:S.filter(C=>C.status==="Suspendat").length}],active:S.filter(C=>C.status==="În exploatare").length,inactive:S.filter(C=>C.status==="Scos din funcțiune").length,expired:0,expiringSoon:0},O=[{key:"serial_number",label:"SERIE",sortable:!0,render:C=>t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>window.open(C.onjn_details_url,"_blank"),className:"text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 font-semibold hover:underline transition-colors",children:C.serial_number}),e("a",{href:C.onjn_details_url,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-indigo-600 transition-colors",title:"Vezi detalii ONJN",children:e(Yt,{className:"w-4 h-4"})})]})},{key:"equipment_type",label:"TIP",sortable:!0,render:C=>e("div",{className:"text-slate-700 dark:text-slate-300",children:C.equipment_type||"-"})},{key:"company_name",label:"COMPANIE",sortable:!0,render:C=>e("div",{className:"font-medium text-slate-800 dark:text-slate-200",children:C.company_name||"-"})},{key:"brand_name",label:"BRAND",sortable:!0,render:C=>C.brand_name?t("button",{onClick:()=>a(`/onjn-operators/brand/${encodeURIComponent(C.brand_name)}`),className:`text-indigo-600 dark:text-indigo-400 font-semibold hover:text-indigo-800 dark:hover:text-indigo-300 
                     hover:underline transition-colors flex items-center space-x-1`,title:`Vezi toate sloturile ${C.brand_name}`,children:[e(_e,{className:"w-4 h-4"}),e("span",{children:C.brand_name})]}):e("span",{className:"text-slate-400",children:"-"})},{key:"slot_address",label:"ADRESĂ SLOT",sortable:!0,render:C=>t("div",{className:"text-sm",children:[e("div",{className:"text-slate-700 dark:text-slate-300",children:C.slot_address||"-"}),C.city&&t("div",{className:"text-slate-500 dark:text-slate-400 text-xs mt-1 flex items-center",children:[e(Fe,{className:"w-3 h-3 mr-1"}),C.city]})]})},{key:"county",label:"JUDEȚ",sortable:!0},{key:"license_number",label:"LICENȚĂ",sortable:!0,render:C=>e("div",{className:"text-xs text-slate-600 dark:text-slate-400 font-mono",children:C.license_number||"-"})},{key:"authorization_date",label:"AUTORIZARE",sortable:!0,render:C=>e("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:C.authorization_date?new Date(C.authorization_date).toLocaleDateString("ro-RO"):"-"})},{key:"expiry_date",label:"EXPIRARE",sortable:!0,render:C=>{if(!C.expiry_date)return e("span",{className:"text-slate-400",children:"-"});const W=new Date(C.expiry_date),Z=W-new Date,se=Math.ceil(Z/(1e3*60*60*24));let ne="text-green-600 dark:text-green-400",ce=null;return C.is_expired||se<0?(ne="text-red-600 dark:text-red-400",ce=e(lt,{className:"w-4 h-4 inline mr-1"})):se<=30&&(ne="text-orange-600 dark:text-orange-400",ce=e(lt,{className:"w-4 h-4 inline mr-1"})),t("div",{className:`text-sm font-medium ${ne}`,children:[ce,W.toLocaleDateString("ro-RO")]})}},{key:"status",label:"STATUS",sortable:!0,render:C=>{const W=C.status==="În exploatare";return e("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${W?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:C.status})}}];return e(he,{children:t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl shadow-lg shadow-indigo-500/25",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Operatori ONJN"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"TOȚI operatorii din Registrul Public ONJN (până la 25,000 sloturi)"}),x&&t("div",{className:"mt-2 flex items-center space-x-2",children:[e(Me,{className:"w-4 h-4 text-slate-500"}),t("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Ultima actualizare: ",x.toLocaleString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})]}),t("div",{className:"flex space-x-3",children:[t("button",{onClick:D,disabled:c||d&&d.status==="running",className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(ut,{className:`w-4 h-4 ${c?"animate-spin":""}`}),e("span",{children:c?"Sincronizare...":"Refresh ONJN"})]}),t("button",{onClick:U,disabled:c||d&&d.status==="running",className:"btn-secondary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(ht,{className:"w-4 h-4"}),e("span",{children:"📁 Import JSON"})]}),t("button",{onClick:v,disabled:z===0,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${z>0?"bg-red-500 hover:bg-red-600 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-500"}`,title:`${z} filtre active`,children:[e(X,{className:"w-4 h-4"}),t("span",{children:["Reset Filtre ",z>0&&`(${z})`]})]})]})]}),(d||c)&&t("div",{className:"mt-4 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl p-6 text-white",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(ut,{className:"w-6 h-6 animate-spin"}),t("div",{children:[e("h3",{className:"font-bold text-lg",children:"Sincronizare ONJN în curs..."}),e("p",{className:"text-indigo-100 text-sm",children:(d==null?void 0:d.currentStep)||"Se pregătește sincronizarea..."})]})]}),t("div",{className:"text-right",children:[t("div",{className:"text-2xl font-bold",children:[(d==null?void 0:d.currentPage)||0,"/",(d==null?void 0:d.totalPages)||500]}),e("div",{className:"text-indigo-100 text-sm",children:"pagini"})]})]}),t("div",{className:"mb-4",children:[t("div",{className:"flex justify-between text-sm text-indigo-100 mb-2",children:[e("span",{children:"Progres"}),t("span",{children:[((d==null?void 0:d.totalPages)||500)>0?Math.round(((d==null?void 0:d.currentPage)||0)/((d==null?void 0:d.totalPages)||500)*100):0,"%"]})]}),e("div",{className:"w-full bg-indigo-300 bg-opacity-30 rounded-full h-3",children:e("div",{className:"bg-white rounded-full h-3 transition-all duration-500 ease-out",style:{width:`${((d==null?void 0:d.totalPages)||500)>0?Math.min(((d==null?void 0:d.currentPage)||0)/((d==null?void 0:d.totalPages)||500)*100,100):0}%`}})})]}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:((d==null?void 0:d.slotsFound)||0).toLocaleString("ro-RO")}),e("div",{className:"text-indigo-100",children:"Sloturi găsite"})]}),t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:(d==null?void 0:d.inserted)||0}),e("div",{className:"text-indigo-100",children:"Adăugate"})]}),t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:(d==null?void 0:d.updated)||0}),e("div",{className:"text-indigo-100",children:"Actualizate"})]}),t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:(d==null?void 0:d.errors)||0}),e("div",{className:"text-indigo-100",children:"Erori"})]})]}),(d==null?void 0:d.startTime)&&t("div",{className:"mt-4 text-center text-indigo-100 text-sm",children:["Sincronizarea a început la: ",new Date(d.startTime).toLocaleTimeString("ro-RO"),d.duration&&t("span",{className:"ml-4",children:["Durată: ",Math.round(d.duration/1e3/60)," minute"]})]})]}),!o&&s.length===0&&e("div",{className:"mt-4 bg-yellow-50 dark:bg-yellow-900/20 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl p-4",children:t("div",{className:"flex items-center space-x-3",children:[e(lt,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"}),t("div",{children:[e("h3",{className:"font-semibold text-yellow-800 dark:text-yellow-300",children:"Baza de date este goală"}),e("p",{className:"text-sm text-yellow-700 dark:text-yellow-400",children:'Apasă butonul "Refresh ONJN" pentru a sincroniza datele (8-10 minute, ~25,000 sloturi)'})]})]})})]}),Y&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/30 rounded-xl",children:e(st,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total Sloturi"}),e("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:Y.total.toLocaleString("ro-RO")}),z>0&&t("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Filtru aplicat (",z," filtre)"]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e(ht,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"În exploatare"}),e("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:Y.active.toLocaleString("ro-RO")})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-xl",children:e(lt,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Scos din funcțiune"}),e("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:Y.inactive.toLocaleString("ro-RO")})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-xl",children:e(Me,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Suspendat"}),e("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:((G=Y.byStatus.find(C=>C.status==="Suspendat"))==null?void 0:G.count)||0})]})]})})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6",children:[e(To,{stats:l,loading:o,onRefresh:R}),e($t.Suspense,{fallback:e("div",{className:"card p-6 animate-pulse bg-slate-100 dark:bg-slate-700 rounded-xl",children:e("div",{className:"h-32"})}),children:e(zo,{operators:S.slice(0,500),onFilterChange:j,filters:E})}),e($t.Suspense,{fallback:e("div",{className:"card p-6 animate-pulse bg-slate-100 dark:bg-slate-700 rounded-xl",children:e("div",{className:"h-32"})}),children:e(Po,{operators:S.slice(0,500),onFilterChange:j,filters:E})}),e($t.Suspense,{fallback:e("div",{className:"card p-6 animate-pulse bg-slate-100 dark:bg-slate-700 rounded-xl",children:e("div",{className:"h-32"})}),children:e(Lo,{operators:S.slice(0,500),onFilterChange:j,filters:E})})]}),e("div",{className:"card p-6",children:t("div",{className:"space-y-4",children:[t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după serie, adresă sau oraș...",value:N,onChange:C=>k(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[t("select",{value:E.company,onChange:C=>P({...E,company:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate companiile"}),F.map(C=>e("option",{value:C,children:C},C))]}),t("select",{value:E.brand,onChange:C=>P({...E,brand:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate brandurile"}),I.map(C=>e("option",{value:C,children:C},C))]}),t("select",{value:E.county,onChange:C=>P({...E,county:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate județele"}),b.map(C=>e("option",{value:C,children:C},C))]}),t("select",{value:E.status,onChange:C=>P({...E,status:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate statusurile"}),e("option",{value:"În exploatare",children:"În exploatare"}),e("option",{value:"Scos din funcțiune",children:"Scos din funcțiune"})]}),t("select",{value:E.license,onChange:C=>P({...E,license:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate licențele"}),y.map(C=>e("option",{value:C,children:C},C))]})]}),(N||E.company||E.brand||E.county||E.status||E.license)&&e("div",{className:"flex justify-end",children:e("button",{onClick:()=>{k(""),P({company:"",brand:"",county:"",status:"",license:""})},className:"btn-secondary text-sm",children:"Resetează filtrele"})})]})}),L.length>0&&t("div",{className:"card p-6",children:[t("div",{className:"flex items-center space-x-3 mb-6",children:[e("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-xl shadow-lg shadow-purple-500/25",children:e(it,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Statistici per Operator"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Câte branduri, locații și sloturi pe locație pentru fiecare operator"})]})]}),e("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 max-h-[400px] overflow-y-auto",children:L.slice(0,12).map((C,W)=>t("div",{className:`bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-900 
                           rounded-xl border border-slate-200 dark:border-slate-600 p-4 hover:shadow-lg transition-all`,children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg flex items-center justify-center text-white font-bold text-sm",children:W+1}),e("h4",{className:"font-bold text-slate-800 dark:text-white text-sm truncate max-w-[200px]",title:C.company,children:C.company})]}),t("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[C.totalSlots," sloturi"]})]}),t("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[t("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3 text-center",children:[e("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:C.brandsCount}),e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Branduri"})]}),t("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-center",children:[e("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:C.locationsCount}),e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Locații"})]})]}),C.slotsPerLocation.length>0&&t("div",{className:"space-y-2",children:[t("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400 flex items-center",children:[e(Fe,{className:"w-3 h-3 mr-1"}),"Top locații:"]}),t("div",{className:"space-y-1",children:[C.slotsPerLocation.slice(0,3).map((T,Z)=>t("div",{className:"flex justify-between items-center text-xs",children:[e("span",{className:"text-slate-700 dark:text-slate-300 truncate max-w-[120px]",title:T.location,children:T.location}),t("span",{className:"font-bold text-indigo-600 dark:text-indigo-400 flex items-center",children:[e(Bs,{className:"w-3 h-3 mr-1"}),T.slots]})]},T.location)),C.slotsPerLocation.length>3&&t("div",{className:"text-xs text-slate-500 dark:text-slate-400 text-center",children:["+",C.slotsPerLocation.length-3," mai multe"]})]})]}),C.brands.length>0&&t("div",{className:"mt-3 pt-2 border-t border-slate-200 dark:border-slate-600",children:[t("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400 mb-1 flex items-center",children:[e(_e,{className:"w-3 h-3 mr-1"}),"Branduri:"]}),t("div",{className:"flex flex-wrap gap-1",children:[C.brands.slice(0,2).map((T,Z)=>e("span",{className:`px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 
                                     text-xs rounded-full truncate max-w-[100px]`,title:T,children:T},T)),C.brands.length>2&&t("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400 text-xs rounded-full",children:["+",C.brands.length-2]})]})]})]},C.company))}),L.length>12&&e("div",{className:"mt-4 text-center",children:t("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Afișare primele 12 din ",L.length," operatori"]})})]}),e("div",{className:"card p-6",children:o?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):S.length===0?t("div",{className:"text-center py-12",children:[e(_e,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:s.length===0?"Nu există date ONJN":"Nu există rezultate"}),e("p",{className:"text-slate-500 mb-4",children:s.length===0?'Apasă pe "Refresh ONJN" pentru a sincroniza datele':"Încearcă să modifici filtrele"})]}):t(De,{children:[t("div",{className:"mb-4 text-sm text-slate-600 dark:text-slate-400",children:["Afișare ",S.length," din ",s.length," înregistrări"]}),e(He,{data:S,columns:O,searchTerm:N,moduleColor:"indigo",itemsPerPage:25})]})})]})})},Oo=({brand:a,onClose:s,onSave:r})=>{const[l,n]=h.useState("url"),[o,i]=h.useState((a==null?void 0:a.brand_logo)||""),[c,u]=h.useState(null),[x,m]=h.useState((a==null?void 0:a.brand_logo)||""),[d,g]=h.useState((a==null?void 0:a.brand_name)||""),[_,p]=h.useState(!1),[N,k]=h.useState(!1),E=A=>{const D=A.target.files[0];if(D){u(D);const U=new FileReader;U.onloadend=()=>{m(U.result)},U.readAsDataURL(D)}},P=A=>{const D=A.target.value;i(D),m(D)},f=async()=>{p(!0);try{const A=`${d.toLowerCase().replace(/\s+/g,"")}.ro`,D=`https://logo.clearbit.com/${A}`,U=new Image;U.onload=()=>{i(D),m(D),$.success("Logo găsit automat!")},U.onerror=()=>{const j=`https://logo.clearbit.com/${A.replace(".ro",".com")}`,v=new Image;v.onload=()=>{i(j),m(j),$.success("Logo găsit automat!")},v.onerror=()=>{$.error("Nu s-a găsit logo automat. Încarcă manual sau adaugă URL.")},v.src=j},U.src=D}catch(A){console.error("Auto search error:",A),$.error("Eroare la căutarea automată!")}finally{p(!1)}},R=async()=>{try{k(!0);const A=new FormData;A.append("brand_name",a.brand_name),A.append("company_name",a.company_name||""),A.append("description",a.description||""),A.append("website_url",a.website_url||""),l==="upload"&&c?(A.append("logo",c),A.append("logo_source","upload")):l==="url"&&o?(A.append("logo_url",o),A.append("logo_source","url")):l==="search"&&o&&(A.append("logo_url",o),A.append("logo_source","auto-search")),(await ae.post("/api/brands",A,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&($.success("Logo actualizat cu succes!"),r())}catch(A){console.error("Error saving logo:",A),$.error("Eroare la salvarea logo-ului!")}finally{k(!1)}};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(St,{className:"w-8 h-8 text-white"})}),t("div",{children:[t("h2",{className:"text-2xl font-bold text-white",children:["Logo Brand: ",a.brand_name]}),e("p",{className:"text-indigo-100 text-sm",children:a.company_name})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"flex space-x-2 bg-slate-100 dark:bg-slate-700 rounded-xl p-1",children:[t("button",{onClick:()=>n("url"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center space-x-2 ${l==="url"?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-400 shadow":"text-slate-600 dark:text-slate-400"}`,children:[e(ta,{className:"w-4 h-4"}),e("span",{children:"URL Link"})]}),t("button",{onClick:()=>n("upload"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center space-x-2 ${l==="upload"?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-400 shadow":"text-slate-600 dark:text-slate-400"}`,children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Încarcă Fișier"})]}),t("button",{onClick:()=>n("search"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center space-x-2 ${l==="search"?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-400 shadow":"text-slate-600 dark:text-slate-400"}`,children:[e(Ge,{className:"w-4 h-4"}),e("span",{children:"Căutare Automată"})]})]}),x&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6 text-center",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:"Previzualizare Logo:"}),e("img",{src:x,alt:"Logo preview",className:"max-h-32 mx-auto object-contain",onError:A=>{A.target.style.display="none",$.error("Eroare la încărcarea imaginii!")}})]}),l==="url"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"URL Logo (ex: https://exemple.com/logo.png)"}),e("input",{type:"url",value:o,onChange:P,placeholder:"https://exemple.com/logo.png",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all`}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Copiază URL-ul direct al imaginii logo-ului"})]}),l==="upload"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Încarcă Logo (PNG, JPG, SVG, max 5MB)"}),e("input",{type:"file",accept:"image/*",onChange:E,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all
                         file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 
                         file:bg-indigo-50 file:text-indigo-600 hover:file:bg-indigo-100`}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Logo-ul va fi încărcat pe AWS S3 și va fi accesibil public"})]}),l==="search"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Caută Logo Automat"}),t("div",{className:"flex space-x-2",children:[e("input",{type:"text",value:d,onChange:A=>g(A.target.value),placeholder:"Numele brandului (ex: MAX BET, ADMIRAL)",className:`flex-1 px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                           bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                           focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all`}),e("button",{onClick:f,disabled:_||!d,className:`px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 
                           disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium
                           flex items-center space-x-2`,children:_?e("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t(De,{children:[e(Ge,{className:"w-4 h-4"}),e("span",{children:"Caută"})]})})]}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Utilizează Clearbit Logo API pentru căutare automată"})]}),t("div",{className:"flex justify-end space-x-4 pt-4 border-t-2 border-slate-200 dark:border-slate-600",children:[e("button",{onClick:s,className:`px-6 py-3 rounded-xl border-2 border-slate-300 dark:border-slate-600 
                       text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 
                       transition-all font-medium`,children:"Anulează"}),e("button",{onClick:R,disabled:N||!o&&!c,className:`px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl 
                       hover:from-indigo-600 hover:to-purple-600 transition-all shadow-lg font-medium
                       disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2`,children:N?t(De,{children:[e("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("span",{children:"Se încarcă..."})]}):t(De,{children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Salvează Logo"})]})})]})]})]})})},Ro=()=>{const{brandName:a}=It(),s=Ye(),r=decodeURIComponent(a),[l,n]=h.useState(null),[o,i]=h.useState([]),[c,u]=h.useState(!0),[x,m]=h.useState(!1);h.useEffect(()=>{d()},[a]);const d=async()=>{try{u(!0);const f=await ae.get(`/api/brands/${encodeURIComponent(r)}`);n(f.data.brand),i(f.data.slots)}catch(f){console.error("Error loading brand data:",f),$.error("Eroare la încărcarea datelor brandului!")}finally{u(!1)}},g=()=>{m(!1),d()},_=o.length,p=o.filter(f=>f.status==="În exploatare").length,N=o.filter(f=>f.is_expired).length,k=[...new Set(o.map(f=>f.city).filter(Boolean))].length,E=[...new Set(o.map(f=>f.county).filter(Boolean))].length,P=[{key:"serial_number",label:"SERIE",sortable:!0,render:f=>t("a",{href:f.onjn_details_url,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-800 font-semibold hover:underline transition-colors flex items-center space-x-1",title:"Vezi detalii pe ONJN",children:[e("span",{children:f.serial_number}),e(Yt,{className:"w-3 h-3"})]})},{key:"equipment_type",label:"TIP",sortable:!0,render:f=>e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:f.equipment_type})},{key:"slot_address",label:"ADRESĂ",sortable:!0,render:f=>t("div",{className:"flex items-start space-x-2",children:[e(Fe,{className:"w-4 h-4 text-slate-400 mt-0.5 flex-shrink-0"}),t("div",{className:"text-sm",children:[e("div",{className:"text-slate-700 dark:text-slate-300",children:f.slot_address}),t("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:[f.city,", ",f.county]})]})]})},{key:"license_number",label:"LICENȚĂ",sortable:!0,render:f=>e("span",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:f.license_number})},{key:"authorization_date",label:"AUTORIZARE",sortable:!0,render:f=>f.authorization_date?t("div",{className:"flex items-center space-x-1 text-sm",children:[e(Me,{className:"w-3 h-3 text-slate-400"}),e("span",{children:new Date(f.authorization_date).toLocaleDateString("ro-RO")})]}):e("span",{className:"text-slate-400",children:"N/A"})},{key:"expiry_date",label:"EXPIRARE",sortable:!0,render:f=>{if(!f.expiry_date)return e("span",{className:"text-slate-400",children:"N/A"});const R=new Date(f.expiry_date),A=new Date;A.setHours(0,0,0,0),R.setHours(0,0,0,0);let D="text-green-600",U=R.toLocaleDateString("ro-RO");if(R<A)D="text-red-600 font-bold",U+=" (Expirat)";else{const j=R.getTime()-A.getTime(),v=Math.ceil(j/(1e3*60*60*24));v<=30&&(D="text-orange-600 font-bold",U+=` (${v} zile)`)}return t("div",{className:"flex items-center space-x-1 text-sm",children:[e(Me,{className:"w-3 h-3 text-slate-400"}),e("span",{className:D,children:U})]})}},{key:"status",label:"STATUS",sortable:!0,render:f=>{const R=f.status==="În exploatare"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";return e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R}`,children:f.status})}}];return c?e(he,{children:e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})})}):l?t(he,{children:[t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[e("div",{className:"flex items-center justify-between mb-6",children:t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>s("/onjn-operators"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Înapoi la Operatori ONJN",children:e(tt,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),t("div",{className:"relative group cursor-pointer",onClick:()=>m(!0),title:"Click pentru a edita logo",children:[l.brand_logo?e("img",{src:l.brand_logo,alt:l.brand_name,className:"w-20 h-20 object-contain rounded-xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-2"}):e("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center",children:e(_e,{className:"w-10 h-10 text-white"})}),e("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e(at,{className:"w-6 h-6 text-white"})})]}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:l.brand_name}),e("p",{className:"text-lg text-slate-600 dark:text-slate-400",children:l.company_name}),l.description&&e("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:l.description}),l.website_url&&t("a",{href:l.website_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center space-x-1 mt-1",children:[e(Us,{className:"w-3 h-3"}),e("span",{children:"Website"}),e(Yt,{className:"w-3 h-3"})]})]})]})}),t("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(At,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total Sloturi"})]}),e("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:_})]}),t("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(ht,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"În Exploatare"})]}),e("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:p})]}),t("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(Me,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Expirate"})]}),e("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:N})]}),t("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(Fe,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Orașe"})]}),e("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:k})]}),t("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(Fe,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Județe"})]}),e("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:E})]})]})]}),t("div",{className:"card p-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4",children:["Toate Sloturile (",_,")"]}),e(He,{data:o,columns:P,loading:c,moduleColor:"indigo"})]})]}),x&&e(Oo,{brand:l,onClose:()=>m(!1),onSave:g})]}):e(he,{children:t("div",{className:"card p-12 text-center",children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-4",children:"Brand negăsit"}),e("button",{onClick:()=>s("/onjn-operators"),className:"btn-primary",children:"Înapoi la Operatori ONJN"})]})})},Fo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",type:"",status:"Valid",expiry_date:"",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",type:a.type||"",status:a.status||"Valid",expiry_date:a.expiry_date||"",notes:a.notes||""})},[a]);const o=c=>{const{name:u,value:x}=c.target;n(m=>({...m,[u]:x}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-red-800 to-rose-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 to-rose-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-rose-500 rounded-2xl shadow-lg",children:e(or,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Document Legal":"Adaugă Document Legal Nou"}),e("p",{className:"text-red-100 text-sm font-medium",children:"Completează informațiile despre documentul legal"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Document *"}),e("input",{type:"text",name:"name",value:l.name,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Numele documentului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip *"}),t("select",{name:"type",value:l.type,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează tipul"}),e("option",{value:"License",children:"Licență"}),e("option",{value:"Permit",children:"Autorizație"}),e("option",{value:"Contract",children:"Contract"}),e("option",{value:"Certificate",children:"Certificat"}),e("option",{value:"Other",children:"Altele"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data Expirării"}),e("input",{type:"date",name:"expiry_date",value:l.expiry_date,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:o,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e("option",{value:"Valid",children:"Valid"}),e("option",{value:"Expired",children:"Expirat"}),e("option",{value:"Expiring Soon",children:"Expiră în curând"}),e("option",{value:"Invalid",children:"Invalid"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:o,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(or,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Document"]})]})]})]})})]})})},jo=()=>{const{legalDocuments:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:o,exportToPDF:i}=ye(),[c,u]=h.useState(""),[x,m]=h.useState([]),[d,g]=h.useState(!1);h.useEffect(()=>{g(x.length>0)},[x]);const _=I=>{m(I?A.map(b=>b.id):[])},p=(I,b)=>{m(b?[...x,I]:x.filter(y=>y!==I))},N=async()=>{if(x.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${x.length} elemente?`))try{for(const I of x)await n("legalDocuments",I);m([]),g(!1)}catch(I){console.error("Error bulk deleting:",I)}},k=()=>{x.length!==0&&console.log("Bulk edit for:",x)},[E,P]=h.useState(!1),[f,R]=h.useState(null),A=a.filter(I=>{var b,y,L;return((b=I.name)==null?void 0:b.toLowerCase().includes(c.toLowerCase()))||((y=I.type)==null?void 0:y.toLowerCase().includes(c.toLowerCase()))||((L=I.status)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))}),D=[{key:"id",label:"#",sortable:!0},{key:"name",label:"NUME DOCUMENT",sortable:!0},{key:"type",label:"TIP",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"expiry_date",label:"DATA EXPIRARE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.expiry_date?new Date(I.expiry_date).toLocaleDateString("ro-RO"):"N/A"})},{key:"created_by",label:"CREAT DE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_at?new Date(I.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"actions",label:"ACȚIUNI",sortable:!1}],U=I=>{R(I),P(!0)},j=async I=>{window.confirm("Sigur vrei să ștergi acest document legal?")&&await n("legalDocuments",I)},v=()=>{R(null),P(!0)},z=async I=>{f?await l("legalDocuments",f.id,I):await r("legalDocuments",I),P(!1),R(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-gray-500 to-slate-500 rounded-2xl shadow-lg shadow-gray-500/25",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Documente Legale"}),e("p",{className:"text-slate-600",children:"Gestionează documentele legale din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{o("legaldocuments")}catch(I){console.error("Error exporting to Excel:",I)}},onExportPDF:()=>{try{i("legaldocuments")}catch(I){console.error("Error exporting to PDF:",I)}},entity:"legaldocuments"}),d&&t(De,{children:[t("button",{onClick:k,className:"btn-secondary flex items-center space-x-2",children:[e(Edit,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:N,className:"btn-danger flex items-center space-x-2",children:[e(Trash2,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:v,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Document"})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută documente...",value:c,onChange:I=>u(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-500"})}):A.length===0?t("div",{className:"text-center py-12",children:[e(ge,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există documente legale"}),e("p",{className:"text-slate-500",children:"Adaugă primul document pentru a începe"})]}):e(He,{data:A,columns:D,onEdit:U,onDelete:j,searchTerm:c,selectedItems:x,onSelectAll:_,onSelectItem:p,moduleColor:"blue"})}),E&&e(Fo,{item:f,onClose:()=>P(!1),onSave:z})]})})},Mo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({username:"",full_name:"",email:"",password:"",role:"user",status:"active",notes:"",avatar:null,avatarPreview:null,permissions:fa("user")}),[o,i]=h.useState(!1);h.useEffect(()=>{a&&n({username:a.username||"",full_name:a.full_name||"",email:a.email||"",role:a.role||"user",status:a.status||"active",notes:a.notes||"",avatar:a.avatar||null,avatarPreview:a.avatar||null,permissions:a.permissions||fa(a.role||"user")})},[a]);const c=g=>{const{name:_,value:p}=g.target;n(N=>{const k={...N,[_]:p};return _==="role"&&(k.permissions=fa(p)),k})},u=(g,_)=>{n(p=>{var N;return{...p,permissions:{...p.permissions,[g]:{...p.permissions[g],[_]:!((N=p.permissions[g])!=null&&N[_])}}}})},x=(g,_)=>{const p=ga[g];n(N=>({...N,permissions:{...N.permissions,[g]:p.actions.reduce((k,E)=>(k[E]=_,k),{})}}))},m=g=>{const _=g.target.files[0];if(_){const p=new FileReader;p.onload=N=>{n(k=>({...k,avatar:N.target.result,avatarPreview:N.target.result}))},p.readAsDataURL(_)}};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-indigo-800 to-blue-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 to-blue-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-blue-500 rounded-2xl shadow-lg",children:e(yt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Utilizator":"Adaugă Utilizator Nou"}),e("p",{className:"text-indigo-100 text-sm font-medium",children:"Completează informațiile despre utilizator"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:g=>{g.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Username *"}),e("input",{type:"text",name:"username",value:l.username,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Username",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Complet *"}),e("input",{type:"text",name:"full_name",value:l.full_name,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Numele complet",required:!0})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Avatar"}),t("div",{className:"flex items-center space-x-4",children:[l.avatarPreview?t("div",{className:"relative",children:[e("img",{src:l.avatarPreview,alt:"Avatar preview",className:"w-16 h-16 rounded-full object-cover border-2 border-slate-300"}),e("button",{type:"button",onClick:()=>n(g=>({...g,avatar:null,avatarPreview:null})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]}):e("div",{className:"w-16 h-16 rounded-full bg-slate-200 flex items-center justify-center",children:e(yt,{className:"w-8 h-8 text-slate-400"})}),t("div",{className:"flex-1",children:[e("input",{type:"file",accept:"image/*",onChange:m,className:"hidden",id:"avatar-upload"}),t("label",{htmlFor:"avatar-upload",className:"inline-flex items-center px-4 py-2 border border-slate-300 rounded-lg cursor-pointer hover:bg-slate-50 transition-colors",children:[e(ze,{className:"w-4 h-4 mr-2"}),l.avatarPreview?"Schimbă Avatar":"Upload Avatar"]}),e("p",{className:"text-xs text-slate-500 mt-1",children:"JPG, PNG sau GIF (max 2MB)"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Email *"}),e("input",{type:"email",name:"email",value:l.email,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Adresa de email",required:!0})]}),t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-slate-700",children:["Parolă ",!a&&"*"]}),e("input",{type:"password",name:"password",value:l.password,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:a?"Lasă gol pentru a păstra parola actuală":"Minim 6 caractere",required:!a,minLength:a?void 0:6})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Rol *"}),t("select",{name:"role",value:l.role,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",required:!0,children:[e("option",{value:"admin",children:"Administrator"}),e("option",{value:"manager",children:"Manager"}),e("option",{value:"user",children:"Utilizator"}),e("option",{value:"marketing",children:"Marketing"}),e("option",{value:"operational",children:"Operational"}),e("option",{value:"financiar",children:"Financiar"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",required:!0,children:[e("option",{value:"active",children:"Activ"}),e("option",{value:"inactive",children:"Inactiv"}),e("option",{value:"suspended",children:"Suspendat"})]})]})]}),t("div",{className:"space-y-3 border-t border-slate-200 pt-6",children:[t("div",{className:"flex items-center justify-between",children:[t("label",{className:"block text-sm font-semibold text-slate-700 flex items-center space-x-2",children:[e(Na,{className:"w-5 h-5 text-indigo-600"}),e("span",{children:"Permisiuni Detaliate"})]}),t("button",{type:"button",onClick:()=>i(!o),className:"flex items-center space-x-2 px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:[e("span",{children:o?"Ascunde":"Arată"}),o?e(Gs,{className:"w-4 h-4"}):e(Ir,{className:"w-4 h-4"})]})]}),o&&t("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4 space-y-4 max-h-96 overflow-y-auto",children:[e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:"Bifează permisiunile pentru fiecare modul. Permisiunile se actualizează automat când schimbi rolul."}),e("div",{className:"grid grid-cols-1 gap-4",children:Object.keys(ga).map(g=>{const _=ga[g],p=l.permissions[g]||{};return _.actions.every(N=>p[N]),_.actions.some(N=>p[N]),t("div",{className:"bg-white dark:bg-slate-700 rounded-lg p-3 border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200",children:_.label}),t("div",{className:"flex space-x-2",children:[e("button",{type:"button",onClick:()=>x(g,!0),className:"text-xs px-2 py-1 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Selectează toate",children:"Toate"}),e("button",{type:"button",onClick:()=>x(g,!1),className:"text-xs px-2 py-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Deselectează toate",children:"Niciuna"})]})]}),e("div",{className:"flex flex-wrap gap-2",children:_.actions.map(N=>t("label",{className:"flex items-center space-x-2 px-3 py-1.5 bg-slate-50 dark:bg-slate-600 rounded-lg cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-500 transition-colors",children:[e("input",{type:"checkbox",checked:p[N]||!1,onChange:()=>u(g,N),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),e("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-200",children:Ci[N]})]},N))})]},g)})})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:c,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(yt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Utilizator"]})]})]})]})})]})})},$o=()=>{const{users:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:o,exportToPDF:i}=ye(),{user:c}=Rt(),[u,x]=h.useState(""),[m,d]=h.useState([]),[g,_]=h.useState(!1),[p,N]=h.useState(!1),[k,E]=h.useState(null);h.useEffect(()=>{_(m.length>0)},[m]);const P=b=>{d(b?D.map(y=>y.id):[])},f=(b,y)=>{d(y?[...m,b]:m.filter(L=>L!==b))},R=async()=>{if(m.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${m.length} utilizatori?`))try{for(const b of m)await n("users",b);d([]),_(!1)}catch(b){console.error("Error bulk deleting users:",b)}},A=()=>{m.length!==0&&console.log("Bulk edit for users:",m)},D=a.filter(b=>{var y,L,Y,O;return((y=b.username)==null?void 0:y.toLowerCase().includes(u.toLowerCase()))||((L=b.full_name)==null?void 0:L.toLowerCase().includes(u.toLowerCase()))||((Y=b.email)==null?void 0:Y.toLowerCase().includes(u.toLowerCase()))||((O=b.role)==null?void 0:O.toLowerCase().includes(u.toLowerCase()))}),U=[{key:"full_name",label:"NUME COMPLET",sortable:!0,render:b=>t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"flex-shrink-0",children:b.avatar?e("img",{src:b.avatar,alt:b.full_name||b.username,className:"w-10 h-10 rounded-full object-cover border-2 border-slate-200"}):e("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-semibold text-sm",children:(b.full_name||b.username||"U").charAt(0).toUpperCase()})}),t("div",{className:"min-w-0 flex-1",children:[e("p",{className:"text-sm font-medium text-slate-900 truncate",children:b.full_name||"N/A"}),t("p",{className:"text-sm text-slate-500 truncate",children:["@",b.username]})]})]})},{key:"email",label:"EMAIL",sortable:!0},{key:"role",label:"ROL",sortable:!0},{key:"created_info",label:"CREAT DE / DATA CREARE",sortable:!0,render:b=>t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{children:b.created_by||"N/A"}),e("div",{className:"text-sm text-slate-500",children:b.created_at?new Date(b.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],j=b=>{E(b),N(!0)},v=async b=>{if(window.confirm("Sigur vrei să ștergi acest utilizator?"))try{(await n("users",b.id)).success||ke.error("Eroare la ștergerea utilizatorului")}catch(L){console.error("Error deleting user:",L),ke.error("Eroare la ștergerea utilizatorului")}},z=()=>{E(null),N(!0)},S=async b=>{if(k)await l("users",k.id,b);else{const y={...b,created_by:(c==null?void 0:c.fullName)||(c==null?void 0:c.username)||"System"};await r("users",y)}N(!1),E(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(xt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Utilizatori"}),e("p",{className:"text-slate-600",children:"Gestionează utilizatorii din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{o("users")}catch(b){console.error("Error exporting to Excel:",b)}},onExportPDF:()=>{try{i("users")}catch(b){console.error("Error exporting to PDF:",b)}},entity:"users"}),t("div",{className:"flex space-x-3",children:[g&&t(De,{children:[t("button",{onClick:A,className:"btn-secondary flex items-center space-x-2",children:[e(at,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:R,className:"btn-danger flex items-center space-x-2",children:[e(je,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:z,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Utilizator"})]})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută utilizatori...",value:u,onChange:b=>x(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):D.length===0?t("div",{className:"text-center py-12",children:[e(xt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există utilizatori"}),e("p",{className:"text-slate-500",children:"Adaugă primul utilizator pentru a începe"})]}):e(He,{data:D,columns:U,onEdit:j,onDelete:v,searchTerm:u,selectedItems:m,onSelectAll:P,onSelectItem:f,moduleColor:"blue"})}),p&&e(Mo,{item:k,onClose:()=>N(!1),onSave:S})]})})},Bo=({compact:a=!1})=>{const[s,r]=h.useState(null),[l,n]=h.useState(null),[o,i]=h.useState(!1),[c,u]=h.useState(!1),[x,m]=h.useState({type:"",text:""});h.useEffect(()=>{d()},[]);const d=async()=>{i(!0);try{const N=await(await fetch("/api/backup/status")).json();N.success&&r(N.data);const E=await(await fetch("/api/backup/stats")).json();E.success&&n(E.data)}catch(p){console.error("Error loading backup info:",p),m({type:"error",text:"Eroare la încărcarea informațiilor despre backup"})}finally{i(!1)}},g=async()=>{u(!0),m({type:"",text:""});try{const N=await(await fetch("/api/backup/create",{method:"POST",headers:{"Content-Type":"application/json"}})).json();N.success?(m({type:"success",text:"Backup creat cu succes!"}),d()):m({type:"error",text:N.message||"Eroare la crearea backup-ului"})}catch(p){console.error("Error creating backup:",p),m({type:"error",text:"Eroare la crearea backup-ului"})}finally{u(!1)}},_=async()=>{try{const N=await(await fetch("/api/backup/export")).blob(),k=window.URL.createObjectURL(N),E=document.createElement("a");E.href=k,E.download=`cashpot_backup_${new Date().toISOString().split("T")[0]}.sql`,document.body.appendChild(E),E.click(),window.URL.revokeObjectURL(k),document.body.removeChild(E),m({type:"success",text:"Backup descărcat cu succes!"})}catch(p){console.error("Error downloading backup:",p),m({type:"error",text:"Eroare la descărcarea backup-ului"})}};return o&&!s?e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-center py-8",children:[e(ut,{className:"w-6 h-6 text-blue-500 dark:text-blue-400 animate-spin"}),e("span",{className:"ml-2 text-slate-600 dark:text-slate-400",children:"Se încarcă informațiile..."})]})}):a?t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e(ot,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),t("div",{children:[e("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"Backup Bază de Date"}),t("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(l==null?void 0:l.totalRecords)||0," înregistrări • ",(l==null?void 0:l.databaseSize)||"N/A"]})]})]}),e("button",{onClick:d,className:"p-2 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",children:e(ut,{className:`w-5 h-5 ${o?"animate-spin":""}`})})]}),t("div",{className:"space-y-3 mb-6",children:[t("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[t("div",{className:"flex items-center space-x-2",children:[s!=null&&s.s3Enabled?e(cr,{className:"w-4 h-4 text-green-600 dark:text-green-400"}):e(Fa,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Stocare"})]}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:(s==null?void 0:s.storageLocation)||"Local"})]}),t("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[t("div",{className:"flex items-center space-x-2",children:[e(dt,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Auto Backup"})]}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s!=null&&s.autoBackupEnabled?`La ${s==null?void 0:s.backupIntervalHours}h`:"Dezactivat"})]})]}),x.text&&t("div",{className:`mb-4 p-3 rounded-lg flex items-center space-x-2 ${x.type==="success"?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:[x.type==="success"?e(bt,{className:"w-4 h-4"}):e(lt,{className:"w-4 h-4"}),e("span",{className:"text-sm",children:x.text})]}),t("div",{className:"grid grid-cols-2 gap-3",children:[e("button",{onClick:g,disabled:c,className:"flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:c?t(De,{children:[e(ut,{className:"w-4 h-4 animate-spin"}),e("span",{className:"text-sm",children:"Creare..."})]}):t(De,{children:[e(ze,{className:"w-4 h-4"}),e("span",{className:"text-sm",children:"Creează Backup"})]})}),t("button",{onClick:_,className:"flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e(We,{className:"w-4 h-4"}),e("span",{className:"text-sm",children:"Descarcă"})]})]})]}):t("div",{className:"space-y-6",children:[t("div",{className:"card p-8",children:[t("div",{className:"flex items-center justify-between mb-8",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Backup Bază de Date"}),e("p",{className:"text-slate-600",children:"Gestionează backup-urile bazei de date și exportă datele"})]}),e("button",{onClick:d,className:"p-3 text-slate-400 hover:text-slate-600 transition-colors",children:e(ut,{className:`w-6 h-6 ${o?"animate-spin":""}`})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100",children:t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ot,{className:"w-8 h-8 text-blue-600"}),t("div",{children:[e("p",{className:"text-sm text-blue-600 font-medium",children:"Total Înregistrări"}),e("p",{className:"text-2xl font-bold text-blue-800",children:(l==null?void 0:l.totalRecords)||0})]})]})}),e("div",{className:"p-6 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100",children:t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Vs,{className:"w-8 h-8 text-green-600"}),t("div",{children:[e("p",{className:"text-sm text-green-600 font-medium",children:"Dimensiune BD"}),e("p",{className:"text-2xl font-bold text-green-800",children:(l==null?void 0:l.databaseSize)||"N/A"})]})]})}),e("div",{className:"p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100",children:t("div",{className:"flex items-center space-x-3 mb-3",children:[s!=null&&s.s3Enabled?e(cr,{className:"w-8 h-8 text-purple-600"}):e(Fa,{className:"w-8 h-8 text-purple-600"}),t("div",{children:[e("p",{className:"text-sm text-purple-600 font-medium",children:"Stocare"}),e("p",{className:"text-lg font-bold text-purple-800",children:(s==null?void 0:s.storageLocation)||"Local"})]})]})})]}),t("div",{className:"p-6 bg-slate-50 rounded-xl mb-8",children:[e("h3",{className:"font-bold text-slate-800 mb-4",children:"Configurare Backup"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"Auto Backup:"}),e("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s!=null&&s.autoBackupEnabled?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s!=null&&s.autoBackupEnabled?"Activ":"Inactiv"})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"Interval Backup:"}),t("span",{className:"font-medium text-slate-800",children:[(s==null?void 0:s.backupIntervalHours)||6," ore"]})]}),(s==null?void 0:s.s3Enabled)&&t(De,{children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"S3 Bucket:"}),e("span",{className:"font-medium text-slate-800",children:s==null?void 0:s.bucketName})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"Regiune:"}),e("span",{className:"font-medium text-slate-800",children:s==null?void 0:s.region})]})]})]})]}),x.text&&t("div",{className:`mb-6 p-4 rounded-lg flex items-center space-x-3 ${x.type==="success"?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:[x.type==="success"?e(bt,{className:"w-5 h-5"}):e(lt,{className:"w-5 h-5"}),e("span",{children:x.text})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e("button",{onClick:g,disabled:c,className:"flex items-center justify-center space-x-2 px-6 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?t(De,{children:[e(ut,{className:"w-5 h-5 animate-spin"}),e("span",{children:"Se creează backup..."})]}):t(De,{children:[e(ze,{className:"w-5 h-5"}),e("span",{children:"Creează Backup Manual"})]})}),t("button",{onClick:_,className:"flex items-center justify-center space-x-2 px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e(We,{className:"w-5 h-5"}),e("span",{children:"Descarcă Backup SQL"})]})]})]}),(l==null?void 0:l.tableStats)&&t("div",{className:"card p-8",children:[e("h3",{className:"text-xl font-bold text-slate-800 mb-6",children:"Statistici pe Tabele"}),e("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(l.tableStats).map(([p,N])=>t("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e("p",{className:"text-sm text-slate-600 capitalize",children:p.replace("_"," ")}),e("p",{className:"text-2xl font-bold text-slate-800",children:N})]},p))})]})]})},Uo=()=>{var U,j,v,z,S,F,I,b,y,L,Y,O,G,C,W,T,Z,se,ne,ce,Ce,Re,Ue,Ve,et,qe,$e,Ze,Q,de,ue,pe,Ae,ee,me,fe,ie,le,be,te,oe,Se,Pe,Ee,B,M,w,V,K,we,Le,Je,Be,nt,Dt,Jt;const[a,s]=h.useState("header"),[r,l]=h.useState({logo:{type:"upload",url:"",file:null},favicon:{type:"upload",url:"",file:null},headerColor:{primary:"#2563eb",secondary:"#4f46e5",useGradient:!0},background:{type:"color",color:"#f1f5f9",imageUrl:"",imageFile:null},loginImage:{type:"upload",url:"",file:null},loginButtonColor:{primary:"#FF7A00",secondary:"#FF9500",useGradient:!1},loginPageColor:{primary:"#FFFFFF",secondary:"#F5F5F5",useGradient:!1},loginCardColor:{primary:"#8B5CF6",secondary:"#A855F7",useGradient:!0},loginTextColor:{title:"#1e293b",labels:"#334155",text:"#64748b"},appTitle:"CASHPOT V7",appSubtitle:"Gaming Management System",loginTexts:{title:"Login",emailLabel:"Email",passwordLabel:"Password",buttonText:"Log In",forgotPassword:"Forgot Password?",termsText:"By clicking login you agree to the terms of the Club Membership Agreement and the Independent Partner Agreement",joinText:"Got an invitation? Join Now",supportText:"Need help? Contact us at login-support@in.group"}});h.useEffect(()=>{n()},[]);const n=async()=>{try{const xe=await ae.get("/api/auth/verify");if(xe.data.success&&xe.data.user){const Ke=xe.data.user.preferences||{};if(Ke.appSettings){l(Ke.appSettings),console.log("✅ Loaded app settings from server");return}}}catch{console.log("⚠️ Could not load settings from server")}const J=sessionStorage.getItem("appSettings");if(J)try{const xe=JSON.parse(J);l(xe),console.log("📱 Loaded app settings from sessionStorage")}catch(xe){console.error("Error parsing sessionStorage settings:",xe)}},o=J=>{l({...r,logo:{...r.logo,type:J}})},i=J=>{l({...r,logo:{...r.logo,url:J}})},c=J=>{const xe=J.target.files[0];if(xe){const Ke=new FileReader;Ke.onloadend=()=>{l({...r,logo:{...r.logo,file:Ke.result}})},Ke.readAsDataURL(xe)}},u=J=>{l({...r,favicon:{...r.favicon,type:J}})},x=J=>{l({...r,favicon:{...r.favicon,url:J}})},m=J=>{const xe=J.target.files[0];if(xe){const Ke=new FileReader;Ke.onloadend=()=>{l({...r,favicon:{...r.favicon,file:Ke.result}});const sr=document.querySelector("link[rel~='icon']");sr&&(sr.href=Ke.result)},Ke.readAsDataURL(xe)}},d=(J,xe)=>{l({...r,headerColor:{...r.headerColor,[J]:xe}})},g=J=>{l({...r,background:{...r.background,type:J}})},_=J=>{l({...r,background:{...r.background,color:J}}),document.body.style.backgroundColor=J},p=J=>{l({...r,background:{...r.background,imageUrl:J}})},N=J=>{const xe=J.target.files[0];if(xe){const Ke=new FileReader;Ke.onloadend=()=>{l({...r,background:{...r.background,imageFile:Ke.result}}),document.body.style.backgroundImage=`url(${Ke.result})`,document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center",document.body.style.backgroundAttachment="fixed"},Ke.readAsDataURL(xe)}},k=J=>{l({...r,loginImage:{...r.loginImage,type:J}})},E=J=>{l({...r,loginImage:{...r.loginImage,url:J}})},P=J=>{const xe=J.target.files[0];if(xe){const Ke=new FileReader;Ke.onloadend=()=>{l({...r,loginImage:{...r.loginImage,file:Ke.result}})},Ke.readAsDataURL(xe)}},f=(J,xe)=>{l({...r,loginButtonColor:{...r.loginButtonColor,[J]:xe}})},R=async()=>{sessionStorage.setItem("appSettings",JSON.stringify(r));try{const J=await ae.get("/api/auth/verify");J.data.success&&J.data.user&&(await ae.put(`/api/users/${J.data.user.id}/preferences`,{preferences:{appSettings:r}}),console.log("✅ App settings saved to server"))}catch(J){console.error("❌ Error saving to server:",J)}if(r.favicon.file){const J=document.querySelector("link[rel~='icon']");if(J)J.href=r.favicon.file;else{const xe=document.createElement("link");xe.rel="icon",xe.type="image/x-icon",xe.href=r.favicon.file,document.head.appendChild(xe)}}D(),alert("Setările au fost salvate cu succes!")},A=async()=>{if(window.confirm("Sigur doriți să resetați toate setările la valorile implicite?")){const J={logo:{type:"upload",url:"",file:null},favicon:{type:"upload",url:"",file:null},headerColor:{primary:"#2563eb",secondary:"#4f46e5",useGradient:!0},background:{type:"color",color:"#f1f5f9",imageUrl:"",imageFile:null},loginImage:{type:"upload",url:"",file:null},loginButtonColor:{primary:"#FF7A00",secondary:"#FF9500",useGradient:!1},loginPageColor:{primary:"#FFFFFF",secondary:"#F5F5F5",useGradient:!1},loginCardColor:{primary:"#8B5CF6",secondary:"#A855F7",useGradient:!0},loginTextColor:{title:"#1e293b",labels:"#334155",text:"#64748b"},appTitle:"CASHPOT V7",appSubtitle:"Gaming Management System",loginTexts:{title:"Login",emailLabel:"Email",passwordLabel:"Password",buttonText:"Log In",forgotPassword:"Forgot Password?",termsText:"By clicking login you agree to the terms of the Club Membership Agreement and the Independent Partner Agreement",joinText:"Got an invitation? Join Now",supportText:"Need help? Contact us at login-support@in.group"}};l(J);try{const xe=await ae.get("/api/auth/verify");xe.data.success&&xe.data.user&&(await ae.put(`/api/users/${xe.data.user.id}/preferences`,{preferences:{appSettings:J}}),console.log("✅ Reset settings saved to server"))}catch(xe){console.error("❌ Error saving reset settings to server:",xe)}document.body.style.backgroundColor="#f1f5f9",document.body.style.backgroundImage="none",alert("Setările au fost resetate!")}},D=()=>{if(r.headerColor.useGradient){const xe=document.querySelector("header");xe&&(xe.style.background=`linear-gradient(to right, ${r.headerColor.primary}, ${r.headerColor.secondary})`)}else{const xe=document.querySelector("header");xe&&(xe.style.background=r.headerColor.primary)}if(r.background.type==="color")document.body.style.backgroundColor=r.background.color,document.body.style.backgroundImage="none";else if(r.background.type==="image"){const xe=r.background.imageFile||r.background.imageUrl;xe&&(document.body.style.backgroundImage=`url(${xe})`,document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center",document.body.style.backgroundAttachment="fixed")}const J=r.favicon.file||r.favicon.url;if(J){const xe=document.querySelector("link[rel~='icon']");xe&&(xe.href=J)}};return h.useEffect(()=>{D()},[r]),e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex space-x-1 bg-slate-100 rounded-xl p-1",children:[e("button",{onClick:()=>s("header"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="header"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(qs,{size:20}),e("span",{children:"Header"})]})}),e("button",{onClick:()=>s("main"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="main"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(zr,{size:20}),e("span",{children:"Pagina Principală"})]})}),e("button",{onClick:()=>s("login"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="login"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(Js,{size:20}),e("span",{children:"Login Page"})]})}),e("button",{onClick:()=>s("backup"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="backup"?"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ot,{size:20}),e("span",{children:"Backup BD"})]})})]})}),a==="header"&&e("div",{className:"space-y-6",children:t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(St,{className:"w-5 h-5 text-blue-600"}),e("span",{children:"Logo Aplicație"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-4",children:[t("button",{onClick:()=>o("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.logo.type==="upload"?"bg-blue-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ze,{className:"w-4 h-4 inline mr-2"}),"Upload"]}),t("button",{onClick:()=>o("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.logo.type==="link"?"bg-blue-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ta,{className:"w-4 h-4 inline mr-2"}),"Link"]})]}),r.logo.type==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Logo"}),e("input",{type:"file",accept:"image/*",onChange:c,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900/30 dark:file:text-blue-300 dark:hover:file:bg-blue-800/40"}),r.logo.file&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.logo.file,alt:"Logo Preview",className:"h-16 object-contain"})})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Logo"}),e("input",{type:"text",value:r.logo.url,onChange:J=>i(J.target.value),className:"input-field",placeholder:"https://example.com/logo.png"}),r.logo.url&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.logo.url,alt:"Logo Preview",className:"h-16 object-contain"})})]})]})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-purple-600"}),e("span",{children:"Culoare Header"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"gradientToggle",checked:r.headerColor.useGradient,onChange:J=>d("useGradient",J.target.checked),className:"form-checkbox rounded text-purple-600"}),e("label",{htmlFor:"gradientToggle",className:"text-sm font-semibold text-slate-700",children:"Folosește Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:r.headerColor.primary,onChange:J=>d("primary",J.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:r.headerColor.primary,onChange:J=>d("primary",J.target.value),className:"input-field flex-1",placeholder:"#2563eb"})]})]}),r.headerColor.useGradient&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:r.headerColor.secondary,onChange:J=>d("secondary",J.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:r.headerColor.secondary,onChange:J=>d("secondary",J.target.value),className:"input-field flex-1",placeholder:"#4f46e5"})]})]}),e("div",{className:"p-4 rounded-lg",style:{background:r.headerColor.useGradient?`linear-gradient(to right, ${r.headerColor.primary}, ${r.headerColor.secondary})`:r.headerColor.primary},children:e("p",{className:"text-white font-bold text-center",children:"Preview Header"})})]})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-teal-600"}),e("span",{children:"Texte Header"})]}),e("div",{className:"space-y-4",children:t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Titlu Aplicație"}),e("input",{type:"text",value:r.appTitle,onChange:J=>l({...r,appTitle:J.target.value}),className:"input-field",placeholder:"CASHPOT V7"}),e("p",{className:"text-xs text-slate-500",children:"Textul afișat în header"})]})})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(St,{className:"w-5 h-5 text-green-600"}),e("span",{children:"Favicon"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-4",children:[t("button",{onClick:()=>u("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.favicon.type==="upload"?"bg-green-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ze,{className:"w-4 h-4 inline mr-2"}),"Upload"]}),t("button",{onClick:()=>u("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.favicon.type==="link"?"bg-green-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ta,{className:"w-4 h-4 inline mr-2"}),"Link"]})]}),r.favicon.type==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Favicon"}),e("input",{type:"file",accept:"image/*,.ico",onChange:m,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100 dark:file:bg-green-900/30 dark:file:text-green-300 dark:hover:file:bg-green-800/40"}),r.favicon.file&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.favicon.file,alt:"Favicon Preview",className:"h-8 w-8 object-contain"})})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Favicon"}),e("input",{type:"text",value:r.favicon.url,onChange:J=>x(J.target.value),className:"input-field",placeholder:"https://example.com/favicon.ico"}),r.favicon.url&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.favicon.url,alt:"Favicon Preview",className:"h-8 w-8 object-contain"})})]})]})]})]})}),a==="main"&&e("div",{className:"space-y-6",children:t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(St,{className:"w-5 h-5 text-orange-600"}),e("span",{children:"Fundal Pagină"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>g("color"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${r.background.type==="color"?"bg-orange-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Culoare"}),e("button",{onClick:()=>g("image"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${r.background.type==="image"?"bg-orange-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Imagine"})]}),r.background.type==="color"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Fundal"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:r.background.color,onChange:J=>_(J.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:r.background.color,onChange:J=>_(J.target.value),className:"input-field flex-1",placeholder:"#f1f5f9"})]})]}):t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-4",children:[t("button",{onClick:()=>l({...r,background:{...r.background,imageType:"upload"}}),className:"flex-1 py-2 px-3 text-sm rounded-lg bg-slate-100 hover:bg-slate-200 font-semibold",children:[e(ze,{className:"w-4 h-4 inline mr-1"}),"Upload"]}),t("button",{onClick:()=>l({...r,background:{...r.background,imageType:"link"}}),className:"flex-1 py-2 px-3 text-sm rounded-lg bg-slate-100 hover:bg-slate-200 font-semibold",children:[e(ta,{className:"w-4 h-4 inline mr-1"}),"Link"]})]}),r.background.imageType==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Imagine"}),e("input",{type:"file",accept:"image/*",onChange:N,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100 dark:file:bg-orange-900/30 dark:file:text-orange-300 dark:hover:file:bg-orange-800/40"})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Imagine"}),e("input",{type:"text",value:r.background.imageUrl,onChange:J=>p(J.target.value),className:"input-field",placeholder:"https://example.com/background.jpg"})]})]})]})]})}),a==="login"&&t("div",{className:"space-y-6",children:[t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-teal-600"}),e("span",{children:"Texte Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Titlu Login"}),e("input",{type:"text",value:((U=r.loginTexts)==null?void 0:U.title)||"Login",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},title:J.target.value}}),className:"input-field",placeholder:"Login"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Etichetă Email"}),e("input",{type:"text",value:((j=r.loginTexts)==null?void 0:j.emailLabel)||"Email",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},emailLabel:J.target.value}}),className:"input-field",placeholder:"Email"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Etichetă Parolă"}),e("input",{type:"text",value:((v=r.loginTexts)==null?void 0:v.passwordLabel)||"Password",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},passwordLabel:J.target.value}}),className:"input-field",placeholder:"Password"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Text Buton"}),e("input",{type:"text",value:((z=r.loginTexts)==null?void 0:z.buttonText)||"Log In",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},buttonText:J.target.value}}),className:"input-field",placeholder:"Log In"})]}),t("div",{className:"space-y-2 lg:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:'Text "Forgot Password"'}),e("input",{type:"text",value:((S=r.loginTexts)==null?void 0:S.forgotPassword)||"Forgot Password?",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},forgotPassword:J.target.value}}),className:"input-field",placeholder:"Forgot Password?"})]}),t("div",{className:"space-y-2 lg:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Text Termeni"}),e("textarea",{value:((F=r.loginTexts)==null?void 0:F.termsText)||"",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},termsText:J.target.value}}),className:"input-field min-h-[60px] resize-none",placeholder:"By clicking login you agree to the terms..."})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:'Text "Join Now"'}),e("input",{type:"text",value:((I=r.loginTexts)==null?void 0:I.joinText)||"Got an invitation? Join Now",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},joinText:J.target.value}}),className:"input-field",placeholder:"Got an invitation? Join Now"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Text Support"}),e("input",{type:"text",value:((b=r.loginTexts)==null?void 0:b.supportText)||"Need help? Contact us at...",onChange:J=>l({...r,loginTexts:{...r.loginTexts||{},supportText:J.target.value}}),className:"input-field",placeholder:"Need help? Contact us at..."})]})]})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-pink-600"}),e("span",{children:"Culori Text Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Titlu"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((y=r.loginTextColor)==null?void 0:y.title)||"#1e293b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},title:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((L=r.loginTextColor)==null?void 0:L.title)||"#1e293b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},title:J.target.value}}),className:"input-field flex-1",placeholder:"#1e293b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-bold text-2xl text-center",style:{color:((Y=r.loginTextColor)==null?void 0:Y.title)||"#1e293b"},children:"Login"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Etichete"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((O=r.loginTextColor)==null?void 0:O.labels)||"#334155",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((G=r.loginTextColor)==null?void 0:G.labels)||"#334155",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:J.target.value}}),className:"input-field flex-1",placeholder:"#334155"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-semibold text-sm",style:{color:((C=r.loginTextColor)==null?void 0:C.labels)||"#334155"},children:"Email *"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Text Secundar"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((W=r.loginTextColor)==null?void 0:W.text)||"#64748b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},text:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((T=r.loginTextColor)==null?void 0:T.text)||"#64748b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},text:J.target.value}}),className:"input-field flex-1",placeholder:"#64748b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"text-xs text-center",style:{color:((Z=r.loginTextColor)==null?void 0:Z.text)||"#64748b"},children:"Terms & Support"})})]})]})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-indigo-600"}),e("span",{children:"Culori Fundal Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Fundal Formular"}),t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"loginPageGradient",checked:((se=r.loginPageColor)==null?void 0:se.useGradient)||!1,onChange:J=>l({...r,loginPageColor:{...r.loginPageColor,useGradient:J.target.checked}}),className:"form-checkbox rounded text-indigo-600"}),e("label",{htmlFor:"loginPageGradient",className:"text-sm font-semibold text-slate-700",children:"Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((ne=r.loginPageColor)==null?void 0:ne.primary)||"#FFFFFF",onChange:J=>l({...r,loginPageColor:{...r.loginPageColor,primary:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((ce=r.loginPageColor)==null?void 0:ce.primary)||"#FFFFFF",onChange:J=>l({...r,loginPageColor:{...r.loginPageColor,primary:J.target.value}}),className:"input-field flex-1"})]})]}),((Ce=r.loginPageColor)==null?void 0:Ce.useGradient)&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((Re=r.loginPageColor)==null?void 0:Re.secondary)||"#F5F5F5",onChange:J=>l({...r,loginPageColor:{...r.loginPageColor,secondary:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Ue=r.loginPageColor)==null?void 0:Ue.secondary)||"#F5F5F5",onChange:J=>l({...r,loginPageColor:{...r.loginPageColor,secondary:J.target.value}}),className:"input-field flex-1"})]})]}),e("div",{className:"p-4 rounded-lg",style:{background:(Ve=r.loginPageColor)!=null&&Ve.useGradient?`linear-gradient(to right, ${r.loginPageColor.primary}, ${r.loginPageColor.secondary})`:((et=r.loginPageColor)==null?void 0:et.primary)||"#FFFFFF"},children:e("p",{className:"text-slate-800 font-bold text-center",children:"Preview Fundal"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Card Sub Logo"}),t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"loginCardGradient",checked:((qe=r.loginCardColor)==null?void 0:qe.useGradient)||!1,onChange:J=>l({...r,loginCardColor:{...r.loginCardColor,useGradient:J.target.checked}}),className:"form-checkbox rounded text-purple-600"}),e("label",{htmlFor:"loginCardGradient",className:"text-sm font-semibold text-slate-700",children:"Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:(($e=r.loginCardColor)==null?void 0:$e.primary)||"#8B5CF6",onChange:J=>l({...r,loginCardColor:{...r.loginCardColor,primary:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Ze=r.loginCardColor)==null?void 0:Ze.primary)||"#8B5CF6",onChange:J=>l({...r,loginCardColor:{...r.loginCardColor,primary:J.target.value}}),className:"input-field flex-1",placeholder:"#8B5CF6"})]})]}),((Q=r.loginCardColor)==null?void 0:Q.useGradient)&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((de=r.loginCardColor)==null?void 0:de.secondary)||"#A855F7",onChange:J=>l({...r,loginCardColor:{...r.loginCardColor,secondary:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((ue=r.loginCardColor)==null?void 0:ue.secondary)||"#A855F7",onChange:J=>l({...r,loginCardColor:{...r.loginCardColor,secondary:J.target.value}}),className:"input-field flex-1",placeholder:"#A855F7"})]})]}),e("div",{className:"rounded-2xl shadow-2xl p-8",style:{background:(pe=r.loginCardColor)!=null&&pe.useGradient?`linear-gradient(to right, ${r.loginCardColor.primary}, ${r.loginCardColor.secondary})`:((Ae=r.loginCardColor)==null?void 0:Ae.primary)||"#8B5CF6"},children:e("p",{className:"text-white font-bold text-2xl text-center",children:"Login"})})]})]})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-orange-600"}),e("span",{children:"Culoare Buton Login"})]}),e("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Buton"}),t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"loginButtonGradient",checked:((ee=r.loginButtonColor)==null?void 0:ee.useGradient)||!1,onChange:J=>f("useGradient",J.target.checked),className:"form-checkbox rounded text-indigo-600"}),e("label",{htmlFor:"loginButtonGradient",className:"text-sm font-semibold text-slate-700",children:"Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((me=r.loginButtonColor)==null?void 0:me.primary)||"#FF7A00",onChange:J=>f("primary",J.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((fe=r.loginButtonColor)==null?void 0:fe.primary)||"#FF7A00",onChange:J=>f("primary",J.target.value),className:"input-field flex-1"})]})]}),((ie=r.loginButtonColor)==null?void 0:ie.useGradient)&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((le=r.loginButtonColor)==null?void 0:le.secondary)||"#FF9500",onChange:J=>f("secondary",J.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((be=r.loginButtonColor)==null?void 0:be.secondary)||"#FF9500",onChange:J=>f("secondary",J.target.value),className:"input-field flex-1"})]})]}),e("div",{className:"p-4 rounded-lg",style:{background:(te=r.loginButtonColor)!=null&&te.useGradient?`linear-gradient(to right, ${r.loginButtonColor.primary}, ${r.loginButtonColor.secondary})`:((oe=r.loginButtonColor)==null?void 0:oe.primary)||"#FF7A00"},children:e("p",{className:"text-white font-bold text-center",children:"Preview Button"})})]})})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-pink-600"}),e("span",{children:"Culori Text Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Titlu"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((Se=r.loginTextColor)==null?void 0:Se.title)||"#1e293b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},title:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Pe=r.loginTextColor)==null?void 0:Pe.title)||"#1e293b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},title:J.target.value}}),className:"input-field flex-1",placeholder:"#1e293b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-bold text-2xl text-center",style:{color:((Ee=r.loginTextColor)==null?void 0:Ee.title)||"#1e293b"},children:"Login"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Etichete"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((B=r.loginTextColor)==null?void 0:B.labels)||"#334155",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((M=r.loginTextColor)==null?void 0:M.labels)||"#334155",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:J.target.value}}),className:"input-field flex-1",placeholder:"#334155"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-semibold text-sm text-center",style:{color:((w=r.loginTextColor)==null?void 0:w.labels)||"#334155"},children:"Email *"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Text Secundar"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((V=r.loginTextColor)==null?void 0:V.text)||"#64748b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},text:J.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((K=r.loginTextColor)==null?void 0:K.text)||"#64748b",onChange:J=>l({...r,loginTextColor:{...r.loginTextColor||{},text:J.target.value}}),className:"input-field flex-1",placeholder:"#64748b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"text-xs text-center",style:{color:((we=r.loginTextColor)==null?void 0:we.text)||"#64748b"},children:"Terms"})})]})]})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(St,{className:"w-5 h-5 text-indigo-600"}),e("span",{children:"Imagine Fundal Login"})]}),t("div",{className:"flex space-x-4 mb-4",children:[t("button",{onClick:()=>k("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${((Le=r.loginImage)==null?void 0:Le.type)==="upload"?"bg-indigo-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e(ze,{className:"w-4 h-4 inline mr-2"}),"Upload"]}),t("button",{onClick:()=>k("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${((Je=r.loginImage)==null?void 0:Je.type)==="link"?"bg-indigo-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e(ta,{className:"w-4 h-4 inline mr-2"}),"Link"]})]}),((Be=r.loginImage)==null?void 0:Be.type)==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Imagine"}),e("input",{type:"file",accept:"image/*",onChange:P,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 dark:file:bg-indigo-900/30 dark:file:text-indigo-300 dark:hover:file:bg-indigo-800/40"}),((nt=r.loginImage)==null?void 0:nt.file)&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.loginImage.file,alt:"Login Preview",className:"h-32 w-full object-cover rounded"})})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Imagine"}),e("input",{type:"text",value:((Dt=r.loginImage)==null?void 0:Dt.url)||"",onChange:J=>E(J.target.value),className:"input-field",placeholder:"https://example.com/login-bg.jpg"}),((Jt=r.loginImage)==null?void 0:Jt.url)&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.loginImage.url,alt:"Login Preview",className:"h-32 w-full object-cover rounded"})})]})]})]}),a==="backup"&&e(Bo,{compact:!1}),a!=="backup"&&e("div",{className:"card p-6",children:t("div",{className:"flex justify-end space-x-4",children:[t("button",{onClick:A,className:"btn-secondary flex items-center space-x-2",children:[e(ut,{size:18}),e("span",{children:"Resetează"})]}),t("button",{onClick:R,className:"btn-primary flex items-center space-x-2",children:[e(qt,{size:18}),e("span",{children:"Salvează Setări"})]})]})})]})})},Go=({task:a,users:s,onSubmit:r,onClose:l})=>{const n=()=>new Date().toISOString().split("T")[0],[o,i]=h.useState({title:"",description:"",priority:"medium",assigned_to:[],due_date:n()});h.useEffect(()=>{i(a?{title:a.title||"",description:a.description||"",priority:a.priority||"medium",assigned_to:a.assigned_users?a.assigned_users.map(m=>m.id):[],due_date:a.due_date?new Date(a.due_date).toISOString().split("T")[0]:n()}:{title:"",description:"",priority:"medium",assigned_to:[],due_date:n()})},[a]);const c=m=>{m.preventDefault(),r(o)},u=m=>{const{name:d,value:g}=m.target;i(_=>({..._,[d]:g}))},x=m=>{const d=Array.from(m.target.selectedOptions,g=>parseInt(g.value));i(g=>({...g,assigned_to:d}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(zt,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează sarcina":"Sarcină nouă"}),e("p",{className:"text-blue-100 text-sm",children:"Gestionare sarcini echipă"})]})]}),e("button",{onClick:l,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:c,className:"p-6 space-y-6",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(zt,{className:"w-4 h-4 inline mr-2"}),"Titlu *"]}),e("input",{type:"text",name:"title",value:o.title,onChange:u,required:!0,placeholder:"Titlul sarcinii...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Descriere"}),e("textarea",{name:"description",value:o.description,onChange:u,rows:3,placeholder:"Descrierea sarcinii...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(lt,{className:"w-4 h-4 inline mr-2"}),"Prioritate"]}),t("select",{name:"priority",value:o.priority,onChange:u,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,children:[e("option",{value:"low",children:"Mică"}),e("option",{value:"medium",children:"Medie"}),e("option",{value:"high",children:"Mare"}),e("option",{value:"urgent",children:"Urgent"})]})]}),t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(Me,{className:"w-4 h-4 inline mr-2"}),"Termen limită"]}),e("input",{type:"date",name:"due_date",value:o.due_date,onChange:u,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]})]}),t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(xt,{className:"w-4 h-4 inline mr-2"}),"Responsabili"]}),e("select",{multiple:!0,value:o.assigned_to,onChange:x,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,size:4,children:s.map(m=>e("option",{value:m.id,children:m.full_name||m.username},m.id))}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"Ține apăsat Ctrl pentru a selecta mai mulți utilizatori"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t-2 border-slate-200 dark:border-slate-600",children:[e("button",{type:"button",onClick:l,className:`px-6 py-3 rounded-xl border-2 border-slate-300 dark:border-slate-600 
                       text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 
                       transition-all font-medium`,children:"Anulează"}),e("button",{type:"submit",className:`px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl 
                       hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg font-medium`,children:a?"Actualizează":"Creează"})]})]})]})})},Vo=()=>{const{tasks:a,users:s,loading:r,refreshData:l}=ye(),{user:n}=Rt(),[o,i]=h.useState(!1),[c,u]=h.useState(null),[x,m]=h.useState(""),[d,g]=h.useState("all"),[_,p]=h.useState("all"),[N,k]=h.useState([]),E=a.filter(y=>{var G,C;const L=((G=y.title)==null?void 0:G.toLowerCase().includes(x.toLowerCase()))||((C=y.description)==null?void 0:C.toLowerCase().includes(x.toLowerCase())),Y=d==="all"||y.status===d,O=_==="all"||y.priority===_;return L&&Y&&O}),P=y=>{switch(y){case"urgent":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-blue-600 bg-blue-50 border-blue-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},f=y=>{switch(y){case"completed":return"text-green-600 bg-green-50 border-green-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"pending":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},R=y=>{switch(y){case"completed":return"Finalizată";case"in_progress":return"În progres";case"pending":return"Așteaptă";case"cancelled":return"Anulată";default:return y}},A=y=>{switch(y){case"urgent":return"Urgent";case"high":return"Mare";case"medium":return"Medie";case"low":return"Mică";default:return y}},D=async y=>{var L,Y;try{const O=await ae.put(`/api/tasks/${y.id}/toggle-check`);O.data.allChecked?ke.success("Toți utilizatorii au bifat! Sarcină completată!"):ke.success(O.data.message),l()}catch(O){console.error("Error toggling check:",O),ke.error(((Y=(L=O.response)==null?void 0:L.data)==null?void 0:Y.error)||"Eroare la bifarea sarcinii!")}},U=async y=>{if(window.confirm("Ești sigur că vrei să ștergi această sarcină?"))try{await ae.delete(`/api/tasks/${y.id}`),ke.success("Sarcina a fost ștearsă!"),l()}catch(L){console.error("Error deleting task:",L),ke.error("Eroare la ștergerea sarcinii!")}},j=async y=>{try{c?(await ae.put(`/api/tasks/${c.id}`,y),ke.success("Sarcina a fost actualizată!")):(await ae.post("/api/tasks",y),ke.success("Sarcina a fost creată!")),i(!1),u(null),l()}catch(L){console.error("Error saving task:",L),ke.error("Eroare la salvarea sarcinii!")}},v=[{key:"check",label:"BIFARE",sortable:!1,render:y=>{const L=y.assigned_users||[],Y=y.checked_users||[],O=L.some(C=>C.id===(n==null?void 0:n.userId)),G=Y.some(C=>C.id===(n==null?void 0:n.userId));return O?t("div",{className:"flex flex-col items-center space-y-1",children:[e("button",{onClick:()=>D(y),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:G?"Debifează":"Bifează ca îndeplinit",children:G?e(zt,{className:"w-5 h-5 text-green-600"}):e(Tr,{className:"w-5 h-5 text-gray-400"})}),t("span",{className:"text-xs text-gray-500",children:[Y.length,"/",L.length]})]}):e("span",{className:"text-gray-400 text-xs",children:"-"})}},{key:"title",label:"TITLU",sortable:!0,render:y=>t("div",{children:[e("div",{className:"font-semibold text-gray-900",children:y.title}),y.description&&e("div",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:y.description})]})},{key:"priority",label:"PRIORITATE",sortable:!0,render:y=>e("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${P(y.priority)}`,children:A(y.priority)})},{key:"status",label:"STATUS",sortable:!0,render:y=>e("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${f(y.status)}`,children:R(y.status)})},{key:"assigned_users",label:"RESPONSABILI",sortable:!1,render:y=>e("div",{className:"flex flex-wrap gap-1",children:y.assigned_users&&y.assigned_users.length>0?y.assigned_users.map((L,Y)=>e("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:L.full_name||L.username},Y)):e("span",{className:"text-gray-400 text-sm",children:"Niciun responsabil"})})},{key:"due_date",label:"TERMEN",sortable:!0,render:y=>{if(!y.due_date)return e("span",{className:"text-gray-400",children:"-"});const L=new Date(y.due_date),Y=new Date,O=L<Y&&y.status!=="completed",G=L.toDateString()===Y.toDateString();return t("div",{className:`text-sm ${O?"text-red-600 font-semibold":G?"text-orange-600 font-semibold":"text-gray-600"}`,children:[L.toLocaleDateString("ro-RO"),O&&e(Ut,{className:"w-4 h-4 inline ml-1"}),G&&e(dt,{className:"w-4 h-4 inline ml-1"})]})}},{key:"created_by_name",label:"CREAT DE",sortable:!1,render:y=>e("span",{className:"text-sm text-gray-600",children:y.created_by_full_name||y.created_by_name||"Unknown"})},{key:"created_at",label:"CREAT",sortable:!0,render:y=>e("span",{className:"text-sm text-gray-500",children:new Date(y.created_at).toLocaleDateString("ro-RO")})},{key:"actions",label:"ACȚIUNI",sortable:!1,render:y=>{var L;return t("div",{className:"flex items-center space-x-2",children:[((L=y.assigned_to)==null?void 0:L.includes(n==null?void 0:n.userId))&&y.status!=="completed"&&t("button",{onClick:()=>F(y),className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md hover:bg-green-700 transition-colors",children:[e(zt,{className:"w-4 h-4 inline mr-1"}),"Complete"]}),y.status==="completed"&&!y.approved_by&&(y.created_by===(n==null?void 0:n.userId)||(n==null?void 0:n.role)==="admin")&&t("button",{onClick:()=>I(y),className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 transition-colors",children:[e(zt,{className:"w-4 h-4 inline mr-1"}),"Aprobă"]}),y.completed_by&&t("span",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:["Finalizat de: ",y.completed_by_full_name||y.completed_by_name]}),y.approved_by&&t("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:["Aprobat de: ",y.approved_by_full_name||y.approved_by_name]})]})}}],z=y=>{u(y),i(!0)},S=()=>{u(null),i(!0)},F=async y=>{if(window.confirm("Confirmă finalizarea acestei sarcini?"))try{const L=prompt("Adaugă nota de finalizare (opțional):");await ae.put(`/api/tasks/${y.id}/complete`,{completion_notes:L}),ke.success("Sarcina a fost marcată ca finalizată!"),l()}catch(L){console.error("Error completing task:",L),ke.error("Eroare la finalizarea sarcinii!")}},I=async y=>{if(window.confirm("Confirmă aprobarea finalizării acestei sarcini?"))try{const L=prompt("Adaugă nota de aprobare (opțional):");await ae.put(`/api/tasks/${y.id}/approve`,{approval_notes:L}),ke.success("Finalizarea sarcinii a fost aprobată!"),l()}catch(L){console.error("Error approving task:",L),ke.error("Eroare la aprobarea sarcinii!")}},b={total:a.length,pending:a.filter(y=>y.status==="pending").length,inProgress:a.filter(y=>y.status==="in_progress").length,completed:a.filter(y=>y.status==="completed").length,overdue:a.filter(y=>!y.due_date||y.status==="completed"?!1:new Date(y.due_date)<new Date).length};return t(he,{children:[t("div",{className:"space-y-6",children:[t("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Sarcini"}),e("p",{className:"text-gray-600",children:"Gestionează sarcinile echipei"})]}),t("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e(Ie,{className:"w-4 h-4"}),"Sarcină nouă"]})]}),t("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e(zt,{className:"w-5 h-5 text-blue-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:b.total}),e("div",{className:"text-sm text-gray-500",children:"Total"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:e(dt,{className:"w-5 h-5 text-yellow-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:b.pending}),e("div",{className:"text-sm text-gray-500",children:"Așteaptă"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e(dt,{className:"w-5 h-5 text-blue-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:b.inProgress}),e("div",{className:"text-sm text-gray-500",children:"În progres"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e(zt,{className:"w-5 h-5 text-green-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:b.completed}),e("div",{className:"text-sm text-gray-500",children:"Finalizate"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e(Ut,{className:"w-5 h-5 text-red-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:b.overdue}),e("div",{className:"text-sm text-gray-500",children:"Întârziate"})]})]})})]}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex flex-col sm:flex-row gap-4",children:[e("div",{className:"flex-1",children:e("input",{type:"text",placeholder:"Caută sarcini...",value:x,onChange:y=>m(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),t("select",{value:d,onChange:y=>g(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"all",children:"Toate statusurile"}),e("option",{value:"pending",children:"Așteaptă"}),e("option",{value:"in_progress",children:"În progres"}),e("option",{value:"completed",children:"Finalizată"}),e("option",{value:"cancelled",children:"Anulată"})]}),t("select",{value:_,onChange:y=>p(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"all",children:"Toate prioritățile"}),e("option",{value:"urgent",children:"Urgent"}),e("option",{value:"high",children:"Mare"}),e("option",{value:"medium",children:"Medie"}),e("option",{value:"low",children:"Mică"})]})]})}),e(He,{data:E,columns:v,onEdit:z,onDelete:U,loading:r,searchTerm:x,onSearchChange:m,moduleColor:"blue",selectedItems:N,onSelectionChange:k})]}),o&&e(Go,{task:c,users:s,onSubmit:j,onClose:()=>{i(!1),u(null)}})]})},qo=()=>{const{messages:a,users:s,loading:r,refreshData:l}=ye(),{user:n}=Rt(),[o,i]=h.useState(null),[c,u]=h.useState(""),[x,m]=h.useState(!1),[d,g]=h.useState(""),[_,p]=h.useState([]),N=h.useRef(null),k=h.useRef(null),P=(()=>{const v=new Map;return a.forEach(z=>{const S=z.sender_id===(n==null?void 0:n.userId)?z.recipient_id:z.sender_id,F=s.find(y=>y.id===S);if(!F)return;const I=`${Math.min(z.sender_id,z.recipient_id)}-${Math.max(z.sender_id,z.recipient_id)}`;v.has(I)||v.set(I,{otherUser:F,lastMessage:z,unreadCount:0,messages:[]});const b=v.get(I);b.messages.push(z),z.recipient_id===(n==null?void 0:n.userId)&&!z.is_read&&b.unreadCount++,new Date(z.created_at)>new Date(b.lastMessage.created_at)&&(b.lastMessage=z)}),Array.from(v.values()).sort((z,S)=>new Date(S.lastMessage.created_at)-new Date(z.lastMessage.created_at))})(),f=P.filter(v=>{var z,S,F,I;return((z=v.otherUser.full_name)==null?void 0:z.toLowerCase().includes(d.toLowerCase()))||((S=v.otherUser.username)==null?void 0:S.toLowerCase().includes(d.toLowerCase()))||((F=v.lastMessage.subject)==null?void 0:F.toLowerCase().includes(d.toLowerCase()))||((I=v.lastMessage.content)==null?void 0:I.toLowerCase().includes(d.toLowerCase()))}),R=o?a.filter(v=>v.sender_id===(n==null?void 0:n.userId)&&v.recipient_id===o.otherUser.id||v.recipient_id===(n==null?void 0:n.userId)&&v.sender_id===o.otherUser.id).sort((v,z)=>new Date(v.created_at)-new Date(z.created_at)):[];h.useEffect(()=>{var v;(v=k.current)==null||v.scrollIntoView({behavior:"smooth"})},[R]),h.useEffect(()=>{if(o){const v=R.filter(z=>z.recipient_id===(n==null?void 0:n.userId)&&!z.is_read);v.forEach(async z=>{try{await ae.put(`/api/messages/${z.id}/read`)}catch(S){console.error("Error marking message as read:",S)}}),v.length>0&&l()}},[o,R,n==null?void 0:n.userId,l]);const A=async()=>{if(!(!c.trim()||!o))try{await ae.post("/api/messages",{recipient_id:o.otherUser.id,subject:`Mesaj pentru ${o.otherUser.full_name||o.otherUser.username}`,content:c,file_attachments:_.map(v=>v.name)}),u(""),p([]),ke.success("Mesajul a fost trimis!"),l()}catch(v){console.error("Error sending message:",v),ke.error("Eroare la trimiterea mesajului!")}},D=async v=>{try{await ae.post("/api/messages",v),ke.success("Mesajul a fost trimis!"),m(!1),l()}catch(z){console.error("Error sending message:",z),ke.error("Eroare la trimiterea mesajului!")}},U=v=>{const z=Array.from(v.target.files);p(z)},j=v=>{const z=new Date(v);return(new Date-z)/(1e3*60*60)<24?z.toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit"}):z.toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit"})};return P.reduce((v,z)=>v+z.unreadCount,0),t(he,{children:[t("div",{className:"flex h-[calc(100vh-8rem)] bg-white rounded-lg border border-gray-200 overflow-hidden",children:[t("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[t("div",{className:"p-4 border-b border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h1",{className:"text-xl font-bold",children:"Mesaje"}),t("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e(Ie,{className:"w-4 h-4"}),"Nou"]})]}),t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e("input",{type:"text",placeholder:"Caută conversații...",value:d,onChange:v=>g(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e("div",{className:"flex-1 overflow-y-auto",children:f.length===0?e("div",{className:"p-4 text-center text-gray-500",children:d?"Nu s-au găsit conversații.":"Nu ai mesaje încă."}):f.map(v=>{const z=v.lastMessage,S=v.unreadCount>0;return e("button",{onClick:()=>i(v),className:`w-full p-4 text-left border-b border-gray-100 hover:bg-gray-50 transition-colors ${(o==null?void 0:o.otherUser.id)===v.otherUser.id?"bg-blue-50 border-blue-200":""}`,children:t("div",{className:"flex items-start gap-3",children:[e("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:e(yt,{className:"w-5 h-5 text-blue-600"})}),t("div",{className:"flex-1 min-w-0",children:[t("div",{className:"flex items-center justify-between",children:[e("h3",{className:`font-semibold truncate ${S?"text-gray-900":"text-gray-700"}`,children:v.otherUser.full_name||v.otherUser.username}),e("span",{className:"text-xs text-gray-500 flex-shrink-0 ml-2",children:j(z.created_at)})]}),e("p",{className:`text-sm truncate mt-1 ${S?"text-gray-900 font-medium":"text-gray-600"}`,children:z.content}),S&&e("div",{className:"flex justify-end mt-2",children:e("span",{className:"bg-blue-600 text-white text-xs px-2 py-1 rounded-full",children:v.unreadCount})})]})]})},`${v.otherUser.id}`)})})]}),e("div",{className:"flex-1 flex flex-col",children:o?t(De,{children:[e("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e(yt,{className:"w-4 h-4 text-blue-600"})}),t("div",{children:[e("h2",{className:"font-semibold text-gray-900",children:o.otherUser.full_name||o.otherUser.username}),e("p",{className:"text-sm text-gray-500",children:o.otherUser.email})]})]})}),t("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[R.map(v=>{const z=v.sender_id===(n==null?void 0:n.userId);return e("div",{className:`flex ${z?"justify-end":"justify-start"}`,children:t("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${z?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e("p",{className:"text-sm",children:v.content}),v.file_attachments&&v.file_attachments.length>0&&e("div",{className:"mt-2 space-y-1",children:v.file_attachments.map((S,F)=>t("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[e(La,{className:"w-3 h-3"}),e("span",{className:"truncate",children:S})]},F))}),t("div",{className:`text-xs mt-1 ${z?"text-blue-100":"text-gray-500"}`,children:[j(v.created_at),z&&v.is_read&&e("span",{className:"ml-1",children:"✓"})]})]})},v.id)}),e("div",{ref:k})]}),t("div",{className:"p-4 border-t border-gray-200",children:[_.length>0&&e("div",{className:"mb-3",children:e("div",{className:"flex flex-wrap gap-2",children:_.map((v,z)=>t("div",{className:"flex items-center gap-2 bg-gray-100 px-3 py-1 rounded-lg text-sm",children:[e(La,{className:"w-4 h-4"}),e("span",{children:v.name})]},z))})}),t("div",{className:"flex gap-2",children:[e("input",{type:"file",ref:N,onChange:U,multiple:!0,className:"hidden"}),e("button",{onClick:()=>{var v;return(v=N.current)==null?void 0:v.click()},className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:e(La,{className:"w-4 h-4"})}),e("input",{type:"text",value:c,onChange:v=>u(v.target.value),onKeyPress:v=>v.key==="Enter"&&A(),placeholder:"Scrie un mesaj...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e("button",{onClick:A,disabled:!c.trim(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e(Hs,{className:"w-4 h-4"})})]})]})]}):e("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:t("div",{className:"text-center",children:[e(Xt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e("h3",{className:"text-lg font-medium mb-2",children:"Selectează o conversație"}),e("p",{children:"Choose a conversation from the list to start messaging"})]})})})]}),x&&e(Jo,{users:s.filter(v=>v.id!==(n==null?void 0:n.userId)),onSubmit:D,onClose:()=>m(!1)})]})},Jo=({users:a,onSubmit:s,onClose:r})=>{const[l,n]=h.useState({recipient_id:"",subject:"",content:"",file_attachments:[]}),o=h.useRef(null),i=u=>{if(u.preventDefault(),!l.recipient_id||!l.content.trim()){ke.error("Recipient și conținut sunt obligatorii!");return}s(l)},c=u=>{const x=Array.from(u.target.files);n({...l,file_attachments:x})};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:t("div",{className:"p-6",children:[e("h2",{className:"text-xl font-bold mb-4",children:"Mesaj nou"}),t("form",{onSubmit:i,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destinatar *"}),t("select",{required:!0,value:l.recipient_id,onChange:u=>n({...l,recipient_id:parseInt(u.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Selectează utilizator"}),a.map(u=>e("option",{value:u.id,children:u.full_name||u.username},u.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subiect"}),e("input",{type:"text",value:l.subject,onChange:u=>n({...l,subject:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mesaj *"}),e("textarea",{required:!0,value:l.content,onChange:u=>n({...l,content:u.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Atașamente"}),e("input",{type:"file",ref:o,onChange:c,multiple:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),l.file_attachments.length>0&&t("div",{className:"mt-2",children:[e("p",{className:"text-sm text-gray-600",children:"Fișiere selectate:"}),e("div",{className:"flex flex-wrap gap-2 mt-1",children:l.file_attachments.map((u,x)=>e("span",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:u.name},x))})]})]}),t("div",{className:"flex gap-3 pt-4",children:[e("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Trimite"}),e("button",{type:"button",onClick:r,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Anulează"})]})]})]})})})};function Ho(){return e(wi,{children:e(ki,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:t(ks,{children:[e(Te,{path:"/login",element:e(Si,{})}),e(Te,{path:"/",element:e(aa,{to:"/companies",replace:!0})}),e(Te,{path:"/companies",element:e(Oe,{module:q.COMPANIES,children:e(Ti,{})})}),e(Te,{path:"/companies/:id",element:e(Oe,{module:q.COMPANIES,children:e(Ao,{})})}),e(Te,{path:"/locations",element:e(Oe,{module:q.LOCATIONS,children:e(Fi,{})})}),e(Te,{path:"/locations/:id",element:e(Oe,{module:q.LOCATIONS,children:e(ji,{})})}),e(Te,{path:"/providers",element:e(Oe,{module:q.PROVIDERS,children:e(Bi,{})})}),e(Te,{path:"/cabinets",element:e(Oe,{module:q.CABINETS,children:e(qi,{})})}),e(Te,{path:"/game-mixes",element:e(Oe,{module:q.GAME_MIXES,children:e(Yi,{})})}),e(Te,{path:"/games/:gameId",element:e(Oe,{module:q.SLOTS,children:e(lo,{})})}),e(Te,{path:"/slots",element:e(Oe,{module:q.SLOTS,children:e(oo,{})})}),e(Te,{path:"/slots/history",element:e(Oe,{module:q.SLOTS,children:e(mo,{})})}),e(Te,{path:"/slots/cyber-import",element:e(Oe,{module:q.CYBER_IMPORT,children:e(io,{})})}),e(Te,{path:"/slots/:id",element:e(Oe,{module:q.SLOTS,children:e(co,{})})}),e(Te,{path:"/warehouse",element:e(Oe,{module:q.WAREHOUSE,children:e(ho,{})})}),e(Te,{path:"/metrology",element:e(Oe,{module:q.METROLOGY,children:e(vo,{})})}),e(Te,{path:"/approval-detail/:id",element:e(Oe,{module:q.METROLOGY,children:e(yo,{})})}),e(Te,{path:"/jackpots",element:e(Oe,{module:q.JACKPOTS,children:e(ko,{})})}),e(Te,{path:"/invoices",element:e(Oe,{module:q.INVOICES,children:e(So,{})})}),e(Te,{path:"/invoices/:id",element:e(Oe,{module:q.INVOICES,children:e(_o,{})})}),e(Te,{path:"/onjn-reports",element:e(Oe,{module:q.ONJN,children:e(Do,{})})}),e(Te,{path:"/onjn-operators",element:e(Oe,{module:q.ONJN,children:e(Io,{})})}),e(Te,{path:"/onjn-operators/brand/:brandName",element:e(Oe,{module:q.ONJN,children:e(Ro,{})})}),e(Te,{path:"/legal-documents",element:e(Oe,{module:q.LEGAL,children:e(jo,{})})}),e(Te,{path:"/marketing",element:e(Oe,{module:q.MARKETING,children:e(eo,{})})}),e(Te,{path:"/marketing-ai",element:e(Oe,{module:q.MARKETING,children:e(ao,{})})}),e(Te,{path:"/marketing/:id",element:e(Oe,{module:q.MARKETING,children:e(ro,{})})}),e(Te,{path:"/tasks",element:e(Er,{children:e(Vo,{})})}),e(Te,{path:"/messages",element:e(Er,{children:e(qo,{})})}),e(Te,{path:"/users",element:e(Oe,{requiredRole:"admin",children:e($o,{})})}),e(Te,{path:"/settings",element:e(Oe,{module:q.SETTINGS,children:e(Uo,{})})}),e(Te,{path:"*",element:e(aa,{to:"/login",replace:!0})})]})})})})}ja.createRoot(document.getElementById("root")).render(e($t.StrictMode,{children:e(Gl,{children:t(Cs,{children:[e(Ho,{}),e(Bl,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff",borderRadius:"12px",padding:"16px",fontSize:"14px",fontWeight:"500"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}));
