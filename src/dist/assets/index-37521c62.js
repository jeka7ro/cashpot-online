import{r as h,a as zs,b as va}from"./vendor-b69f2a9f.js";import{N as Ht,u as He,a as Ps,L as Ls,b as It,R as Is,c as Ee,B as Rs}from"./router-c483c27c.js";import{E as Xa,a as Qe,B as it,b as _e,M as We,U as bt,G as ct,C as $t,P as At,A as Yt,T as Gt,F as ge,S as ya,c as lt,d as zt,e as or,f as Lt,g as Os,h as Fs,i as js,j as Ia,X as ve,L as Ms,k as $s,l as Bs,R as ht,D as ot,m as cr,H as Ma,n as dt,o as kt,p as nt,q as ze,r as Je,s as Us,t as Bt,u as Me,v as Ut,w as $r,x as Gs,y as Ka,Z as sa,z as tt,I as Fe,J as _t,K as na,N as Qt,O as Vs,Q as Ge,V as Ie,W as yt,Y as Br,_ as et,$ as dr,a0 as jt,a1 as Ur,a2 as Xt,a3 as qs,a4 as Js,a5 as Gr,a6 as pt,a7 as Vr,a8 as Ws,a9 as Hs,aa as Ys,ab as Za,ac as la,ad as mr,ae as qt,af as Kt,ag as Xs,ah as Ks,ai as ra,aj as Zs,ak as ur,al as Qs,am as el,an as tl,ao as al,ap as Ft,aq as Ra,ar as rl}from"./icons-eda47c46.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var qr={exports:{}},Sa={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sl=h,ll=Symbol.for("react.element"),nl=Symbol.for("react.fragment"),il=Object.prototype.hasOwnProperty,ol=sl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cl={key:!0,ref:!0,__self:!0,__source:!0};function Jr(a,s,r){var l,n={},i=null,o=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(l in s)il.call(s,l)&&!cl.hasOwnProperty(l)&&(n[l]=s[l]);if(a&&a.defaultProps)for(l in s=a.defaultProps,s)n[l]===void 0&&(n[l]=s[l]);return{$$typeof:ll,type:a,key:i,ref:o,props:n,_owner:ol.current}}Sa.Fragment=nl;Sa.jsx=Jr;Sa.jsxs=Jr;qr.exports=Sa;var Qa=qr.exports;const De=Qa.Fragment,e=Qa.jsx,t=Qa.jsxs;var $a={},hr=zs;$a.createRoot=hr.createRoot,$a.hydrateRoot=hr.hydrateRoot;let dl={data:""},ml=a=>{if(typeof window=="object"){let s=(a?a.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(a||document.head).appendChild(s),s.firstChild}return a||dl},ul=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,hl=/\/\*[^]*?\*\/|  +/g,pr=/\n+/g,Pt=(a,s)=>{let r="",l="",n="";for(let i in a){let o=a[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":l+=i[1]=="f"?Pt(o,i):i+"{"+Pt(o,i[1]=="k"?"":s)+"}":typeof o=="object"?l+=Pt(o,s?s.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,c):c?c+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Pt.p?Pt.p(i,o):i+":"+o+";")}return r+(s&&n?s+"{"+n+"}":n)+l},St={},Wr=a=>{if(typeof a=="object"){let s="";for(let r in a)s+=r+Wr(a[r]);return s}return a},pl=(a,s,r,l,n)=>{let i=Wr(a),o=St[i]||(St[i]=(u=>{let p=0,m=11;for(;p<u.length;)m=101*m+u.charCodeAt(p++)>>>0;return"go"+m})(i));if(!St[o]){let u=i!==a?a:(p=>{let m,d,f=[{}];for(;m=ul.exec(p.replace(hl,""));)m[4]?f.shift():m[3]?(d=m[3].replace(pr," ").trim(),f.unshift(f[0][d]=f[0][d]||{})):f[0][m[1]]=m[2].replace(pr," ").trim();return f[0]})(a);St[o]=Pt(n?{["@keyframes "+o]:u}:u,r?"":"."+o)}let c=r&&St.g?St.g:null;return r&&(St.g=St[o]),((u,p,m,d)=>{d?p.data=p.data.replace(d,u):p.data.indexOf(u)===-1&&(p.data=m?u+p.data:p.data+u)})(St[o],s,l,c),o},xl=(a,s,r)=>a.reduce((l,n,i)=>{let o=s[i];if(o&&o.call){let c=o(r),u=c&&c.props&&c.props.className||/^go/.test(c)&&c;o=u?"."+u:c&&typeof c=="object"?c.props?"":Pt(c,""):c===!1?"":c}return l+n+(o??"")},"");function _a(a){let s=this||{},r=a.call?a(s.p):a;return pl(r.unshift?r.raw?xl(r,[].slice.call(arguments,1),s.p):r.reduce((l,n)=>Object.assign(l,n&&n.call?n(s.p):n),{}):r,ml(s.target),s.g,s.o,s.k)}let Hr,Ba,Ua;_a.bind({g:1});let Et=_a.bind({k:1});function bl(a,s,r,l){Pt.p=s,Hr=a,Ba=r,Ua=l}function Rt(a,s){let r=this||{};return function(){let l=arguments;function n(i,o){let c=Object.assign({},i),u=c.className||n.className;r.p=Object.assign({theme:Ba&&Ba()},c),r.o=/ *go\d+/.test(u),c.className=_a.apply(r,l)+(u?" "+u:""),s&&(c.ref=o);let p=a;return a[0]&&(p=c.as||a,delete c.as),Ua&&p[0]&&Ua(c),Hr(p,c)}return s?s(n):n}}var gl=a=>typeof a=="function",wa=(a,s)=>gl(a)?a(s):a,fl=(()=>{let a=0;return()=>(++a).toString()})(),Yr=(()=>{let a;return()=>{if(a===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");a=!s||s.matches}return a}})(),Nl=20,er="default",Xr=(a,s)=>{let{toastLimit:r}=a.settings;switch(s.type){case 0:return{...a,toasts:[s.toast,...a.toasts].slice(0,r)};case 1:return{...a,toasts:a.toasts.map(o=>o.id===s.toast.id?{...o,...s.toast}:o)};case 2:let{toast:l}=s;return Xr(a,{type:a.toasts.find(o=>o.id===l.id)?1:0,toast:l});case 3:let{toastId:n}=s;return{...a,toasts:a.toasts.map(o=>o.id===n||n===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return s.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(o=>o.id!==s.toastId)};case 5:return{...a,pausedAt:s.time};case 6:let i=s.time-(a.pausedAt||0);return{...a,pausedAt:void 0,toasts:a.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},ha=[],Kr={toasts:[],pausedAt:void 0,settings:{toastLimit:Nl}},vt={},Zr=(a,s=er)=>{vt[s]=Xr(vt[s]||Kr,a),ha.forEach(([r,l])=>{r===s&&l(vt[s])})},Qr=a=>Object.keys(vt).forEach(s=>Zr(a,s)),vl=a=>Object.keys(vt).find(s=>vt[s].toasts.some(r=>r.id===a)),Aa=(a=er)=>s=>{Zr(s,a)},yl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},wl=(a={},s=er)=>{let[r,l]=h.useState(vt[s]||Kr),n=h.useRef(vt[s]);h.useEffect(()=>(n.current!==vt[s]&&l(vt[s]),ha.push([s,l]),()=>{let o=ha.findIndex(([c])=>c===s);o>-1&&ha.splice(o,1)}),[s]);let i=r.toasts.map(o=>{var c,u,p;return{...a,...a[o.type],...o,removeDelay:o.removeDelay||((c=a[o.type])==null?void 0:c.removeDelay)||(a==null?void 0:a.removeDelay),duration:o.duration||((u=a[o.type])==null?void 0:u.duration)||(a==null?void 0:a.duration)||yl[o.type],style:{...a.style,...(p=a[o.type])==null?void 0:p.style,...o.style}}});return{...r,toasts:i}},kl=(a,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:a,pauseDuration:0,...r,id:(r==null?void 0:r.id)||fl()}),ia=a=>(s,r)=>{let l=kl(s,a,r);return Aa(l.toasterId||vl(l.id))({type:2,toast:l}),l.id},U=(a,s)=>ia("blank")(a,s);U.error=ia("error");U.success=ia("success");U.loading=ia("loading");U.custom=ia("custom");U.dismiss=(a,s)=>{let r={type:3,toastId:a};s?Aa(s)(r):Qr(r)};U.dismissAll=a=>U.dismiss(void 0,a);U.remove=(a,s)=>{let r={type:4,toastId:a};s?Aa(s)(r):Qr(r)};U.removeAll=a=>U.remove(void 0,a);U.promise=(a,s,r)=>{let l=U.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof a=="function"&&(a=a()),a.then(n=>{let i=s.success?wa(s.success,n):void 0;return i?U.success(i,{id:l,...r,...r==null?void 0:r.success}):U.dismiss(l),n}).catch(n=>{let i=s.error?wa(s.error,n):void 0;i?U.error(i,{id:l,...r,...r==null?void 0:r.error}):U.dismiss(l)}),a};var Cl=1e3,Sl=(a,s="default")=>{let{toasts:r,pausedAt:l}=wl(a,s),n=h.useRef(new Map).current,i=h.useCallback((d,f=Cl)=>{if(n.has(d))return;let T=setTimeout(()=>{n.delete(d),o({type:4,toastId:d})},f);n.set(d,T)},[]);h.useEffect(()=>{if(l)return;let d=Date.now(),f=r.map(T=>{if(T.duration===1/0)return;let b=(T.duration||0)+T.pauseDuration-(d-T.createdAt);if(b<0){T.visible&&U.dismiss(T.id);return}return setTimeout(()=>U.dismiss(T.id,s),b)});return()=>{f.forEach(T=>T&&clearTimeout(T))}},[r,l,s]);let o=h.useCallback(Aa(s),[s]),c=h.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=h.useCallback((d,f)=>{o({type:1,toast:{id:d,height:f}})},[o]),p=h.useCallback(()=>{l&&o({type:6,time:Date.now()})},[l,o]),m=h.useCallback((d,f)=>{let{reverseOrder:T=!1,gutter:b=8,defaultPosition:y}=f||{},k=r.filter(g=>(g.position||y)===(d.position||y)&&g.height),A=k.findIndex(g=>g.id===d.id),O=k.filter((g,$)=>$<A&&g.visible).length;return k.filter(g=>g.visible).slice(...T?[O+1]:[0,O]).reduce((g,$)=>g+($.height||0)+b,0)},[r]);return h.useEffect(()=>{r.forEach(d=>{if(d.dismissed)i(d.id,d.removeDelay);else{let f=n.get(d.id);f&&(clearTimeout(f),n.delete(d.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:u,startPause:c,endPause:p,calculateOffset:m}}},_l=Et`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Al=Et`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,El=Et`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Dl=Rt("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${a=>a.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${_l} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Al} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${a=>a.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${El} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Tl=Et`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,zl=Rt("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${a=>a.secondary||"#e0e0e0"};
  border-right-color: ${a=>a.primary||"#616161"};
  animation: ${Tl} 1s linear infinite;
`,Pl=Et`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ll=Et`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Il=Rt("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${a=>a.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Pl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ll} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${a=>a.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Rl=Rt("div")`
  position: absolute;
`,Ol=Rt("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Fl=Et`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,jl=Rt("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Fl} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Ml=({toast:a})=>{let{icon:s,type:r,iconTheme:l}=a;return s!==void 0?typeof s=="string"?h.createElement(jl,null,s):s:r==="blank"?null:h.createElement(Ol,null,h.createElement(zl,{...l}),r!=="loading"&&h.createElement(Rl,null,r==="error"?h.createElement(Dl,{...l}):h.createElement(Il,{...l})))},$l=a=>`
0% {transform: translate3d(0,${a*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Bl=a=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${a*-150}%,-1px) scale(.6); opacity:0;}
`,Ul="0%{opacity:0;} 100%{opacity:1;}",Gl="0%{opacity:1;} 100%{opacity:0;}",Vl=Rt("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ql=Rt("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Jl=(a,s)=>{let r=a.includes("top")?1:-1,[l,n]=Yr()?[Ul,Gl]:[$l(r),Bl(r)];return{animation:s?`${Et(l)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Et(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Wl=h.memo(({toast:a,position:s,style:r,children:l})=>{let n=a.height?Jl(a.position||s||"top-center",a.visible):{opacity:0},i=h.createElement(Ml,{toast:a}),o=h.createElement(ql,{...a.ariaProps},wa(a.message,a));return h.createElement(Vl,{className:a.className,style:{...n,...r,...a.style}},typeof l=="function"?l({icon:i,message:o}):h.createElement(h.Fragment,null,i,o))});bl(h.createElement);var Hl=({id:a,className:s,style:r,onHeightUpdate:l,children:n})=>{let i=h.useCallback(o=>{if(o){let c=()=>{let u=o.getBoundingClientRect().height;l(a,u)};c(),new MutationObserver(c).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[a,l]);return h.createElement("div",{ref:i,className:s,style:r},n)},Yl=(a,s)=>{let r=a.includes("top"),l=r?{top:0}:{bottom:0},n=a.includes("center")?{justifyContent:"center"}:a.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Yr()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...l,...n}},Xl=_a`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ma=16,Kl=({reverseOrder:a,position:s="top-center",toastOptions:r,gutter:l,children:n,toasterId:i,containerStyle:o,containerClassName:c})=>{let{toasts:u,handlers:p}=Sl(r,i);return h.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:ma,left:ma,right:ma,bottom:ma,pointerEvents:"none",...o},className:c,onMouseEnter:p.startPause,onMouseLeave:p.endPause},u.map(m=>{let d=m.position||s,f=p.calculateOffset(m,{reverseOrder:a,gutter:l,defaultPosition:s}),T=Yl(d,f);return h.createElement(Hl,{id:m.id,key:m.id,onHeightUpdate:p.updateHeight,className:m.visible?Xl:"",style:T},m.type==="custom"?wa(m.message,m):n?n(m):h.createElement(Wl,{toast:m,position:d}))}))},ke=U;const es=h.createContext(),Zl=()=>{const a=h.useContext(es);if(!a)throw new Error("useTheme must be used within a ThemeProvider");return a},Ql=({children:a})=>{const[s,r]=h.useState(()=>sessionStorage.getItem("theme")||"dark");h.useEffect(()=>{sessionStorage.setItem("theme",s),s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[s]);const l=()=>{r(n=>n==="light"?"dark":"light")};return e(es.Provider,{value:{theme:s,setTheme:r,toggleTheme:l},children:a})};function ts(a,s){return function(){return a.apply(s,arguments)}}const{toString:en}=Object.prototype,{getPrototypeOf:tr}=Object,{iterator:Ea,toStringTag:as}=Symbol,Da=(a=>s=>{const r=en.call(s);return a[r]||(a[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),gt=a=>(a=a.toLowerCase(),s=>Da(s)===a),Ta=a=>s=>typeof s===a,{isArray:ea}=Array,Zt=Ta("undefined");function oa(a){return a!==null&&!Zt(a)&&a.constructor!==null&&!Zt(a.constructor)&&mt(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const rs=gt("ArrayBuffer");function tn(a){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(a):s=a&&a.buffer&&rs(a.buffer),s}const an=Ta("string"),mt=Ta("function"),ss=Ta("number"),ca=a=>a!==null&&typeof a=="object",rn=a=>a===!0||a===!1,pa=a=>{if(Da(a)!=="object")return!1;const s=tr(a);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(as in a)&&!(Ea in a)},sn=a=>{if(!ca(a)||oa(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},ln=gt("Date"),nn=gt("File"),on=gt("Blob"),cn=gt("FileList"),dn=a=>ca(a)&&mt(a.pipe),mn=a=>{let s;return a&&(typeof FormData=="function"&&a instanceof FormData||mt(a.append)&&((s=Da(a))==="formdata"||s==="object"&&mt(a.toString)&&a.toString()==="[object FormData]"))},un=gt("URLSearchParams"),[hn,pn,xn,bn]=["ReadableStream","Request","Response","Headers"].map(gt),gn=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function da(a,s,{allOwnKeys:r=!1}={}){if(a===null||typeof a>"u")return;let l,n;if(typeof a!="object"&&(a=[a]),ea(a))for(l=0,n=a.length;l<n;l++)s.call(null,a[l],l,a);else{if(oa(a))return;const i=r?Object.getOwnPropertyNames(a):Object.keys(a),o=i.length;let c;for(l=0;l<o;l++)c=i[l],s.call(null,a[c],c,a)}}function ls(a,s){if(oa(a))return null;s=s.toLowerCase();const r=Object.keys(a);let l=r.length,n;for(;l-- >0;)if(n=r[l],s===n.toLowerCase())return n;return null}const Mt=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),ns=a=>!Zt(a)&&a!==Mt;function Ga(){const{caseless:a,skipUndefined:s}=ns(this)&&this||{},r={},l=(n,i)=>{const o=a&&ls(r,i)||i;pa(r[o])&&pa(n)?r[o]=Ga(r[o],n):pa(n)?r[o]=Ga({},n):ea(n)?r[o]=n.slice():(!s||!Zt(n))&&(r[o]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&da(arguments[n],l);return r}const fn=(a,s,r,{allOwnKeys:l}={})=>(da(s,(n,i)=>{r&&mt(n)?a[i]=ts(n,r):a[i]=n},{allOwnKeys:l}),a),Nn=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),vn=(a,s,r,l)=>{a.prototype=Object.create(s.prototype,l),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:s.prototype}),r&&Object.assign(a.prototype,r)},yn=(a,s,r,l)=>{let n,i,o;const c={};if(s=s||{},a==null)return s;do{for(n=Object.getOwnPropertyNames(a),i=n.length;i-- >0;)o=n[i],(!l||l(o,a,s))&&!c[o]&&(s[o]=a[o],c[o]=!0);a=r!==!1&&tr(a)}while(a&&(!r||r(a,s))&&a!==Object.prototype);return s},wn=(a,s,r)=>{a=String(a),(r===void 0||r>a.length)&&(r=a.length),r-=s.length;const l=a.indexOf(s,r);return l!==-1&&l===r},kn=a=>{if(!a)return null;if(ea(a))return a;let s=a.length;if(!ss(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=a[s];return r},Cn=(a=>s=>a&&s instanceof a)(typeof Uint8Array<"u"&&tr(Uint8Array)),Sn=(a,s)=>{const l=(a&&a[Ea]).call(a);let n;for(;(n=l.next())&&!n.done;){const i=n.value;s.call(a,i[0],i[1])}},_n=(a,s)=>{let r;const l=[];for(;(r=a.exec(s))!==null;)l.push(r);return l},An=gt("HTMLFormElement"),En=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,l,n){return l.toUpperCase()+n}),xr=(({hasOwnProperty:a})=>(s,r)=>a.call(s,r))(Object.prototype),Dn=gt("RegExp"),is=(a,s)=>{const r=Object.getOwnPropertyDescriptors(a),l={};da(r,(n,i)=>{let o;(o=s(n,i,a))!==!1&&(l[i]=o||n)}),Object.defineProperties(a,l)},Tn=a=>{is(a,(s,r)=>{if(mt(a)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const l=a[r];if(mt(l)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},zn=(a,s)=>{const r={},l=n=>{n.forEach(i=>{r[i]=!0})};return ea(a)?l(a):l(String(a).split(s)),r},Pn=()=>{},Ln=(a,s)=>a!=null&&Number.isFinite(a=+a)?a:s;function In(a){return!!(a&&mt(a.append)&&a[as]==="FormData"&&a[Ea])}const Rn=a=>{const s=new Array(10),r=(l,n)=>{if(ca(l)){if(s.indexOf(l)>=0)return;if(oa(l))return l;if(!("toJSON"in l)){s[n]=l;const i=ea(l)?[]:{};return da(l,(o,c)=>{const u=r(o,n+1);!Zt(u)&&(i[c]=u)}),s[n]=void 0,i}}return l};return r(a,0)},On=gt("AsyncFunction"),Fn=a=>a&&(ca(a)||mt(a))&&mt(a.then)&&mt(a.catch),os=((a,s)=>a?setImmediate:s?((r,l)=>(Mt.addEventListener("message",({source:n,data:i})=>{n===Mt&&i===r&&l.length&&l.shift()()},!1),n=>{l.push(n),Mt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",mt(Mt.postMessage)),jn=typeof queueMicrotask<"u"?queueMicrotask.bind(Mt):typeof process<"u"&&process.nextTick||os,Mn=a=>a!=null&&mt(a[Ea]),H={isArray:ea,isArrayBuffer:rs,isBuffer:oa,isFormData:mn,isArrayBufferView:tn,isString:an,isNumber:ss,isBoolean:rn,isObject:ca,isPlainObject:pa,isEmptyObject:sn,isReadableStream:hn,isRequest:pn,isResponse:xn,isHeaders:bn,isUndefined:Zt,isDate:ln,isFile:nn,isBlob:on,isRegExp:Dn,isFunction:mt,isStream:dn,isURLSearchParams:un,isTypedArray:Cn,isFileList:cn,forEach:da,merge:Ga,extend:fn,trim:gn,stripBOM:Nn,inherits:vn,toFlatObject:yn,kindOf:Da,kindOfTest:gt,endsWith:wn,toArray:kn,forEachEntry:Sn,matchAll:_n,isHTMLForm:An,hasOwnProperty:xr,hasOwnProp:xr,reduceDescriptors:is,freezeMethods:Tn,toObjectSet:zn,toCamelCase:En,noop:Pn,toFiniteNumber:Ln,findKey:ls,global:Mt,isContextDefined:ns,isSpecCompliantForm:In,toJSONObject:Rn,isAsyncFn:On,isThenable:Fn,setImmediate:os,asap:jn,isIterable:Mn};function Ne(a,s,r,l,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),l&&(this.request=l),n&&(this.response=n,this.status=n.status?n.status:null)}H.inherits(Ne,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const cs=Ne.prototype,ds={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{ds[a]={value:a}});Object.defineProperties(Ne,ds);Object.defineProperty(cs,"isAxiosError",{value:!0});Ne.from=(a,s,r,l,n,i)=>{const o=Object.create(cs);H.toFlatObject(a,o,function(m){return m!==Error.prototype},p=>p!=="isAxiosError");const c=a&&a.message?a.message:"Error",u=s==null&&a?a.code:s;return Ne.call(o,c,u,r,l,n),a&&o.cause==null&&Object.defineProperty(o,"cause",{value:a,configurable:!0}),o.name=a&&a.name||"Error",i&&Object.assign(o,i),o};const $n=null;function Va(a){return H.isPlainObject(a)||H.isArray(a)}function ms(a){return H.endsWith(a,"[]")?a.slice(0,-2):a}function br(a,s,r){return a?a.concat(s).map(function(n,i){return n=ms(n),!r&&i?"["+n+"]":n}).join(r?".":""):s}function Bn(a){return H.isArray(a)&&!a.some(Va)}const Un=H.toFlatObject(H,{},null,function(s){return/^is[A-Z]/.test(s)});function za(a,s,r){if(!H.isObject(a))throw new TypeError("target must be an object");s=s||new FormData,r=H.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,k){return!H.isUndefined(k[y])});const l=r.metaTokens,n=r.visitor||m,i=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(s);if(!H.isFunction(n))throw new TypeError("visitor must be a function");function p(b){if(b===null)return"";if(H.isDate(b))return b.toISOString();if(H.isBoolean(b))return b.toString();if(!u&&H.isBlob(b))throw new Ne("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(b)||H.isTypedArray(b)?u&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function m(b,y,k){let A=b;if(b&&!k&&typeof b=="object"){if(H.endsWith(y,"{}"))y=l?y:y.slice(0,-2),b=JSON.stringify(b);else if(H.isArray(b)&&Bn(b)||(H.isFileList(b)||H.endsWith(y,"[]"))&&(A=H.toArray(b)))return y=ms(y),A.forEach(function(g,$){!(H.isUndefined(g)||g===null)&&s.append(o===!0?br([y],$,i):o===null?y:y+"[]",p(g))}),!1}return Va(b)?!0:(s.append(br(k,y,i),p(b)),!1)}const d=[],f=Object.assign(Un,{defaultVisitor:m,convertValue:p,isVisitable:Va});function T(b,y){if(!H.isUndefined(b)){if(d.indexOf(b)!==-1)throw Error("Circular reference detected in "+y.join("."));d.push(b),H.forEach(b,function(A,O){(!(H.isUndefined(A)||A===null)&&n.call(s,A,H.isString(O)?O.trim():O,y,f))===!0&&T(A,y?y.concat(O):[O])}),d.pop()}}if(!H.isObject(a))throw new TypeError("data must be an object");return T(a),s}function gr(a){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(l){return s[l]})}function ar(a,s){this._pairs=[],a&&za(a,this,s)}const us=ar.prototype;us.append=function(s,r){this._pairs.push([s,r])};us.toString=function(s){const r=s?function(l){return s.call(this,l,gr)}:gr;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function Gn(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function hs(a,s,r){if(!s)return a;const l=r&&r.encode||Gn;H.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(s,r):i=H.isURLSearchParams(s)?s.toString():new ar(s,r).toString(l),i){const o=a.indexOf("#");o!==-1&&(a=a.slice(0,o)),a+=(a.indexOf("?")===-1?"?":"&")+i}return a}class Vn{constructor(){this.handlers=[]}use(s,r,l){return this.handlers.push({fulfilled:s,rejected:r,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){H.forEach(this.handlers,function(l){l!==null&&s(l)})}}const fr=Vn,ps={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},qn=typeof URLSearchParams<"u"?URLSearchParams:ar,Jn=typeof FormData<"u"?FormData:null,Wn=typeof Blob<"u"?Blob:null,Hn={isBrowser:!0,classes:{URLSearchParams:qn,FormData:Jn,Blob:Wn},protocols:["http","https","file","blob","url","data"]},rr=typeof window<"u"&&typeof document<"u",qa=typeof navigator=="object"&&navigator||void 0,Yn=rr&&(!qa||["ReactNative","NativeScript","NS"].indexOf(qa.product)<0),Xn=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Kn=rr&&window.location.href||"http://localhost",Zn=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:rr,hasStandardBrowserEnv:Yn,hasStandardBrowserWebWorkerEnv:Xn,navigator:qa,origin:Kn},Symbol.toStringTag,{value:"Module"})),at={...Zn,...Hn};function Qn(a,s){return za(a,new at.classes.URLSearchParams,{visitor:function(r,l,n,i){return at.isNode&&H.isBuffer(r)?(this.append(l,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...s})}function ei(a){return H.matchAll(/\w+|\[(\w*)]/g,a).map(s=>s[0]==="[]"?"":s[1]||s[0])}function ti(a){const s={},r=Object.keys(a);let l;const n=r.length;let i;for(l=0;l<n;l++)i=r[l],s[i]=a[i];return s}function xs(a){function s(r,l,n,i){let o=r[i++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),u=i>=r.length;return o=!o&&H.isArray(n)?n.length:o,u?(H.hasOwnProp(n,o)?n[o]=[n[o],l]:n[o]=l,!c):((!n[o]||!H.isObject(n[o]))&&(n[o]=[]),s(r,l,n[o],i)&&H.isArray(n[o])&&(n[o]=ti(n[o])),!c)}if(H.isFormData(a)&&H.isFunction(a.entries)){const r={};return H.forEachEntry(a,(l,n)=>{s(ei(l),n,r,0)}),r}return null}function ai(a,s,r){if(H.isString(a))try{return(s||JSON.parse)(a),H.trim(a)}catch(l){if(l.name!=="SyntaxError")throw l}return(r||JSON.stringify)(a)}const sr={transitional:ps,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const l=r.getContentType()||"",n=l.indexOf("application/json")>-1,i=H.isObject(s);if(i&&H.isHTMLForm(s)&&(s=new FormData(s)),H.isFormData(s))return n?JSON.stringify(xs(s)):s;if(H.isArrayBuffer(s)||H.isBuffer(s)||H.isStream(s)||H.isFile(s)||H.isBlob(s)||H.isReadableStream(s))return s;if(H.isArrayBufferView(s))return s.buffer;if(H.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(i){if(l.indexOf("application/x-www-form-urlencoded")>-1)return Qn(s,this.formSerializer).toString();if((c=H.isFileList(s))||l.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return za(c?{"files[]":s}:s,u&&new u,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),ai(s)):s}],transformResponse:[function(s){const r=this.transitional||sr.transitional,l=r&&r.forcedJSONParsing,n=this.responseType==="json";if(H.isResponse(s)||H.isReadableStream(s))return s;if(s&&H.isString(s)&&(l&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(s,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?Ne.from(c,Ne.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:at.classes.FormData,Blob:at.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],a=>{sr.headers[a]={}});const lr=sr,ri=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),si=a=>{const s={};let r,l,n;return a&&a.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),l=o.substring(n+1).trim(),!(!r||s[r]&&ri[r])&&(r==="set-cookie"?s[r]?s[r].push(l):s[r]=[l]:s[r]=s[r]?s[r]+", "+l:l)}),s},Nr=Symbol("internals");function aa(a){return a&&String(a).trim().toLowerCase()}function xa(a){return a===!1||a==null?a:H.isArray(a)?a.map(xa):String(a)}function li(a){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=r.exec(a);)s[l[1]]=l[2];return s}const ni=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function Oa(a,s,r,l,n){if(H.isFunction(l))return l.call(this,s,r);if(n&&(s=r),!!H.isString(s)){if(H.isString(l))return s.indexOf(l)!==-1;if(H.isRegExp(l))return l.test(s)}}function ii(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,l)=>r.toUpperCase()+l)}function oi(a,s){const r=H.toCamelCase(" "+s);["get","set","has"].forEach(l=>{Object.defineProperty(a,l+r,{value:function(n,i,o){return this[l].call(this,s,n,i,o)},configurable:!0})})}class Pa{constructor(s){s&&this.set(s)}set(s,r,l){const n=this;function i(c,u,p){const m=aa(u);if(!m)throw new Error("header name must be a non-empty string");const d=H.findKey(n,m);(!d||n[d]===void 0||p===!0||p===void 0&&n[d]!==!1)&&(n[d||u]=xa(c))}const o=(c,u)=>H.forEach(c,(p,m)=>i(p,m,u));if(H.isPlainObject(s)||s instanceof this.constructor)o(s,r);else if(H.isString(s)&&(s=s.trim())&&!ni(s))o(si(s),r);else if(H.isObject(s)&&H.isIterable(s)){let c={},u,p;for(const m of s){if(!H.isArray(m))throw TypeError("Object iterator must return a key-value pair");c[p=m[0]]=(u=c[p])?H.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(c,r)}else s!=null&&i(r,s,l);return this}get(s,r){if(s=aa(s),s){const l=H.findKey(this,s);if(l){const n=this[l];if(!r)return n;if(r===!0)return li(n);if(H.isFunction(r))return r.call(this,n,l);if(H.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=aa(s),s){const l=H.findKey(this,s);return!!(l&&this[l]!==void 0&&(!r||Oa(this,this[l],l,r)))}return!1}delete(s,r){const l=this;let n=!1;function i(o){if(o=aa(o),o){const c=H.findKey(l,o);c&&(!r||Oa(l,l[c],c,r))&&(delete l[c],n=!0)}}return H.isArray(s)?s.forEach(i):i(s),n}clear(s){const r=Object.keys(this);let l=r.length,n=!1;for(;l--;){const i=r[l];(!s||Oa(this,this[i],i,s,!0))&&(delete this[i],n=!0)}return n}normalize(s){const r=this,l={};return H.forEach(this,(n,i)=>{const o=H.findKey(l,i);if(o){r[o]=xa(n),delete r[i];return}const c=s?ii(i):String(i).trim();c!==i&&delete r[i],r[c]=xa(n),l[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return H.forEach(this,(l,n)=>{l!=null&&l!==!1&&(r[n]=s&&H.isArray(l)?l.join(", "):l)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const l=new this(s);return r.forEach(n=>l.set(n)),l}static accessor(s){const l=(this[Nr]=this[Nr]={accessors:{}}).accessors,n=this.prototype;function i(o){const c=aa(o);l[c]||(oi(n,o),l[c]=!0)}return H.isArray(s)?s.forEach(i):i(s),this}}Pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(Pa.prototype,({value:a},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>a,set(l){this[r]=l}}});H.freezeMethods(Pa);const xt=Pa;function Fa(a,s){const r=this||lr,l=s||r,n=xt.from(l.headers);let i=l.data;return H.forEach(a,function(c){i=c.call(r,i,n.normalize(),s?s.status:void 0)}),n.normalize(),i}function bs(a){return!!(a&&a.__CANCEL__)}function ta(a,s,r){Ne.call(this,a??"canceled",Ne.ERR_CANCELED,s,r),this.name="CanceledError"}H.inherits(ta,Ne,{__CANCEL__:!0});function gs(a,s,r){const l=r.config.validateStatus;!r.status||!l||l(r.status)?a(r):s(new Ne("Request failed with status code "+r.status,[Ne.ERR_BAD_REQUEST,Ne.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function ci(a){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return s&&s[1]||""}function di(a,s){a=a||10;const r=new Array(a),l=new Array(a);let n=0,i=0,o;return s=s!==void 0?s:1e3,function(u){const p=Date.now(),m=l[i];o||(o=p),r[n]=u,l[n]=p;let d=i,f=0;for(;d!==n;)f+=r[d++],d=d%a;if(n=(n+1)%a,n===i&&(i=(i+1)%a),p-o<s)return;const T=m&&p-m;return T?Math.round(f*1e3/T):void 0}}function mi(a,s){let r=0,l=1e3/s,n,i;const o=(p,m=Date.now())=>{r=m,n=null,i&&(clearTimeout(i),i=null),a(...p)};return[(...p)=>{const m=Date.now(),d=m-r;d>=l?o(p,m):(n=p,i||(i=setTimeout(()=>{i=null,o(n)},l-d)))},()=>n&&o(n)]}const ka=(a,s,r=3)=>{let l=0;const n=di(50,250);return mi(i=>{const o=i.loaded,c=i.lengthComputable?i.total:void 0,u=o-l,p=n(u),m=o<=c;l=o;const d={loaded:o,total:c,progress:c?o/c:void 0,bytes:u,rate:p||void 0,estimated:p&&c&&m?(c-o)/p:void 0,event:i,lengthComputable:c!=null,[s?"download":"upload"]:!0};a(d)},r)},vr=(a,s)=>{const r=a!=null;return[l=>s[0]({lengthComputable:r,total:a,loaded:l}),s[1]]},yr=a=>(...s)=>H.asap(()=>a(...s)),ui=at.hasStandardBrowserEnv?((a,s)=>r=>(r=new URL(r,at.origin),a.protocol===r.protocol&&a.host===r.host&&(s||a.port===r.port)))(new URL(at.origin),at.navigator&&/(msie|trident)/i.test(at.navigator.userAgent)):()=>!0,hi=at.hasStandardBrowserEnv?{write(a,s,r,l,n,i){const o=[a+"="+encodeURIComponent(s)];H.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),H.isString(l)&&o.push("path="+l),H.isString(n)&&o.push("domain="+n),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(a){const s=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pi(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function xi(a,s){return s?a.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):a}function fs(a,s,r){let l=!pi(s);return a&&(l||r==!1)?xi(a,s):s}const wr=a=>a instanceof xt?{...a}:a;function Vt(a,s){s=s||{};const r={};function l(p,m,d,f){return H.isPlainObject(p)&&H.isPlainObject(m)?H.merge.call({caseless:f},p,m):H.isPlainObject(m)?H.merge({},m):H.isArray(m)?m.slice():m}function n(p,m,d,f){if(H.isUndefined(m)){if(!H.isUndefined(p))return l(void 0,p,d,f)}else return l(p,m,d,f)}function i(p,m){if(!H.isUndefined(m))return l(void 0,m)}function o(p,m){if(H.isUndefined(m)){if(!H.isUndefined(p))return l(void 0,p)}else return l(void 0,m)}function c(p,m,d){if(d in s)return l(p,m);if(d in a)return l(void 0,p)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(p,m,d)=>n(wr(p),wr(m),d,!0)};return H.forEach(Object.keys({...a,...s}),function(m){const d=u[m]||n,f=d(a[m],s[m],m);H.isUndefined(f)&&d!==c||(r[m]=f)}),r}const Ns=a=>{const s=Vt({},a);let{data:r,withXSRFToken:l,xsrfHeaderName:n,xsrfCookieName:i,headers:o,auth:c}=s;if(s.headers=o=xt.from(o),s.url=hs(fs(s.baseURL,s.url,s.allowAbsoluteUrls),a.params,a.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),H.isFormData(r)){if(at.hasStandardBrowserEnv||at.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(H.isFunction(r.getHeaders)){const u=r.getHeaders(),p=["content-type","content-length"];Object.entries(u).forEach(([m,d])=>{p.includes(m.toLowerCase())&&o.set(m,d)})}}if(at.hasStandardBrowserEnv&&(l&&H.isFunction(l)&&(l=l(s)),l||l!==!1&&ui(s.url))){const u=n&&i&&hi.read(i);u&&o.set(n,u)}return s},bi=typeof XMLHttpRequest<"u",gi=bi&&function(a){return new Promise(function(r,l){const n=Ns(a);let i=n.data;const o=xt.from(n.headers).normalize();let{responseType:c,onUploadProgress:u,onDownloadProgress:p}=n,m,d,f,T,b;function y(){T&&T(),b&&b(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let k=new XMLHttpRequest;k.open(n.method.toUpperCase(),n.url,!0),k.timeout=n.timeout;function A(){if(!k)return;const g=xt.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders()),_={data:!c||c==="text"||c==="json"?k.responseText:k.response,status:k.status,statusText:k.statusText,headers:g,config:a,request:k};gs(function(G){r(G),y()},function(G){l(G),y()},_),k=null}"onloadend"in k?k.onloadend=A:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(A)},k.onabort=function(){k&&(l(new Ne("Request aborted",Ne.ECONNABORTED,a,k)),k=null)},k.onerror=function($){const _=$&&$.message?$.message:"Network Error",E=new Ne(_,Ne.ERR_NETWORK,a,k);E.event=$||null,l(E),k=null},k.ontimeout=function(){let $=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const _=n.transitional||ps;n.timeoutErrorMessage&&($=n.timeoutErrorMessage),l(new Ne($,_.clarifyTimeoutError?Ne.ETIMEDOUT:Ne.ECONNABORTED,a,k)),k=null},i===void 0&&o.setContentType(null),"setRequestHeader"in k&&H.forEach(o.toJSON(),function($,_){k.setRequestHeader(_,$)}),H.isUndefined(n.withCredentials)||(k.withCredentials=!!n.withCredentials),c&&c!=="json"&&(k.responseType=n.responseType),p&&([f,b]=ka(p,!0),k.addEventListener("progress",f)),u&&k.upload&&([d,T]=ka(u),k.upload.addEventListener("progress",d),k.upload.addEventListener("loadend",T)),(n.cancelToken||n.signal)&&(m=g=>{k&&(l(!g||g.type?new ta(null,a,k):g),k.abort(),k=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const O=ci(n.url);if(O&&at.protocols.indexOf(O)===-1){l(new Ne("Unsupported protocol "+O+":",Ne.ERR_BAD_REQUEST,a));return}k.send(i||null)})},fi=(a,s)=>{const{length:r}=a=a?a.filter(Boolean):[];if(s||r){let l=new AbortController,n;const i=function(p){if(!n){n=!0,c();const m=p instanceof Error?p:this.reason;l.abort(m instanceof Ne?m:new ta(m instanceof Error?m.message:m))}};let o=s&&setTimeout(()=>{o=null,i(new Ne(`timeout ${s} of ms exceeded`,Ne.ETIMEDOUT))},s);const c=()=>{a&&(o&&clearTimeout(o),o=null,a.forEach(p=>{p.unsubscribe?p.unsubscribe(i):p.removeEventListener("abort",i)}),a=null)};a.forEach(p=>p.addEventListener("abort",i));const{signal:u}=l;return u.unsubscribe=()=>H.asap(c),u}},Ni=fi,vi=function*(a,s){let r=a.byteLength;if(!s||r<s){yield a;return}let l=0,n;for(;l<r;)n=l+s,yield a.slice(l,n),l=n},yi=async function*(a,s){for await(const r of wi(a))yield*vi(r,s)},wi=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const s=a.getReader();try{for(;;){const{done:r,value:l}=await s.read();if(r)break;yield l}}finally{await s.cancel()}},kr=(a,s,r,l)=>{const n=yi(a,s);let i=0,o,c=u=>{o||(o=!0,l&&l(u))};return new ReadableStream({async pull(u){try{const{done:p,value:m}=await n.next();if(p){c(),u.close();return}let d=m.byteLength;if(r){let f=i+=d;r(f)}u.enqueue(new Uint8Array(m))}catch(p){throw c(p),p}},cancel(u){return c(u),n.return()}},{highWaterMark:2})},Cr=64*1024,{isFunction:ua}=H,ki=(({Request:a,Response:s})=>({Request:a,Response:s}))(H.global),{ReadableStream:Sr,TextEncoder:_r}=H.global,Ar=(a,...s)=>{try{return!!a(...s)}catch{return!1}},Ci=a=>{a=H.merge.call({skipUndefined:!0},ki,a);const{fetch:s,Request:r,Response:l}=a,n=s?ua(s):typeof fetch=="function",i=ua(r),o=ua(l);if(!n)return!1;const c=n&&ua(Sr),u=n&&(typeof _r=="function"?(b=>y=>b.encode(y))(new _r):async b=>new Uint8Array(await new r(b).arrayBuffer())),p=i&&c&&Ar(()=>{let b=!1;const y=new r(at.origin,{body:new Sr,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!y}),m=o&&c&&Ar(()=>H.isReadableStream(new l("").body)),d={stream:m&&(b=>b.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!d[b]&&(d[b]=(y,k)=>{let A=y&&y[b];if(A)return A.call(y);throw new Ne(`Response type '${b}' is not supported`,Ne.ERR_NOT_SUPPORT,k)})});const f=async b=>{if(b==null)return 0;if(H.isBlob(b))return b.size;if(H.isSpecCompliantForm(b))return(await new r(at.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(H.isArrayBufferView(b)||H.isArrayBuffer(b))return b.byteLength;if(H.isURLSearchParams(b)&&(b=b+""),H.isString(b))return(await u(b)).byteLength},T=async(b,y)=>{const k=H.toFiniteNumber(b.getContentLength());return k??f(y)};return async b=>{let{url:y,method:k,data:A,signal:O,cancelToken:g,timeout:$,onDownloadProgress:_,onUploadProgress:E,responseType:G,headers:j,withCredentials:N="same-origin",fetchOptions:D}=Ns(b),S=s||fetch;G=G?(G+"").toLowerCase():"text";let F=Ni([O,g&&g.toAbortSignal()],$),I=null;const x=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let v;try{if(E&&p&&k!=="get"&&k!=="head"&&(v=await T(j,A))!==0){let J=new r(y,{method:"POST",body:A,duplex:"half"}),P;if(H.isFormData(A)&&(P=J.headers.get("content-type"))&&j.setContentType(P),J.body){const[Z,se]=vr(v,ka(yr(E)));A=kr(J.body,Cr,Z,se)}}H.isString(N)||(N=N?"include":"omit");const L=i&&"credentials"in r.prototype,K={...D,signal:F,method:k.toUpperCase(),headers:j.normalize().toJSON(),body:A,duplex:"half",credentials:L?N:void 0};I=i&&new r(y,K);let R=await(i?S(I,D):S(y,K));const C=m&&(G==="stream"||G==="response");if(m&&(_||C&&x)){const J={};["status","statusText","headers"].forEach(oe=>{J[oe]=R[oe]});const P=H.toFiniteNumber(R.headers.get("content-length")),[Z,se]=_&&vr(P,ka(yr(_),!0))||[];R=new l(kr(R.body,Cr,Z,()=>{se&&se(),x&&x()}),J)}G=G||"text";let z=await d[H.findKey(d,G)||"text"](R,b);return!C&&x&&x(),await new Promise((J,P)=>{gs(J,P,{data:z,headers:xt.from(R.headers),status:R.status,statusText:R.statusText,config:b,request:I})})}catch(L){throw x&&x(),L&&L.name==="TypeError"&&/Load failed|fetch/i.test(L.message)?Object.assign(new Ne("Network Error",Ne.ERR_NETWORK,b,I),{cause:L.cause||L}):Ne.from(L,L&&L.code,b,I)}}},Si=new Map,vs=a=>{let s=a?a.env:{};const{fetch:r,Request:l,Response:n}=s,i=[l,n,r];let o=i.length,c=o,u,p,m=Si;for(;c--;)u=i[c],p=m.get(u),p===void 0&&m.set(u,p=c?new Map:Ci(s)),m=p;return p};vs();const Ja={http:$n,xhr:gi,fetch:{get:vs}};H.forEach(Ja,(a,s)=>{if(a){try{Object.defineProperty(a,"name",{value:s})}catch{}Object.defineProperty(a,"adapterName",{value:s})}});const Er=a=>`- ${a}`,_i=a=>H.isFunction(a)||a===null||a===!1,ys={getAdapter:(a,s)=>{a=H.isArray(a)?a:[a];const{length:r}=a;let l,n;const i={};for(let o=0;o<r;o++){l=a[o];let c;if(n=l,!_i(l)&&(n=Ja[(c=String(l)).toLowerCase()],n===void 0))throw new Ne(`Unknown adapter '${c}'`);if(n&&(H.isFunction(n)||(n=n.get(s))))break;i[c||"#"+o]=n}if(!n){const o=Object.entries(i).map(([u,p])=>`adapter ${u} `+(p===!1?"is not supported by the environment":"is not available in the build"));let c=r?o.length>1?`since :
`+o.map(Er).join(`
`):" "+Er(o[0]):"as no adapter specified";throw new Ne("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return n},adapters:Ja};function ja(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new ta(null,a)}function Dr(a){return ja(a),a.headers=xt.from(a.headers),a.data=Fa.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),ys.getAdapter(a.adapter||lr.adapter,a)(a).then(function(l){return ja(a),l.data=Fa.call(a,a.transformResponse,l),l.headers=xt.from(l.headers),l},function(l){return bs(l)||(ja(a),l&&l.response&&(l.response.data=Fa.call(a,a.transformResponse,l.response),l.response.headers=xt.from(l.response.headers))),Promise.reject(l)})}const ws="1.12.2",La={};["object","boolean","number","function","string","symbol"].forEach((a,s)=>{La[a]=function(l){return typeof l===a||"a"+(s<1?"n ":" ")+a}});const Tr={};La.transitional=function(s,r,l){function n(i,o){return"[Axios v"+ws+"] Transitional option '"+i+"'"+o+(l?". "+l:"")}return(i,o,c)=>{if(s===!1)throw new Ne(n(o," has been removed"+(r?" in "+r:"")),Ne.ERR_DEPRECATED);return r&&!Tr[o]&&(Tr[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(i,o,c):!0}};La.spelling=function(s){return(r,l)=>(console.warn(`${l} is likely a misspelling of ${s}`),!0)};function Ai(a,s,r){if(typeof a!="object")throw new Ne("options must be an object",Ne.ERR_BAD_OPTION_VALUE);const l=Object.keys(a);let n=l.length;for(;n-- >0;){const i=l[n],o=s[i];if(o){const c=a[i],u=c===void 0||o(c,i,a);if(u!==!0)throw new Ne("option "+i+" must be "+u,Ne.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ne("Unknown option "+i,Ne.ERR_BAD_OPTION)}}const ba={assertOptions:Ai,validators:La},Nt=ba.validators;class Ca{constructor(s){this.defaults=s||{},this.interceptors={request:new fr,response:new fr}}async request(s,r){try{return await this._request(s,r)}catch(l){if(l instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{l.stack?i&&!String(l.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+i):l.stack=i}catch{}}throw l}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=Vt(this.defaults,r);const{transitional:l,paramsSerializer:n,headers:i}=r;l!==void 0&&ba.assertOptions(l,{silentJSONParsing:Nt.transitional(Nt.boolean),forcedJSONParsing:Nt.transitional(Nt.boolean),clarifyTimeoutError:Nt.transitional(Nt.boolean)},!1),n!=null&&(H.isFunction(n)?r.paramsSerializer={serialize:n}:ba.assertOptions(n,{encode:Nt.function,serialize:Nt.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ba.assertOptions(r,{baseUrl:Nt.spelling("baseURL"),withXsrfToken:Nt.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&H.merge(i.common,i[r.method]);i&&H.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),r.headers=xt.concat(o,i);const c=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(u=u&&y.synchronous,c.unshift(y.fulfilled,y.rejected))});const p=[];this.interceptors.response.forEach(function(y){p.push(y.fulfilled,y.rejected)});let m,d=0,f;if(!u){const b=[Dr.bind(this),void 0];for(b.unshift(...c),b.push(...p),f=b.length,m=Promise.resolve(r);d<f;)m=m.then(b[d++],b[d++]);return m}f=c.length;let T=r;for(;d<f;){const b=c[d++],y=c[d++];try{T=b(T)}catch(k){y.call(this,k);break}}try{m=Dr.call(this,T)}catch(b){return Promise.reject(b)}for(d=0,f=p.length;d<f;)m=m.then(p[d++],p[d++]);return m}getUri(s){s=Vt(this.defaults,s);const r=fs(s.baseURL,s.url,s.allowAbsoluteUrls);return hs(r,s.params,s.paramsSerializer)}}H.forEach(["delete","get","head","options"],function(s){Ca.prototype[s]=function(r,l){return this.request(Vt(l||{},{method:s,url:r,data:(l||{}).data}))}});H.forEach(["post","put","patch"],function(s){function r(l){return function(i,o,c){return this.request(Vt(c||{},{method:s,headers:l?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Ca.prototype[s]=r(),Ca.prototype[s+"Form"]=r(!0)});const ga=Ca;class nr{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const l=this;this.promise.then(n=>{if(!l._listeners)return;let i=l._listeners.length;for(;i-- >0;)l._listeners[i](n);l._listeners=null}),this.promise.then=n=>{let i;const o=new Promise(c=>{l.subscribe(c),i=c}).then(n);return o.cancel=function(){l.unsubscribe(i)},o},s(function(i,o,c){l.reason||(l.reason=new ta(i,o,c),r(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=l=>{s.abort(l)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new nr(function(n){s=n}),cancel:s}}}const Ei=nr;function Di(a){return function(r){return a.apply(null,r)}}function Ti(a){return H.isObject(a)&&a.isAxiosError===!0}const Wa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wa).forEach(([a,s])=>{Wa[s]=a});const zi=Wa;function ks(a){const s=new ga(a),r=ts(ga.prototype.request,s);return H.extend(r,ga.prototype,s,{allOwnKeys:!0}),H.extend(r,s,null,{allOwnKeys:!0}),r.create=function(n){return ks(Vt(a,n))},r}const Ke=ks(lr);Ke.Axios=ga;Ke.CanceledError=ta;Ke.CancelToken=Ei;Ke.isCancel=bs;Ke.VERSION=ws;Ke.toFormData=za;Ke.AxiosError=Ne;Ke.Cancel=Ke.CanceledError;Ke.all=function(s){return Promise.all(s)};Ke.spread=Di;Ke.isAxiosError=Ti;Ke.mergeConfig=Vt;Ke.AxiosHeaders=xt;Ke.formToJSON=a=>xs(H.isHTMLForm(a)?new FormData(a):a);Ke.getAdapter=ys.getAdapter;Ke.HttpStatusCode=zi;Ke.default=Ke;const re=Ke,Cs=h.createContext(),Ot=()=>{const a=h.useContext(Cs);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a},Pi=({children:a})=>{const[s,r]=h.useState(null),[l,n]=h.useState(!0),[i,o]=h.useState(()=>sessionStorage.getItem("authToken"));h.useEffect(()=>{i?re.defaults.headers.common.Authorization=`Bearer ${i}`:delete re.defaults.headers.common.Authorization},[i]),h.useEffect(()=>{(async()=>{if(i)try{const b=(await re.get("/api/auth/verify",{timeout:1e4})).data.user;b?r({id:b._id||b.id,username:b.username,email:b.email,fullName:b.fullName||b.full_name||b.username,role:b.role,avatar:b.avatar,status:b.status||"active",permissions:b.permissions||{},lastLogin:new Date().toISOString()}):(console.error("No user data received from verify endpoint"),o(null),r(null))}catch(T){console.error("Auth verification failed:",T),T.code==="ECONNABORTED"&&ke.error("Timeout la verificare autentificare"),sessionStorage.removeItem("authToken"),o(null),r(null)}else window.location.pathname!=="/login"&&window.location.replace("/login");n(!1)})()},[i]);const d={user:s,token:i,loading:l,login:async(f,T)=>{var b,y;try{n(!0);const k=await re.post("/api/auth/login",{username:f,password:T}),{token:A}=k.data;sessionStorage.setItem("authToken",A),o(A),re.defaults.headers.common.Authorization=`Bearer ${A}`;const{user:O}=k.data;if(O){const g={id:O._id||O.id,username:O.username,email:O.email,fullName:O.fullName||O.full_name||O.username,role:O.role,avatar:O.avatar,status:O.status||"active",permissions:O.permissions||{},lastLogin:new Date().toISOString()};return r(g),ke.success(`Bun venit, ${g.fullName}!`),{success:!0}}else throw new Error("No user data received after login")}catch(k){const A=((y=(b=k.response)==null?void 0:b.data)==null?void 0:y.message)||"Eroare la autentificare";return ke.error(A),{success:!1,error:A}}finally{n(!1)}},logout:()=>{sessionStorage.removeItem("authToken"),o(null),r(null),delete re.defaults.headers.common.Authorization,ke.success("V-ați deconectat cu succes!")},clearAuth:()=>{sessionStorage.removeItem("authToken"),o(null),r(null),delete re.defaults.headers.common.Authorization,window.location.reload()},updateUser:f=>{r(f)},isAuthenticated:!!s};return e(Cs.Provider,{value:d,children:a})};re.defaults.baseURL="https://cashpot-backend.onrender.com";const Ss=h.createContext(),ye=()=>{const a=h.useContext(Ss);if(!a)throw new Error("useData must be used within DataProvider");return a},Li=({children:a})=>{const[s,r]=h.useState([]),[l,n]=h.useState([]),[i,o]=h.useState([]),[c,u]=h.useState([]),[p,m]=h.useState([]),[d,f]=h.useState([]),[T,b]=h.useState([]),[y,k]=h.useState([]),[A,O]=h.useState([]),[g,$]=h.useState([]),[_,E]=h.useState([]),[G,j]=h.useState([]),[N,D]=h.useState([]),[S,F]=h.useState([]),[I,x]=h.useState([]),[v,L]=h.useState([]),[K,R]=h.useState([]),[C,z]=h.useState([]),[J,P]=h.useState([]),[Z,se]=h.useState([]),[oe,de]=h.useState([]),[Se,Oe]=h.useState([]),[Ue,Ze]=h.useState(!1),$e={companies:{state:s,setState:r},locations:{state:l,setState:n},providers:{state:i,setState:o},platforms:{state:c,setState:u},cabinets:{state:p,setState:m},gameMixes:{state:d,setState:f},slots:{state:T,setState:b},warehouse:{state:y,setState:k},metrology:{state:A,setState:O},jackpots:{state:g,setState:$},invoices:{state:_,setState:E},onjnReports:{state:G,setState:j},legalDocuments:{state:N,setState:D},users:{state:S,setState:F},games:{state:I,setState:x},proprietari:{state:v,setState:L},contracts:{state:K,setState:R},promotions:{state:C,setState:z},approvals:{state:J,setState:P},tasks:{state:Z,setState:se},messages:{state:oe,setState:de},notifications:{state:Se,setState:Oe}},rt=async()=>{console.log("🚀 Starting to fetch all data in parallel..."),Ze(!0);try{const ne=Object.keys($e),le=["companies","locations","providers"],be=ne.filter(B=>!le.includes(B)),te=le.map(B=>re.get(`/api/${B}`,{timeout:1e4}).catch(M=>(console.error(`❌ Error fetching ${B}:`,M),{data:[]})));console.log(`📡 Making ${te.length} priority requests...`),(await Promise.all(te)).forEach((B,M)=>{const w=le[M],V=Array.isArray(B.data)?B.data:[];console.log(`✅ ${w}: ${V.length} items`),$e[w].setState(V)}),console.log("⚡ Priority data loaded!");try{const B=await re.get("/api/cyber/slots-with-jackpots",{timeout:1e4}),M=Array.isArray(B.data)?B.data:[];console.log(`✅ slots with jackpots: ${M.length} items`),b(M)}catch(B){console.error("❌ Error fetching slots with jackpots, trying regular slots:",B);try{const M=await re.get("/api/slots",{timeout:1e4}),w=Array.isArray(M.data)?M.data:[];console.log(`✅ slots (fallback): ${w.length} items`),b(w)}catch(M){console.error("❌ Error fetching regular slots, trying local file:",M);try{console.log("🔄 Trying to load slots from local file...");const w=await re.get("/cyber-slots.json",{timeout:5e3}),V=Array.isArray(w.data)?w.data:[];if(console.log(`✅ slots (local file): ${V.length} items`),V.length>0){b(V),ke.success(`${V.length} sloturi încărcate din fișier local (mod offline)`);return}}catch(w){console.error("❌ Error fetching slots from local file:",w)}console.warn("⚠️ All slot data sources failed, using empty array"),b([])}}const Ce=be.map(B=>re.get(`/api/${B}`,{timeout:1e4}).catch(w=>(console.error(`❌ Error fetching ${B}:`,w),{data:[]})));console.log(`📡 Loading ${Ce.length} remaining entities in background...`);const Pe=await Promise.all(Ce);Pe.forEach((B,M)=>{const w=be[M],V=Array.isArray(B.data)?B.data:[];console.log(`✅ ${w}: ${V.length} items`),$e[w].setState(V)});const Ae=be.findIndex(B=>B==="promotions");if(Ae!==-1){const B=Pe[Ae];if((Array.isArray(B.data)?B.data:[]).length===0){console.log("🚨 PROMOTIONS EMPTY - trying direct API call...");try{const w=await re.get("/api/promotions",{timeout:5e3});Array.isArray(w.data)&&w.data.length>0&&(console.log(`✅ Direct promotions fetch: ${w.data.length} items`),z(w.data))}catch(w){console.error("❌ Direct promotions fetch failed:",w)}}}console.log("⚡ All data loaded!")}catch(ne){console.error("Error fetching data:",ne),ke.error("Eroare la încărcarea datelor")}finally{Ze(!1)}};h.useEffect(()=>{console.log("🚀 DataContext useEffect triggered"),rt()},[]);const Be=async()=>{const ne=new Date,le=new Date().toISOString().split("T")[0],be=new Date(ne);be.setDate(ne.getDate()+(8-ne.getDay())%7);const te=[];for(let B=0;B<5;B++){const M=new Date(be);M.setDate(be.getDate()+B*7),te.push(M.toISOString().split("T")[0])}const ie=new Date(te[4]);ie.setDate(ie.getDate()+7);const Ce=ie.toISOString().split("T")[0],Pe=te.map((B,M)=>({amount:"10000",currency:"RON",date:B,winner:""}));return Ye("promotions",{name:"Tombola Craiova - Premii Săptămânale",description:"Tombola cu 5 premii săptămânale a câte 10.000 lei fiecare. Extragerea are loc în fiecare luni.",start_date:le,end_date:Ce,location:"Craiova",locations:[{location:"Craiova",start_date:le,end_date:Ce}],prizes:Pe,status:"Active",notes:"Creat automat pentru testare"})},Ye=async(ne,le)=>{try{if(console.log(`🚀 Creating ${ne} with data:`,le),ne==="slots"&&le.items&&Array.isArray(le.items)&&le.items.length>0)try{console.log("🔥 USING OFFLINE MODE FOR SLOTS IMPORT-MARINA");const te=le.items.map(ie=>({...ie,id:ie.id||Date.now()+Math.floor(Math.random()*1e3),created_at:ie.created_at||new Date().toISOString(),last_updated:ie.last_updated||new Date().toISOString(),imported_by:"Offline Import",import_source:"Marina (Offline)"}));return b(ie=>[...te,...ie]),ke.success(`${te.length} sloturi importate cu succes! (Mod offline)`),{success:!0,data:{imported:te.length,slots:te}}}catch(te){console.error("❌ Offline slots import failed:",te)}if(ne==="promotions")try{console.log("🔥 USING DIRECT ENDPOINT FOR PROMOTIONS");const te={name:le.name||"Test Promotion",description:le.description||"Auto-created test promotion",start_date:le.start_date||new Date().toISOString().split("T")[0],end_date:le.end_date||"2025-12-31",location:le.location||(le.locations&&le.locations.length>0?le.locations[0].location:"Default Location"),prizes:JSON.stringify(le.prizes||[]),locations:JSON.stringify(le.locations||[]),status:le.status||"Active",created_by:"Direct API",created_at:new Date().toISOString()};z(ie=>[...ie,te]);try{re.post("https://cashpot-backend.onrender.com/api/promotions",te).then(ie=>{console.log("✅ Promotion saved to AWS successfully:",ie.data)}).catch(ie=>{console.error("❌ AWS save error:",ie),setTimeout(()=>{console.log("🔄 Retrying AWS save..."),re.post("https://cashpot-backend.onrender.com/api/promotions",te).then(Ce=>{console.log("✅ AWS retry successful:",Ce.data)}).catch(Ce=>{console.error("❌ AWS retry failed:",Ce),setTimeout(()=>{console.log("🔄 Final AWS save attempt..."),re.post("https://cashpot-backend.onrender.com/api/promotions/direct",te).catch(Pe=>{console.error("❌ All AWS save attempts failed:",Pe)})},3e3)})},2e3)})}catch(ie){console.error("❌ AWS save attempt error:",ie)}return ke.success("Promoție adăugată cu succes!"),{success:!0,data:te}}catch(te){console.error("❌ Direct promotions endpoint failed:",te)}const be=await re.post(`/api/${ne}`,le);if(be.data){const te=be.data;if(te.compression){const{originalSize:ie,compressedSize:Ce,compressionRatio:Pe,savedBytes:Ae}=te.compression,B=(ie/1024/1024).toFixed(2),M=(Ce/1024/1024).toFixed(2),w=(Ae/1024).toFixed(2);ke.success(`Adăugat cu succes! PDF comprimat: ${B}MB → ${M}MB (${Pe}% reducere, ${w}KB economisite)`,{duration:6e3})}else ke.success("Adăugat cu succes!");return $e[ne].setState(ie=>[te,...ie]),{success:!0,data:te}}}catch(be){if(console.error(`Error creating ${ne}:`,be),ne==="slots"&&le.items&&Array.isArray(le.items)){console.log("🔄 FALLBACK: Creating offline slots import");const te=le.items.map(ie=>({...ie,id:ie.id||Date.now()+Math.floor(Math.random()*1e3),created_at:ie.created_at||new Date().toISOString(),last_updated:ie.last_updated||new Date().toISOString(),imported_by:"Offline Import Fallback",import_source:"Marina (Offline Fallback)"}));return b(ie=>[...te,...ie]),ke.success(`${te.length} sloturi importate în mod offline! Se vor sincroniza când serverul este disponibil.`),{success:!0,data:{imported:te.length,slots:te}}}if(ne==="promotions"){console.log("🔄 FALLBACK: Creating offline promotion");const te={id:Date.now(),name:le.name||"Offline Promotion",description:le.description||"Created in offline mode",start_date:le.start_date||new Date().toISOString().split("T")[0],end_date:le.end_date||"2025-12-31",location:le.location||(le.locations&&le.locations.length>0?le.locations[0].location:"Default Location"),prizes:le.prizes||[],locations:le.locations||[],status:le.status||"Active",created_by:"Offline Mode",created_at:new Date().toISOString()};z(ie=>[...ie,te]);try{console.log("🚀 Sending to AWS ONLY - NO LOCAL STORAGE"),re.post("https://cashpot-backend.onrender.com/api/promotions",te).then(ie=>{console.log("✅ Promotion saved to AWS successfully:",ie.data)}).catch(ie=>{console.error("❌ AWS save error:",ie),setTimeout(()=>{console.log("🔄 Retrying AWS save..."),re.post("https://cashpot-backend.onrender.com/api/promotions",te).then(Ce=>{console.log("✅ AWS retry successful:",Ce.data)}).catch(Ce=>{console.error("❌ AWS retry failed:",Ce),setTimeout(()=>{console.log("🔄 Final AWS save attempt..."),re.post("https://cashpot-backend.onrender.com/api/promotions/direct",te).catch(Pe=>{console.error("❌ All AWS save attempts failed:",Pe),re.post("https://cashpot-backend-working.onrender.com/api/promotions",te).then(Ae=>{console.log("✅ Alternative AWS endpoint successful:",Ae.data)}).catch(Ae=>{console.error("❌ Alternative AWS endpoint failed:",Ae)})})},3e3)})},2e3)})}catch(ie){console.error("❌ AWS save attempt error:",ie)}return ke.success("Promoție adăugată cu succes! Se sincronizează cu AWS..."),{success:!0,data:te}}return ke.error("Eroare la adăugare!"),{success:!1,error:be.message}}},Q=async(ne,le,be)=>{try{const te=await re.put(`/api/${ne}/${le}`,be);if(te.data){const ie=te.data;if(ie.compression){const{originalSize:Ce,compressedSize:Pe,compressionRatio:Ae,savedBytes:B}=ie.compression,M=(Ce/1024/1024).toFixed(2),w=(Pe/1024/1024).toFixed(2),V=(B/1024).toFixed(2);ke.success(`Actualizat cu succes! PDF comprimat: ${M}MB → ${w}MB (${Ae}% reducere, ${V}KB economisite)`,{duration:6e3})}else ke.success("Actualizat cu succes!");return $e[ne].setState(Ce=>(Ce||[]).map(Pe=>Pe.id===le?{...Pe,...ie}:Pe)),{success:!0,data:ie}}}catch(te){return console.error(`Error updating ${ne}:`,te),ke.error("Eroare la actualizare!"),{success:!1,error:te.message}}},ce=async(ne,le,be=!1)=>{try{return await re.delete(`/api/${ne}/${le}`),$e[ne].setState(te=>te.filter(ie=>ie.id!==le)),be||ke.success("Șters cu succes!"),{success:!0}}catch(te){return console.error(`Error deleting ${ne}:`,te),be||ke.error("Eroare la ștergere!"),{success:!1,error:te.message}}},ue=ne=>{const le=$e[ne].state,be=le.length>0?Object.keys(le[0]||{}):[];let te=`<?xml version="1.0"?>
`;te+=`<?mso-application progid="Excel.Sheet"?>
`,te+=`<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
`,te+=` xmlns:o="urn:schemas-microsoft-com:office:office"
`,te+=` xmlns:x="urn:schemas-microsoft-com:office:excel"
`,te+=` xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
`,te+=` xmlns:html="http://www.w3.org/TR/REC-html40">
`,te+=`<Worksheet ss:Name="Sheet1">
`,te+=`<Table>
`,te+=`<Row>
`(be||[]).forEach(Ae=>{te+=`<Cell><Data ss:Type="String">${pe(Ae)}</Data></Cell>
`}),te+=`</Row>
`(le||[]).forEach(Ae=>{te+=`<Row>
`(be||[]).forEach(B=>{const M=Ae[B];M==null?te+=`<Cell><Data ss:Type="String"></Data></Cell>
`:typeof M=="number"?te+=`<Cell><Data ss:Type="Number">${M}</Data></Cell>
`:te+=`<Cell><Data ss:Type="String">${pe(String(M))}</Data></Cell>
`}),te+=`</Row>
`}),te+=`</Table>
`,te+=`</Worksheet>
`,te+="</Workbook>";const ie=new Blob([te],{type:"application/vnd.ms-excel"}),Ce=URL.createObjectURL(ie),Pe=document.createElement("a");Pe.href=Ce,Pe.download=`${ne}-${new Date().toISOString().split("T")[0]}.xls`,Pe.click(),URL.revokeObjectURL(Ce),ke.success("Exportat în Excel cu succes!")},pe=ne=>String(ne).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),me={createTestWeeklyTombola:Be,companies:s,locations:l,providers:i,platforms:c,cabinets:p,gameMixes:d,slots:T,warehouse:y,metrology:A,jackpots:g,invoices:_,onjnReports:G,legalDocuments:N,users:S,games:I,proprietari:v,contracts:K,promotions:C,approvals:J,tasks:Z,messages:oe,notifications:Se,loading:Ue,statistics:fe,createItem:Ye,updateItem:Q,deleteItem:ce,exportData:ne=>{ue(ne)},exportToExcel:ue,exportToPDF:ne=>{const le=$e[ne].state,be=le.length>0?Object.keys(le[0]||{}):[];let te=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1 { color: #333; }
          table { border-collapse: collapse; width: 100%; margin-top: 20px; }
          th { background-color: #4CAF50; color: white; padding: 12px; text-align: left; border: 1px solid #ddd; }
          td { padding: 10px; border: 1px solid #ddd; }
          tr:nth-child(even) { background-color: #f2f2f2; }
          .footer { margin-top: 20px; text-align: center; color: #666; font-size: 12px; }
        </style>
      </head>
      <body>
        <h1>Raport ${ne.toUpperCase()}</h1>
        <p>Generat la: ${new Date().toLocaleString("ro-RO")}</p>
        <table>
          <thead>
            <tr>
              ${(be||[]).map(Ce=>`<th>${Ce}</th>`).join("")}
            </tr>
          </thead>
          <tbody>
    `(le||[]).forEach(Ce=>{te+="<tr>"(be||[]).forEach(Pe=>{const Ae=Ce[Pe],B=Ae==null?"":typeof Ae=="object"?JSON.stringify(Ae):String(Ae);te+=`<td>${B}</td>`}),te+="</tr>"});te+=`
          </tbody>
        </table>
        <div class="footer">
          Total înregistrări: ${le.length}
        </div>
      </body>
      </html>
    `;const ie=window.open("","","width=1200,height=800");ie.document.write(te),ie.document.close(),setTimeout(()=>{ie.print(),ke.success('PDF generat! Folosește "Salvează ca PDF" în dialogul de printare.')},250)},refreshData:rt},fe={totalCompanies:s.length,totalLocations:l.length,totalProviders:i.length,totalCabinets:p.length,totalGameMixes:d.length,totalSlots:T.length,totalWarehouse:y.length,totalMetrology:A.length,totalJackpots:g.length,totalInvoices:_.length,totalOnjnReports:G.length,totalLegalDocuments:N.length,totalUsers:S.length,totalGames:I.length,totalTasks:Z.length,totalMessages:oe.length,totalNotifications:Se.length};return e(Ss.Provider,{value:me,children:a})},_s=({size:a="lg",text:s="Se încarcă..."})=>t("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[t("div",{className:"relative",children:[e("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"}[a]} border-4 border-slate-200 border-t-blue-600 rounded-full animate-spin`}),e("div",{className:"absolute inset-0 flex items-center justify-center",children:e("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"})})]}),e("p",{className:"mt-4 text-slate-600 font-medium animate-pulse",children:s})]}),zr=({children:a})=>{const{isAuthenticated:s,loading:r}=Ot();return r?e(_s,{}):s?a:e(Ht,{to:"/login",replace:!0})},q={DASHBOARD:"dashboard",COMPANIES:"companies",LOCATIONS:"locations",PROVIDERS:"providers",CABINETS:"cabinets",GAME_MIXES:"gameMixes",SLOTS:"slots",WAREHOUSE:"warehouse",METROLOGY:"metrology",JACKPOTS:"jackpots",INVOICES:"invoices",ONJN:"onjn",LEGAL:"legal",USERS:"users",SETTINGS:"settings",CONTRACTS:"contracts",CYBER_IMPORT:"cyberImport",MARKETING:"marketing"},ae={VIEW:"view",CREATE:"create",EDIT:"edit",DELETE:"delete",EXPORT:"export",IMPORT:"import"},fa={[q.DASHBOARD]:{label:"📊 Dashboard",actions:[ae.VIEW,ae.EDIT]},[q.COMPANIES]:{label:"🏢 Companii",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.LOCATIONS]:{label:"📍 Locații",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.PROVIDERS]:{label:"🎮 Furnizori",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.CABINETS]:{label:"🎰 Cabinete",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.GAME_MIXES]:{label:"🎲 Game Mixes",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.SLOTS]:{label:"🍒 Sloturi",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT,ae.IMPORT]},[q.WAREHOUSE]:{label:"📦 Depozit",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.METROLOGY]:{label:"⚖️ Metrologie",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.CONTRACTS]:{label:"📄 Contracte",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.INVOICES]:{label:"🧾 Facturi",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.JACKPOTS]:{label:"💰 Jackpot-uri",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE]},[q.ONJN]:{label:"⚖️ ONJN",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.LEGAL]:{label:"📋 Legal",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]},[q.USERS]:{label:"👥 Utilizatori",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE]},[q.SETTINGS]:{label:"⚙️ Setări",actions:[ae.VIEW,ae.EDIT]},[q.CYBER_IMPORT]:{label:"🔄 Import Cyber",actions:[ae.VIEW,ae.IMPORT]},[q.MARKETING]:{label:"📢 Marketing & Promoții",actions:[ae.VIEW,ae.CREATE,ae.EDIT,ae.DELETE,ae.EXPORT]}},Ii={[ae.VIEW]:"Vizualizare",[ae.CREATE]:"Creare",[ae.EDIT]:"Editare",[ae.DELETE]:"Ștergere",[ae.EXPORT]:"Export",[ae.IMPORT]:"Import"},Pr={admin:{...Object.keys(q).reduce((a,s)=>{const r=q[s];return a[r]=fa[r].actions.reduce((l,n)=>(l[n]=!0,l),{}),a},{})},manager:{[q.DASHBOARD]:{view:!0,edit:!0},[q.COMPANIES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0,import:!0},[q.WAREHOUSE]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.METROLOGY]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.CONTRACTS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.INVOICES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.JACKPOTS]:{view:!0,create:!0,edit:!0,delete:!1},[q.ONJN]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.LEGAL]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.USERS]:{view:!0,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!0,edit:!1},[q.CYBER_IMPORT]:{view:!0,import:!0},[q.MARKETING]:{view:!0,create:!0,edit:!0,delete:!1,export:!0}},user:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0,import:!1},[q.WAREHOUSE]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.METROLOGY]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CONTRACTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.INVOICES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LEGAL]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!1,import:!1},[q.MARKETING]:{view:!0,create:!1,edit:!1,delete:!1,export:!0}},marketing:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.PROVIDERS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.CABINETS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.GAME_MIXES]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.SLOTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0,import:!1},[q.WAREHOUSE]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.METROLOGY]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.CONTRACTS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.INVOICES]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.LEGAL]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!1,import:!1},[q.MARKETING]:{view:!0,create:!0,edit:!0,delete:!0,export:!0}},operational:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!0,edit:!0,delete:!1,export:!0,import:!0},[q.WAREHOUSE]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.METROLOGY]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.CONTRACTS]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.INVOICES]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LEGAL]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!0,import:!0},[q.MARKETING]:{view:!0,create:!1,edit:!1,delete:!1,export:!0}},financiar:{[q.DASHBOARD]:{view:!0,edit:!1},[q.COMPANIES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.LOCATIONS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.PROVIDERS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.CABINETS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.GAME_MIXES]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.SLOTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0,import:!1},[q.WAREHOUSE]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.METROLOGY]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.CONTRACTS]:{view:!0,create:!1,edit:!1,delete:!1,export:!0},[q.INVOICES]:{view:!0,create:!0,edit:!0,delete:!1,export:!0},[q.JACKPOTS]:{view:!0,create:!1,edit:!1,delete:!1},[q.ONJN]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.LEGAL]:{view:!1,create:!1,edit:!1,delete:!1,export:!1},[q.USERS]:{view:!1,create:!1,edit:!1,delete:!1},[q.SETTINGS]:{view:!1,edit:!1},[q.CYBER_IMPORT]:{view:!1,import:!1},[q.MARKETING]:{view:!0,create:!1,edit:!1,delete:!1,export:!0}}},As=(a,s,r)=>!a||!a[s]?!1:a[s][r]===!0,Na=a=>Pr[a]||Pr.user,Re=({children:a,requiredRole:s,requiredPermission:r,module:l,action:n="view"})=>{const{user:i,loading:o}=Ot();return o?e(_s,{}):i?s&&i.role!==s&&i.role!=="admin"?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:t("div",{className:"text-center p-8",children:[e("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Acces Restricționat"}),e("p",{className:"text-slate-600 mb-6",children:"Nu aveți permisiunea necesară pentru a accesa această pagină."}),e("button",{onClick:()=>window.history.back(),className:"btn-primary",children:"Înapoi"})]})}):r&&l&&!As(i.permissions,l,n)?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:t("div",{className:"text-center p-8",children:[e("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Permisiune Insuficientă"}),e("p",{className:"text-slate-600 mb-6",children:"Nu aveți permisiunea necesară pentru a accesa această secțiune."}),e("button",{onClick:()=>window.history.back(),className:"btn-primary",children:"Înapoi"})]})}):a:e(Ht,{to:"/login",replace:!0})},Ri=()=>{var _,E,G,j,N,D,S,F,I,x,v,L,K,R;const a=He(),{login:s,isAuthenticated:r,loading:l}=Ot(),[n,i]=h.useState({username:"",password:""}),[o,c]=h.useState(!1),[u,p]=h.useState(!1),[m,d]=h.useState(!1),[f,T]=h.useState({logo:{type:"upload",url:"",file:null},loginImage:{type:"upload",url:"",file:null},loginButtonColor:{primary:"#FF7A00",secondary:"#FF9500",useGradient:!1},loginPageColor:{primary:"#FFFFFF",secondary:"#F5F5F5",useGradient:!1},loginCardColor:{primary:"#8B5CF6",secondary:"#A855F7",useGradient:!0},loginTextColor:{title:"#1e293b",labels:"#334155",text:"#64748b"},loginTexts:{title:"Welcome Back",emailLabel:"Email Address",passwordLabel:"Password",buttonText:"Sign In to CASHPOT",forgotPassword:"Forgot your password?",termsText:"By signing in, you agree to our Terms of Service and Privacy Policy",joinText:"New to CASHPOT? Create Account",supportText:"Need assistance? Contact our support team"}});h.useEffect(()=>{},[]),h.useEffect(()=>{r&&a("/dashboard",{replace:!0})},[r,a]);const b=C=>{i({...n,[C.target.name]:C.target.value})},y=async C=>{C.preventDefault(),p(!0),(await s(n.username,n.password)).success&&a("/dashboard",{replace:!0}),p(!1)};if(r)return e(Ht,{to:"/dashboard",replace:!0});const k=f.logo.file||f.logo.url||"/favicon.svg",A=f.loginImage.file||f.loginImage.url||"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&q=80",O=f.loginButtonColor.useGradient?{background:`linear-gradient(to right, ${f.loginButtonColor.primary}, ${f.loginButtonColor.secondary})`}:{backgroundColor:f.loginButtonColor.primary},g=f.loginPageColor.useGradient?{background:`linear-gradient(to right, ${f.loginPageColor.primary}, ${f.loginPageColor.secondary})`}:{backgroundColor:f.loginPageColor.primary},$=(_=f.loginCardColor)!=null&&_.useGradient?{background:`linear-gradient(to right, ${f.loginCardColor.primary}, ${f.loginCardColor.secondary})`}:{backgroundColor:((E=f.loginCardColor)==null?void 0:E.primary)||"#8B5CF6"};return t("div",{className:"min-h-screen flex",children:[e("div",{className:"w-full lg:w-1/2 flex items-center justify-center pt-16",style:g,children:t("div",{className:"w-full max-w-lg px-8 lg:px-16",children:[t("div",{className:"rounded-2xl shadow-2xl p-16",style:$,children:[t("div",{className:"flex flex-col items-center mb-12",children:[e("img",{src:k,alt:"Logo",className:"h-20 md:h-24 object-contain mb-4",onError:C=>{C.target.src="/favicon.svg"}}),e("h1",{className:"text-2xl md:text-3xl font-bold text-white text-center",children:((G=f.loginTexts)==null?void 0:G.title)||"Welcome Back"}),e("p",{className:"text-white/80 text-center mt-2",children:"Access your CASHPOT dashboard"})]}),t("form",{onSubmit:y,className:"space-y-6",children:[t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-white",children:[((j=f.loginTexts)==null?void 0:j.emailLabel)||"Email",e("span",{className:"text-red-300",children:"*"})]}),e("input",{type:"text",name:"username",value:n.username,onChange:b,className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"your@email.com",required:!0,disabled:u})]}),t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-white",children:[((N=f.loginTexts)==null?void 0:N.passwordLabel)||"Password",e("span",{className:"text-red-300",children:"*"})]}),t("div",{className:"relative",children:[e("input",{type:o?"text":"password",name:"password",value:n.password,onChange:b,className:"w-full px-4 py-3 pr-12 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"••••••••",required:!0,disabled:u}),e("button",{type:"button",onClick:()=>c(!o),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",disabled:u,children:o?e(Xa,{size:20}):e(Qe,{size:20})})]})]}),e("div",{className:"flex items-center justify-between",children:t("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e("input",{type:"checkbox",checked:m,onChange:C=>d(C.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",disabled:u}),e("span",{className:"text-sm text-white font-medium",children:"Remember Password"})]})}),e("button",{type:"submit",disabled:u||l,className:"w-full py-3 rounded-lg text-white font-semibold shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:O,children:u||l?t("div",{className:"flex items-center justify-center space-x-2",children:[e("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e("span",{children:((D=f.loginTexts)==null?void 0:D.buttonText)||"Log In"})]}):((S=f.loginTexts)==null?void 0:S.buttonText)||"Log In"})]})]}),e("div",{className:"mt-8 text-center",children:e("a",{href:"#",className:"text-sm text-orange-500 hover:text-orange-600 font-medium hover:underline",children:((F=f.loginTexts)==null?void 0:F.forgotPassword)||"Forgot Password?"})}),e("div",{className:"mt-6 text-xs text-center",style:{color:((I=f.loginTextColor)==null?void 0:I.text)||"#64748b"},children:((x=f.loginTexts)==null?void 0:x.termsText)||"By clicking login you agree to the terms of the Club Membership Agreement and the Independent Partner Agreement"}),e("div",{className:"mt-4 text-center text-sm",style:{color:((v=f.loginTextColor)==null?void 0:v.text)||"#64748b"},children:e("span",{dangerouslySetInnerHTML:{__html:(((L=f.loginTexts)==null?void 0:L.joinText)||"New to CASHPOT? Create Account").replace(/Create Account/g,'<a href="#" class="text-orange-500 hover:text-orange-600 font-semibold hover:underline">Create Account</a>')}})}),e("div",{className:"mt-4 text-xs text-center",style:{color:((K=f.loginTextColor)==null?void 0:K.text)||"#64748b"},children:((R=f.loginTexts)==null?void 0:R.supportText)||"Need help? Contact us at login-support@in.group"})]})}),e("div",{className:"hidden lg:flex lg:w-1/2 items-center justify-center p-8",style:g,children:e("div",{className:"w-full h-full rounded-3xl overflow-hidden shadow-2xl",children:e("img",{src:A,alt:"Login Background",className:"w-full h-full object-cover",onError:C=>{C.target.src="https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&q=80"}})})})]})},he=({children:a})=>{const[s,r]=h.useState(!0),[l,n]=h.useState(new Date),[i,o]=h.useState(!1),{user:c,logout:u}=Ot(),{companies:p,locations:m,providers:d,platforms:f,cabinets:T,gameMixes:b,slots:y,warehouse:k,metrology:A,approvals:O,jackpots:g,invoices:$,onjnReports:_,legalDocuments:E,users:G,promotions:j,tasks:N,messages:D,notifications:S}=ye(),{theme:F,toggleTheme:I}=Zl(),x=Ps(),[v,L]=va.useState({logo:{type:"upload",url:"",file:null},headerColor:{primary:"#2563eb",secondary:"#4f46e5",useGradient:!0},appTitle:"CASHPOT V7",appSubtitle:"Gaming Management System"});va.useEffect(()=>{K()},[]);const K=async()=>{try{const P=await re.get("/api/auth/verify");if(P.data.success&&P.data.user){const Z=P.data.user.preferences||{};if(Z.appSettings){if(L(Z.appSettings),Z.appSettings.favicon&&Z.appSettings.favicon.file){const se=document.querySelector("link[rel~='icon']");if(se)se.href=Z.appSettings.favicon.file;else{const oe=document.createElement("link");oe.rel="icon",oe.type="image/x-icon",oe.href=Z.appSettings.favicon.file,document.head.appendChild(oe)}}console.log("✅ Loaded app settings in Layout from server");return}}}catch{console.log("⚠️ Could not load settings from server in Layout")}};h.useEffect(()=>{const P=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(P)},[]),h.useEffect(()=>{const P=Z=>{i&&!Z.target.closest(".notification-container")&&o(!1)};return document.addEventListener("click",P),()=>document.removeEventListener("click",P)},[i]);const C=[{id:"dashboard",label:"Dashboard",icon:it,path:"/dashboard",count:null,module:q.DASHBOARD},{id:"companies",label:"Companii",icon:_e,path:"/companies",count:p.length,module:q.COMPANIES},{id:"locations",label:"Locații",icon:We,path:"/locations",count:m.length,module:q.LOCATIONS},{id:"providers",label:"Furnizori",icon:bt,path:"/providers",count:d.length,module:q.PROVIDERS},{id:"cabinets",label:"Cabinete",icon:ct,path:"/cabinets",count:T.length,module:q.CABINETS},{id:"game-mixes",label:"Game Mixes",icon:$t,path:"/game-mixes",count:b.length,module:q.GAME_MIXES},{id:"slots",label:"Sloturi",icon:it,path:"/slots",count:y.length,module:q.SLOTS},{id:"warehouse",label:"Depozit",icon:At,path:"/warehouse",count:k.length,module:q.WAREHOUSE},{id:"metrology",label:"Metrologie CVT",icon:Yt,path:"/metrology",count:A.length,module:q.METROLOGY},{id:"jackpots",label:"Jackpots",icon:Gt,path:"/jackpots",count:g.length,module:q.JACKPOTS},{id:"invoices",label:"Facturi",icon:ge,path:"/invoices",count:$.length,module:q.INVOICES},{id:"onjn-reports",label:"Rapoarte ONJN",icon:ya,path:"/onjn-reports",count:_.length,module:q.ONJN},{id:"legal-documents",label:"Documente Legale",icon:ge,path:"/legal-documents",count:E.length,module:q.LEGAL},{id:"marketing",label:"Marketing",icon:lt,path:"/marketing",count:(j==null?void 0:j.length)||0,module:q.MARKETING},{id:"tasks",label:"Sarcini",icon:zt,path:"/tasks",count:(N==null?void 0:N.length)||0},{id:"messages",label:"Mesaje",icon:or,path:"/messages",count:(D==null?void 0:D.filter(P=>P.recipient_id===(c==null?void 0:c.userId)&&!P.is_read).length)||0},{id:"users",label:"Utilizatori",icon:bt,path:"/users",count:G.length,module:q.USERS,requiresAdmin:!0},{id:"settings",label:"Setări",icon:Lt,path:"/settings",count:null,module:q.SETTINGS}].filter(P=>{if((c==null?void 0:c.role)==="admin")return!0;if(P.requiresAdmin&&(c==null?void 0:c.role)!=="admin")return!1;if(!P.module)return!0;const Z=c!=null&&c.permissions&&Object.keys(c.permissions).length>0?c.permissions:Na(c==null?void 0:c.role);return As(Z,P.module,"view")});C.find(P=>P.path===x.pathname);const z=S.filter(P=>!P.is_read).length+D.filter(P=>P.recipient_id===(c==null?void 0:c.userId)&&!P.is_read).length,J=F==="dark"?{background:"linear-gradient(to right, #1e293b, #0f172a)"}:v.headerColor.useGradient?{background:`linear-gradient(to right, ${v.headerColor.primary}, ${v.headerColor.secondary})`}:{backgroundColor:v.headerColor.primary};return t("div",{className:"flex h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[e("div",{className:`fixed top-0 left-0 right-0 backdrop-blur-xl border-b text-white px-4 md:px-6 py-2 md:py-3 z-30 shadow-2xl ${F==="dark"?"border-slate-700/50 shadow-slate-900/20":"border-white/20 shadow-blue-500/10"}`,style:J,children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-2 md:space-x-4",children:[e("button",{onClick:()=>r(!s),className:`p-2 rounded-xl transition-all duration-200 hover:shadow-lg ${F==="dark"?"hover:bg-slate-700/80":"hover:bg-slate-100/80"}`,children:e(Os,{size:20})}),t("div",{className:"flex items-center",children:[v.logo.file||v.logo.url?e("img",{src:v.logo.file||v.logo.url,alt:"Logo",className:"h-8 md:h-12 object-contain",onError:P=>{P.target.style.display="none",P.target.nextSibling.style.display="flex"}}):null,e("div",{className:"w-8 h-8 md:w-12 md:h-12 bg-gradient-to-br from-amber-400 via-orange-500 to-red-500 rounded-2xl flex items-center justify-center shadow-xl shadow-orange-500/30 ring-2 ring-orange-200/50",style:{display:v.logo.file||v.logo.url?"none":"flex"},children:e("span",{className:"text-white font-bold text-base md:text-xl",children:"C"})})]})]}),t("div",{className:"flex items-center space-x-2 md:space-x-4",children:[t("div",{className:"hidden md:block text-right",children:[e("div",{className:"text-white font-semibold text-sm",children:l.toLocaleString("ro-RO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e("div",{className:"text-white/70 text-xs",children:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"🖥️ Local":"☁️ Online"})]}),e("button",{onClick:I,className:"p-2 rounded-xl hover:bg-white/20 transition-all duration-200 hover:shadow-lg group",title:F==="dark"?"Light Mode":"Dark Mode",children:F==="dark"?e(Fs,{size:18,className:"group-hover:scale-110 transition-transform text-white"}):e(js,{size:18,className:"group-hover:scale-110 transition-transform text-white"})}),t("div",{className:"relative hidden sm:block notification-container",children:[t("button",{onClick:()=>o(!i),className:"p-2 rounded-xl hover:bg-white/20 transition-all duration-200 hover:shadow-lg group",children:[e(Ia,{size:18,className:"group-hover:scale-110 transition-transform text-white"}),z>0&&e("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-gradient-to-r from-red-500 to-pink-500 rounded-full shadow-lg animate-pulse flex items-center justify-center text-xs text-white font-bold",children:z>99?"99+":z})]}),i&&t("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50 z-50 max-h-96 overflow-hidden",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-6 py-4 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-indigo-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl shadow-lg",children:e(Ia,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-lg font-bold text-white",children:"Notificări"})]}),e("button",{onClick:()=>o(!1),className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-2 transition-all duration-200",children:e(ve,{size:20})})]}),e("div",{className:"max-h-80 overflow-y-auto",children:z===0?t("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:[e("div",{className:"mb-2",children:e(Ia,{size:32,className:"mx-auto text-gray-300 dark:text-gray-600"})}),"Nu ai notificări noi"]}):t("div",{className:"divide-y divide-gray-200/50 dark:divide-slate-700/50",children:[D.filter(P=>P.recipient_id===(c==null?void 0:c.userId)&&!P.is_read).slice(0,5).map(P=>e("div",{className:"p-4 hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 dark:hover:from-blue-900/20 dark:hover:to-indigo-900/20 transition-all duration-200",children:t("div",{className:"text-sm text-gray-900 dark:text-white",children:[t("div",{className:"font-semibold text-blue-600 dark:text-blue-400 mb-1 flex items-center",children:[e(or,{size:14,className:"mr-2"}),"Mesaj nou"]}),e("div",{className:"text-gray-600 dark:text-gray-300 truncate mb-2",children:P.content}),e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(P.created_at).toLocaleString("ro-RO")})]})},`msg-${P.id}`)),S.filter(P=>!P.is_read).slice(0,5).map(P=>e("div",{className:"p-4 hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 dark:hover:from-blue-900/20 dark:hover:to-indigo-900/20 transition-all duration-200",children:t("div",{className:"text-sm text-gray-900 dark:text-white",children:[e("div",{className:"font-semibold text-indigo-600 dark:text-indigo-400 mb-1",children:P.title}),e("div",{className:"text-gray-600 dark:text-gray-300 mb-2",children:P.content}),e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(P.created_at).toLocaleString("ro-RO")})]})},`notif-${P.id}`))]})}),z>0&&e("div",{className:"p-4 border-t border-gray-200/50 dark:border-slate-700/50 bg-gradient-to-r from-blue-50/30 to-indigo-50/30 dark:from-blue-900/10 dark:to-indigo-900/10",children:e("a",{href:"/messages",className:"block w-full text-center text-sm font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",onClick:()=>o(!1),children:"Vezi toate mesajele →"})})]})]}),t("div",{className:"flex items-center space-x-3 md:space-x-4",children:[c!=null&&c.avatar?e("img",{src:c.avatar,alt:(c==null?void 0:c.fullName)||(c==null?void 0:c.username)||"Admin",className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-white/50 dark:border-slate-500/50 shadow-xl object-cover"}):e("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-semibold text-base md:text-lg border-2 border-white/50 dark:border-slate-500/50 shadow-xl",children:((c==null?void 0:c.fullName)||(c==null?void 0:c.username)||"A").charAt(0).toUpperCase()}),e("div",{className:"text-sm md:text-base hidden sm:block",children:e("div",{className:"font-semibold text-white",children:c?c.fullName||c.username:"Loading..."})})]}),e("button",{onClick:u,className:"p-2 bg-gradient-to-r from-red-500 to-red-600 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-lg hover:shadow-red-500/25 group",children:e(Ms,{size:16,className:"group-hover:scale-110 transition-transform"})})]})]})}),e("div",{className:`${s?"w-64 md:w-72":"w-0 md:w-20"} bg-white/70 dark:bg-slate-800/90 backdrop-blur-xl border-r border-white/30 dark:border-slate-700/50 transition-all duration-300 flex flex-col mt-14 md:mt-20 shadow-2xl shadow-slate-500/10 dark:shadow-slate-900/20 fixed md:relative z-20 h-full ${s?"translate-x-0":"-translate-x-full md:translate-x-0"}`,children:e("div",{className:"flex-1 sidebar-scroll p-2 md:p-3",style:{maxHeight:"calc(100vh - 5rem)"},children:e("nav",{className:"space-y-1",children:C.map(P=>{const Z=x.pathname===P.path;return t(Ls,{to:P.path,onDoubleClick:()=>r(!s),className:`w-full flex items-center ${s?"justify-between":"justify-center"} p-2 md:p-3 rounded-2xl text-left transition-all duration-200 group ${Z?"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-600 text-white shadow-xl shadow-blue-500/25 ring-2 ring-blue-200/50":"text-slate-700 dark:text-slate-300 hover:bg-white/60 dark:hover:bg-slate-700/60 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]"}`,title:s?"":P.label,children:[t("div",{className:`flex items-center ${s?"space-x-3":"justify-center"}`,children:[e(P.icon,{className:`text-lg md:text-xl transition-transform group-hover:scale-110 ${Z?"drop-shadow-lg":""}`}),s&&e("span",{className:`font-semibold text-sm md:text-base transition-colors ${Z?"text-white":"text-slate-700 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white"}`,children:P.label})]}),s&&P.count!==null&&e("span",{className:`text-xs px-3 md:px-4 py-1.5 md:py-2 rounded-full font-bold transition-all duration-200 ${Z?"bg-white/20 text-white backdrop-blur-sm border border-white/30":"bg-gradient-to-r from-blue-100 to-indigo-100 dark:from-slate-600 dark:to-slate-700 text-blue-700 dark:text-slate-300 group-hover:from-blue-200 group-hover:to-indigo-200 dark:group-hover:from-slate-500 dark:group-hover:to-slate-600"}`,children:P.count})]},P.id)})})})}),s&&e("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-10 md:hidden",onClick:()=>r(!1)}),e("div",{className:"flex-1 flex flex-col overflow-hidden mt-14 md:mt-20 bg-white dark:bg-slate-900 ",children:e("div",{className:"flex-1 overflow-auto p-6 md:p-8 bg-slate-50 dark:bg-slate-900",children:a})})]})},Tt=({title:a,value:s,icon:r,color:l,change:n,changeType:i,loading:o,size:c="medium",isEditing:u=!1,isVisible:p=!0,onToggleVisibility:m,onToggleSelection:d,onSizeChange:f,isSelected:T=!1,dragHandleProps:b={}})=>{const y={blue:"from-blue-500 to-indigo-500",green:"from-green-500 to-emerald-500",purple:"from-purple-500 to-violet-500",orange:"from-orange-500 to-amber-500",indigo:"from-indigo-500 to-blue-500",emerald:"from-emerald-500 to-green-500",slate:"from-slate-500 to-gray-500",cyan:"from-cyan-500 to-blue-500",yellow:"from-yellow-500 to-orange-500",red:"from-red-500 to-pink-500",gray:"from-gray-500 to-slate-500"},k={xs:{container:"p-3",icon:"w-6 h-6",title:"text-xs",value:"text-lg",change:"text-xs"},small:{container:"p-4",icon:"w-8 h-8",title:"text-sm",value:"text-xl",change:"text-xs"},medium:{container:"p-6",icon:"w-12 h-12",title:"text-base",value:"text-3xl",change:"text-sm"},large:{container:"p-8",icon:"w-16 h-16",title:"text-lg",value:"text-4xl",change:"text-base"},"extra-large":{container:"p-10",icon:"w-20 h-20",title:"text-xl",value:"text-5xl",change:"text-lg"}},A=k[c]||k.medium,O={blue:"shadow-blue-500/25",green:"shadow-green-500/25",purple:"shadow-purple-500/25",orange:"shadow-orange-500/25",indigo:"shadow-indigo-500/25",emerald:"shadow-emerald-500/25",slate:"shadow-slate-500/25",cyan:"shadow-cyan-500/25",yellow:"shadow-yellow-500/25",red:"shadow-red-500/25",gray:"shadow-gray-500/25"};return o?t("div",{className:`card ${A.container} animate-pulse`,children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-24"}),e("div",{className:`${A.icon} bg-slate-200 dark:bg-slate-700 rounded-2xl`})]}),t("div",{className:"space-y-2",children:[e("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded w-16"}),e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-20"})]})]}):t("div",{className:`card ${A.container} hover:shadow-2xl transition-all duration-300 hover:scale-105 group ${T?"ring-2 ring-blue-500":""}`,children:[u&&t("div",{className:"absolute top-2 right-2 flex space-x-1 z-10",children:[e("button",{onClick:m,className:"p-1 rounded bg-white/80 hover:bg-white text-slate-600 hover:text-slate-800 transition-colors",title:p?"Ascunde cardul":"Afișează cardul",children:p?e(Qe,{className:"w-4 h-4"}):e(Xa,{className:"w-4 h-4"})}),e("div",{...b,className:"p-1 rounded bg-white/80 hover:bg-white text-slate-600 hover:text-slate-800 transition-colors cursor-grab active:cursor-grabbing",title:"Trage pentru a reordona",children:e($s,{className:"w-4 h-4"})})]}),t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:`${A.title} font-bold text-slate-600 dark:text-slate-300 uppercase tracking-wider`,children:a}),e("div",{className:`p-3 rounded-2xl bg-gradient-to-r ${y[l]} shadow-lg ${O[l]}`,children:e(r,{className:`${A.icon} text-white`})})]}),t("div",{className:"space-y-2",children:[e("div",{className:`${A.value} font-bold text-slate-800 dark:text-slate-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors`,children:(s==null?void 0:s.toLocaleString())||0}),n&&t("div",{className:`flex items-center space-x-1 ${A.change} font-semibold ${i==="positive"?"text-green-600":"text-red-600"}`,children:[i==="positive"?e(lt,{className:"w-4 h-4"}):e(Bs,{className:"w-4 h-4"}),e("span",{children:n}),e("span",{className:"text-slate-500 dark:text-slate-400",children:"vs. luna trecută"})]})]}),u&&f&&e("div",{className:"mt-4 pt-3 border-t border-slate-200 dark:border-slate-700",children:t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Mărime:"}),t("select",{value:c,onChange:g=>f(g.target.value),className:"text-xs bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded px-2 py-1",children:[e("option",{value:"xs",children:"XS"}),e("option",{value:"small",children:"Small"}),e("option",{value:"medium",children:"Medium"}),e("option",{value:"large",children:"Large"}),e("option",{value:"extra-large",children:"XL"})]})]})})]})},Oi=({compact:a=!1})=>{const[s,r]=h.useState(null),[l,n]=h.useState(null),[i,o]=h.useState(!1),[c,u]=h.useState(!1),[p,m]=h.useState({type:"",text:""});h.useEffect(()=>{d()},[]);const d=async()=>{o(!0);try{const y=await(await fetch("/api/backup/status")).json();y.success&&r(y.data);const A=await(await fetch("/api/backup/stats")).json();A.success&&n(A.data)}catch(b){console.error("Error loading backup info:",b),m({type:"error",text:"Eroare la încărcarea informațiilor despre backup"})}finally{o(!1)}},f=async()=>{u(!0),m({type:"",text:""});try{const y=await(await fetch("/api/backup/create",{method:"POST",headers:{"Content-Type":"application/json"}})).json();y.success?(m({type:"success",text:"Backup creat cu succes!"}),d()):m({type:"error",text:y.message||"Eroare la crearea backup-ului"})}catch(b){console.error("Error creating backup:",b),m({type:"error",text:"Eroare la crearea backup-ului"})}finally{u(!1)}},T=async()=>{try{const y=await(await fetch("/api/backup/export")).blob(),k=window.URL.createObjectURL(y),A=document.createElement("a");A.href=k,A.download=`cashpot_backup_${new Date().toISOString().split("T")[0]}.sql`,document.body.appendChild(A),A.click(),window.URL.revokeObjectURL(k),document.body.removeChild(A),m({type:"success",text:"Backup descărcat cu succes!"})}catch(b){console.error("Error downloading backup:",b),m({type:"error",text:"Eroare la descărcarea backup-ului"})}};return i&&!s?e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-center py-8",children:[e(ht,{className:"w-6 h-6 text-blue-500 dark:text-blue-400 animate-spin"}),e("span",{className:"ml-2 text-slate-600 dark:text-slate-400",children:"Se încarcă informațiile..."})]})}):a?t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e(ot,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),t("div",{children:[e("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"Backup Bază de Date"}),t("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(l==null?void 0:l.totalRecords)||0," înregistrări • ",(l==null?void 0:l.databaseSize)||"N/A"]})]})]}),e("button",{onClick:d,className:"p-2 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",children:e(ht,{className:`w-5 h-5 ${i?"animate-spin":""}`})})]}),t("div",{className:"space-y-3 mb-6",children:[t("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[t("div",{className:"flex items-center space-x-2",children:[s!=null&&s.s3Enabled?e(cr,{className:"w-4 h-4 text-green-600 dark:text-green-400"}):e(Ma,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Stocare"})]}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:(s==null?void 0:s.storageLocation)||"Local"})]}),t("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[t("div",{className:"flex items-center space-x-2",children:[e(dt,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Auto Backup"})]}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s!=null&&s.autoBackupEnabled?`La ${s==null?void 0:s.backupIntervalHours}h`:"Dezactivat"})]})]}),p.text&&t("div",{className:`mb-4 p-3 rounded-lg flex items-center space-x-2 ${p.type==="success"?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:[p.type==="success"?e(kt,{className:"w-4 h-4"}):e(nt,{className:"w-4 h-4"}),e("span",{className:"text-sm",children:p.text})]}),t("div",{className:"grid grid-cols-2 gap-3",children:[e("button",{onClick:f,disabled:c,className:"flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:c?t(De,{children:[e(ht,{className:"w-4 h-4 animate-spin"}),e("span",{className:"text-sm",children:"Creare..."})]}):t(De,{children:[e(ze,{className:"w-4 h-4"}),e("span",{className:"text-sm",children:"Creează Backup"})]})}),t("button",{onClick:T,className:"flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e(Je,{className:"w-4 h-4"}),e("span",{className:"text-sm",children:"Descarcă"})]})]})]}):t("div",{className:"space-y-6",children:[t("div",{className:"card p-8",children:[t("div",{className:"flex items-center justify-between mb-8",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Backup Bază de Date"}),e("p",{className:"text-slate-600",children:"Gestionează backup-urile bazei de date și exportă datele"})]}),e("button",{onClick:d,className:"p-3 text-slate-400 hover:text-slate-600 transition-colors",children:e(ht,{className:`w-6 h-6 ${i?"animate-spin":""}`})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100",children:t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ot,{className:"w-8 h-8 text-blue-600"}),t("div",{children:[e("p",{className:"text-sm text-blue-600 font-medium",children:"Total Înregistrări"}),e("p",{className:"text-2xl font-bold text-blue-800",children:(l==null?void 0:l.totalRecords)||0})]})]})}),e("div",{className:"p-6 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100",children:t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Us,{className:"w-8 h-8 text-green-600"}),t("div",{children:[e("p",{className:"text-sm text-green-600 font-medium",children:"Dimensiune BD"}),e("p",{className:"text-2xl font-bold text-green-800",children:(l==null?void 0:l.databaseSize)||"N/A"})]})]})}),e("div",{className:"p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100",children:t("div",{className:"flex items-center space-x-3 mb-3",children:[s!=null&&s.s3Enabled?e(cr,{className:"w-8 h-8 text-purple-600"}):e(Ma,{className:"w-8 h-8 text-purple-600"}),t("div",{children:[e("p",{className:"text-sm text-purple-600 font-medium",children:"Stocare"}),e("p",{className:"text-lg font-bold text-purple-800",children:(s==null?void 0:s.storageLocation)||"Local"})]})]})})]}),t("div",{className:"p-6 bg-slate-50 rounded-xl mb-8",children:[e("h3",{className:"font-bold text-slate-800 mb-4",children:"Configurare Backup"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"Auto Backup:"}),e("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s!=null&&s.autoBackupEnabled?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s!=null&&s.autoBackupEnabled?"Activ":"Inactiv"})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"Interval Backup:"}),t("span",{className:"font-medium text-slate-800",children:[(s==null?void 0:s.backupIntervalHours)||6," ore"]})]}),(s==null?void 0:s.s3Enabled)&&t(De,{children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"S3 Bucket:"}),e("span",{className:"font-medium text-slate-800",children:s==null?void 0:s.bucketName})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-slate-600",children:"Regiune:"}),e("span",{className:"font-medium text-slate-800",children:s==null?void 0:s.region})]})]})]})]}),p.text&&t("div",{className:`mb-6 p-4 rounded-lg flex items-center space-x-3 ${p.type==="success"?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:[p.type==="success"?e(kt,{className:"w-5 h-5"}):e(nt,{className:"w-5 h-5"}),e("span",{children:p.text})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e("button",{onClick:f,disabled:c,className:"flex items-center justify-center space-x-2 px-6 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?t(De,{children:[e(ht,{className:"w-5 h-5 animate-spin"}),e("span",{children:"Se creează backup..."})]}):t(De,{children:[e(ze,{className:"w-5 h-5"}),e("span",{children:"Creează Backup Manual"})]})}),t("button",{onClick:T,className:"flex items-center justify-center space-x-2 px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e(Je,{className:"w-5 h-5"}),e("span",{children:"Descarcă Backup SQL"})]})]})]}),(l==null?void 0:l.tableStats)&&t("div",{className:"card p-8",children:[e("h3",{className:"text-xl font-bold text-slate-800 mb-6",children:"Statistici pe Tabele"}),e("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(l.tableStats).map(([b,y])=>t("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e("p",{className:"text-sm text-slate-600 capitalize",children:b.replace("_"," ")}),e("p",{className:"text-2xl font-bold text-slate-800",children:y})]},b))})]})]})},Fi=()=>{const[a,s]=h.useState([]),[r,l]=h.useState(!0);h.useEffect(()=>{n()},[]);const n=async()=>{try{const c=await re.get("/api/promotions/active");s(c.data)}catch(c){console.error("Error fetching active promotions:",c)}finally{l(!1)}},i=c=>{if(!c)return null;const u=new Date,m=new Date(c)-u;return Math.ceil(m/(1e3*60*60*24))},o=a.reduce((c,u)=>c+(parseFloat(u.prize_amount)||0),0);return r?e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/3"}),e("div",{className:"h-20 bg-slate-200 dark:bg-slate-700 rounded"})]})}):t("div",{className:"card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-800",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-xl shadow-lg",children:e(lt,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Promoții Active"}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[a.length," campanii în desfășurare"]})]})]}),t("div",{className:"text-right",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Fond Total"}),t("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[o.toLocaleString("ro-RO")," RON"]})]})]}),a.length===0?t("div",{className:"text-center py-8",children:[e(lt,{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e("p",{className:"text-slate-500 dark:text-slate-400",children:"Nu există promoții active"})]}):e("div",{className:"space-y-3",children:a.slice(0,5).map(c=>{const u=i(c.end_date),p=u<=7;return e("div",{className:`p-4 rounded-xl border transition-all hover:shadow-lg cursor-pointer ${p?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600"}`,children:t("div",{className:"flex items-start justify-between",children:[t("div",{className:"flex-1 space-y-2",children:[t("div",{className:"flex items-center space-x-2",children:[e("h4",{className:"font-semibold text-slate-900 dark:text-white",children:c.name}),p&&e(Bt,{className:"w-4 h-4 text-yellow-600"})]}),t("div",{className:"flex items-center space-x-4 text-sm",children:[t("div",{className:"flex items-center space-x-1 text-slate-600 dark:text-slate-400",children:[e(We,{className:"w-4 h-4"}),e("span",{children:c.location})]}),t("div",{className:"flex items-center space-x-1 text-slate-600 dark:text-slate-400",children:[e(Me,{className:"w-4 h-4"}),e("span",{children:new Date(c.end_date).toLocaleDateString("ro-RO")})]})]}),c.prize_amount&&t("div",{className:"flex items-center space-x-2",children:[e(Ut,{className:"w-4 h-4 text-green-500"}),t("span",{className:"font-bold text-green-600 dark:text-green-400",children:[parseFloat(c.prize_amount).toLocaleString("ro-RO")," ",c.prize_currency||"RON"]})]})]}),t("div",{className:"text-right",children:[e("div",{className:`text-2xl font-bold ${p?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:u}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:u===1?"zi rămasă":"zile rămase"})]})]})},c.id)})}),a.length>5&&t("button",{className:"mt-4 w-full py-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-semibold flex items-center justify-center space-x-1",children:[t("span",{children:["Vezi toate (",a.length,")"]}),e($r,{className:"w-4 h-4"})]})]})},ji=()=>{const[a,s]=h.useState([]),[r,l]=h.useState(new Date),[n,i]=h.useState(!0);h.useEffect(()=>{o()},[]);const o=async()=>{try{const T=await re.get("/api/promotions");s(T.data)}catch(T){console.error("Error fetching promotions:",T)}finally{i(!1)}},c=T=>{const b=T.getFullYear(),y=T.getMonth();return new Date(b,y+1,0).getDate()},u=T=>{const b=T.getFullYear(),y=T.getMonth();return new Date(b,y,1).getDay()},p=T=>a.filter(b=>{const y=new Date(b.start_date),k=new Date(b.end_date),A=new Date(T);return y.setHours(0,0,0,0),k.setHours(0,0,0,0),A.setHours(0,0,0,0),A>=y&&A<=k}),m=()=>{l(new Date(r.getFullYear(),r.getMonth()-1))},d=()=>{l(new Date(r.getFullYear(),r.getMonth()+1))},f=()=>{const T=c(r),b=u(r),y=[];r.toLocaleDateString("ro-RO",{month:"long",year:"numeric"});for(let k=0;k<b;k++)y.push(e("div",{className:"aspect-square"},`empty-${k}`));for(let k=1;k<=T;k++){const A=new Date(r.getFullYear(),r.getMonth(),k),O=p(A),g=A.toDateString()===new Date().toDateString(),$=O.length>0;y.push(t("div",{className:`aspect-square p-2 border border-slate-200 dark:border-slate-700 rounded-lg transition-all ${g?"bg-blue-100 dark:bg-blue-900/30 border-blue-400 dark:border-blue-600":$?"bg-pink-50 dark:bg-pink-900/20 border-pink-300 dark:border-pink-700 hover:bg-pink-100 dark:hover:bg-pink-900/30 cursor-pointer":"hover:bg-slate-50 dark:hover:bg-slate-750"}`,title:O.length>0?O.map(_=>_.name).join(", "):"",children:[e("div",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-1",children:k}),$&&t("div",{className:"space-y-1",children:[O.slice(0,2).map((_,E)=>e("div",{className:"text-[10px] bg-pink-500 text-white px-1 py-0.5 rounded truncate",title:_.name,children:_.name.substring(0,15)},E)),O.length>2&&t("div",{className:"text-[9px] text-pink-600 dark:text-pink-400 font-semibold",children:["+",O.length-2," mai multe"]})]})]},k))}return y};return n?e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/3"}),e("div",{className:"h-64 bg-slate-200 dark:bg-slate-700 rounded"})]})}):t("div",{className:"card p-6",children:[e("div",{className:"flex items-center justify-between mb-6",children:t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl shadow-lg",children:e(Me,{className:"w-5 h-5 text-white"})}),e("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Calendar Promoții"})]})}),t("div",{className:"flex items-center justify-between mb-4",children:[e("button",{onClick:m,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(Gs,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("h4",{className:"text-lg font-semibold text-slate-900 dark:text-white capitalize",children:r.toLocaleDateString("ro-RO",{month:"long",year:"numeric"})}),e("button",{onClick:d,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e($r,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})})]}),e("div",{className:"grid grid-cols-7 gap-1 mb-4",children:["Du","Lu","Ma","Mi","Jo","Vi","Sâ"].map(T=>e("div",{className:"text-center text-xs font-semibold text-slate-600 dark:text-slate-400 p-2",children:T},T))}),e("div",{className:"grid grid-cols-7 gap-1",children:f()}),t("div",{className:"mt-4 flex items-center justify-center space-x-4 text-xs",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-3 h-3 bg-blue-100 dark:bg-blue-900/30 border border-blue-400 dark:border-blue-600 rounded"}),e("span",{className:"text-slate-600 dark:text-slate-400",children:"Astăzi"})]}),t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-3 h-3 bg-pink-50 dark:bg-pink-900/20 border border-pink-300 dark:border-pink-700 rounded"}),e("span",{className:"text-slate-600 dark:text-slate-400",children:"Cu promoții"})]})]})]})},Mi=()=>{const[a,s]=h.useState([]),[r,l]=h.useState([]),[n,i]=h.useState(!0);h.useEffect(()=>{o()},[]);const o=async()=>{try{const p=(await re.get("/api/promotions/active")).data;s(p);const m=c(p);l(m)}catch(u){console.error("Error fetching promotions:",u)}finally{i(!1)}},c=u=>{const p=[],m=new Map;u.forEach(b=>{const y=new Date(b.start_date),k=new Date(b.end_date);for(let A=new Date(y);A<=k;A.setDate(A.getDate()+1)){const O=A.toISOString().split("T")[0];m.has(O)||m.set(O,[]),m.get(O).push(b)}}),m.forEach((b,y)=>{if(b.length>=2){const k={};b.forEach(A=>{k[A.location]||(k[A.location]=[]),k[A.location].push(A)}),Object.entries(k).forEach(([A,O])=>{O.length>=2&&p.push({type:"critical",icon:Bt,title:"🔴 CONFLICT CRITIC",message:`${O.length} promoții în aceeași zi (${new Date(y).toLocaleDateString("ro-RO")}) la ${A}`,details:O.map(g=>g.name).join(", "),severity:"high"})})}});const d=Array.from(m.keys()).sort();for(let b=0;b<d.length-1;b++){const y=new Date(d[b]),k=new Date(d[b+1]);Math.ceil((k-y)/(1e3*60*60*24))===1&&(m.get(d[b]),m.get(d[b+1]),p.push({type:"warning",icon:Bt,title:"🟡 ZILE CONSECUTIVE",message:`Promoții la 1 zi distanță (${y.toLocaleDateString("ro-RO")} - ${k.toLocaleDateString("ro-RO")})`,details:"Poate obosi audiența",severity:"medium"}))}const f=u.reduce((b,y)=>b+(parseFloat(y.prize_amount)||0),0),T=f/u.length;if(u.length>0){const b={};u.forEach(k=>{b[k.location]=(b[k.location]||0)+1});const y=Object.entries(b).sort((k,A)=>A[1]-k[1])[0];y&&y[1]>=3&&p.push({type:"info",icon:lt,title:"📊 ANALIZĂ DISTRIBUȚIE",message:`${y[0]} are cele mai multe promoții (${y[1]})`,details:"Consideră diversificarea pe alte locații",severity:"low"})}if(u.length>0&&f>0&&p.push({type:"success",icon:kt,title:"💰 ANALIZĂ BUGETE",message:`Fond total: ${f.toLocaleString("ro-RO")} RON`,details:`Premiu mediu: ${T.toLocaleString("ro-RO")} RON`,severity:"low"}),u.length>=2){const b=u.flatMap(k=>{const A=new Date(k.start_date),O=new Date(k.end_date);return[A,O]}).sort((k,A)=>k-A),y=Math.max(...b.slice(1).map((k,A)=>Math.ceil((k-b[A])/(1e3*60*60*24))));y>14&&p.push({type:"info",icon:Me,title:"📅 GAP TEMPORAL",message:`Interval de ${y} zile între promoții`,details:"Consideră adăugarea unei promoții intermediare",severity:"low"})}return p.sort((b,y)=>{const k={high:0,medium:1,low:2};return k[b.severity]-k[y.severity]})};return n?e("div",{className:"card p-6",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-1/2"}),e("div",{className:"h-32 bg-slate-200 dark:bg-slate-700 rounded"})]})}):t("div",{className:"card p-6 bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 border border-purple-200 dark:border-purple-800",children:[t("div",{className:"flex items-center space-x-3 mb-6",children:[e("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-indigo-500 rounded-xl shadow-lg",children:e(Ka,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Analiză AI Marketing"}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[r.length," insight-uri detectate"]})]})]}),r.length===0?t("div",{className:"text-center py-8",children:[e(kt,{className:"w-16 h-16 text-green-500 mx-auto mb-3"}),e("p",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"✅ Totul arată perfect!"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-500 mt-2",children:"Nu sunt detectate conflicte sau probleme"})]}):e("div",{className:"space-y-3",children:r.map((u,p)=>{const m=u.icon;return e("div",{className:`p-4 rounded-xl border ${{critical:"bg-red-50 dark:bg-red-900/20 border-red-300 dark:border-red-700 text-red-700 dark:text-red-400",warning:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700 text-yellow-700 dark:text-yellow-400",info:"bg-blue-50 dark:bg-blue-900/20 border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400",success:"bg-green-50 dark:bg-green-900/20 border-green-300 dark:border-green-700 text-green-700 dark:text-green-400"}[u.type]} transition-all hover:shadow-lg`,children:t("div",{className:"flex items-start space-x-3",children:[e(m,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),t("div",{className:"flex-1",children:[e("h4",{className:"font-semibold text-sm mb-1",children:u.title}),e("p",{className:"text-sm opacity-90 mb-1",children:u.message}),u.details&&e("p",{className:"text-xs opacity-75 italic",children:u.details})]})]})},p)})}),t("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[t("div",{className:"bg-white dark:bg-slate-700 p-4 rounded-xl border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(sa,{className:"w-4 h-4 text-purple-500"}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Promoții Active"})]}),e("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:a.length})]}),t("div",{className:"bg-white dark:bg-slate-700 p-4 rounded-xl border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(Bt,{className:"w-4 h-4 text-red-500"}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Alerte Critice"})]}),e("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:r.filter(u=>u.severity==="high").length})]})]})]})};function $i(a){const s=Object.prototype.toString.call(a);return s==="[object Window]"||s==="[object global]"}function Bi(a){return"nodeType"in a}function Ui(a){var s,r;return a?$i(a)?a:Bi(a)&&(s=(r=a.ownerDocument)==null?void 0:r.defaultView)!=null?s:window:window}var Lr;(function(a){a.DragStart="dragStart",a.DragMove="dragMove",a.DragEnd="dragEnd",a.DragCancel="dragCancel",a.DragOver="dragOver",a.RegisterDroppable="registerDroppable",a.SetDroppableDisabled="setDroppableDisabled",a.UnregisterDroppable="unregisterDroppable"})(Lr||(Lr={}));const Gi=Object.freeze({x:0,y:0});function Vi(a){if(a.startsWith("matrix3d(")){const s=a.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(a.startsWith("matrix(")){const s=a.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function qi(a,s,r){const l=Vi(s);if(!l)return a;const{scaleX:n,scaleY:i,x:o,y:c}=l,u=a.left-o-(1-n)*parseFloat(r),p=a.top-c-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),m=n?a.width/n:a.width,d=i?a.height/i:a.height;return{width:m,height:d,top:p,right:u+m,bottom:p+d,left:u}}const Ji={ignoreTransform:!1};function Es(a,s){s===void 0&&(s=Ji);let r=a.getBoundingClientRect();if(s.ignoreTransform){const{transform:p,transformOrigin:m}=Ui(a).getComputedStyle(a);p&&(r=qi(r,p,m))}const{top:l,left:n,width:i,height:o,bottom:c,right:u}=r;return{top:l,left:n,width:i,height:o,bottom:c,right:u}}function Ir(a){return Es(a,{ignoreTransform:!0})}var Wt;(function(a){a[a.Forward=1]="Forward",a[a.Backward=-1]="Backward"})(Wt||(Wt={}));var Rr;(function(a){a.Click="click",a.DragStart="dragstart",a.Keydown="keydown",a.ContextMenu="contextmenu",a.Resize="resize",a.SelectionChange="selectionchange",a.VisibilityChange="visibilitychange"})(Rr||(Rr={}));var ut;(function(a){a.Space="Space",a.Down="ArrowDown",a.Right="ArrowRight",a.Left="ArrowLeft",a.Up="ArrowUp",a.Esc="Escape",a.Enter="Enter",a.Tab="Tab"})(ut||(ut={}));ut.Space,ut.Enter,ut.Esc,ut.Space,ut.Enter,ut.Tab;var Or;(function(a){a[a.RightClick=2]="RightClick"})(Or||(Or={}));var Fr;(function(a){a[a.Pointer=0]="Pointer",a[a.DraggableRect=1]="DraggableRect"})(Fr||(Fr={}));var jr;(function(a){a[a.TreeOrder=0]="TreeOrder",a[a.ReversedTreeOrder=1]="ReversedTreeOrder"})(jr||(jr={}));Wt.Backward+"",Wt.Forward+"",Wt.Backward+"",Wt.Forward+"";var Ha;(function(a){a[a.Always=0]="Always",a[a.BeforeDragging=1]="BeforeDragging",a[a.WhileDragging=2]="WhileDragging"})(Ha||(Ha={}));var Ya;(function(a){a.Optimized="optimized"})(Ya||(Ya={}));Ha.WhileDragging,Ya.Optimized;({...Gi});var Mr;(function(a){a[a.Uninitialized=0]="Uninitialized",a[a.Initializing=1]="Initializing",a[a.Initialized=2]="Initialized"})(Mr||(Mr={}));ut.Down,ut.Right,ut.Up,ut.Left;const qe=({data:a,columns:s,onEdit:r,onDelete:l,onView:n,onViewContracts:i,onViewProprietari:o,onRowClick:c,loading:u=!1,searchTerm:p="",onSearchChange:m,selectedItems:d=[],onSelectAll:f,onSelectItem:T,moduleColor:b="blue"})=>{const[y,k]=h.useState(1),[A,O]=h.useState(""),[g,$]=h.useState("asc"),[_,E]=h.useState(50),G={blue:{header:"from-blue-50/80 to-blue-100/80 dark:from-blue-900/20 dark:to-blue-800/20",text:"text-blue-800 dark:text-blue-200",hover:"hover:bg-blue-100/60 dark:hover:bg-blue-700/30",accent:"text-blue-600"},green:{header:"from-emerald-50/80 to-emerald-100/80 dark:from-emerald-900/20 dark:to-emerald-800/20",text:"text-emerald-800 dark:text-emerald-200",hover:"hover:bg-emerald-100/60 dark:hover:bg-emerald-700/30",accent:"text-emerald-600"},purple:{header:"from-purple-50/80 to-purple-100/80 dark:from-purple-900/20 dark:to-purple-800/20",text:"text-purple-800 dark:text-purple-200",hover:"hover:bg-purple-100/60 dark:hover:bg-purple-700/30",accent:"text-purple-600"},orange:{header:"from-orange-50/80 to-orange-100/80 dark:from-orange-900/20 dark:to-orange-800/20",text:"text-orange-800 dark:text-orange-200",hover:"hover:bg-orange-100/60 dark:hover:bg-orange-700/30",accent:"text-orange-600"},red:{header:"from-red-50/80 to-red-100/80 dark:from-red-900/20 dark:to-red-800/20",text:"text-red-800 dark:text-red-200",hover:"hover:bg-red-100/60 dark:hover:bg-red-700/30",accent:"text-red-600"},indigo:{header:"from-indigo-50/80 to-indigo-100/80 dark:from-indigo-900/20 dark:to-indigo-800/20",text:"text-indigo-800 dark:text-indigo-200",hover:"hover:bg-indigo-100/60 dark:hover:bg-indigo-700/30",accent:"text-indigo-600"},teal:{header:"from-teal-50/80 to-teal-100/80 dark:from-teal-900/20 dark:to-teal-800/20",text:"text-teal-800 dark:text-teal-200",hover:"hover:bg-teal-100/60 dark:hover:bg-teal-700/30",accent:"text-teal-600"},pink:{header:"from-pink-50/80 to-pink-100/80 dark:from-pink-900/20 dark:to-pink-800/20",text:"text-pink-800 dark:text-pink-200",hover:"hover:bg-pink-100/60 dark:hover:bg-pink-700/30",accent:"text-pink-600"}},j=G[b]||G.blue,N=Math.ceil(a.length/_),D=(y-1)*_,S=a.slice(D,D+_),F=x=>{A===x?$(g==="asc"?"desc":"asc"):(O(x),$("asc"))},I=[...S].sort((x,v)=>{if(!A)return 0;const L=x[A]||"",K=v[A]||"";return g==="asc"?L.toString().localeCompare(K.toString()):K.toString().localeCompare(L.toString())});return u?e("div",{className:"card p-8",children:t("div",{className:"animate-pulse space-y-4",children:[e("div",{className:"h-4 bg-slate-200 rounded w-1/4"}),e("div",{className:"space-y-3",children:[...Array(5)].map((x,v)=>e("div",{className:"h-16 bg-slate-200 rounded"},v))})]})}):t("div",{className:"card overflow-hidden",children:[e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full min-w-[800px] bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700",children:[e("thead",{className:`table-header bg-gradient-to-r ${j.header}`,children:t("tr",{children:[e("th",{className:"p-6 w-12",children:e("div",{className:"flex items-center justify-center",children:e("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-slate-100 dark:bg-slate-700 border-slate-300 dark:border-slate-600 rounded focus:ring-blue-500 focus:ring-2",checked:S.length>0&&S.every(x=>d.includes(x.id)),onChange:x=>f&&f(x.target.checked)})})}),e("th",{className:`text-left p-6 font-bold ${j.text} text-base uppercase tracking-wider w-16`,children:"#"}),s.map(x=>e("th",{className:`text-left p-6 font-bold ${j.text} text-base uppercase tracking-wider ${x.sortable?`cursor-pointer ${j.hover} transition-colors`:""}`,onClick:()=>x.sortable&&F(x.key),children:t("div",{className:"flex items-center space-x-2",children:[e("span",{children:x.label}),x.sortable&&A===x.key&&e("span",{className:j.accent,children:g==="asc"?"↑":"↓"})]})},x.key)),e("th",{className:`text-left p-6 font-bold ${j.text} text-base uppercase tracking-wider`,children:"Acțiuni"})]})}),e("tbody",{className:"divide-y divide-slate-200/50 dark:divide-slate-700/50",children:I.map((x,v)=>t("tr",{className:`table-row hover:bg-slate-50 dark:hover:bg-slate-750 transition-colors ${c?"cursor-pointer":""}`,onClick:()=>c&&c(x),children:[e("td",{className:"p-6",onClick:L=>L.stopPropagation(),children:e("div",{className:"flex items-center justify-center",children:e("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-slate-100 dark:bg-slate-700 border-slate-300 dark:border-slate-600 rounded focus:ring-blue-500 focus:ring-2 group-hover:bg-blue-50 dark:group-hover:bg-slate-600",checked:d.includes(x.id),onChange:L=>T&&T(x.id,L.target.checked)})})}),e("td",{className:"p-6 text-slate-600 dark:text-slate-400 font-semibold text-base",children:D+v+1}),s.map(L=>e("td",{className:"p-6 text-base font-medium text-slate-700 dark:text-slate-300",children:L.render?L.render(x):x[L.key]},L.key)),(r||l||n||i||o)&&e("td",{className:"p-6",onClick:L=>L.stopPropagation(),children:t("div",{className:"flex flex-col space-y-2",children:[t("div",{className:"flex space-x-2",children:[n&&e("button",{onClick:()=>n(x),className:"p-2 text-blue-600 dark:text-blue-400 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 hover:from-blue-100 hover:to-indigo-100 dark:hover:from-blue-800/40 dark:hover:to-indigo-800/40 rounded-xl shadow-lg hover:shadow-blue-500/25 transition-all duration-200 group/btn",title:"Previzualizează",children:e(Qe,{size:14,className:"group-hover/btn:scale-110 transition-transform"})}),i&&e("button",{onClick:()=>i(x),className:"p-2 text-green-600 dark:text-green-400 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 hover:from-green-100 hover:to-emerald-100 dark:hover:from-green-800/40 dark:hover:to-emerald-800/40 rounded-xl shadow-lg hover:shadow-green-500/25 transition-all duration-200 group/btn",title:"Vezi contracte",children:e(ge,{size:14,className:"group-hover/btn:scale-110 transition-transform"})}),o&&e("button",{onClick:()=>o(x),className:"p-2 text-purple-600 dark:text-purple-400 bg-gradient-to-r from-purple-50 to-violet-50 dark:from-purple-900/30 dark:to-violet-900/30 hover:from-purple-100 hover:to-violet-100 dark:hover:from-purple-800/40 dark:hover:to-violet-800/40 rounded-xl shadow-lg hover:shadow-purple-500/25 transition-all duration-200 group/btn",title:"Vezi proprietari",children:e(_e,{size:14,className:"group-hover/btn:scale-110 transition-transform"})})]}),t("div",{className:"flex space-x-2",children:[r&&e("button",{onClick:()=>r(x),className:"p-2 text-emerald-600 dark:text-emerald-400 bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/30 dark:to-green-900/30 hover:from-emerald-100 hover:to-green-100 dark:hover:from-emerald-800/40 dark:hover:to-green-800/40 rounded-xl shadow-lg hover:shadow-emerald-500/25 transition-all duration-200 group/btn",title:"Editează",children:e(tt,{size:14,className:"group-hover/btn:scale-110 transition-transform"})}),l&&e("button",{onClick:()=>l(x),className:"p-2 text-red-600 dark:text-red-400 bg-gradient-to-r from-red-50 to-pink-50 dark:from-red-900/30 dark:to-pink-900/30 hover:from-red-100 hover:to-pink-100 dark:hover:from-red-800/40 dark:hover:to-pink-800/40 rounded-xl shadow-lg hover:shadow-red-500/25 transition-all duration-200 group/btn",title:"Șterge",children:e(Fe,{size:14,className:"group-hover/btn:scale-110 transition-transform"})})]})]})})]},x._id||x.id))})]})}),t("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-700 dark:via-slate-800 dark:to-slate-700 px-6 md:px-8 py-4 md:py-6 border-t border-slate-200/50 dark:border-slate-600/50 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[t("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e("span",{className:"text-sm md:text-base font-semibold text-slate-700 dark:text-slate-200",children:"Înregistrări:"}),t("select",{value:_,onChange:x=>{E(Number(x.target.value)),k(1)},className:"border-2 border-slate-200 dark:border-slate-600 rounded-2xl px-4 py-2 text-sm font-medium bg-white/80 dark:bg-slate-700/80 backdrop-blur-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 transition-all duration-200 shadow-lg text-slate-900 dark:text-slate-100",children:[e("option",{value:15,children:"15"}),e("option",{value:25,children:"25"}),e("option",{value:50,children:"50"}),e("option",{value:100,children:"100"}),e("option",{value:200,children:"200"})]}),t("span",{className:"text-sm md:text-base text-slate-600 dark:text-slate-300 font-medium",children:[D+1,"-",Math.min(D+_,a.length)," din ",a.length]})]}),t("div",{className:"flex items-center justify-between sm:justify-start gap-3",children:[e("button",{onClick:()=>k(Math.max(1,y-1)),disabled:y===1,className:"px-4 md:px-6 py-2 md:py-3 border-2 border-slate-200 dark:border-slate-600 rounded-2xl text-sm md:text-base font-bold hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl group text-slate-700 dark:text-slate-200",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Înapoi"})}),e("div",{className:"flex items-center space-x-2",children:t("span",{className:"text-sm md:text-base text-slate-600 dark:text-slate-200 font-bold bg-white/80 dark:bg-slate-800/80 px-4 py-2 rounded-2xl shadow-lg",children:["Pag ",y,"/",N||1]})}),e("button",{onClick:()=>k(Math.min(N,y+1)),disabled:y===N,className:"px-4 md:px-6 py-2 md:py-3 border-2 border-slate-200 dark:border-slate-600 rounded-2xl text-sm md:text-base font-bold hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl group text-slate-700 dark:text-slate-200",children:e("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:"Înainte"})})]})]})]})},Ct=({pdfUrl:a,title:s="Document PDF",placeholder:r="Nu există document de afișat",placeholderSubtext:l="Atașează un document PDF pentru vizualizare"})=>a?t("div",{className:"space-y-4",children:[e("div",{className:"aspect-[3/4] bg-white dark:bg-slate-800 rounded-lg border-2 border-slate-200 dark:border-slate-600 overflow-hidden",children:e("iframe",{src:a,className:"w-full h-full",title:s})}),t("div",{className:"flex space-x-3",children:[t("button",{onClick:()=>window.open(a,"_blank"),className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:[e(Qe,{className:"w-4 h-4"}),e("span",{children:"Vizualizează"})]}),t("button",{onClick:()=>window.open(a,"_blank"),className:"flex-1 btn-secondary flex items-center justify-center space-x-2",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Descarcă"})]})]})]}):e("div",{className:"aspect-[3/4] bg-slate-100 dark:bg-slate-700 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 flex items-center justify-center",children:t("div",{className:"text-center text-slate-500 dark:text-slate-400",children:[e(ge,{className:"w-16 h-16 mx-auto mb-2 opacity-50"}),e("p",{className:"text-sm font-medium",children:r}),e("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1",children:l})]})}),Wi=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",type:"Furnizor",license:"",email:"",phone:"",address:"",contactPerson:"",status:"Activ",notes:"",cui:"",cuiFile:null,cuiPreview:null});h.useEffect(()=>{a&&n({name:a.name||"",type:a.type||"Furnizor",license:a.license||"",email:a.email||"",phone:a.phone||"",address:a.address||"",contactPerson:a.contact_person||"",status:a.status||"Activ",notes:a.notes||"",cui:a.cui||"",cuiFile:a.cuiFile||null,cuiPreview:a.cuiFile||null})},[a]);const i=m=>{n({...l,[m.target.name]:m.target.value})},o=m=>{const d=m.target.files[0];if(d){const f=new FileReader;f.onload=T=>{const b=T.target.result;n(y=>({...y,cuiFile:b,cuiPreview:b}))},f.readAsDataURL(d)}},c=()=>{window.confirm("Sigur doriți să ștergeți documentul CUI?")&&n(m=>({...m,cuiFile:null,cuiPreview:null}))},u=m=>m?m.includes("data:image")?e(_t,{className:"w-4 h-4"}):e(ge,{className:"w-4 h-4"}):e(ge,{className:"w-4 h-4"});return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-purple-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Companie":"Adaugă Companie"}),e("p",{className:"text-blue-100 text-sm font-medium",children:"Completează informațiile despre companie"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault();const d={...l,contact_person:l.contactPerson};delete d.contactPerson,r(d)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Tip Companie *"}),t("select",{name:"type",value:l.type,onChange:i,className:"input-field",required:!0,children:[e("option",{value:"Operator",children:"Operator (Proprietar)"}),e("option",{value:"Furnizor",children:"Furnizor (pentru contracte)"})]}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Operator = compania ta de bază | Furnizor = companii externe pentru contracte"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Nume Companie *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"input-field",placeholder:"ex: BRML Industries SRL",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Număr Licență *"}),e("input",{type:"text",name:"license",value:l.license,onChange:i,className:"input-field",placeholder:"ex: L-2024-001",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Persoană de Contact *"}),e("input",{type:"text",name:"contactPerson",value:l.contactPerson,onChange:i,className:"input-field",placeholder:"ex: Ion Popescu",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Email *"}),e("input",{type:"email",name:"email",value:l.email,onChange:i,className:"input-field",placeholder:"ex: contact@brml.ro",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Telefon *"}),e("input",{type:"tel",name:"phone",value:l.phone,onChange:i,className:"input-field",placeholder:"ex: +40 21 123 4567",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"CUI (Certificat Unic de Înregistrare)"}),e("input",{type:"text",name:"cui",value:l.cui,onChange:i,className:"input-field",placeholder:"ex: RO12345678"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Status"}),t("select",{name:"status",value:l.status,onChange:i,className:"input-field",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Suspendat",children:"Suspendat"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Adresă Completă *"}),e("textarea",{name:"address",value:l.address,onChange:i,className:"input-field min-h-[100px] resize-none",placeholder:"ex: Str. Centrală nr. 1, București, România",required:!0})]}),t("div",{className:"space-y-4",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Document CUI (PDF sau JPG)"}),t("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl p-6 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors",children:[e("input",{type:"file",id:"cuiFile",accept:".pdf,.jpg,.jpeg,.png",onChange:o,className:"hidden"}),t("label",{htmlFor:"cuiFile",className:"cursor-pointer flex flex-col items-center space-y-3",children:[e("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white",children:e(ze,{className:"w-6 h-6"})}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:l.cuiFile?"Schimbă documentul":"Încarcă document CUI"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF, JPG, PNG (max 10MB)"})]})]})]}),l.cuiPreview&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-4 border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-2",children:[u(l.cuiFile),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Document CUI"})]}),e("button",{type:"button",onClick:c,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge documentul",children:e(ve,{className:"w-4 h-4"})})]}),l.cuiFile.includes("data:image")?e("div",{className:"aspect-[3/4] bg-white rounded-lg border-2 border-slate-200 overflow-hidden",children:e("img",{src:l.cuiPreview,alt:"CUI Preview",className:"w-full h-full object-contain"})}):e(Ct,{pdfUrl:l.cuiPreview,title:`CUI Document ${l.name}`,placeholder:"Documentul CUI nu este disponibil",placeholderSubtext:"Atașează documentul CUI pentru vizualizare"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200",children:"Note Adiționale"}),e("textarea",{name:"notes",value:l.notes,onChange:i,className:"input-field min-h-[80px] resize-none",placeholder:"Informații suplimentare despre companie..."})]}),t("div",{className:"flex justify-end space-x-4 pt-8 border-t-2 border-slate-200/50 dark:border-slate-700/50 mt-8",children:[e("button",{type:"button",onClick:s,className:"btn-secondary group",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Anulează"})}),e("button",{type:"submit",className:"btn-primary group",children:t("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:[a?"Actualizează":"Adaugă"," Companie"]})})]})]})})]})})},Hi=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-blue-100",children:"Detalii Companie"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Tip Companie"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.type||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Ut,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"CUI"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white font-mono",children:a.cui||"N/A"})]}),a.phone&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(na,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Telefon"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.phone})]}),a.email&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Qt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Email"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white break-all",children:a.email})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-6 rounded-xl border border-purple-200 dark:border-purple-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.documents&&Array.isArray(a.documents)&&a.documents.length>0&&t("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-6 rounded-xl border border-amber-200 dark:border-amber-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Documente Atașate"}),e("div",{className:"space-y-2",children:a.documents.map((n,i)=>t("div",{className:"flex items-center justify-between bg-white dark:bg-slate-700 p-3 rounded-lg",children:[t("div",{className:"flex items-center space-x-3",children:[e(ge,{className:"w-5 h-5 text-amber-600"}),e("span",{className:"text-slate-900 dark:text-white",children:n.name||`Document ${i+1}`})]}),e("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Vizualizează"})]},i))})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},Yi=({isOpen:a,onClose:s,onConfirm:r,title:l="Confirmare",message:n,confirmText:i="Confirmă",cancelText:o="Anulează",type:c="danger"})=>{if(!a)return null;const p=(()=>{switch(c){case"danger":return{icon:"text-red-500",button:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"};case"warning":return{icon:"text-yellow-500",button:"bg-yellow-600 hover:bg-yellow-700 text-white",iconBg:"bg-yellow-100"};case"info":return{icon:"text-blue-500",button:"bg-blue-600 hover:bg-blue-700 text-white",iconBg:"bg-blue-100"};default:return{icon:"text-red-500",button:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"}}})();return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[t("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:`p-2 rounded-full ${p.iconBg}`,children:e(Bt,{className:`w-6 h-6 ${p.icon}`})}),e("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:l})]}),e("button",{onClick:s,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(ve,{className:"w-5 h-5 text-slate-500"})})]}),e("div",{className:"p-6",children:e("p",{className:"text-slate-600 dark:text-slate-300 text-base leading-relaxed",children:n})}),t("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-slate-200 dark:border-slate-700",children:[e("button",{onClick:s,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors font-medium",children:o}),e("button",{onClick:()=>{r(),s()},className:`px-6 py-2 rounded-lg font-medium transition-colors ${p.button}`,children:i})]})]})})},ft=({onExportExcel:a,onExportPDF:s,entity:r})=>t("div",{className:"flex items-center space-x-2",children:[t("button",{onClick:a,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors shadow-md hover:shadow-lg",title:"Exportă în Excel",children:[e(Vs,{className:"w-4 h-4"}),e("span",{children:"Excel"})]}),t("button",{onClick:s,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors shadow-md hover:shadow-lg",title:"Exportă în PDF",children:[e(ge,{className:"w-4 h-4"}),e("span",{children:"PDF"})]})]}),Xi=()=>{const[a,s]=h.useState({isOpen:!1,title:"",message:"",confirmText:"Confirmă",cancelText:"Anulează",type:"danger",onConfirm:null});return{confirmState:a,confirm:n=>new Promise(i=>{s({isOpen:!0,title:n.title||"Confirmare",message:n.message||"Ești sigur?",confirmText:n.confirmText||"Confirmă",cancelText:n.cancelText||"Anulează",type:n.type||"danger",onConfirm:()=>{i(!0)}})}),close:()=>{s(n=>({...n,isOpen:!1,onConfirm:null}))}}},Ki=()=>{const a=He(),{companies:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:i,exportToPDF:o,loading:c}=ye(),{confirmState:u,confirm:p,close:m}=Xi(),[d,f]=h.useState(!1),[T,b]=h.useState(null),[y,k]=h.useState(""),[A,O]=h.useState([]),[g,$]=h.useState(!1),[_,E]=h.useState(null),[G,j]=h.useState(!1);h.useEffect(()=>{$(A.length>0)},[A]);const N=s.filter(P=>{var Z,se,oe,de;return((Z=P.name)==null?void 0:Z.toLowerCase().includes(y.toLowerCase()))||((se=P.license)==null?void 0:se.toLowerCase().includes(y.toLowerCase()))||((oe=P.email)==null?void 0:oe.toLowerCase().includes(y.toLowerCase()))||((de=P.contact_person)==null?void 0:de.toLowerCase().includes(y.toLowerCase()))}),D=[{key:"companyInfo",label:"Companie & CUI",sortable:!0,render:P=>{var Z,se,oe,de;return t("div",{className:"space-y-2",children:[t("div",{className:"flex items-center space-x-3",children:[(Z=P.logo)!=null&&Z.file||(se=P.logo)!=null&&se.url?e("img",{src:P.logo.file||P.logo.url,alt:`${P.name} logo`,className:"w-8 h-8 object-contain rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 p-1 flex-shrink-0",onError:Se=>{Se.target.style.display="none",Se.target.nextSibling.style.display="block"}}):null,e(_e,{className:`w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 ${(oe=P.logo)!=null&&oe.file||(de=P.logo)!=null&&de.url?"hidden":""}`}),e("button",{onClick:()=>a(`/companies/${P.id}`),className:"font-bold text-slate-900 dark:text-slate-100 hover:text-blue-700 dark:hover:text-blue-400 transition-colors text-left",children:P.name})]}),P.license&&e("div",{className:"flex items-center space-x-2",children:e("span",{className:"text-blue-800 dark:text-blue-300 text-xs font-bold",children:P.license})}),P.cui&&t("div",{className:"flex items-center space-x-2",children:[t("span",{className:"text-blue-800 dark:text-blue-300 text-xs font-bold",children:["CUI: ",P.cui]}),P.cuiFile&&t("div",{className:"flex items-center space-x-1",children:[e("button",{onClick:()=>window.open(P.cuiFile,"_blank"),className:"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Previzualizează CUI",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const Se=document.createElement("a");Se.href=P.cuiFile,Se.download=`CUI_${P.name||"company"}.${P.cuiFile.includes("data:image")?"jpg":"pdf"}`,Se.click()},className:"p-1 text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/30 rounded transition-colors",title:"Descarcă CUI",children:e(Je,{className:"w-4 h-4"})})]})]})]})}},{key:"contactInfo",label:"Contact",sortable:!0,render:P=>t("div",{className:"space-y-2",children:[P.contact_person&&t("div",{className:"flex items-center space-x-2",children:[e(yt,{className:"w-4 h-4 text-slate-500 dark:text-slate-400 flex-shrink-0"}),e("div",{className:"text-slate-700 dark:text-slate-300 font-medium text-sm",children:P.contact_person})]}),P.phone&&t("div",{className:"flex items-center space-x-2",children:[e(na,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0"}),e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:P.phone})]}),P.email&&t("div",{className:"flex items-center space-x-2",children:[e(Qt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 flex-shrink-0"}),e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:P.email})]})]})},{key:"status",label:"Status",sortable:!0,render:P=>{var de;const Z=((de=P.status)==null?void 0:de.toLowerCase())||"",se=Z==="activ"||Z==="active",oe=Z==="suspendat"||Z==="suspended";return e("span",{className:`px-4 py-2 rounded-2xl text-xs font-bold shadow-lg ${se?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-green-500/25":oe?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-yellow-500/25":"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-red-500/25"}`,children:se?"Activ":oe?"Suspendat":"Inactiv"})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:P=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:P.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:P.created_at?new Date(P.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],S=()=>{b(null),f(!0)},F=P=>{b(P),f(!0)},I=async P=>{await p({title:"Șterge Companie",message:`Sigur doriți să ștergeți compania "${P.name}"?`,type:"danger"})&&await n("companies",P.id)},x=P=>{O(P?N.map(Z=>Z.id):[])},v=(P,Z)=>{O(Z?[...A,P]:A.filter(se=>se!==P))},L=async()=>{if(A.length===0)return;if(await p({title:"Șterge Companiile",message:`Ești sigur că vrei să ștergi ${A.length} companii?`,type:"danger"}))try{for(const Z of A)await n("companies",Z);O([]),$(!1)}catch(Z){console.error("Error bulk deleting companies:",Z)}},K=()=>{A.length!==0&&console.log("Bulk edit for companies:",A)},R=async P=>{T?await l("companies",T.id,P):await r("companies",P),f(!1),b(null)},C=()=>{try{i("companies")}catch(P){console.error("Error exporting to Excel:",P)}},z=()=>{try{o("companies")}catch(P){console.error("Error exporting to PDF:",P)}},J=()=>{console.log("Import functionality to be implemented")};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Management Companii"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionează companiile de gaming din sistem"})]})]}),t("div",{className:"flex flex-wrap items-center gap-3",children:[t("div",{className:"relative flex-1 min-w-[200px] group",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-400 transition-colors",size:18}),e("input",{type:"text",placeholder:"Caută companii...",value:y,onChange:P=>k(P.target.value),onKeyDown:P=>{if(P.key==="Tab"&&y.length>0){const Z=s.find(se=>{var oe;return(oe=se.name)==null?void 0:oe.toLowerCase().startsWith(y.toLowerCase())});Z&&k(Z.name)}},className:"input-field pl-12 bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:border-blue-500 dark:focus:border-blue-400"}),y.length>0&&e("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg z-10 max-h-48 overflow-y-auto",children:s.filter(P=>{var Z;return(Z=P.name)==null?void 0:Z.toLowerCase().includes(y.toLowerCase())}).slice(0,5).map((P,Z)=>e("button",{onClick:()=>k(P.name),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:P.name},P.id))})]}),t("button",{onClick:J,className:"btn-secondary flex items-center space-x-2",children:[e(ze,{size:16}),e("span",{children:"Importă"})]}),e(ft,{onExportExcel:C,onExportPDF:z,entity:"companies"}),t("div",{className:"flex space-x-3",children:[g&&t(De,{children:[t("button",{onClick:K,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:L,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:S,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Companie"})]})]})]})]})}),e(qe,{data:N,columns:D,onEdit:F,onDelete:I,onRowClick:P=>{E(P),j(!0)},loading:c.companies,searchTerm:y,onSearchChange:k,selectedItems:A,onSelectAll:x,onSelectItem:v,moduleColor:"blue"}),d&&e(Wi,{item:T,onClose:()=>{f(!1),b(null)},onSave:R}),e(Yi,{isOpen:u.isOpen,onClose:m,onConfirm:u.onConfirm,title:u.title,message:u.message,confirmText:u.confirmText,cancelText:u.cancelText,type:u.type}),G&&e(Hi,{item:_,onClose:()=>{j(!1),E(null)}})]})})},Zi=({item:a,onClose:s,onSave:r})=>{const{companies:l,users:n}=ye(),[i,o]=h.useState({name:"",address:"",company:"",capacity:"",surface:"",planFile:null,status:"Activ",coordinates:"",contact_person:"",notes:""});h.useEffect(()=>{a&&o({name:a.name||"",address:a.address||"",company:a.company||"",capacity:a.capacity||"",surface:a.surface||"",planFile:a.planFile||null,status:a.status||"Activ",coordinates:a.coordinates||"",contact_person:a.contact_person||"",notes:a.notes||""})},[a]);const c=m=>{o({...i,[m.target.name]:m.target.value})},u=m=>{const d=m.target.files[0];d&&o({...i,planFile:d})};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-green-800 to-emerald-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600/20 to-emerald-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-lg",children:e(We,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Locație":"Adaugă Locație"}),e("p",{className:"text-green-100 text-sm font-medium",children:"Completează informațiile despre locație"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault(),r(i)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Locație *"}),e("input",{type:"text",name:"name",value:i.name,onChange:c,className:"input-field",placeholder:"ex: Locația Centru",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Companie *"}),t("select",{name:"company",value:i.company,onChange:c,className:"input-field",required:!0,children:[e("option",{value:"",children:"Selectează o companie"}),l.map(m=>e("option",{value:m.name,children:m.name},m.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Persoană de Contact"}),t("select",{name:"contact_person",value:i.contact_person,onChange:c,className:"input-field",children:[e("option",{value:"",children:"Selectează o persoană de contact"}),n.map(m=>t("option",{value:m.full_name||m.username,children:[m.full_name||m.username," (@",m.username,")"]},m.id))]}),e("p",{className:"text-xs text-slate-500",children:"Persoana responsabilă pentru această locație"})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Adresă Completă *"}),e("textarea",{name:"address",value:i.address,onChange:c,className:"input-field min-h-[100px] resize-none",placeholder:"ex: Str. Centrală nr. 1, București, România",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Suprafață (m²) *"}),e("input",{type:"number",name:"surface",value:i.surface,onChange:c,className:"input-field",placeholder:"ex: 150",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Capacitate (calculată din sloturi)"}),t("div",{className:"input-field bg-slate-50 text-slate-600 cursor-not-allowed",children:[i.capacity||0," sloturi"]}),e("p",{className:"text-xs text-slate-500",children:"Capacitatea se calculează automat din numărul de sloturi alocate acestei locații"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status"}),t("select",{name:"status",value:i.status,onChange:c,className:"input-field",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Mentenanță",children:"Mentenanță"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Coordonate (lat, lng)"}),e("input",{type:"text",name:"coordinates",value:i.coordinates,onChange:c,className:"input-field",placeholder:"ex: 44.4268, 26.1025"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Plan Locație"}),t("div",{className:"relative",children:[e("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png,.dwg,.dxf",onChange:u,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),i.planFile&&t("div",{className:"mt-2 text-sm text-green-600 font-medium",children:["✓ Fișier selectat: ",i.planFile.name]})]}),e("p",{className:"text-xs text-slate-500",children:"Formate acceptate: PDF, JPG, PNG, DWG, DXF"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note Adiționale"}),e("textarea",{name:"notes",value:i.notes,onChange:c,className:"input-field min-h-[80px] resize-none",placeholder:"Informații suplimentare despre locație..."})]}),t("div",{className:"flex justify-end space-x-4 pt-8 border-t-2 border-slate-200/50 mt-8",children:[e("button",{type:"button",onClick:s,className:"btn-secondary group",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Anulează"})}),e("button",{type:"submit",className:"btn-primary group",children:t("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:[a?"Actualizează":"Adaugă"," Locație"]})})]})]})})]})})},Qi=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(We,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-green-100",children:"Detalii Locație"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(We,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Adresă"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.address||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Companie"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.company||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Br,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Suprafață"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.surface?`${a.surface} m²`:"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),a.coordinates&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Coordonate GPS"}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white font-mono",children:a.coordinates})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]}),a.documents&&a.documents.length>0&&t("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-6 rounded-xl border border-amber-200 dark:border-amber-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Documente Atașate"}),e("div",{className:"space-y-2",children:a.documents.map((n,i)=>t("div",{className:"flex items-center justify-between bg-white dark:bg-slate-700 p-3 rounded-lg",children:[t("div",{className:"flex items-center space-x-3",children:[e(ge,{className:"w-5 h-5 text-amber-600"}),e("span",{className:"text-slate-900 dark:text-white",children:n.name})]}),e("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Descarcă"})]},i))})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},eo=({item:a,onClose:s,onSave:r,locationId:l})=>{const{locations:n,proprietari:i}=ye(),[o,c]=h.useState({contract_number:"",title:"",location_id:l||"",proprietar_id:"",type:"Chirie Locație",status:"Active",start_date:"",end_date:"",monthly_rent:"",currency:"RON",deposit:"",payment_terms:"",description:"",contractFile:null,contractPreview:null}),u=()=>{const b=new Date,y=b.getFullYear(),k=String(b.getMonth()+1).padStart(2,"0"),A=String(b.getDate()).padStart(2,"0"),O=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`CT-CH-${y}${k}${A}-${O}`};h.useEffect(()=>{c(a?{contract_number:a.contract_number||"",title:a.title||"",location_id:a.location_id||l||"",proprietar_id:a.proprietar_id||"",type:a.type||"Chirie Locație",status:a.status||"Active",start_date:a.start_date?a.start_date.split("T")[0]:"",end_date:a.end_date?a.end_date.split("T")[0]:"",monthly_rent:a.monthly_rent||"",currency:a.currency||"RON",deposit:a.deposit||"",payment_terms:a.payment_terms||"",description:a.description||"",contractFile:a.contractFile||null,contractPreview:a.contractFile||null}:b=>({...b,contract_number:u()}))},[a,l]);const p=b=>{const{name:y,value:k}=b.target;c(A=>({...A,[y]:k}))},m=b=>{const y=b.target.files[0];if(y){const k=new FileReader;k.onload=A=>{const O=A.target.result;c(g=>({...g,contractFile:O,contractPreview:O}))},k.readAsDataURL(y)}},d=()=>{window.confirm("Sigur doriți să ștergeți fișierul contractului?")&&c(b=>({...b,contractFile:null,contractPreview:null}))},f=b=>b?e(ge,{className:"w-4 h-4"}):e(ge,{className:"w-4 h-4"});return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-green-800 to-emerald-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600/20 to-emerald-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-lg",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Contract":"Adaugă Contract Nou"}),e("p",{className:"text-green-100 text-sm font-medium",children:"Completează informațiile despre contract"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:b=>{b.preventDefault(),r(o)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Număr Contract *"}),t("div",{className:"flex space-x-2",children:[e("input",{type:"text",name:"contract_number",value:o.contract_number,onChange:p,required:!0,className:"flex-1 px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"ex: CT-CH-2024-001"}),!a&&e("button",{type:"button",onClick:()=>c(b=>({...b,contract_number:u()})),className:"px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl transition-colors",title:"Generează număr nou",children:"🔄"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Titlu Contract *"}),e("input",{type:"text",name:"title",value:o.title,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"ex: Contract Chirie Locație București"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Locație *"}),t("select",{name:"location_id",value:o.location_id,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"",children:"Selectează locația"}),n==null?void 0:n.map(b=>e("option",{value:b.id,children:b.name},b.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Proprietar *"}),t("select",{name:"proprietar_id",value:o.proprietar_id,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"",children:"Selectează proprietarul"}),i==null?void 0:i.map(b=>e("option",{value:b.id,children:b.name},b.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Tip Contract *"}),t("select",{name:"type",value:o.type,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"Chirie Locație",children:"Chirie Locație"}),e("option",{value:"Chirie Comercială",children:"Chirie Comercială"}),e("option",{value:"Chirie Industrială",children:"Chirie Industrială"}),e("option",{value:"Chirie Oficiu",children:"Chirie Oficiu"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Status *"}),t("select",{name:"status",value:o.status,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Inactive",children:"Inactiv"}),e("option",{value:"Expired",children:"Expirat"}),e("option",{value:"Pending",children:"În așteptare"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Data Început *"}),e("input",{type:"date",name:"start_date",value:o.start_date,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Data Sfârșit *"}),e("input",{type:"date",name:"end_date",value:o.end_date,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Chiria Lunară *"}),e("input",{type:"number",name:"monthly_rent",value:o.monthly_rent,onChange:p,required:!0,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"0.00"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Depozit Garantie"}),e("input",{type:"number",name:"deposit",value:o.deposit,onChange:p,step:"0.01",min:"0",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"0.00"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Monedă *"}),t("select",{name:"currency",value:o.currency,onChange:p,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",children:[e("option",{value:"RON",children:"RON"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Termeni de Plată"}),e("input",{type:"text",name:"payment_terms",value:o.payment_terms,onChange:p,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"ex: Lunar, până în data de 5"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Descriere"}),e("textarea",{name:"description",value:o.description,onChange:p,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none",placeholder:"Descrierea contractului..."})]}),t("div",{className:"space-y-4",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Fișier Contract (PDF)"}),t("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl p-6 text-center hover:border-green-400 dark:hover:border-green-500 transition-colors",children:[e("input",{type:"file",id:"contractFile",accept:".pdf",onChange:m,className:"hidden"}),t("label",{htmlFor:"contractFile",className:"cursor-pointer flex flex-col items-center space-y-3",children:[e("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center text-white",children:e(ze,{className:"w-6 h-6"})}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:o.contractFile?"Schimbă contractul":"Încarcă fișier contract"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF (max 10MB)"})]})]})]}),o.contractPreview&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-4 border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-2",children:[f(o.contractFile),e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Fișier Contract"})]}),e("button",{type:"button",onClick:d,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge fișierul",children:e(ve,{className:"w-4 h-4"})})]}),e(Ct,{pdfUrl:o.contractPreview,title:`Contract ${o.contract_number||o.title}`,placeholder:"Contractul nu este disponibil",placeholderSubtext:"Atașează fișierul contractului pentru vizualizare"})]})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(ge,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Contract"]})]})]})]})})]})})},to=({locationId:a,locationName:s})=>{const{contracts:r,createItem:l,updateItem:n,deleteItem:i,loading:o}=ye(),[c,u]=h.useState(!1),[p,m]=h.useState(null),[d,f]=h.useState([]);h.useEffect(()=>{if(r)if(a){const g=r.filter($=>$.location_id==a);f(g)}else f(r);else f([])},[r,a]);const T=()=>{m(null),u(!0)},b=g=>{console.log("View contract:",g)},y=g=>{console.log("Download contract:",g)},k=g=>{m(g),u(!0)},A=async g=>{window.confirm(`Sigur doriți să ștergeți contractul "${g.contract_number}"?`)&&await i("contracts",g.id)},O=async g=>{p?await n("contracts",p.id,g):await l("contracts",g),u(!1),m(null)};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{children:[t("h3",{className:"text-xl font-bold text-slate-800",children:["Contracte - ",s]}),e("p",{className:"text-slate-600",children:"Gestionează contractele asociate acestei locații"})]}),t("button",{onClick:T,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Contract"})]})]}),e("div",{className:"card overflow-hidden",children:e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100",children:t("tr",{children:[e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Nr. Contract"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Tip Contract"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Perioadă"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Chiria Lunară"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Proprietar"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Acțiuni"})]})}),e("tbody",{className:"divide-y divide-slate-200",children:d.map(g=>t("tr",{className:"table-row hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"font-bold text-slate-900",children:g.contract_number})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-slate-700 font-medium",children:g.title}),e("div",{className:"text-slate-500 text-sm",children:g.type})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"text-slate-600 text-sm",children:[new Date(g.start_date).toLocaleDateString("ro-RO")," - ",new Date(g.end_date).toLocaleDateString("ro-RO")]})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[t("div",{className:"text-slate-700 font-sans",children:[parseFloat(g.monthly_rent||0).toLocaleString("ro-RO")," ",g.currency]}),g.deposit&&t("div",{className:"text-slate-500 text-xs",children:["Depozit: ",parseFloat(g.deposit).toLocaleString("ro-RO")," ",g.currency]})]}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-slate-700 font-medium",children:g.proprietar_name||"N/A"}),g.proprietar_contact&&e("div",{className:"text-slate-500 text-xs",children:g.proprietar_contact})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${g.status==="Active"?"bg-green-100 text-green-800":g.status==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.status==="Active"?"Activ":g.status==="Inactive"?"Inactiv":g.status==="Expired"?"Expirat":g.status==="Pending"?"În așteptare":g.status})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>b(g),className:"text-blue-600 hover:text-blue-900 p-1 rounded-lg hover:bg-blue-50 transition-colors",title:"Vezi contract",children:e(Qe,{size:16})}),e("button",{onClick:()=>y(g),className:"text-green-600 hover:text-green-900 p-1 rounded-lg hover:bg-green-50 transition-colors",title:"Descarcă contract",children:e(Je,{size:16})}),e("button",{onClick:()=>k(g),className:"text-yellow-600 hover:text-yellow-900 p-1 rounded-lg hover:bg-yellow-50 transition-colors",title:"Editează contract",children:e(tt,{size:16})}),e("button",{onClick:()=>A(g),className:"text-red-600 hover:text-red-900 p-1 rounded-lg hover:bg-red-50 transition-colors",title:"Șterge contract",children:e(Fe,{size:16})})]})})]},g.id))})]})})}),d.length===0&&t("div",{className:"card p-12 text-center",children:[e("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl inline-block mb-6",children:e(ge,{className:"w-16 h-16 text-blue-500 mx-auto"})}),e("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Nu există contracte"}),e("p",{className:"text-slate-600 mb-6",children:"Adaugă primul contract pentru această locație"}),t("button",{onClick:T,className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Contract"})]})]}),c&&e(eo,{item:p,onClose:()=>{u(!1),m(null)},onSave:O,locationId:a})]})},ao=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",contact_person:"",email:"",phone:"",address:"",cnp_cui:"",type:"Persoana Fizica",status:"Activ",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",contact_person:a.contact_person||"",email:a.email||"",phone:a.phone||"",address:a.address||"",cnp_cui:a.cnp_cui||"",type:a.type||"Persoana Fizica",status:a.status||"Activ",notes:a.notes||""})},[a]);const i=c=>{const{name:u,value:p}=c.target;n(m=>({...m,[u]:p}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-purple-800 to-violet-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-violet-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl shadow-lg",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Proprietar":"Adaugă Proprietar Nou"}),e("p",{className:"text-purple-100 text-sm font-medium",children:"Completează informațiile despre proprietar"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Nume Proprietar *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: Ion Popescu sau SC Imobiliare SRL"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Persoană de Contact"}),e("input",{type:"text",name:"contact_person",value:l.contact_person,onChange:i,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: Maria Ionescu"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Email"}),e("input",{type:"email",name:"email",value:l.email,onChange:i,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: ion.popescu@email.com"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Telefon"}),e("input",{type:"tel",name:"phone",value:l.phone,onChange:i,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: +40712345678"})]}),t("div",{className:"md:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Adresă"}),e("input",{type:"text",name:"address",value:l.address,onChange:i,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: Str. Mihai Viteazu nr. 10, București"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"CNP / CUI"}),e("input",{type:"text",name:"cnp_cui",value:l.cnp_cui,onChange:i,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"ex: 1234567890123 sau RO12345678"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Tip *"}),t("select",{name:"type",value:l.type,onChange:i,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e("option",{value:"Persoana Fizica",children:"Persoană Fizică"}),e("option",{value:"Persoana Juridica",children:"Persoană Juridică"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:i,required:!0,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-200 mb-2",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:3,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Note suplimentare despre proprietar..."})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(_e,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Proprietar"]})]})]})]})})]})})},ro=({locationId:a,locationName:s})=>{const{proprietari:r,createItem:l,updateItem:n,deleteItem:i}=ye(),[o,c]=h.useState(!1),[u,p]=h.useState(null),[m,d]=h.useState(""),f=(r||[]).filter($=>{var _,E,G,j;return((_=$.name)==null?void 0:_.toLowerCase().includes(m.toLowerCase()))||((E=$.contact_person)==null?void 0:E.toLowerCase().includes(m.toLowerCase()))||((G=$.email)==null?void 0:G.toLowerCase().includes(m.toLowerCase()))||((j=$.phone)==null?void 0:j.toLowerCase().includes(m.toLowerCase()))}),T=()=>{p(null),c(!0)},b=$=>{console.log("View proprietar:",$)},y=$=>{p($),c(!0)},k=async $=>{if(window.confirm(`Sigur doriți să ștergeți proprietarul "${$.name}"?`))try{await i("proprietari",$.id)}catch(_){console.error("Error deleting proprietar:",_)}},A=async $=>{try{u?await n("proprietari",u.id,$):await l("proprietari",$),c(!1),p(null)}catch(_){console.error("Error saving proprietar:",_)}},O=$=>{switch($){case"Persoana Fizica":return"bg-blue-100 text-blue-800";case"Persoana Juridica":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},g=$=>{switch($){case"Activ":return"bg-green-100 text-green-800";case"Inactiv":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Proprietari"}),t("p",{className:"text-slate-600",children:["Gestionează proprietarii pentru ",s]})]}),t("button",{onClick:T,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Proprietar"})]})]}),t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută proprietari...",value:m,onChange:$=>d($.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),f.length>0?e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map($=>t("div",{className:"card p-6 hover:shadow-lg transition-all duration-200 group",children:[t("div",{className:"flex items-start justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h3",{className:"font-bold text-slate-800 group-hover:text-blue-700 transition-colors",children:$.name}),e("p",{className:"text-slate-600 text-sm",children:$.contact_person})]})]}),t("div",{className:"flex space-x-1",children:[e("button",{onClick:()=>b($),className:"p-2 text-slate-400 hover:text-blue-500 transition-colors",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>y($),className:"p-2 text-slate-400 hover:text-green-500 transition-colors",children:e(tt,{className:"w-4 h-4"})}),e("button",{onClick:()=>k($),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:e(Fe,{className:"w-4 h-4"})})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[$.email&&t("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[e(Qt,{className:"w-4 h-4"}),e("span",{children:$.email})]}),$.phone&&t("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[e(na,{className:"w-4 h-4"}),e("span",{children:$.phone})]}),$.address&&t("div",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[e(We,{className:"w-4 h-4"}),e("span",{className:"truncate",children:$.address})]})]}),t("div",{className:"flex space-x-2",children:[e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${O($.type)}`,children:$.type}),e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${g($.status)}`,children:$.status})]}),$.cnp_cui&&t("div",{className:"text-xs text-slate-500",children:[$.type==="Persoana Fizica"?"CNP:":"CUI:"," ",$.cnp_cui]}),$.notes&&e("div",{className:"text-sm text-slate-600 bg-slate-50 p-2 rounded-lg",children:$.notes})]})]},$.id))}):t("div",{className:"card p-12 text-center",children:[e("div",{className:"p-8 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl inline-block mb-6",children:e(_e,{className:"w-20 h-20 text-blue-500 mx-auto"})}),e("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Nu există proprietari"}),e("p",{className:"text-slate-600 mb-6",children:"Adaugă primul proprietar pentru această locație"}),t("button",{onClick:T,className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Proprietar"})]})]}),o&&e(ao,{item:u,onClose:()=>{c(!1),p(null)},onSave:A})]})},so=()=>{const a=He(),{locations:s,contracts:r,slots:l,createItem:n,updateItem:i,deleteItem:o,exportToExcel:c,exportToPDF:u,loading:p}=ye(),[m,d]=h.useState(!1),[f,T]=h.useState(null),[b,y]=h.useState(""),[k,A]=h.useState([]),[O,g]=h.useState(!1),[$,_]=h.useState(!1),[E,G]=h.useState(null),[j,N]=h.useState(!1);h.useEffect(()=>{g(k.length>0)},[k]);const D=ee=>{A(ee?Z.map(me=>me.id):[])},S=(ee,me)=>{A(me?[...k,ee]:k.filter(fe=>fe!==ee))},F=async()=>{k.length!==0&&_(!0)},I=async()=>{try{for(const ee of k)await o("locations",ee);A([]),g(!1),_(!1),U.success(`${k.length} locații șterse cu succes!`)}catch(ee){console.error("Error bulk deleting:",ee),U.error("Eroare la ștergerea locațiilor!")}},x=()=>{k.length!==0&&console.log("Bulk edit for:",k)},[v,L]=h.useState("locations"),[K,R]=h.useState(null),[C,z]=h.useState(null),[J,P]=h.useState(!1),Z=s.filter(ee=>{var me,fe,ne,le;return((me=ee.name)==null?void 0:me.toLowerCase().includes(b.toLowerCase()))||((fe=ee.address)==null?void 0:fe.toLowerCase().includes(b.toLowerCase()))||((ne=ee.company)==null?void 0:ne.toLowerCase().includes(b.toLowerCase()))||((le=ee.contact_person)==null?void 0:le.toLowerCase().includes(b.toLowerCase()))}),se=ee=>l.filter(fe=>fe.location===ee&&fe.status!=="Depozit").length,oe=ee=>{const me=r.filter(ie=>ie.location_id===ee&&ie.status==="Active");if(me.length===0)return null;const fe=me.sort((ie,Ce)=>new Date(Ce.end_date)-new Date(ie.end_date))[0];if(!fe.end_date)return null;const ne=new Date,be=new Date(fe.end_date)-ne;return Math.ceil(be/(1e3*60*60*24))},de=(ee,me)=>{const fe=r.filter(be=>be.location_id===ee&&be.status==="Active");if(fe.length===0||!me)return null;const ne=fe.sort((be,te)=>new Date(te.end_date)-new Date(be.end_date))[0];return ne.monthly_rent?(ne.monthly_rent/me).toFixed(2):null},Se=[{key:"name",label:"Nume Locație",sortable:!0,render:ee=>t("div",{className:"space-y-1",children:[e("button",{onClick:()=>a(`/locations/${ee.id}`),className:"text-slate-900 dark:text-slate-100 hover:text-green-700 dark:hover:text-green-400 transition-colors text-left font-medium",children:ee.name}),e("div",{className:"text-slate-600 dark:text-slate-400",children:ee.address})]})},{key:"company",label:"Companie",sortable:!0,render:ee=>t("div",{className:"space-y-1",children:[e("span",{className:"text-blue-800 dark:text-blue-300",children:ee.company}),e("div",{className:"flex items-center space-x-2",children:ee.contact_person?t(De,{children:[e("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white shadow-lg",children:ee.contact_person.charAt(0).toUpperCase()}),e("span",{className:"text-slate-700",children:ee.contact_person})]}):e("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"Nu este setată"})})]})},{key:"surface",label:"Suprafață (m²)",sortable:!0,render:ee=>e("div",{className:"text-slate-600",children:ee.surface?`${ee.surface} m²`:"N/A"})},{key:"capacity",label:"Capacitate (Sloturi)",sortable:!0,render:ee=>{const me=se(ee.name);return t("div",{className:"text-slate-600",children:[me," sloturi"]})}},{key:"cost_per_m2",label:"Cost/m²",sortable:!1,render:ee=>{const me=de(ee.id,ee.surface);return me===null?e("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"N/A"}):t("div",{className:"flex items-center space-x-1",children:[e("span",{className:"text-blue-600 dark:text-blue-400",children:me}),e("span",{className:"text-slate-500 dark:text-slate-400",children:"RON/m²"})]})}},{key:"plan_file",label:"Plan Locație",sortable:!1,render:ee=>e("div",{className:"flex items-center space-x-2",children:ee.plan_file?t(De,{children:[e("button",{onClick:()=>ue(ee),className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",title:"Vizualizează planul",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>Te(ee),className:"p-2 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-300 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",title:"Descarcă planul",children:e(Je,{className:"w-4 h-4"})}),e("button",{onClick:()=>pe(ee),className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",title:"Șterge planul",children:e(ve,{className:"w-4 h-4"})})]}):e("span",{className:"text-slate-400 dark:text-slate-500 text-sm italic",children:"Nu există plan"})})},{key:"contract_expiration",label:"Zile Rămase Contract",sortable:!1,render:ee=>{const me=oe(ee.id);if(me===null)return e("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"Fără contract activ"});const fe=me<0,ne=me<=30&&me>=0;return t("div",{className:`flex items-center space-x-1 ${fe?"text-red-600 dark:text-red-400":ne?"text-orange-600 dark:text-orange-400":"text-green-600 dark:text-green-400"}`,children:[e("span",{children:fe?Math.abs(me):me}),e("span",{children:fe?"zile expirat":"zile rămase"})]})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:ee=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:ee.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:ee.created_at?new Date(ee.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Oe=()=>{T(null),d(!0)},Ue=ee=>{T(ee),d(!0)},Ze=async ee=>{if(confirm(`Sigur doriți să ștergeți locația "${ee.name}"?`))try{await o("locations",ee.id),U.success("Locația a fost ștearsă cu succes!")}catch{U.error("Eroare la ștergerea locației")}},$e=async ee=>{try{if(ee.planFile&&ee.planFile instanceof File){const fe=new FormData;if(Object.keys(ee).forEach(ne=>{ne==="planFile"&&ee[ne]instanceof File?fe.append("planFile",ee[ne]):ne!=="planFile"&&fe.append(ne,ee[ne])}),f){if(!(await fetch(`/api/locations/${f.id}`,{method:"PUT",body:fe})).ok)throw new Error("Failed to update location")}else if(!(await fetch("/api/locations",{method:"POST",body:fe})).ok)throw new Error("Failed to create location")}else{const fe={...ee};if(delete fe.planFile,f){if(!(await fetch(`/api/locations/${f.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)})).ok)throw new Error("Failed to update location")}else if(!(await fetch("/api/locations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)})).ok)throw new Error("Failed to create location")}window.location.reload(),d(!1),T(null),U.success(f?"Locația a fost actualizată cu succes!":"Locația a fost creată cu succes!")}catch(me){console.error("Error saving location:",me),console.error("Error details:",me.message),U.error(`Eroare la salvare locație: ${me.message}`)}},rt=()=>{try{c("locations")}catch(ee){console.error("Error exporting to Excel:",ee)}},Be=()=>{try{u("locations")}catch(ee){console.error("Error exporting to PDF:",ee)}},Ye=()=>{console.log("Import functionality to be implemented")},Q=ee=>{R(ee),L("contracts")},ce=ee=>{R(ee),L("proprietari")},ue=ee=>{ee.plan_file&&(z(ee.plan_file),P(!0))},pe=async ee=>{if(window.confirm(`Sigur doriți să ștergeți planul locației "${ee.name}"?`))try{await i("locations",ee.id,{plan_file:null})}catch(me){console.error("Error deleting document:",me)}},Te=ee=>{if(ee.plan_file){const me=document.createElement("a");me.href=ee.plan_file,me.download=`Plan_${ee.name||"location"}.pdf`,me.click()}};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex space-x-1 bg-slate-100 rounded-xl p-1",children:[e("button",{onClick:()=>L("locations"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${v==="locations"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg shadow-blue-500/25":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(We,{size:20}),e("span",{children:"Locații"})]})}),e("button",{onClick:()=>L("contracts"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${v==="contracts"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg shadow-green-500/25":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ge,{size:20}),e("span",{children:"Contracte"})]})}),e("button",{onClick:()=>L("proprietari"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${v==="proprietari"?"bg-gradient-to-r from-purple-500 to-violet-500 text-white shadow-lg shadow-purple-500/25":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(_e,{size:20}),e("span",{children:"Proprietari"})]})})]})}),v==="locations"?t(De,{children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-wrap items-center gap-3",children:[t("div",{className:"relative flex-1 min-w-[200px] group",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-400 transition-colors",size:18}),e("input",{type:"text",placeholder:"Caută locații...",value:b,onChange:ee=>y(ee.target.value),className:"input-field pl-12 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-100 dark:placeholder-slate-400"})]}),t("button",{onClick:Ye,className:"btn-secondary flex items-center space-x-2",children:[e(ze,{size:16}),e("span",{children:"Importă"})]}),e(ft,{onExportExcel:rt,onExportPDF:Be,entity:"locations"}),O&&t(De,{children:[t("button",{onClick:x,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:F,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:()=>a("/slots/cyber-import"),className:"btn-success flex items-center space-x-2",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Import Cyber"})]}),t("button",{onClick:Oe,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Locație"})]})]})}),e(qe,{data:Z,columns:Se,onEdit:Ue,onDelete:Ze,onViewContracts:Q,onRowClick:ee=>{G(ee),N(!0)},onViewProprietari:ce,loading:p.locations,searchTerm:b,onSearchChange:y,selectedItems:k,onSelectAll:D,onSelectItem:S,moduleColor:"blue"}),Z.length>0&&e("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700",children:t("div",{className:"flex items-center justify-center space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e("span",{className:"text-white font-bold text-sm",children:"📊"})}),e("span",{className:"text-slate-700 dark:text-slate-300 font-medium",children:"Total sloturi în toate locațiile:"})]}),t("div",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg font-bold text-xl",children:[Z.reduce((ee,me)=>ee+se(me.name),0)," sloturi"]})]})}),m&&e(Zi,{item:f,onClose:()=>{d(!1),T(null)},onSave:$e}),J&&C&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-3xl w-full max-w-6xl h-[90vh] overflow-hidden shadow-2xl",children:[t("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 px-6 py-4 flex justify-between items-center",children:[t("h3",{className:"text-xl font-bold text-white flex items-center",children:[e(ge,{className:"w-6 h-6 mr-2"}),"Vizualizare Plan Locație"]}),e("button",{onClick:()=>{P(!1),z(null)},className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:e(ve,{className:"w-6 h-6"})})]}),e("div",{className:"h-full p-6",children:e(Ct,{pdfUrl:C,title:"Plan Locație",placeholder:"Planul locației nu este disponibil",placeholderSubtext:"Atașează planul locației pentru vizualizare"})})]})})]}):v==="contracts"?e(to,{locationId:(K==null?void 0:K.id)||null,locationName:(K==null?void 0:K.name)||"Toate Contractele"}):e(ro,{locationId:K==null?void 0:K.id,locationName:(K==null?void 0:K.name)||"Selectați o locație"}),$&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(Fe,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Șterge ",k.length," Locații"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",k.length," locații selectate? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",k.length," Locații"]})]})]})}),j&&e(Qi,{item:E,onClose:()=>{N(!1),G(null)}})]})})},lo=()=>{const{id:a}=It(),s=He(),{locations:r,contracts:l,slots:n,cabinets:i,companies:o,users:c,loading:u}=ye(),[p,m]=h.useState(null),[d,f]=h.useState("overview");if(h.useEffect(()=>{const g=r.find($=>$.id===parseInt(a));m(g)},[a,r]),u)return e(he,{children:e("div",{className:"flex items-center justify-center h-screen",children:e("div",{className:"text-xl text-slate-600",children:"Se încarcă..."})})});if(!p)return e(he,{children:e("div",{className:"flex items-center justify-center h-screen",children:e("div",{className:"text-xl text-red-600",children:"Locația nu a fost găsită"})})});const T=l.filter(g=>g.location_id===p.id),b=n.filter(g=>g.location===p.name&&g.status!=="Depozit"),y=i.filter(g=>g.location_id===p.id);o.find(g=>g.name===p.company);const k=T.filter(g=>g.status==="Active"),A=b.length,O=y.length;return e(he,{children:t("div",{className:"p-6 space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>s("/locations"),className:"p-3 bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-800 rounded-2xl hover:from-slate-200 hover:to-slate-300 dark:hover:from-slate-600 dark:hover:to-slate-700 transition-all duration-200 shadow-lg",children:e(et,{className:"w-5 h-5"})}),t("div",{children:[e("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100",children:p.name}),e("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:p.address})]})]}),e("div",{className:"flex space-x-3",children:t("button",{onClick:()=>s(`/locations/${a}/edit`),className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-emerald-500/25 transition-all duration-200 flex items-center space-x-2",children:[e(tt,{className:"w-5 h-5"}),e("span",{children:"Editează"})]})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Contracte Active"}),e("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:k.length})]}),e("div",{className:"p-4 bg-blue-500/10 rounded-2xl",children:e(ge,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})})]})}),e("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Sloturi"}),e("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mt-2",children:A})]}),e("div",{className:"p-4 bg-green-500/10 rounded-2xl",children:e(At,{className:"w-8 h-8 text-green-600 dark:text-green-400"})})]})}),e("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/20 dark:to-violet-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Cabinete"}),e("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400 mt-2",children:O})]}),e("div",{className:"p-4 bg-purple-500/10 rounded-2xl",children:e(_e,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})})]})}),e("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 p-6 rounded-2xl shadow-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:"Suprafață"}),t("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-2",children:[p.surface||0," m²"]})]}),e("div",{className:"p-4 bg-orange-500/10 rounded-2xl",children:e(dr,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})})]})})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg overflow-hidden",children:[e("div",{className:"border-b border-slate-200 dark:border-slate-700",children:t("div",{className:"flex space-x-1 p-4",children:[e("button",{onClick:()=>f("overview"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="overview"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:"Prezentare Generală"}),t("button",{onClick:()=>f("contracts"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="contracts"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:["Contracte (",T.length,")"]}),t("button",{onClick:()=>f("slots"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="slots"?"bg-gradient-to-r from-purple-500 to-violet-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:["Sloturi (",A,")"]}),t("button",{onClick:()=>f("cabinets"),className:`px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${d==="cabinets"?"bg-gradient-to-r from-orange-500 to-amber-500 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:["Cabinete (",O,")"]})]})}),t("div",{className:"p-6",children:[d==="overview"&&t("div",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Informații Generale"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center space-x-3",children:[e(We,{className:"w-5 h-5 text-blue-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Adresă"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:p.address})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(_e,{className:"w-5 h-5 text-green-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Companie"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:p.company})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(dr,{className:"w-5 h-5 text-orange-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Suprafață"}),t("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:[p.surface||0," m²"]})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(bt,{className:"w-5 h-5 text-purple-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Persoană de Contact"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:p.contact_person||"Nu este setată"})]})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Plan Locație"}),p.plan_file?t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center space-x-3",children:[e(ge,{className:"w-5 h-5 text-blue-500"}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Fișier Plan"}),e("p",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Plan disponibil"})]})]}),t("div",{className:"flex space-x-3",children:[t("button",{className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center space-x-2",children:[e(Qe,{className:"w-4 h-4"}),e("span",{children:"Vizualizează"})]}),t("button",{className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center space-x-2",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Descarcă"})]})]})]}):e("p",{className:"text-slate-400 italic",children:"Nu există plan încărcat"})]})]}),p.notes&&t("div",{className:"space-y-3",children:[e("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Note"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-xl",children:e("p",{className:"text-slate-700 dark:text-slate-300",children:p.notes})})]})]}),d==="contracts"&&e("div",{className:"space-y-4",children:T.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-green-50/80 to-emerald-50/80 dark:from-green-900/20 dark:to-emerald-800/20",children:t("tr",{children:[e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Număr Contract"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Tip"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Proprietar"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Perioadă"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Chirie Lunară"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Status"}),e("th",{className:"text-left p-4 font-bold text-green-800 dark:text-green-200 text-sm uppercase",children:"Contract PDF"})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:T.map(g=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e("td",{className:"p-4",children:g.contract_number}),e("td",{className:"p-4",children:g.type}),e("td",{className:"p-4",children:g.proprietar_name}),t("td",{className:"p-4",children:[new Date(g.start_date).toLocaleDateString("ro-RO")," - ",new Date(g.end_date).toLocaleDateString("ro-RO")]}),t("td",{className:"p-4",children:[g.monthly_rent," ",g.currency]}),e("td",{className:"p-4",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${g.status==="Active"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"}`,children:g.status})}),e("td",{className:"p-4",children:g.file_path?t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>window.open(`https://www.w1n.ro${g.file_path}`,"_blank"),className:"p-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",title:"Vizualizează PDF",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const $=document.createElement("a");$.href=`https://www.w1n.ro${g.file_path}`,$.download=`contract-${g.contract_number}.pdf`,$.click()},className:"p-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors",title:"Descarcă PDF",children:e(Je,{className:"w-4 h-4"})})]}):e("span",{className:"text-slate-400 italic",children:"N/A"})})]},g.id))})]})}):e("p",{className:"text-slate-400 italic text-center py-8",children:"Nu există contracte pentru această locație"})}),d==="slots"&&e("div",{className:"space-y-4",children:b.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-purple-50/80 to-violet-50/80 dark:from-purple-900/20 dark:to-violet-800/20",children:t("tr",{children:[e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"ID"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Număr Serie"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Denumire"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Furnizor"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Cabinet"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Game Mix"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Data Licență"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Data CVT"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Status"}),e("th",{className:"text-left p-4 font-bold text-purple-800 dark:text-purple-200 text-sm uppercase",children:"Tip Proprietate"})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:b.map(g=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e("td",{className:"p-4 font-semibold",children:g.id}),e("td",{className:"p-4 font-semibold",children:g.serial_number}),e("td",{className:"p-4",children:g.name}),e("td",{className:"p-4",children:g.provider}),e("td",{className:"p-4",children:g.cabinet}),e("td",{className:"p-4",children:g.game_mix}),e("td",{className:"p-4",children:g.license_date?new Date(g.license_date).toLocaleDateString("ro-RO"):"N/A"}),e("td",{className:"p-4",children:g.cvt_date?new Date(g.cvt_date).toLocaleDateString("ro-RO"):"N/A"}),e("td",{className:"p-4",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${g.status==="Activ"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"}`,children:g.status})}),e("td",{className:"p-4",children:g.property_type==="Owned"?"Proprietate":"Închiriat"})]},g.id))})]})}):e("p",{className:"text-slate-400 italic text-center py-8",children:"Nu există sloturi în această locație"})}),d==="cabinets"&&e("div",{className:"space-y-4",children:y.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-gradient-to-r from-orange-50/80 to-amber-50/80 dark:from-orange-900/20 dark:to-amber-800/20",children:t("tr",{children:[e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Număr Serie"}),e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Model"}),e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Producător"}),e("th",{className:"text-left p-4 font-bold text-orange-800 dark:text-orange-200 text-sm uppercase",children:"Status"})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:y.map(g=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e("td",{className:"p-4 font-semibold",children:g.serial_number}),e("td",{className:"p-4",children:g.model}),e("td",{className:"p-4",children:g.manufacturer}),e("td",{className:"p-4",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${g.status==="Activ"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"}`,children:g.status})})]},g.id))})]})}):e("p",{className:"text-slate-400 italic text-center py-8",children:"Nu există cabinete în această locație"})})]})]})]})})},no=({item:a,onClose:s,onSave:r})=>{ye();const[l,n]=h.useState({name:"",contact_person:"",contact:"",phone:"",company:"",status:"Activ",notes:"",logo:{type:"upload",url:"",file:null}});h.useEffect(()=>{a&&n({name:a.name||"",contact_person:a.contact_person||"",contact:a.contact||"",phone:a.phone||"",company:a.company||"",status:a.status||"Activ",notes:a.notes||"",logo:a.logo?typeof a.logo=="object"?a.logo:{type:"upload",url:"",file:null}:{type:"upload",url:"",file:null}})},[a]);const i=m=>{n({...l,[m.target.name]:m.target.value})},o=m=>{n({...l,logo:{...l.logo,type:m}})},c=m=>{n({...l,logo:{...l.logo,url:m}})},u=m=>{const d=m.target.files[0];if(d){const f=new FileReader;f.onloadend=()=>{n({...l,logo:{...l.logo,file:f.result}})},f.readAsDataURL(d)}};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-purple-800 to-violet-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-violet-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl shadow-lg",children:e(bt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Furnizor":"Adaugă Furnizor"}),e("p",{className:"text-purple-100 text-sm font-medium",children:"Completează informațiile despre furnizor"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Furnizor *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"input-field",placeholder:"ex: EGT Digital",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Persoana de Contact *"}),e("input",{type:"text",name:"contact_person",value:l.contact_person,onChange:i,className:"input-field",placeholder:"ex: Ion Popescu",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Companie Furnizor *"}),e("input",{type:"text",name:"company",value:l.company,onChange:i,className:"input-field",placeholder:"Introdu numele companiei",required:!0}),e("p",{className:"text-xs text-slate-500",children:"Compania care deține furnizorul (pentru facturi și contracte)"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Email Contact *"}),e("input",{type:"email",name:"contact",value:l.contact,onChange:i,className:"input-field",placeholder:"ex: contact@egt-digital.com",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Telefon *"}),e("input",{type:"text",name:"phone",value:l.phone,onChange:i,className:"input-field",placeholder:"ex: +40 21 555 1234",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status"}),t("select",{name:"status",value:l.status,onChange:i,className:"input-field",children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Suspendat",children:"Suspendat"})]})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Logo Furnizor"}),t("div",{className:"flex space-x-4 mb-4",children:[e("button",{type:"button",onClick:()=>o("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${l.logo.type==="upload"?"bg-purple-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Upload Logo"}),e("button",{type:"button",onClick:()=>o("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${l.logo.type==="link"?"bg-purple-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Link URL"})]}),l.logo.type==="upload"?t("div",{children:[e("input",{type:"file",accept:"image/*",onChange:u,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100"}),l.logo.file&&t("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg flex items-center space-x-4",children:[e("img",{src:l.logo.file,alt:"Logo Preview",className:"h-9 w-9 object-contain rounded"}),e("span",{className:"text-sm text-green-600 font-medium",children:"✓ Logo încărcat"})]})]}):t("div",{children:[e("input",{type:"text",value:l.logo.url,onChange:m=>c(m.target.value),className:"input-field",placeholder:"https://example.com/logo.png"}),l.logo.url&&t("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg flex items-center space-x-4",children:[e("img",{src:l.logo.url,alt:"Logo Preview",className:"h-9 w-9 object-contain rounded"}),e("span",{className:"text-sm text-green-600 font-medium",children:"✓ Logo settat"})]})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note Adiționale"}),e("textarea",{name:"notes",value:l.notes,onChange:i,className:"input-field min-h-[80px] resize-none",placeholder:"Informații suplimentare despre furnizor..."})]}),t("div",{className:"flex justify-end space-x-4 pt-8 border-t-2 border-slate-200/50 mt-8",children:[e("button",{type:"button",onClick:s,className:"btn-secondary group",children:e("span",{className:"group-hover:-translate-x-1 transition-transform inline-block",children:"Anulează"})}),e("button",{type:"submit",className:"btn-primary group",children:t("span",{className:"group-hover:translate-x-1 transition-transform inline-block",children:[a?"Actualizează":"Adaugă"," Furnizor"]})})]})]})})]})})},io=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-purple-100",children:"Detalii Furnizor"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Companie"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.company||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(yt,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Persoană Contact"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.contact||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(na,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Telefon"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.phone||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Qt,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Email"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white break-all",children:a.email||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ge,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Număr Jocuri"})]}),t("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:[a.games_count||0," jocuri"]})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},oo=()=>{const{providers:a,games:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:i,exportToPDF:o,loading:c}=ye(),[u,p]=h.useState(!1),[m,d]=h.useState(null),[f,T]=h.useState(""),[b,y]=h.useState([]),[k,A]=h.useState(!1),[O,g]=h.useState(null),[$,_]=h.useState(!1),E=z=>!s||!z?0:s.filter(J=>J.provider&&J.provider.toLowerCase()===z.toLowerCase()).length;h.useEffect(()=>{A(b.length>0)},[b]);const G=z=>{y(z?S.map(J=>J.id):[])},j=(z,J)=>{y(J?[...b,z]:b.filter(P=>P!==z))},N=async()=>{if(b.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${b.length} elemente?`))try{for(const z of b)await n("providers",z);y([]),A(!1)}catch(z){console.error("Error bulk deleting:",z)}},D=()=>{b.length!==0&&console.log("Bulk edit for:",b)},S=a.filter(z=>{var J,P,Z;return((J=z.name)==null?void 0:J.toLowerCase().includes(f.toLowerCase()))||((P=z.contact)==null?void 0:P.toLowerCase().includes(f.toLowerCase()))||((Z=z.contractType)==null?void 0:Z.toLowerCase().includes(f.toLowerCase()))}),F=[{key:"name",label:"Nume Furnizor",sortable:!0,render:z=>{var P,Z,se;const J=((P=z.logo)==null?void 0:P.file)||((Z=z.logo)==null?void 0:Z.url);return t("div",{className:"flex items-center space-x-3",children:[J?e("img",{src:J,alt:z.name,className:"w-9 h-9 rounded-full object-cover border-2 border-slate-200 bg-white shadow-md",onError:oe=>{oe.target.style.display="none",oe.target.nextSibling.style.display="flex"}}):null,e("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-purple-500 to-violet-500 flex items-center justify-center text-white font-bold shadow-lg",style:{display:J?"none":"flex"},children:((se=z.name)==null?void 0:se.charAt(0))||"F"}),e("div",{className:"font-bold text-slate-900 dark:text-slate-100 group-hover:text-purple-700 dark:group-hover:text-purple-400 transition-colors",children:z.name})]})}},{key:"company",label:"Companie",sortable:!0,render:z=>e("span",{className:"text-slate-800 font-medium text-base",children:z.company||"N/A"})},{key:"contact",label:"Contact",sortable:!0,render:z=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:z.contact}),e("div",{className:"text-slate-600 font-medium text-base",children:z.phone})]})},{key:"games_count",label:"Nr. Jocuri",sortable:!0,render:z=>{const J=E(z.name);return t("span",{className:"text-slate-800 font-medium text-base",children:[J," jocuri"]})}},{key:"status",label:"Status",sortable:!0,render:z=>{var Z;const J=((Z=z.status)==null?void 0:Z.toLowerCase())||"",P=J==="activ"||J==="active";return e("span",{className:`px-4 py-2 rounded-2xl text-base font-medium shadow-lg ${P?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-green-500/25":"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-red-500/25"}`,children:P?"Activ":"Inactiv"})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:z=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:z.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:z.created_at?new Date(z.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],I=()=>{d(null),p(!0)},x=z=>{d(z),p(!0)},v=async z=>{window.confirm(`Sigur doriți să ștergeți furnizorul "${z.name}"?`)&&await n("providers",z.id)},L=async z=>{m?await l("providers",m.id,z):await r("providers",z),p(!1),d(null)},K=()=>{try{i("providers")}catch(z){console.error("Error exporting to Excel:",z)}},R=()=>{try{o("providers")}catch(z){console.error("Error exporting to PDF:",z)}},C=()=>{console.log("Import functionality to be implemented")};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-wrap items-center gap-3",children:[t("div",{className:"relative flex-1 min-w-[200px] group",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-400 transition-colors",size:18}),e("input",{type:"text",placeholder:"Caută furnizori...",value:f,onChange:z=>T(z.target.value),onKeyDown:z=>{if(z.key==="Tab"&&f.length>0){const J=a.find(P=>{var Z;return(Z=P.name)==null?void 0:Z.toLowerCase().startsWith(f.toLowerCase())});J&&T(J.name)}},className:"input-field pl-12"}),f.length>0&&e("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg z-10 max-h-48 overflow-y-auto",children:a.filter(z=>{var J,P;return((J=z.name)==null?void 0:J.toLowerCase().includes(f.toLowerCase()))||((P=z.contact)==null?void 0:P.toLowerCase().includes(f.toLowerCase()))}).slice(0,5).map((z,J)=>e("button",{onClick:()=>T(z.name),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:z.name},z.id))})]}),t("button",{onClick:C,className:"btn-secondary flex items-center space-x-2",children:[e(ze,{size:16}),e("span",{children:"Importă"})]}),e(ft,{onExportExcel:K,onExportPDF:R,entity:"providers"}),k&&t(De,{children:[t("button",{onClick:D,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:N,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:I,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Furnizor"})]})]})}),e(qe,{data:S,columns:F,loading:c.providers,searchTerm:f,onSearchChange:T,onEdit:x,onDelete:v,onRowClick:z=>{g(z),_(!0)},selectedItems:b,onSelectAll:G,onSelectItem:j,moduleColor:"blue"}),u&&e(no,{item:m,onClose:()=>{p(!1),d(null)},onSave:L}),$&&e(io,{item:O,onClose:()=>{_(!1),g(null)}})]})})},co=({item:a,onClose:s,onSave:r})=>{const{providers:l,platforms:n}=ye(),[i,o]=h.useState({provider:"",name:"",model:"",platform:"",status:"Activ",notes:""});h.useEffect(()=>{a&&o({provider:a.provider||"",name:a.name||"",model:a.model||"",platform:a.platform||"",status:a.status||"Activ",notes:a.notes||""})},[a]);const c=p=>{p.preventDefault(),r(i)},u=p=>{const{name:m,value:d}=p.target;o(f=>({...f,[m]:d}))};return e("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[t("div",{className:"sticky top-0 bg-gradient-to-r from-purple-600 via-purple-700 to-violet-600 text-white px-8 py-6 flex items-center justify-between rounded-t-3xl shadow-lg",children:[e("h2",{className:"text-2xl font-bold flex items-center",children:a?"Editează Cabinet":"Adaugă Cabinet Nou"}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-all duration-200 hover:scale-110",children:e(ve,{size:24})})]}),t("form",{onSubmit:c,className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:i.provider,onChange:u,className:"input-field",required:!0,children:[e("option",{value:"",children:"Selectează furnizor"}),l==null?void 0:l.map(p=>e("option",{value:p.name,children:p.name},p.id))]}),e("p",{className:"text-xs text-slate-500",children:"Furnizorul cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Cabinet *"}),e("input",{type:"text",name:"name",value:i.name,onChange:u,className:"input-field",placeholder:"Ex: Cabinet Premium 01",required:!0}),e("p",{className:"text-xs text-slate-500",children:"Numele cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Model"}),e("input",{type:"text",name:"model",value:i.model,onChange:u,className:"input-field",placeholder:"Ex: Deluxe 2024"}),e("p",{className:"text-xs text-slate-500",children:"Modelul cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Platformă *"}),t("select",{name:"platform",value:i.platform,onChange:u,className:"input-field",required:!0,children:[e("option",{value:"",children:"Selectează platformă"}),n==null?void 0:n.map(p=>e("option",{value:p.name,children:p.name},p.id))]}),e("p",{className:"text-xs text-slate-500",children:"Platforma tehnică a cabinetului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status *"}),t("select",{name:"status",value:i.status,onChange:u,className:"input-field",required:!0,children:[e("option",{value:"Activ",children:"Activ"}),e("option",{value:"Inactiv",children:"Inactiv"}),e("option",{value:"Mentenanță",children:"Mentenanță"})]}),e("p",{className:"text-xs text-slate-500",children:"Statusul actual"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note Adiționale"}),e("textarea",{name:"notes",value:i.notes,onChange:u,className:"input-field min-h-[100px] resize-none",placeholder:"Informații suplimentare despre cabinet..."}),e("p",{className:"text-xs text-slate-500",children:"Observații și detalii adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary px-8",children:"Anulează"}),e("button",{type:"submit",className:"btn-primary px-8",children:a?"Actualizează Cabinet":"Adaugă Cabinet"})]})]})]})})},mo=({item:a,onClose:s})=>{var r,l;return a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e(ct,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name||a.model}),e("p",{className:"text-cyan-100",children:"Detalii Cabinet"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Furnizor"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.provider_name||a.provider||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ct,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Model"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.model||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(jt,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Platformă"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.platform_name||a.platform||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-cyan-600 dark:text-cyan-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Status"})]}),e("span",{className:`inline-flex px-4 py-2 rounded-full text-sm font-semibold ${((r=a.status)==null?void 0:r.toLowerCase())==="activ"||((l=a.status)==null?void 0:l.toLowerCase())==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:a.status||"N/A"})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null},Ds=({item:a,onClose:s,onSave:r})=>{const{providers:l}=ye(),[n,i]=h.useState({name:"",serial_numbers:"",provider_id:"",avatar_url:"",avatar_file:"",status:"Active",notes:""}),[o,c]=h.useState(null);h.useEffect(()=>{a&&(i({name:a.name||"",serial_numbers:a.serial_numbers||"",provider_id:a.provider_id||"",avatar_url:a.avatar_url||"",avatar_file:a.avatar_file||"",status:a.status||"Active",notes:a.notes||""}),a.avatar_url?c(a.avatar_url):a.avatar_file&&a.avatar_file!=="{}"?c(a.avatar_file):c(null))},[a]);const u=f=>{f.preventDefault(),r(n)},p=f=>{const{name:T,value:b}=f.target;i(y=>({...y,[T]:b}))},m=f=>{const T=f.target.files[0];if(T){const b=new FileReader;b.onload=y=>{const k=y.target.result;i(A=>({...A,avatar_file:k,avatar_url:""})),c(k)},b.readAsDataURL(T)}},d=f=>{i(T=>({...T,avatar_url:f.target.value,avatar_file:""})),f.target.value?c(f.target.value):c(null)};return e("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t("div",{className:"bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[t("div",{className:"sticky top-0 bg-gradient-to-r from-teal-600 via-cyan-600 to-blue-600 text-white px-8 py-6 flex items-center justify-between rounded-t-3xl shadow-lg",children:[e("h2",{className:"text-2xl font-bold flex items-center",children:a?"Editează Platformă":"Adaugă Platformă Nouă"}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-all duration-200 hover:scale-110",children:e(ve,{size:24})})]}),t("form",{onSubmit:u,className:"p-6",children:[t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Platformă *"}),e("input",{type:"text",name:"name",value:n.name,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",placeholder:"Ex: Android 10 Pro",required:!0})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor"}),t("select",{name:"provider_id",value:n.provider_id,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",children:[e("option",{value:"",children:"Selectează furnizor"}),l.map(f=>e("option",{value:f.id,children:f.name},f.id))]})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Avatar Platformă"}),t("div",{className:"space-y-3",children:[o&&e("div",{className:"flex justify-center",children:e("img",{src:o,alt:"Preview",className:"w-20 h-20 rounded-xl object-cover border-2 border-slate-200 shadow-sm"})}),e("input",{type:"url",name:"avatar_url",value:n.avatar_url,onChange:d,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",placeholder:"https://example.com/avatar.png"}),e("div",{className:"relative",children:e("input",{type:"file",name:"avatar_file",onChange:m,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100",accept:"image/*"})})]})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:n.status,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm",required:!0,children:[e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"})]})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:n.notes,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm resize-none",placeholder:"Informații adiționale despre platformă...",rows:3})]})]}),t("div",{className:"mt-6 space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numere Seriale *"}),e("textarea",{name:"serial_numbers",value:n.serial_numbers,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm text-sm resize-none",placeholder:`Introdu numerele seriale, separate prin virgulă sau pe rânduri diferite:
SN001, SN002, SN003
sau:
SN001
SN002
SN003`,rows:4,required:!0}),t("div",{className:"flex items-center space-x-2 text-xs text-slate-500",children:[e("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-50 text-blue-700",children:"💡 Exemplu: SN12345, SN12346, SN12347"}),e("span",{children:"sau pe rânduri separate"})]})]}),t("div",{className:"flex justify-end space-x-3 pt-4 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-2.5 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-xl transition-all duration-200 font-medium",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl hover:from-cyan-600 hover:to-blue-600 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:a?"Actualizează":"Adaugă Platformă"})]})]})]})})},uo=({locationId:a,locationName:s,hideSearchAndAdd:r=!1})=>{const{platforms:l,createItem:n,updateItem:i,deleteItem:o}=ye(),[c,u]=h.useState(!1),[p,m]=h.useState(null),[d,f]=h.useState(""),T=l.filter(E=>{var G,j,N,D;return((G=E.name)==null?void 0:G.toLowerCase().includes(d.toLowerCase()))||((j=E.type)==null?void 0:j.toLowerCase().includes(d.toLowerCase()))||((N=E.status)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))||((D=E.description)==null?void 0:D.toLowerCase().includes(d.toLowerCase()))}),b=()=>{m(null),u(!0)},y=E=>{console.log("View platform:",E)},k=E=>{m(E),u(!0)},A=async E=>{if(window.confirm(`Sigur doriți să ștergeți platforma "${E.name}"?`))try{await o("platforms",E.id)}catch(G){console.error("Error deleting platform:",G)}},O=async E=>{try{p?await i("platforms",p.id,E):await n("platforms",E),u(!1),m(null)}catch(G){console.error("Error saving platform:",G)}},g=E=>{switch(E){case"Gaming":return"bg-purple-100 text-purple-800";case"Server":return"bg-blue-100 text-blue-800";case"Workstation":return"bg-green-100 text-green-800";case"Terminal":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},$=E=>{switch(E){case"Active":return"bg-green-100 text-green-800";case"Inactive":return"bg-red-100 text-red-800";case"Maintenance":return"bg-yellow-100 text-yellow-800";case"Offline":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},_=E=>{switch(E){case"Gaming":return e(jt,{className:"w-6 h-6 text-white"});case"Server":return e(Ma,{className:"w-6 h-6 text-white"});case"Workstation":return e(Ur,{className:"w-6 h-6 text-white"});case"Terminal":return e(jt,{className:"w-6 h-6 text-white"});default:return e(jt,{className:"w-6 h-6 text-white"})}};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Platforme"}),e("p",{className:"text-slate-600",children:a?`Gestionează platformele pentru ${s}`:"Toate platformele din sistem"})]}),!r&&t("button",{onClick:b,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Platformă"})]})]}),!r&&t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută platforme...",value:d,onChange:E=>f(E.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),T.length>0?e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(E=>t("div",{className:"card p-6 hover:shadow-lg transition-all duration-200 group",children:[t("div",{className:"flex items-start justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-xl",children:_(E.type)}),t("div",{children:[e("h3",{className:"font-bold text-slate-800 group-hover:text-purple-700 transition-colors",children:E.name}),e("p",{className:"text-slate-600 text-sm",children:E.type})]})]}),t("div",{className:"flex space-x-1",children:[e("button",{onClick:()=>y(E),className:"p-2 text-slate-400 hover:text-blue-500 transition-colors",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>k(E),className:"p-2 text-slate-400 hover:text-green-500 transition-colors",children:e(tt,{className:"w-4 h-4"})}),e("button",{onClick:()=>A(E),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:e(Fe,{className:"w-4 h-4"})})]})]}),t("div",{className:"space-y-3",children:[t("div",{className:"space-y-2",children:[E.description&&e("div",{className:"text-sm text-slate-600",children:E.description}),E.specifications&&t("div",{className:"text-xs text-slate-500",children:[e("strong",{children:"Specs:"})," ",E.specifications]}),E.location&&t("div",{className:"text-xs text-slate-500",children:[e("strong",{children:"Locație:"})," ",E.location]})]}),t("div",{className:"flex space-x-2",children:[e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${g(E.type)}`,children:E.type}),e("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${$(E.status)}`,children:E.status==="Active"?"Activ":E.status==="Inactive"?"Inactiv":E.status==="Maintenance"?"În mentenanță":E.status==="Offline"?"Offline":E.status})]}),E.notes&&e("div",{className:"text-sm text-slate-600 bg-slate-50 p-2 rounded-lg",children:E.notes})]})]},E.id))}):t("div",{className:"card p-12 text-center",children:[e("div",{className:"p-6 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-3xl inline-block mb-6",children:e(jt,{className:"w-16 h-16 text-purple-500 mx-auto"})}),e("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Nu există platforme"}),e("p",{className:"text-slate-600 mb-6",children:a?"Adaugă prima platformă pentru această locație":"Nu există platforme în sistem"}),!r&&t("button",{onClick:b,className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(Ie,{size:18}),e("span",{children:"Adaugă Platformă"})]})]}),c&&e(Ds,{item:p,onClose:()=>{u(!1),m(null)},onSave:O})]})},ho=()=>{const{cabinets:a,platforms:s,providers:r,createItem:l,updateItem:n,deleteItem:i,exportData:o,loading:c}=ye(),[u,p]=h.useState(!1),[m,d]=h.useState(!1),[f,T]=h.useState(null),[b,y]=h.useState(""),[k,A]=h.useState([]),[O,g]=h.useState(!1),[$,_]=h.useState(!1),[E,G]=h.useState(null),[j,N]=h.useState(!1),[D,S]=h.useState(""),[F,I]=h.useState(""),[x,v]=h.useState(!0),[L,K]=h.useState(!1);h.useEffect(()=>{g(k.length>0)},[k]);const R=Q=>{A(Q?Oe.map(ce=>ce.id):[])},C=(Q,ce)=>{A(ce?[...k,Q]:k.filter(ue=>ue!==Q))},z=async()=>{k.length!==0&&_(!0)},J=async()=>{_(!1);const Q=k.length;let ce=0,ue=0;try{const pe=U.loading(`Șterg ${Q} elemente...`,{duration:1/0}),Te=5;for(let ee=0;ee<k.length;ee+=Te){const fe=k.slice(ee,ee+Te).map(async le=>{try{await i("cabinets",le,!0),ce++}catch(be){ue++,console.error(`Error deleting cabinet ${le}:`,be)}});await Promise.all(fe);const ne=Math.min(ee+Te,Q);U.loading(`Șterg ${Q} elemente... (${ne}/${Q})`,{id:pe})}U.dismiss(pe),ue===0?U.success(`✅ ${ce} elemente șterse cu succes!`,{duration:5e3}):ce>0?U.success(`⚠️ ${ce} elemente șterse, ${ue} erori`,{duration:5e3}):U.error(`❌ Eroare la ștergerea tuturor ${Q} elemente`,{duration:5e3}),A([]),g(!1)}catch(pe){console.error("Error bulk deleting:",pe),U.error("Eroare la ștergerea elementelor!"),_(!1)}},P=()=>{k.length!==0&&console.log("Bulk edit for:",k)},Z=()=>{y(""),S(""),I(""),v(!0)},se=()=>[...new Set(a.map(Q=>Q.provider).filter(Boolean))],oe=()=>[...new Set(a.map(Q=>Q.platform).filter(Boolean))],[de,Se]=h.useState("cabinets"),Oe=a.filter(Q=>{var me,fe,ne,le,be,te;const ce=((me=Q.name)==null?void 0:me.toLowerCase().includes(b.toLowerCase()))||((fe=Q.provider)==null?void 0:fe.toLowerCase().includes(b.toLowerCase()))||((ne=Q.model)==null?void 0:ne.toLowerCase().includes(b.toLowerCase()))||((le=Q.platform)==null?void 0:le.toLowerCase().includes(b.toLowerCase())),ue=!D||Q.provider===D,pe=!F||Q.platform===F,Te=((be=Q.status)==null?void 0:be.toLowerCase())==="activ"||((te=Q.status)==null?void 0:te.toLowerCase())==="active";return ce&&ue&&pe&&(x||Te)});s!=null&&s.filter(Q=>{var ce,ue;return((ce=Q.name)==null?void 0:ce.toLowerCase().includes(b.toLowerCase()))||((ue=Q.serial_numbers)==null?void 0:ue.toLowerCase().includes(b.toLowerCase()))});const Ue=[{key:"name",label:"Nume Cabinet",sortable:!0,render:Q=>t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white font-bold shadow-lg",children:e(ct,{className:"w-4 h-4 text-white"})}),e("div",{className:"font-bold text-slate-900",children:Q.name})]})},{key:"provider",label:"Furnizor",sortable:!0,render:Q=>{var pe;const ue=(Te=>{if(Te.provider_logo)try{const ee=typeof Te.provider_logo=="string"?JSON.parse(Te.provider_logo):Te.provider_logo;return ee.file||ee.url||ee}catch{return Te.provider_logo}return null})(Q);return t("div",{className:"flex items-center space-x-3",children:[ue?e("img",{src:ue,alt:Q.provider_name||Q.provider,className:"w-8 h-8 rounded-full object-cover border-2 border-slate-200 bg-white shadow-md",onError:Te=>{Te.target.style.display="none",Te.target.nextSibling.style.display="flex"}}):null,e("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-violet-500 flex items-center justify-center text-white font-bold shadow-lg",style:{display:ue?"none":"flex"},children:((pe=Q.provider_name||Q.provider)==null?void 0:pe.charAt(0))||"F"}),e("span",{className:"text-slate-800 font-medium text-base",children:Q.provider_name||Q.provider||"N/A"})]})}},{key:"model",label:"Model",sortable:!0},{key:"platform",label:"Platformă",sortable:!0,render:Q=>{const ue=(pe=>pe.platform_avatar_url&&pe.platform_avatar_url.trim()!==""?pe.platform_avatar_url:pe.platform_avatar_file&&pe.platform_avatar_file!=="{}"&&pe.platform_avatar_file.trim()!==""?pe.platform_avatar_file:null)(Q);return t("div",{className:"flex items-center space-x-3",children:[ue?e("img",{src:ue,alt:Q.platform_name||Q.platform,className:"w-[60px] h-[30px] object-contain",onError:pe=>{pe.target.style.display="none",pe.target.nextSibling.style.display="flex"}}):null,e("div",{className:`w-[60px] h-[30px] rounded flex items-center justify-center text-white font-bold shadow-sm ${ue?"bg-white border border-slate-200":"bg-gradient-to-br from-cyan-500 to-blue-500"}`,style:{display:ue?"none":"flex"},children:e(jt,{className:`w-5 h-5 ${ue?"text-slate-600":"text-white"}`})}),e("span",{className:"text-slate-800 font-medium text-base",children:Q.platform_name||Q.platform||"N/A"})]})}},{key:"status",label:"Status",sortable:!0,render:Q=>{var ue,pe;const ce=((ue=Q.status)==null?void 0:ue.toLowerCase())==="activ"||((pe=Q.status)==null?void 0:pe.toLowerCase())==="active";return e("span",{className:`px-4 py-2 rounded-2xl text-base font-medium shadow-lg ${ce?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-green-500/25":"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-red-500/25"}`,children:ce?"Activ":"Inactiv"})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:Q=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:Q.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:Q.created_at?new Date(Q.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];h.useState({});const Ze=()=>{T(null),p(!0)},$e=()=>{T(null),d(!0)},rt=Q=>{T(Q),de==="cabinets"?p(!0):d(!0)},Be=async Q=>{const ce=de==="cabinets"?"cabinets":"platforms";f?await n(ce,f.id,Q):await l(ce,Q),p(!1),d(!1)},Ye=async Q=>{const ce=de==="cabinets"?"cabinets":"platforms",ue=typeof Q=="object"?Q.id:Q;window.confirm(`Sigur vrei să ștergi acest ${de==="cabinets"?"cabinet":"platformă"}?`)&&await i(ce,ue)};return t(he,{children:[t("div",{className:"space-y-6",children:[e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 bg-slate-100 rounded-xl p-1",children:[e("button",{onClick:()=>{Se("cabinets"),y("")},className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${de==="cabinets"?"bg-gradient-to-r from-purple-500 to-violet-500 text-white shadow-lg shadow-purple-500/25 scale-105":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ct,{size:20}),e("span",{children:"CABINETE"}),e("span",{className:`px-2 py-1 rounded-full text-xs ${de==="cabinets"?"bg-white/20":"bg-slate-200 text-slate-700"}`,children:a.length})]})}),e("button",{onClick:()=>{Se("platforms"),y("")},className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${de==="platforms"?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/25 scale-105":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(jt,{size:20}),e("span",{children:"PLATFORME"}),e("span",{className:`px-2 py-1 rounded-full text-xs ${de==="platforms"?"bg-white/20":"bg-slate-200 text-slate-700"}`,children:(s==null?void 0:s.length)||0})]})})]})}),e("div",{className:"card p-6",children:t("div",{className:"space-y-4",children:[t("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e("div",{className:"flex-1 max-w-md",children:t("div",{className:"relative",children:[e(Ge,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400",size:20}),e("input",{type:"text",placeholder:`Caută ${de==="cabinets"?"cabinete":"platforme"}...`,value:b,onChange:Q=>y(Q.target.value),onKeyDown:Q=>{if(Q.key==="Tab"&&b.length>0)if(de==="cabinets"){const ce=a.find(ue=>{var pe,Te;return((pe=ue.name)==null?void 0:pe.toLowerCase().startsWith(b.toLowerCase()))||((Te=ue.provider)==null?void 0:Te.toLowerCase().startsWith(b.toLowerCase()))});ce&&y(ce.name||ce.provider)}else{const ce=s==null?void 0:s.find(ue=>{var pe;return(pe=ue.name)==null?void 0:pe.toLowerCase().startsWith(b.toLowerCase())});ce&&y(ce.name)}},className:"input-field pl-12"}),b.length>0&&e("div",{className:"absolute top-full left-0 right-0 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg z-10 max-h-48 overflow-y-auto",children:de==="cabinets"?e(De,{children:a.filter(Q=>{var ce,ue;return((ce=Q.name)==null?void 0:ce.toLowerCase().includes(b.toLowerCase()))||((ue=Q.provider)==null?void 0:ue.toLowerCase().includes(b.toLowerCase()))}).slice(0,5).map((Q,ce)=>e("button",{onClick:()=>y(Q.name||Q.provider),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:Q.name||Q.provider},Q.id))}):e(De,{children:s==null?void 0:s.filter(Q=>{var ce;return(ce=Q.name)==null?void 0:ce.toLowerCase().includes(b.toLowerCase())}).slice(0,5).map((Q,ce)=>e("button",{onClick:()=>y(Q.name),className:"w-full px-4 py-2 text-left hover:bg-slate-50 dark:hover:bg-slate-600 text-sm text-slate-700 dark:text-slate-300 border-b border-slate-200 dark:border-slate-600 last:border-b-0",children:Q.name},Q.id))})})]})}),t("div",{className:"flex gap-3",children:[t("button",{onClick:()=>K(!L),className:`btn-secondary flex items-center space-x-2 ${L?"bg-blue-500 text-white":""}`,children:[e(Xt,{size:18}),e("span",{children:"Filtre"})]}),t("button",{onClick:()=>o(de==="cabinets"?"cabinets":"platforms"),className:"btn-secondary flex items-center space-x-2",children:[e(Je,{size:18}),e("span",{className:"hidden sm:inline",children:"Export"})]}),O&&de==="cabinets"&&t(De,{children:[t("button",{onClick:z,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Fe,{className:"w-4 h-4"}),t("span",{children:["Șterge (",k.length,")"]})]}),t("button",{onClick:P,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]})]}),t("button",{onClick:de==="cabinets"?Ze:$e,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{size:18}),e("span",{children:de==="cabinets"?"Adaugă Cabinet":"Adaugă Platformă"})]})]})]}),L&&de==="cabinets"&&e("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Furnizor"}),t("select",{value:D,onChange:Q=>S(Q.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e("option",{value:"",children:"Toate furnizorii"}),se().map(Q=>e("option",{value:Q,children:Q},Q))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Platformă"}),t("select",{value:F,onChange:Q=>I(Q.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e("option",{value:"",children:"Toate platformele"}),oe().map(Q=>e("option",{value:Q,children:Q},Q))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Status"}),e("div",{className:"flex items-center space-x-3",children:t("button",{onClick:()=>v(!x),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ${x?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200"}`,children:[x?e(Qe,{className:"w-4 h-4"}):e(Xa,{className:"w-4 h-4"}),e("span",{className:"font-medium",children:x?"Arată toate":"Doar active"})]})})]}),e("div",{className:"flex items-end",children:t("button",{onClick:Z,className:"w-full px-4 py-2 bg-slate-200 dark:bg-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors flex items-center justify-center space-x-2",children:[e(ve,{className:"w-4 h-4"}),e("span",{children:"Resetează"})]})})]})})]})}),de==="cabinets"?t("div",{className:"card p-6",children:[t("div",{className:"mb-4 flex items-center justify-between",children:[t("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Afișez ",Oe.length," din ",a.length," cabinete",!x&&e("span",{className:"ml-2 px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 rounded-full text-xs",children:"Doar active"})]}),(D||F||b)&&e("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Filtre active"})]}),e(qe,{data:Oe,columns:Ue,onEdit:rt,onDelete:Ye,onRowClick:Q=>{G(Q),N(!0)},loading:c,selectedItems:k,onSelectAll:R,onSelectItem:C,moduleColor:"blue"})]}):e(uo,{locationId:null,locationName:"Toate Platformele",hideSearchAndAdd:!0})]}),u&&e(co,{item:f,onClose:()=>p(!1),onSave:Be}),m&&e(Ds,{item:f,onClose:()=>d(!1),onSave:Be}),j&&e(mo,{item:E,onClose:()=>{N(!1),G(null)}}),$&&e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:t("div",{className:"p-6",children:[t("div",{className:"flex items-center space-x-4 mb-4",children:[e("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 rounded-full",children:e(Fe,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:["Șterge ",k.length," Elemente"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",k.length," elemente selectate? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:J,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",k.length," Elemente"]})]})]})})})]})},po=({item:a,onClose:s,onSave:r})=>{const{providers:l}=ye(),[n,i]=h.useState({name:"",provider:"",games:"",rtp:"",denomination:.01,max_bet:"",gaming_places:1,status:"Active",notes:""});h.useEffect(()=>{if(a){let p="";try{if(typeof a.games=="string"){const m=JSON.parse(a.games);p=Array.isArray(m)?m.join(`
`):""}else Array.isArray(a.games)&&(p=a.games.join(`
`))}catch(m){console.error("Error parsing games:",m),p=""}i({name:a.name||"",provider:a.provider||"",games:p,rtp:a.rtp||"",denomination:a.denomination||.01,max_bet:a.max_bet||"",gaming_places:a.gaming_places||1,status:a.status||"Active",notes:a.notes||""})}},[a]);const o=p=>{const{name:m,value:d}=p.target;i(f=>({...f,[m]:d}))},c=()=>n.games.trim()?n.games.split(`
`).filter(p=>p.trim()).length:0;return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-indigo-800 to-blue-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 to-blue-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl shadow-lg",children:e($t,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Game Mix":"Adaugă Game Mix"}),e("p",{className:"text-indigo-100 text-sm font-medium",children:"Completează informațiile despre game mix"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:p=>{p.preventDefault();const m=n.games.split(`
`).map(f=>f.trim()).filter(f=>f.length>0),d={...n,games:m,rtp:n.rtp?parseFloat(n.rtp):null,denomination:n.denomination?parseFloat(n.denomination):.01,max_bet:n.max_bet?parseFloat(n.max_bet):null,gaming_places:n.gaming_places?parseInt(n.gaming_places):1};console.log("🎮 GameMix submitData:",d),r(d)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Nume Game Mix *"}),e("input",{type:"text",name:"name",value:n.name,onChange:o,className:"input-field",placeholder:"ex: Mix Clasice Novomatic",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Furnizor"}),t("select",{name:"provider",value:n.provider,onChange:o,className:"input-field",children:[e("option",{value:"",children:"Selectează furnizor"}),l==null?void 0:l.map(p=>e("option",{value:p.name,children:p.name},p.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"RTP (%)"}),e("input",{type:"number",step:"0.01",name:"rtp",value:n.rtp,onChange:o,className:"input-field",placeholder:"ex: 96.5"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Status *"}),t("select",{name:"status",value:n.status,onChange:o,className:"input-field",required:!0,children:[e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Jocuri în Mix"}),t("div",{className:"flex items-center space-x-3 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200",children:[e("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white font-bold shadow-lg",children:c()}),t("div",{children:[t("div",{className:"font-bold text-slate-900",children:[c()," jocuri"]}),e("div",{className:"text-sm text-slate-500",children:"în acest mix"})]})]})]})]}),e("div",{className:"space-y-4",children:t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Jocuri în Mix"}),e("textarea",{name:"games",value:n.games,onChange:o,className:"input-field",rows:6,placeholder:`Introdu numele jocurilor, separate pe rânduri diferite:
Book of Ra
Sizzling Hot
Lucky Lady Charm
Dolphins Pearl`}),t("div",{className:"flex items-center space-x-2 text-xs text-slate-500",children:[e("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-green-50 text-green-700",children:"💡 Exemplu: Un joc pe fiecare rând"}),e("span",{className:"text-slate-400",children:"•"}),t("span",{children:[c()," jocuri adăugate"]})]})]})}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Configurație Tehnică"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Denomination"}),e("input",{type:"number",step:"0.01",name:"denomination",value:n.denomination,onChange:o,className:"input-field",placeholder:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Max Bet"}),e("input",{type:"number",step:"0.01",name:"max_bet",value:n.max_bet,onChange:o,className:"input-field",placeholder:"100.00"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Gaming Places"}),e("input",{type:"number",name:"gaming_places",value:n.gaming_places,onChange:o,className:"input-field",placeholder:"1"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:n.notes,onChange:o,className:"input-field",rows:3,placeholder:"Note adiționale despre acest game mix..."})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e($t,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Game Mix"]})]})]})]})})]})})},xo=({item:a,onClose:s})=>a?e("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-orange-600 to-amber-600 p-6 rounded-t-2xl sticky top-0 z-10",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e($t,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white",children:a.name}),e("p",{className:"text-orange-100",children:"Detalii Game Mix"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-8 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(_e,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Furnizor"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.provider||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(ct,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Cabinet"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.cabinet||"N/A"})]}),a.version&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(At,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Versiune"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white font-mono",children:a.version})]}),a.gaming_places&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(At,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Gaming Places"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.gaming_places})]})]}),(a.created_by||a.created_at)&&t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl border border-blue-200 dark:border-blue-800",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-600 p-6 rounded-xl",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})]})]}),e("div",{className:"bg-slate-50 dark:bg-slate-900 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-xl hover:from-slate-700 hover:to-slate-800 transition-all shadow-lg",children:"Închide"})})]})}):null,bo=()=>{const a=He();ye();const[s,r]=h.useState([]),[l,n]=h.useState(!1),[i,o]=h.useState(""),[c,u]=h.useState(""),[p,m]=h.useState(""),[d,f]=h.useState(""),[T,b]=h.useState("grid"),[y,k]=h.useState("name"),A=[{game_id:"00000004-0000-5000-9000-000000000001",name:"10 Burning Heart",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"fruits",volatility:"low - medium",lines:10,layout:"5x3",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000001.png"},{game_id:"00000004-0000-5000-9000-000000000002",name:"100 Burning Hot",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"fruits",volatility:"medium",lines:100,layout:"5x4",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000002.png"},{game_id:"00000004-0000-5000-9000-000000000003",name:"100 Cats",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"animals and nature and wildlife",volatility:"low - medium",lines:100,layout:"5x4",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000003.png"},{game_id:"00000004-0000-5000-9000-000000000005",name:"2 Dragons",provider:"Amusnet",provider_id:"00000005-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"video slot",mechanic:"rng",theme:"dragons and mythical creatures;asian cultures;oriental and asian prosperity",volatility:"high",lines:20,layout:"5x3",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000005.png"},{game_id:"00000004-0000-5000-9000-000000000099",name:"Mini Burning Hot",provider:"Egypt Quest",provider_id:"00000555-dc86-47af-8013-c46b4c5105af",category:"Slots",type:"slots",product:"Casino",classification:"n/a",mechanic:"n/a",theme:"n/a",volatility:"n/a",lines:5,layout:"n/a",image_url:"https://cdn.cashpot.ro/cashpot/t1/thumbnail_games/00000004-0000-5000-9000-000000000099.png"}];h.useEffect(()=>{O()},[]);const O=async()=>{n(!0);try{const S=await fetch("/api/games");if(!S.ok)throw new Error("Failed to load games");const F=await S.json();r(F)}catch(S){console.error("Error loading games:",S),r(A)}finally{n(!1)}},g=[...new Set(s.map(S=>S.provider))],$=[...new Set(s.map(S=>S.volatility).filter(S=>S&&S!=="n/a"))];[...new Set(s.map(S=>S.theme).filter(S=>S&&S!=="n/a"))];const _=s.filter(S=>{const F=S.name.toLowerCase().includes(i.toLowerCase()),I=!c||S.provider===c,x=!p||S.volatility===p,v=!d||S.theme.includes(d);return F&&I&&x&&v}),E=[..._].sort((S,F)=>{switch(y){case"provider":return S.provider.localeCompare(F.provider);case"volatility":const I={low:1,"low - medium":2,medium:3,high:4};return(I[S.volatility]||5)-(I[F.volatility]||5);default:return S.name.localeCompare(F.name)}}),G=S=>{switch(S){case"low":return"bg-green-100 text-green-800";case"low - medium":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=S=>{switch(S){case"low":return e(dt,{className:"w-3 h-3"});case"low - medium":return e(sa,{className:"w-3 h-3"});case"medium":return e(Gr,{className:"w-3 h-3"});case"high":return e(sa,{className:"w-3 h-3"});default:return e(dt,{className:"w-3 h-3"})}};return t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(ct,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Biblioteca Jocuri"}),e("p",{className:"text-slate-600",children:"Toate jocurile disponibile de la toți furnizorii"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>{console.log("Export games library")},className:"btn-secondary flex items-center space-x-2",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Exportă"})]}),t("button",{onClick:()=>{console.log("Import games from Google Sheets")},className:"btn-primary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă din Sheets"})]})]})]})}),t("div",{className:"card p-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t("div",{className:"lg:col-span-2 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută jocuri...",value:i,onChange:S=>o(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),t("select",{value:c,onChange:S=>u(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"",children:"Toți furnizorii"}),g.map(S=>e("option",{value:S,children:S},S))]}),t("select",{value:p,onChange:S=>m(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"",children:"Toate volatilitățile"}),$.map(S=>e("option",{value:S,children:S},S))]}),t("select",{value:y,onChange:S=>k(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"name",children:"Sortare: Nume"}),e("option",{value:"provider",children:"Sortare: Furnizor"}),e("option",{value:"volatility",children:"Sortare: Volatilitate"})]})]}),t("div",{className:"flex items-center justify-between mt-4",children:[e("div",{className:"flex items-center space-x-2",children:t("span",{className:"text-sm text-slate-600",children:[_.length," jocuri din ",s.length," total"]})}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>b("grid"),className:`p-2 rounded-lg transition-colors ${T==="grid"?"bg-purple-100 text-purple-600":"text-slate-400 hover:text-slate-600"}`,children:e(qs,{className:"w-4 h-4"})}),e("button",{onClick:()=>b("list"),className:`p-2 rounded-lg transition-colors ${T==="list"?"bg-purple-100 text-purple-600":"text-slate-400 hover:text-slate-600"}`,children:e(Js,{className:"w-4 h-4"})})]})]})]}),e("div",{className:"card p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):_.length===0?t("div",{className:"text-center py-12",children:[e(ct,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există jocuri"}),e("p",{className:"text-slate-500",children:"Importă jocurile din Google Sheets pentru a începe"})]}):e("div",{className:T==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4":"space-y-4",children:E.map(S=>T==="grid"?e("div",{className:"group cursor-pointer",onClick:()=>a(`/games/${S.game_id}`),children:t("div",{className:"bg-white rounded-xl border border-slate-200 p-3 hover:shadow-lg transition-all duration-200 hover:scale-105",children:[t("div",{className:"w-full h-64 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-lg mb-3 overflow-hidden flex items-center justify-center",children:[e("img",{src:S.image_url,alt:S.name,className:"max-w-full max-h-full object-contain group-hover:scale-105 transition-transform duration-300",style:{imageRendering:"crisp-edges"},onError:F=>{F.target.style.display="none",F.target.nextSibling.style.display="flex"}}),e("div",{className:"w-full h-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",style:{display:"none"},children:e(ct,{className:"w-8 h-8 text-purple-400"})})]}),t("div",{className:"space-y-2",children:[e("h3",{className:"font-semibold text-slate-800 text-sm line-clamp-2 group-hover:text-purple-600 transition-colors",children:S.name}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded-full",children:S.provider}),S.volatility&&S.volatility!=="n/a"&&t("span",{className:`text-xs px-2 py-1 rounded-full flex items-center space-x-1 ${G(S.volatility)}`,children:[j(S.volatility),e("span",{children:S.volatility})]})]}),S.lines&&S.lines!=="n/a"&&t("div",{className:"text-xs text-slate-500",children:[S.lines," linii • ",S.layout]})]})]})},S.game_id):t("div",{className:"flex items-center space-x-4 p-4 bg-white rounded-xl border border-slate-200 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>a(`/games/${S.game_id}`),children:[t("div",{className:"w-20 h-20 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-lg overflow-hidden flex-shrink-0 flex items-center justify-center",children:[e("img",{src:S.image_url,alt:S.name,className:"max-w-full max-h-full object-contain",style:{imageRendering:"crisp-edges"},onError:F=>{F.target.style.display="none",F.target.nextSibling.style.display="flex"}}),e("div",{className:"w-full h-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",style:{display:"none"},children:e(ct,{className:"w-6 h-6 text-purple-400"})})]}),t("div",{className:"flex-1 min-w-0",children:[e("h3",{className:"font-semibold text-slate-800 group-hover:text-purple-600 transition-colors",children:S.name}),e("p",{className:"text-sm text-slate-500 truncate",children:S.theme}),t("div",{className:"flex items-center space-x-2 mt-1",children:[e("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded-full",children:S.provider}),S.volatility&&S.volatility!=="n/a"&&t("span",{className:`text-xs px-2 py-1 rounded-full flex items-center space-x-1 ${G(S.volatility)}`,children:[j(S.volatility),e("span",{children:S.volatility})]}),S.lines&&S.lines!=="n/a"&&t("span",{className:"text-xs text-slate-500",children:[S.lines," linii"]})]})]}),e("button",{onClick:F=>{F.stopPropagation(),a(`/games/${S.game_id}`)},className:"p-2 text-slate-400 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:e(Qe,{className:"w-4 h-4"})})]},S.game_id))})})]})},go=()=>{const{gameMixes:a,createItem:s,updateItem:r,deleteItem:l,refreshData:n}=ye(),[i,o]=h.useState("mixes"),[c,u]=h.useState(!1),[p,m]=h.useState(null),[d,f]=h.useState(""),[T,b]=h.useState("all"),[y,k]=h.useState([]),[A,O]=h.useState(!1),[g,$]=h.useState(null),[_,E]=h.useState(!1);h.useEffect(()=>{O(y.length>0)},[y]);const G=()=>{m(null),u(!0)},j=R=>{m(R),u(!0)},N=()=>{u(!1),m(null)},D=async R=>{try{console.log("🎮 GameMixes handleSave:",{selectedItem:p,formData:R}),p?(console.log("🎮 Updating game mix:",p.id,R),await r("gameMixes",p.id,R)):(console.log("🎮 Creating game mix:",R),await s("gameMixes",R)),await n(),N()}catch(C){console.error("Error saving game mix:",C)}},S=async R=>{if(window.confirm("Ești sigur că vrei să ștergi acest game mix?"))try{await l("gameMixes",R)}catch(C){console.error("Error deleting game mix:",C)}},F=R=>{k(R?L.map(C=>C.id):[])},I=(R,C)=>{k(C?[...y,R]:y.filter(z=>z!==R))},x=async()=>{if(y.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${y.length} game mix-uri?`))try{for(const R of y)await l("gameMixes",R);k([]),O(!1)}catch(R){console.error("Error bulk deleting game mixes:",R)}},v=()=>{y.length!==0&&console.log("Bulk edit for:",y)},L=a.filter(R=>{var J,P;const C=((J=R.name)==null?void 0:J.toLowerCase().includes(d.toLowerCase()))||((P=R.provider)==null?void 0:P.toLowerCase().includes(d.toLowerCase())),z=T==="all"||R.status===T;return C&&z}),K=[{key:"name",label:"Nume Game Mix",sortable:!0,render:R=>t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-red-500 to-pink-500 flex items-center justify-center text-white font-bold shadow-lg",children:e($t,{className:"w-5 h-5"})}),t("div",{children:[e("div",{className:"font-bold text-slate-900",children:R.name}),t("div",{className:"text-sm text-slate-500",children:["ID: ",R.id]})]})]})},{key:"provider",label:"Furnizor",sortable:!0,render:R=>e("span",{className:"bg-gradient-to-r from-purple-100 to-violet-100 text-purple-800 px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm",children:R.provider||"N/A"})},{key:"games",label:"Jocuri",render:R=>{const C=typeof R.games=="string"?JSON.parse(R.games):R.games,z=Array.isArray(C)?C.length:0;return t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white font-bold shadow-lg",children:z}),t("span",{className:"text-sm font-medium text-slate-700",children:[z," jocuri"]})]})}},{key:"status",label:"Status",sortable:!0,render:R=>{var J;const C=((J=R.status)==null?void 0:J.toLowerCase())||"";return e("span",{className:`px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ${C==="activ"||C==="active"?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800":"bg-gradient-to-r from-red-100 to-pink-100 text-red-800"}`,children:R.status})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:R=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 font-medium text-base",children:R.created_by||"N/A"}),e("div",{className:"text-slate-500 text-sm",children:R.created_at?new Date(R.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];return e(he,{children:t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl shadow-lg shadow-red-500/25",children:e($t,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Game Mixes"}),e("p",{className:"text-slate-600",children:"Gestionează mixurile de jocuri și biblioteca de jocuri"})]})]}),t("div",{className:"flex items-center space-x-3",children:[i==="mixes"&&A&&t(De,{children:[t("button",{onClick:v,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),t("span",{children:["Bulk Edit (",y.length,")"]})]}),t("button",{onClick:x,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),t("span",{children:["Bulk Delete (",y.length,")"]})]})]}),i==="mixes"&&t("button",{onClick:G,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-5 h-5"}),e("span",{children:"Adaugă Game Mix"})]})]})]}),t("div",{className:"flex space-x-1 bg-slate-100 p-1 rounded-lg",children:[t("button",{onClick:()=>o("mixes"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-md transition-all duration-200 ${i==="mixes"?"bg-white text-red-600 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"}`,children:[e($t,{className:"w-4 h-4"}),e("span",{className:"font-medium",children:"Game Mixes"})]}),t("button",{onClick:()=>o("games"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-md transition-all duration-200 ${i==="games"?"bg-white text-purple-600 shadow-sm":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"}`,children:[e(ct,{className:"w-4 h-4"}),e("span",{className:"font-medium",children:"Biblioteca Jocuri"})]})]})]}),i==="mixes"?t(De,{children:[e("div",{className:"card p-6",children:t("div",{className:"flex flex-wrap gap-4 items-center",children:[e("div",{className:"flex-1 min-w-64",children:t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută game mix sau furnizor...",value:d,onChange:R=>f(R.target.value),className:"input-field pl-10"})]})}),t("div",{className:"flex items-center space-x-2",children:[e(Xt,{className:"w-5 h-5 text-slate-500"}),t("select",{value:T,onChange:R=>b(R.target.value),className:"input-field",children:[e("option",{value:"all",children:"Toate statusurile"}),e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"})]})]}),t("div",{className:"flex items-center space-x-2",children:[t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Export"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Import"})]})]})]})}),e("div",{className:"card",children:e(qe,{data:L,columns:K,onEdit:j,onDelete:S,onRowClick:R=>{$(R),E(!0)},searchTerm:d,emptyMessage:"Nu există game mixes în sistem",selectedItems:y,onSelectAll:F,onSelectItem:I,moduleColor:"blue"})})]}):e(bo,{}),c&&e(po,{item:p,onClose:N,onSave:D}),_&&e(xo,{item:g,onClose:()=>{E(!1),$(null)}})]})})},fo=({item:a,onClose:s,onSave:r})=>{const{locations:l}=ye(),n=()=>new Date().toISOString().split("T")[0],i=()=>"2025-12-31",o=()=>"2025-12-31",[c,u]=h.useState(()=>{const _=new Date().toISOString().split("T")[0],E="2025-12-31";return{name:"",description:"",start_date:_,end_date:E,location:"",locations:[{location:"",start_date:_,end_date:E}],prizes:[{amount:"",currency:"RON",date:"2025-12-31",winner:""}],status:"Active",notes:"",attachments:[],bannerFile:null,bannerPreview:null,documentsFile:null,documentsPreview:null}});h.useEffect(()=>{if(a){let _=[{amount:"",currency:"RON",date:"",winner:""}];a.prizes?_=typeof a.prizes=="string"?JSON.parse(a.prizes):a.prizes:a.prize_amount&&(_=[{amount:a.prize_amount||"",currency:a.prize_currency||"RON",date:a.prize_date?a.prize_date.split("T")[0]:"",winner:a.winner||""}]);let E=[{location:"",start_date:"",end_date:""}];a.locations?E=typeof a.locations=="string"?JSON.parse(a.locations):a.locations:a.location&&(E=[{location:a.location||"",start_date:a.start_date?a.start_date.split("T")[0]:"",end_date:a.end_date?a.end_date.split("T")[0]:""}]);let G=[];a.attachments&&(G=typeof a.attachments=="string"?JSON.parse(a.attachments):a.attachments),u({name:a.name||a.title||"",description:a.description||"",start_date:a.start_date?a.start_date.split("T")[0]:"",end_date:a.end_date?a.end_date.split("T")[0]:"",location:a.location||"",locations:E.length>0?E:[{location:"",start_date:"",end_date:""}],prizes:_.length>0?_:[{amount:"",currency:"RON",date:"",winner:""}],status:a.status||"Active",notes:a.notes||"",attachments:G||[],bannerFile:a.banner_url||null,bannerPreview:a.banner_url||null,documentsFile:a.documents_url||null,documentsPreview:a.documents_url||null})}else{const _=n(),E=i(),G=o();u({name:"",description:"",start_date:_,end_date:E,location:"",locations:[{location:"",start_date:_,end_date:E}],prizes:[{amount:"",currency:"RON",date:G,winner:""}],status:"Active",notes:"",attachments:[],bannerFile:null,bannerPreview:null,documentsFile:null,documentsPreview:null})}},[a]);const p=_=>{const{name:E,value:G}=_.target;u(j=>({...j,[E]:G}))},m=(_,E,G)=>{u(j=>({...j,locations:j.locations.map((N,D)=>D===_?{...N,[E]:G}:N)}))},d=()=>{const _=n(),E=i();u(G=>({...G,locations:[...G.locations,{location:"",start_date:_,end_date:E}]}))},f=_=>{u(E=>({...E,locations:E.locations.filter((G,j)=>j!==_)}))},T=(_,E,G)=>{const j=[...c.prizes];j[_][E]=G,u(N=>({...N,prizes:j}))},b=()=>{const _=o();u(E=>({...E,prizes:[...E.prizes,{amount:"",currency:"RON",date:_,winner:""}]}))},y=_=>{if(c.prizes.length===1){alert("Trebuie să existe cel puțin un premiu!");return}u(E=>({...E,prizes:E.prizes.filter((G,j)=>j!==_)}))},k=_=>{const E=_.target.files[0];if(E){const G=new FileReader;G.onload=j=>{u(N=>({...N,bannerFile:E,bannerPreview:j.target.result}))},G.readAsDataURL(E)}},A=_=>{const E=_.target.files[0];if(E){const G=new FileReader;G.onload=j=>{u(N=>({...N,documentsFile:E,documentsPreview:j.target.result}))},G.readAsDataURL(E)}},O=()=>{window.confirm("Sigur doriți să ștergeți banner-ul?")&&u(_=>({..._,bannerFile:null,bannerPreview:null}))},g=()=>{window.confirm("Sigur doriți să ștergeți documentele?")&&u(_=>({..._,documentsFile:null,documentsPreview:null}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(lt,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editare Promoție":"Promoție Nouă"}),e("p",{className:"text-blue-100 text-sm",children:"Marketing & Tombole"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:_=>{_.preventDefault();const E=c.prizes.filter(D=>D.amount&&parseFloat(D.amount)>0);if(E.length===0){alert("Adaugă cel puțin un premiu cu sumă validă!");return}const G=E.sort((D,S)=>D.date?S.date?new Date(D.date)-new Date(S.date):-1:1),j=new FormData;c.bannerFile&&c.bannerFile instanceof File&&j.append("banner",c.bannerFile),c.documentsFile&&c.documentsFile instanceof File&&j.append("documents",c.documentsFile);const N={...c,prizes:G,banner_url:c.bannerPreview,documents_url:c.documentsPreview};r(N)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(lt,{className:"w-4 h-4 inline mr-2"}),"Nume Promoție *"]}),e("input",{type:"text",name:"name",value:c.name,onChange:p,required:!0,placeholder:"Ex: Tombola Paște 2025",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(We,{className:"w-4 h-4 inline mr-2"}),"Locații (Multiple săli cu date diferite) *"]}),t("div",{className:"space-y-4",children:[c.locations.map((_,E)=>t("div",{className:"p-4 border border-slate-200 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-800",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Sala ",E+1]}),c.locations.length>1&&e("button",{type:"button",onClick:()=>f(E),className:"text-red-500 hover:text-red-700 transition-colors",children:e(Fe,{className:"w-4 h-4"})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Locație"}),t("select",{value:_.location,onChange:G=>m(E,"location",G.target.value),required:!0,className:`w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-600 
                                   bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                                   focus:border-blue-500 focus:ring-1 focus:ring-blue-200 transition-all text-sm`,children:[e("option",{value:"",children:"Selectează sala"}),l.map(G=>e("option",{value:G.name,children:G.name},G.id))]})]}),t("div",{children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Data început"}),e("input",{type:"date",value:_.start_date,onChange:G=>m(E,"start_date",G.target.value),className:`w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-600 
                                   bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                                   focus:border-blue-500 focus:ring-1 focus:ring-blue-200 transition-all text-sm`})]}),t("div",{children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Data sfârșit"}),e("input",{type:"date",value:_.end_date,onChange:G=>m(E,"end_date",G.target.value),className:`w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-600 
                                   bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                                   focus:border-blue-500 focus:ring-1 focus:ring-blue-200 transition-all text-sm`})]})]})]},E)),t("button",{type:"button",onClick:d,className:`w-full py-2 px-4 border-2 border-dashed border-slate-300 dark:border-slate-600 
                           rounded-lg text-slate-600 dark:text-slate-400 hover:border-blue-500 
                           hover:text-blue-500 transition-all flex items-center justify-center space-x-2`,children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă altă sală"})]})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Descriere"}),e("textarea",{name:"description",value:c.description,onChange:p,rows:3,placeholder:"Descriere promoție...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-pink-500 focus:ring-2 focus:ring-pink-200 transition-all`})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center",children:[e(Ut,{className:"w-5 h-5 mr-2 text-pink-500"}),"Premii (Data Acordare)"]}),t("button",{type:"button",onClick:b,className:`flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-500 
                         text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg`,children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Premiu"})]})]}),e("div",{className:"space-y-4",children:c.prizes.map((_,E)=>t("div",{className:"bg-slate-50 dark:bg-slate-700 p-4 rounded-xl border-2 border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:["Premiu #",E+1]}),c.prizes.length>1&&e("button",{type:"button",onClick:()=>y(E),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900 rounded-lg transition-all",children:e(Fe,{className:"w-4 h-4"})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Sumă *"}),e("input",{type:"number",value:_.amount||"",onChange:G=>T(E,"amount",G.target.value),required:!0,placeholder:"5000",min:"0",step:"0.01",className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Monedă"}),t("select",{value:_.currency||"RON",onChange:G=>T(E,"currency",G.target.value),className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,children:[e("option",{value:"RON",children:"RON"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Data Acordare *"}),e("input",{type:"date",value:_.date||"",onChange:G=>T(E,"date",G.target.value),required:!0,className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{className:"md:col-span-1",children:[e("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"Câștigător"}),e("input",{type:"text",value:_.winner||"",onChange:G=>T(E,"winner",G.target.value),placeholder:"Nume câștigător",className:`w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-500 
                                 bg-white dark:bg-slate-600 text-slate-900 dark:text-white text-base font-medium
                                 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]})]})]},E))})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("div",{className:"flex items-center justify-between mb-4",children:t("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center",children:[e(_t,{className:"w-5 h-5 mr-2 text-blue-500"}),"Banner Promoție"]})}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Imagine Banner (JPG, PNG)"}),e("input",{type:"file",name:"bannerFile",accept:".jpg,.jpeg,.png",onChange:k,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                            bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                            focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all
                            file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold 
                            file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100`})]}),c.bannerPreview&&t("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(_t,{className:"w-5 h-5 text-blue-600"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Banner încărcat"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Imagine Banner"})]})]}),e("button",{type:"button",onClick:O,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge banner",children:e(ve,{className:"w-4 h-4"})})]}),e("div",{className:"relative w-full h-40 bg-slate-100 dark:bg-slate-800 rounded-lg overflow-hidden",children:e("img",{src:c.bannerPreview,alt:"Banner Preview",className:"w-full h-full object-contain"})})]})]})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("div",{className:"flex items-center justify-between mb-4",children:t("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center",children:[e(pt,{className:"w-5 h-5 mr-2 text-blue-500"}),"Documente Promoție"]})}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Document (PDF)"}),e("input",{type:"file",name:"documentsFile",accept:".pdf",onChange:A,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                            bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                            focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all
                            file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold 
                            file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100`})]}),c.documentsPreview&&t("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(pt,{className:"w-5 h-5 text-blue-600"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Document încărcat"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF Document"})]})]}),e("button",{type:"button",onClick:g,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge documentul",children:e(ve,{className:"w-4 h-4"})})]}),e(Ct,{pdfUrl:c.documentsPreview,title:`Document Promoție ${c.name}`,placeholder:"Documentul nu este disponibil",placeholderSubtext:"Atașează documentul pentru vizualizare"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Status"}),t("select",{name:"status",value:c.status,onChange:p,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                          bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                          focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Completed",children:"Finalizat"}),e("option",{value:"Cancelled",children:"Anulat"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Note"}),e("input",{type:"text",name:"notes",value:c.notes,onChange:p,placeholder:"Note adiționale...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                          bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                          focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t-2 border-slate-200 dark:border-slate-600",children:[e("button",{type:"button",onClick:s,className:`px-6 py-3 rounded-xl border-2 border-slate-300 dark:border-slate-600 
                       text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 
                       transition-all font-medium`,children:"Anulează"}),e("button",{type:"submit",className:`px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl 
                       hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg font-medium`,children:a?"Salvează Modificările":"Creează Promoție"})]})]})]})})},No=({item:a,onClose:s})=>{var c;if(!a)return null;let r=[];a.prizes?r=typeof a.prizes=="string"?JSON.parse(a.prizes):a.prizes:a.prize_amount&&(r=[{amount:a.prize_amount,currency:a.prize_currency||"RON",date:a.prize_date,winner:a.winner}]),a.attachments&&(typeof a.attachments=="string"?JSON.parse(a.attachments):a.attachments);const l=u=>{if(!u)return null;const p=new Date,d=new Date(u)-p;return Math.ceil(d/(1e3*60*60*24))},n=u=>{if(!u)return null;const p=new Date,d=new Date(u)-p;return Math.ceil(d/(1e3*60*60*24))},i=l(a.end_date);a.start_date&&a.end_date&&Math.ceil((new Date(a.end_date)-new Date(a.start_date))/(1e3*60*60*24));const o=r.reduce((u,p)=>u+(parseFloat(p.amount)||0),0);return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-cyan-800 to-teal-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-600/20 to-teal-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-cyan-500 to-teal-500 rounded-2xl shadow-lg",children:e(lt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a.name||a.title}),e("p",{className:"text-cyan-100 text-sm font-medium",children:"Detalii Promoție & Premii"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),t("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:[t("div",{className:"space-y-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2",children:"Informații Promoție"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Nume Promoție"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:a.name||a.title||"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Status"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":a.status==="Completed"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"}`,children:a.status||"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Perioada Desfășurare"}),t("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.start_date?new Date(a.start_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"până la"}),e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.end_date?new Date(a.end_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"}),i!==null&&e("p",{className:`text-sm mt-2 font-semibold ${i>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:i>0?`${i} zile rămase`:"Expirată"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Locație"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.location||"N/A"})})]})]}),a.description&&t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Descriere"}),e("div",{className:"p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.description})})]})]}),r.length>0&&t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2 mb-6",children:["Premii (",r.length,")"]}),e("div",{className:"space-y-4",children:r.map((u,p)=>{const m=u.date,d=n(m),f=d!==null&&d<0,T=d===0,b=d!==null&&d>0&&d<=7;return e("div",{className:"p-6 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:["Premiu #",p+1]}),t("div",{className:"flex items-center space-x-2",children:[e(Ut,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f?"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200":T?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":b?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}`,children:T?"ASTĂZI":b?`${d} zile`:f?"Expirat":"Activ"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Sumă"}),e("div",{className:"p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:t("p",{className:"text-xl font-bold text-slate-900 dark:text-white",children:[parseFloat(u.amount||0).toLocaleString("ro-RO")," ",u.currency||"RON"]})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Data Acordare"}),e("div",{className:"p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:m?new Date(m).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Câștigător"}),e("div",{className:"p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:u.winner?t("div",{className:"flex items-center space-x-2",children:[e(Gt,{className:"w-4 h-4 text-yellow-500"}),e("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:u.winner})]}):e("p",{className:"text-sm text-slate-500 dark:text-slate-400 italic",children:f?"Neacordat":"În așteptare"})})]})]})},p)})}),r.length>1&&e("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg border border-green-200 dark:border-green-800",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e(Vr,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),t("div",{children:[e("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"TOTAL FOND PREMII"}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Suma totală a tuturor premiilor"})]})]}),e("div",{className:"text-right",children:t("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[o.toLocaleString("ro-RO")," ",((c=r[0])==null?void 0:c.currency)||"RON"]})})]})})]}),(a.banner_url||a.documents_url||a.attachments)&&t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2 mb-6",children:"Atașamente"}),a.banner_url&&t("div",{className:"mb-6",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Banner Promoție"}),e("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600 p-4",children:e("div",{className:"relative w-full h-48 bg-white dark:bg-slate-600 rounded-lg overflow-hidden border border-slate-200 dark:border-slate-500",children:e("img",{src:a.banner_url,alt:`Banner pentru ${a.name||a.title}`,className:"w-full h-full object-contain"})})})]}),a.documents_url&&t("div",{className:"mb-6",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Document Promoție"}),e("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600 p-4",children:e(Ct,{pdfUrl:a.documents_url,title:`Document Promoție ${a.name||a.title}`,placeholder:"Documentul nu este disponibil",placeholderSubtext:"Nu există document atașat pentru această promoție"})})]}),a.attachments&&Array.isArray(a.attachments)&&a.attachments.length>0&&t("div",{children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Fișiere Atașate"}),e("div",{className:"space-y-3",children:a.attachments.map((u,p)=>t("div",{className:"flex items-center space-x-3 p-3 bg-white dark:bg-slate-600 rounded-lg border border-slate-200 dark:border-slate-500",children:[e(pt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),t("div",{className:"flex-1",children:[e("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:u.name||`Fișier ${p+1}`}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:u.size?`${(u.size/1024/1024).toFixed(2)} MB`:"Fișier"})]}),e("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors",children:"Vezi"})]},p))})]})]}),t("div",{className:"border-t-2 border-slate-200 dark:border-slate-600 pt-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 border-b border-slate-200 dark:border-slate-600 pb-2 mb-6",children:"Informații Suplimentare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Creat de"}),e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_by||"N/A"})})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Data creării"}),e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-base font-medium text-slate-900 dark:text-white",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})})]}),a.notes&&t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Notițe"}),e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:a.notes})})]})]})]})]}),e("div",{className:"bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 p-6 rounded-b-2xl flex justify-end",children:e("button",{onClick:s,className:"btn-secondary",children:"Închide"})})]})})},vo=()=>{const{promotions:a,loading:s,createItem:r,updateItem:l,deleteItem:n,createTestWeeklyTombola:i}=ye(),o=He(),[c,u]=h.useState(""),[p,m]=h.useState([]),[d,f]=h.useState(!1),[T,b]=h.useState(!1),[y,k]=h.useState(null),[A,O]=h.useState(!1),[g,$]=h.useState(null);va.useEffect(()=>{f(p.length>0)},[p]);const _=a.filter(x=>{var L,K,R;return((L=x.title)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))||((K=x.name)==null?void 0:K.toLowerCase().includes(c.toLowerCase()))||((R=x.description)==null?void 0:R.toLowerCase().includes(c.toLowerCase()))}),E=x=>{m(x?_.map(v=>v.id):[])},G=(x,v)=>{m(v?[...p,x]:p.filter(L=>L!==x))},j=()=>{k(null),b(!0)},N=x=>{k(x),b(!0)},D=async x=>{const v=x.title||x.name||"această promoție";window.confirm(`Sigur vrei să ștergi ${v}?`)&&await n("promotions",x.id)},S=async x=>{y?await l("promotions",y.id,x):await r("promotions",x),b(!1),k(null)},F=x=>{const v=new Date;v.setHours(0,0,0,0);const L=x.start_date?new Date(x.start_date):null,K=x.end_date?new Date(x.end_date):null;if(L&&L.setHours(0,0,0,0),K&&K.setHours(0,0,0,0),L&&L>v){const R=Math.ceil((L-v)/864e5);return{text:`Începe în ${R} ${R===1?"zi":"zile"}`,color:"text-blue-600",icon:Me}}if(K&&K<v){const R=Math.ceil((v-K)/864e5);return{text:`Expirat de ${R} ${R===1?"zi":"zile"}`,color:"text-red-600",icon:dt}}if(K&&K>=v){const R=Math.ceil((K-v)/864e5);return{text:`${R} ${R===1?"zi":"zile"} rămase`,color:"text-green-600",icon:dt}}return{text:"-",color:"text-gray-400",icon:dt}},I=[{key:"title",label:"TITLU PROMOȚIE",sortable:!0,render:x=>e("button",{onClick:()=>{$(x),O(!0)},className:"text-blue-600 hover:text-blue-800 font-semibold hover:underline transition-colors",children:x.title||x.name||"Fără titlu"})},{key:"description",label:"DESCRIERE",sortable:!1,render:x=>e("div",{className:"text-sm text-slate-600 dark:text-slate-400 max-w-xs",children:x.description?x.description.length>60?`${x.description.substring(0,60)}...`:x.description:"Fără descriere"})},{key:"dates_period",label:"PERIOADA",sortable:!0,render:x=>t("div",{className:"space-y-1",children:[t("div",{className:"flex items-center text-sm text-slate-700 dark:text-slate-300",children:[e(Me,{className:"w-3.5 h-3.5 mr-1 text-green-600"}),x.start_date?new Date(x.start_date).toLocaleDateString("ro-RO"):"N/A"]}),t("div",{className:"flex items-center text-sm text-slate-700 dark:text-slate-300",children:[e(Me,{className:"w-3.5 h-3.5 mr-1 text-red-600"}),x.end_date?new Date(x.end_date).toLocaleDateString("ro-RO"):"N/A"]})]})},{key:"days_info",label:"ZILE",sortable:!1,render:x=>{const v=F(x),L=v.icon;return t("div",{className:`flex items-center space-x-1 font-medium text-sm ${v.color}`,children:[e(L,{className:"w-4 h-4"}),e("span",{children:v.text})]})}},{key:"status",label:"STATUS",sortable:!0,render:x=>{const v=new Date,L=x.end_date?new Date(x.end_date):null,K=x.start_date?new Date(x.start_date):null,R=L&&L>=v&&(!K||K<=v),C=K&&K>v,z=L&&L<v;let J="Inactiv",P="bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300";return R?(J="Activ",P="bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"):C?(J="În așteptare",P="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"):z&&(J="Expirat",P="bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"),e("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${P}`,children:J})}},{key:"rules_document",label:"REGULAMENT",sortable:!1,render:x=>{if(!x.rules_document&&!x.documents_url)return e("div",{className:"text-slate-400 text-sm",children:"-"});const v=x.rules_document||x.documents_url;return e("div",{className:"flex justify-center",children:e("button",{onClick:()=>window.open(v,"_blank"),className:"p-2 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg transition-colors",title:"Vizualizează regulamentul",children:e(Qe,{className:"w-5 h-5"})})})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:x=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:x.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:x.created_at?new Date(x.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(lt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Marketing"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare promoții și campanii"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>o("/marketing-ai"),className:"btn-secondary flex items-center space-x-2",children:[e(Ka,{className:"w-4 h-4"}),e("span",{children:"Analiză AI"})]}),t("button",{onClick:j,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Promoție"})]})]})]})}),e("div",{className:"card p-6",children:e("div",{className:"flex items-center space-x-4",children:t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută în promoții...",value:c,onChange:x=>u(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e(Fi,{}),e(ji,{})]}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):_.length===0?t("div",{className:"text-center py-12",children:[e(lt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există promoții"}),e("p",{className:"text-slate-500",children:"Adaugă prima promoție pentru a începe"})]}):e(qe,{data:_,columns:I,onEdit:N,onDelete:D,searchTerm:c,selectedItems:p,onSelectAll:E,onSelectItem:G,moduleColor:"blue"})}),T&&e(fo,{item:y,onClose:()=>{b(!1),k(null)},onSave:S}),A&&e(No,{item:g,onClose:()=>{O(!1),$(null)}})]})})},yo=()=>{const a=He();return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:e("div",{className:"flex items-center justify-between",children:t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>a("/marketing"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Înapoi la Marketing",children:e(et,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(Ka,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Analiză AI Marketing"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Insights și recomandări inteligente pentru campaniile tale"})]})]})})}),e("div",{className:"w-full",children:e(Mi,{})})]})})},wo=()=>{var j;const{id:a}=It(),s=He(),{promotions:r,locations:l,loading:n}=ye(),[i,o]=h.useState(!1),[c,u]=h.useState(!0),[p,m]=h.useState(!1),[d,f]=h.useState(null);h.useEffect(()=>{const N=r==null?void 0:r.find(D=>D.id===parseInt(a));N&&f(N)},[a,r]),h.useEffect(()=>{u(JSON.parse(!1))},[]);const T=N=>{u(N)};if(n)return e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă detaliile promoției..."})]})})});if(!d)return e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e(Ut,{className:"w-16 h-16 text-slate-400 dark:text-slate-500 mx-auto mb-4"}),e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Promoția nu a fost găsită"}),e("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Promoția pe care o căutați nu există în sistem."}),t("button",{onClick:()=>s("/marketing"),className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(et,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Marketing"})]})]})})});let b=[];d.prizes?b=typeof d.prizes=="string"?JSON.parse(d.prizes):d.prizes:d.prize_amount&&(b=[{amount:d.prize_amount,currency:d.prize_currency||"RON",date:d.prize_date,winner:d.winner}]);let y=[];d.locations?y=typeof d.locations=="string"?JSON.parse(d.locations):d.locations:d.location&&(y=[{location:d.location,start_date:d.start_date,end_date:d.end_date}]);const k=N=>{if(!N)return null;const D=new Date,F=new Date(N)-D;return Math.ceil(F/(1e3*60*60*24))},A=N=>{if(!N)return null;const D=new Date,F=new Date(N)-D;return Math.ceil(F/(1e3*60*60*24))},O=k(d.end_date),g=d.start_date&&d.end_date?Math.ceil((new Date(d.end_date)-new Date(d.start_date))/(1e3*60*60*24)):0,$=b.reduce((N,D)=>N+(parseFloat(D.amount)||0),0),_=N=>{const D=l.find(S=>S.id===N||S.name===N);return D?D.name:N},E=async(N,D)=>{if(N){m(!0);try{const S=new FormData;S.append("file",N),S.append("type",D),S.append("promotion_id",d.id);const F=await re.post("/api/upload/promotion",S,{headers:{"Content-Type":"multipart/form-data"}});if(F.data.success){U.success(`${D==="banner"?"Banner":"Regulament"} încărcat cu succes!`);const I={...d};D==="banner"?I.banner_path=F.data.file_path:I.regulation_path=F.data.file_path,f(I)}else U.error("Eroare la încărcarea fișierului")}catch(S){console.error("Upload error:",S),U.error("Eroare la încărcarea fișierului")}finally{m(!1)}}},G=async()=>{if(window.confirm("Sigur vrei să ștergi această promoție?"))try{await re.delete(`/api/promotions/${d.id}`),U.success("Promoție ștearsă cu succes!"),s("/marketing")}catch(N){console.error("Delete error:",N),U.error("Eroare la ștergerea promoției")}};return e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 mb-6",children:e("div",{className:"bg-gradient-to-r from-pink-600 via-rose-600 to-red-600 px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("button",{onClick:()=>s("/marketing"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-white"})}),e("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl",children:e(Ut,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h1",{className:"text-2xl font-bold text-white",children:d.name}),e("p",{className:"text-pink-100",children:"Promoție & Premii"})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>o(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Setări",children:e(Lt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>s(`/marketing/${d.id}/edit`),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Editează",children:e(tt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:G,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Șterge",children:e(Fe,{className:"w-5 h-5 text-white"})})]})]})})}),i&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:[e("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Afișare"})}),e("div",{className:"p-6 space-y-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"font-medium text-slate-800 dark:text-slate-200",children:"Afișare automată atașamente"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Afișează automat PDF-urile în pagina de detalii"})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:c,onChange:N=>T(N.target.checked),className:"sr-only peer"}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})}),e("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e("button",{onClick:()=>o(!1),className:"btn-primary",children:"Închide"})})]})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"lg:col-span-2 space-y-6",children:[O!==null&&e("div",{className:`p-6 rounded-xl border-2 ${O>7?"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-300 dark:border-green-700":O>0?"bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-yellow-300 dark:border-yellow-700":"bg-gradient-to-br from-gray-50 to-slate-50 dark:from-gray-900/20 dark:to-slate-900/20 border-gray-300 dark:border-gray-700"}`,children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e(dt,{className:`w-12 h-12 ${O>7?"text-green-500":O>0?"text-yellow-500":"text-gray-500"}`}),t("div",{children:[e("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400",children:"ZILE RĂMASE"}),e("p",{className:`text-4xl font-bold ${O>7?"text-green-600 dark:text-green-400":O>0?"text-yellow-600 dark:text-yellow-400":"text-gray-600 dark:text-gray-400"}`,children:O>0?O:"EXPIRAT"})]})]}),t("div",{className:"text-right",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Durată totală"}),t("p",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:[g," zile"]})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(Me,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Perioada Desfășurare"})]}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:new Date(d.start_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"})}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400 my-2",children:"până la"}),e("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:new Date(d.end_date).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"})})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e(We,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),t("h3",{className:"font-semibold text-slate-700 dark:text-slate-200",children:["Locații (",y.length,")"]})]}),e("div",{className:"space-y-2",children:y.map((N,D)=>t("div",{className:"flex items-center justify-between p-2 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[e("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:_(N.location)}),N.start_date&&N.end_date&&t("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[new Date(N.start_date).toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit"})," - ",new Date(N.end_date).toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit"})]})]},D))})]})]}),b.length>0&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center",children:[e(Vr,{className:"w-6 h-6 mr-3 text-pink-600 dark:text-pink-400"}),"Premii (",b.length,")"]}),b.length>1&&t("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 px-6 py-3 rounded-xl text-white shadow-lg",children:[e("p",{className:"text-sm font-semibold",children:"TOTAL FOND PREMII"}),t("p",{className:"text-2xl font-bold",children:[$.toLocaleString("ro-RO")," ",((j=b[0])==null?void 0:j.currency)||"RON"]})]})]}),e("div",{className:"grid grid-cols-1 gap-4",children:b.map((N,D)=>{const S=N.date,F=A(S),I=F!==null&&F<0,x=F===0,v=F!==null&&F>0&&F<=7;return e("div",{className:`p-4 rounded-xl border-2 ${I?"bg-gradient-to-br from-gray-50 to-slate-100 dark:from-gray-900/20 dark:to-slate-800/20 border-gray-300 dark:border-gray-700":x?"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border-red-400 dark:border-red-700 shadow-xl":v?"bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 border-yellow-400 dark:border-yellow-700":"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-300 dark:border-green-700"}`,children:e("div",{className:"flex items-start justify-between",children:t("div",{className:"flex items-start space-x-4 flex-1",children:[e("div",{className:`p-3 rounded-xl ${I?"bg-gray-200 dark:bg-gray-700":x?"bg-red-200 dark:bg-red-800":v?"bg-yellow-200 dark:bg-yellow-800":"bg-green-200 dark:bg-green-800"}`,children:e(Ut,{className:`w-6 h-6 ${I?"text-gray-600 dark:text-gray-300":x?"text-red-600 dark:text-red-300":v?"text-yellow-600 dark:text-yellow-300":"text-green-600 dark:text-green-300"}`})}),t("div",{className:"flex-1",children:[t("div",{className:"flex items-center space-x-3 mb-2",children:[t("h4",{className:"text-lg font-bold text-slate-800 dark:text-white",children:["Premiu #",D+1]}),x&&e("span",{className:"px-3 py-1 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse",children:"ASTĂZI!"}),v&&!x&&t("span",{className:"px-3 py-1 bg-yellow-500 text-white text-xs font-bold rounded-full",children:[F," ZILE"]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-3",children:[t("div",{children:[e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"SUMĂ PREMIU"}),t("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[parseFloat(N.amount||0).toLocaleString("ro-RO")," ",N.currency||"RON"]})]}),t("div",{children:[e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"DATA ACORDARE"}),e("p",{className:"text-base font-semibold text-slate-900 dark:text-white",children:S?new Date(S).toLocaleDateString("ro-RO",{day:"numeric",month:"long",year:"numeric"}):"N/A"}),F!==null&&F>0&&!x&&t("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["(peste ",F," ",F===1?"zi":"zile",")"]})]}),t("div",{children:[e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"CÂȘTIGĂTOR"}),N.winner?t("div",{className:"flex items-center space-x-2",children:[e(Gt,{className:"w-5 h-5 text-yellow-500"}),e("p",{className:"text-base font-semibold text-slate-900 dark:text-white",children:N.winner})]}):e("p",{className:"text-base text-slate-500 dark:text-slate-400 italic",children:I?"Neacordat":"În așteptare"})]})]})]})]})})},D)})})]}),d.description&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Descriere Promoție"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:d.description})]}),d.notes&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-3",children:"Notițe Suplimentare"}),e("p",{className:"text-slate-900 dark:text-white whitespace-pre-wrap",children:d.notes})]})]}),t("div",{className:"space-y-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 flex items-center",children:[e(_t,{className:"w-5 h-5 mr-2 text-pink-600 dark:text-pink-400"}),"Banner Promoție"]}),t("label",{className:"btn-secondary cursor-pointer",children:[e(ze,{className:"w-4 h-4 mr-2"}),d.banner_path?"Schimbă":"Încarcă",e("input",{type:"file",accept:"image/*",onChange:N=>E(N.target.files[0],"banner"),className:"hidden",disabled:p})]})]}),d.banner_path?t("div",{className:"space-y-3",children:[e("img",{src:`/uploads/promotions/${d.banner_path}`,alt:"Banner promoție",className:"w-full h-32 object-cover rounded-lg border border-slate-200 dark:border-slate-600"}),t("div",{className:"flex items-center justify-between text-sm text-slate-600 dark:text-slate-400",children:[e("span",{children:"Banner activ"}),t("button",{onClick:()=>window.open(`/uploads/promotions/${d.banner_path}`,"_blank"),className:"flex items-center space-x-1 hover:text-pink-600 dark:hover:text-pink-400",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Deschide"})]})]})]}):t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(Ws,{className:"w-12 h-12 mx-auto mb-2"}),e("p",{children:"Nu există banner"})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-pink-600 dark:text-pink-400"}),"Regulament"]}),t("label",{className:"btn-secondary cursor-pointer",children:[e(ze,{className:"w-4 h-4 mr-2"}),d.regulation_path?"Schimbă":"Încarcă",e("input",{type:"file",accept:".pdf,.doc,.docx",onChange:N=>E(N.target.files[0],"regulation"),className:"hidden",disabled:p})]})]}),d.regulation_path?t("div",{className:"space-y-3",children:[t("div",{className:"flex items-center space-x-2 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[e(ge,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"}),e("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:d.regulation_path})]}),t("div",{className:"flex items-center justify-between text-sm text-slate-600 dark:text-slate-400",children:[e("span",{children:"Regulament activ"}),t("button",{onClick:()=>window.open(`/uploads/promotions/${d.regulation_path}`,"_blank"),className:"flex items-center space-x-1 hover:text-pink-600 dark:hover:text-pink-400",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Deschide"})]})]}),c&&e("div",{className:"mt-4",children:e(Ct,{filePath:`/uploads/promotions/${d.regulation_path}`,title:"Regulament Promoție"})})]}):t("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e(ge,{className:"w-12 h-12 mx-auto mb-2"}),e("p",{children:"Nu există regulament"})]})]}),(d.created_by||d.created_at)&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Informații Creare"}),t("div",{className:"space-y-4",children:[t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Creat de:"}),t("p",{className:"text-base font-medium text-slate-900 dark:text-white flex items-center",children:[e(yt,{className:"w-4 h-4 mr-2"}),d.created_by||"N/A"]})]}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Data creării:"}),t("p",{className:"text-base font-medium text-slate-900 dark:text-white flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2"}),d.created_at?new Date(d.created_at).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"]})]})]})]})]})]})]})})})},wt=a=>{if(!a)return"N/A";if(!a.includes(" - "))return a;const s=a.split(" - ");return s.length>1?s[1]:a},ko=(a,s=[])=>{if(!a)return"N/A";const r=s.find(l=>l.id===a||l.name===a);return wt(r?r.name:a)},Co=()=>{const{gameId:a}=It(),s=He(),{slots:r,gameMixes:l,providers:n,companies:i,locations:o,cabinets:c}=ye(),[u,p]=h.useState(null),[m,d]=h.useState(!0),[f,T]=h.useState(null),[b,y]=h.useState([]);h.useEffect(()=>{$(),k()},[a,r,l]);const k=()=>{if(!u||!r||!l)return;const j=[];r.forEach(N=>{if(N.game_mix){const D=l.find(S=>S.name===N.game_mix||S.id===N.game_mix);if(D&&D.games){let S=[];try{S=typeof D.games=="string"?JSON.parse(D.games):D.games}catch{S=[D.games]}S.includes(u.name)&&j.push({...N,gameMixName:D.name,providerName:A(N.provider),locationName:O(N.location),cabinetName:g(N.cabinet)})}}}),y(j)},A=j=>{const N=n==null?void 0:n.find(D=>D.id===j||D.name===j);return N?N.name:j},O=j=>{const N=o==null?void 0:o.find(D=>D.id===j||D.name===j);return N?N.name:j},g=j=>{const N=c==null?void 0:c.find(D=>D.id===j||D.name===j);return N?N.name||N.model:j},$=async()=>{d(!0);try{const j=await fetch(`/api/games/${a}`);if(!j.ok)throw new Error("Game not found");const N=await j.json();p(N),_(N)}catch(j){console.error("Error loading game details:",j)}finally{d(!1)}},_=j=>{const N=r.filter(I=>{if(!I.game_mix)return!1;const x=l.find(L=>L.name===I.game_mix||L.id===I.game_mix);if(!x||!x.games)return!1;let v=[];try{v=typeof x.games=="string"?JSON.parse(x.games):x.games}catch{v=[x.games]}return v.includes(j.name)}),D={};N.forEach(I=>{const x=I.location||"Unknown";D[x]||(D[x]={count:0,cabinets:new Set,gameMixes:new Set,slots:[]}),D[x].count++,D[x].cabinets.add(I.cabinet||"Unknown"),D[x].gameMixes.add(I.game_mix||"None"),D[x].slots.push(I)});const S={};N.forEach(I=>{const x=I.cabinet||"Unknown";S[x]||(S[x]={count:0,locations:new Set,gameMixes:new Set,slots:[]}),S[x].count++,S[x].locations.add(I.location||"Unknown"),S[x].gameMixes.add(I.game_mix||"None"),S[x].slots.push(I)});const F={};N.forEach(I=>{const x=I.game_mix||"None";F[x]||(F[x]={count:0,locations:new Set,cabinets:new Set,slots:[]}),F[x].count++,F[x].locations.add(I.location||"Unknown"),F[x].cabinets.add(I.cabinet||"Unknown"),F[x].slots.push(I)}),T({totalSlots:N.length,uniqueLocations:Object.keys(D).length,uniqueCabinets:Object.keys(S).length,uniqueGameMixes:Object.keys(F).length,locationStats:D,cabinetStats:S,gameMixStats:F,allSlots:N})},E=j=>{switch(j){case"low":return"bg-green-100 text-green-800";case"low - medium":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},G=j=>{switch(j){case"low":return e(dt,{className:"w-4 h-4"});case"low - medium":return e(sa,{className:"w-4 h-4"});case"medium":return e(Gr,{className:"w-4 h-4"});case"high":return e(sa,{className:"w-4 h-4"});default:return e(dt,{className:"w-4 h-4"})}};return m?e(he,{children:e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})})}):u?e(he,{children:t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[e("div",{className:"flex items-center justify-between mb-6",children:t("button",{onClick:()=>s("/game-mixes/games-library"),className:"flex items-center space-x-2 text-slate-600 hover:text-purple-600 transition-colors",children:[e(et,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Biblioteca Jocuri"})]})}),t("div",{className:"flex items-start space-x-6",children:[e("div",{className:"flex-shrink-0",children:t("div",{className:"w-40 h-40 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-2xl overflow-hidden shadow-lg flex items-center justify-center",children:[e("img",{src:u.image_url,alt:u.name,className:"max-w-full max-h-full object-contain",style:{imageRendering:"crisp-edges"},onError:j=>{j.target.style.display="none",j.target.nextSibling.style.display="flex"}}),e("div",{className:"w-full h-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",style:{display:"none"},children:e(ct,{className:"w-16 h-16 text-purple-400"})})]})}),t("div",{className:"flex-1",children:[e("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:u.name}),e("p",{className:"text-slate-600 mb-4",children:u.theme}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Furnizor"}),e("div",{className:"font-semibold text-slate-800",children:u.provider})]}),t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Linii"}),e("div",{className:"font-semibold text-slate-800",children:u.lines||"N/A"})]}),t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Layout"}),e("div",{className:"font-semibold text-slate-800",children:u.layout||"N/A"})]}),t("div",{className:"bg-slate-50 rounded-lg p-3",children:[e("div",{className:"text-sm text-slate-500 mb-1",children:"Tip"}),e("div",{className:"font-semibold text-slate-800",children:u.classification})]})]}),u.volatility&&u.volatility!=="n/a"&&t("div",{className:`inline-flex items-center space-x-2 px-4 py-2 rounded-full ${E(u.volatility)}`,children:[G(u.volatility),e("span",{className:"font-medium",children:u.volatility})]})]})]})]}),f&&t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl inline-block mb-4",children:e(it,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:f.totalSlots}),e("p",{className:"text-slate-600",children:"Sloturi totale"})]}),t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl inline-block mb-4",children:e(We,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:f.uniqueLocations}),e("p",{className:"text-slate-600",children:"Locații"})]}),t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl inline-block mb-4",children:e(_e,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:f.uniqueCabinets}),e("p",{className:"text-slate-600",children:"Cabinete"})]}),t("div",{className:"card p-6 text-center",children:[e("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl inline-block mb-4",children:e(bt,{className:"w-6 h-6 text-white"})}),e("h3",{className:"text-2xl font-bold text-slate-800",children:f.uniqueGameMixes}),e("p",{className:"text-slate-600",children:"Game Mixes"})]})]}),f&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[Object.keys(f.locationStats).length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(We,{className:"w-5 h-5 text-green-500"}),e("span",{children:"Locații"})]}),e("div",{className:"space-y-3",children:Object.entries(f.locationStats).map(([j,N])=>t("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-green-800 mb-2",children:j}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-green-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-green-800",children:N.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-green-600",children:"Cabinete:"}),e("span",{className:"font-semibold text-green-800",children:N.cabinets.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-green-600",children:"Game Mixes:"}),e("span",{className:"font-semibold text-green-800",children:N.gameMixes.size})]})]})]},j))})]}),Object.keys(f.cabinetStats).length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(_e,{className:"w-5 h-5 text-purple-500"}),e("span",{children:"Cabinete"})]}),e("div",{className:"space-y-3",children:Object.entries(f.cabinetStats).map(([j,N])=>t("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-purple-800 mb-2",children:j}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-purple-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-purple-800",children:N.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-purple-600",children:"Locații:"}),e("span",{className:"font-semibold text-purple-800",children:N.locations.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-purple-600",children:"Game Mixes:"}),e("span",{className:"font-semibold text-purple-800",children:N.gameMixes.size})]})]})]},j))})]}),Object.keys(f.gameMixStats).length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(bt,{className:"w-5 h-5 text-orange-500"}),e("span",{children:"Game Mixes"})]}),e("div",{className:"space-y-3",children:Object.entries(f.gameMixStats).map(([j,N])=>t("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-orange-800 mb-2",children:j}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-orange-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-orange-800",children:N.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-orange-600",children:"Locații:"}),e("span",{className:"font-semibold text-orange-800",children:N.locations.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-orange-600",children:"Cabinete:"}),e("span",{className:"font-semibold text-orange-800",children:N.cabinets.size})]})]})]},j))})]}),f&&f.allSlots.length>0&&t("div",{className:"card p-4",children:[t("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center space-x-2",children:[e(_e,{className:"w-5 h-5 text-blue-500"}),e("span",{children:"Furnizori"})]}),e("div",{className:"space-y-3",children:(()=>{const j={};return f.allSlots.forEach(N=>{N.provider&&(j[N.provider]||(j[N.provider]={count:0,locations:new Set,cabinets:new Set}),j[N.provider].count++,N.location&&j[N.provider].locations.add(N.location),N.cabinet&&j[N.provider].cabinets.add(N.cabinet))}),Object.entries(j).map(([N,D])=>t("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3",children:[e("h4",{className:"font-semibold text-blue-800 mb-2",children:N}),t("div",{className:"space-y-1 text-sm",children:[t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-blue-600",children:"Sloturi:"}),e("span",{className:"font-semibold text-blue-800",children:D.count})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-blue-600",children:"Locații:"}),e("span",{className:"font-semibold text-blue-800",children:D.locations.size})]}),t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-blue-600",children:"Cabinete:"}),e("span",{className:"font-semibold text-blue-800",children:D.cabinets.size})]})]})]},N))})()})]})]}),f&&f.allSlots.length>0&&t("div",{className:"card p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-6 flex items-center space-x-2",children:[e(Yt,{className:"w-5 h-5 text-blue-500"}),t("span",{children:["Toate sloturile cu acest joc (",f.allSlots.length,")"]})]}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{children:t("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Serial Number"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Locație"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Furnizor"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Cabinet"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Game Mix"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Status"}),e("th",{className:"text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300",children:"Denomination"})]})}),e("tbody",{children:f.allSlots.map(j=>t("tr",{className:"border-b border-slate-100 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700",children:[e("td",{className:"py-3 px-4",children:e("button",{onClick:()=>s(`/slots/${j.id}`),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-semibold hover:underline transition-colors",children:j.serial_number||"N/A"})}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.location||"N/A"}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.provider||"N/A"}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.cabinet||"N/A"}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:wt(j.game_mix_name||j.game_mix)}),e("td",{className:"py-3 px-4",children:e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:j.status||"N/A"})}),e("td",{className:"py-3 px-4 text-slate-800 dark:text-slate-200",children:j.denomination||"N/A"})]},j.id))})]})})]})]})}):e(he,{children:t("div",{className:"text-center py-12",children:[e(ct,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Jocul nu a fost găsit"}),e("button",{onClick:()=>s("/game-mixes/games-library"),className:"btn-primary",children:"Înapoi la Biblioteca Jocuri"})]})})},So=({item:a,onClose:s,onSave:r})=>{const{locations:l,cabinets:n,gameMixes:i,providers:o}=ye(),[c,u]=h.useState({serial_number:"",provider:"",location:"",game:"",cabinet:"",game_mix:"",denomination:.01,max_bet:"",rtp:"",gaming_places:1,manufacture_year:"",commission_date:"",invoice_number:"",status:"Active",notes:""});h.useEffect(()=>{a&&u({serial_number:a.serial_number||"",provider:a.provider||"",location:a.location||"",game:a.game||"",cabinet:a.cabinet||"",game_mix:a.game_mix||"",denomination:a.denomination||.01,max_bet:a.max_bet||"",rtp:a.rtp||"",gaming_places:a.gaming_places||1,manufacture_year:a.manufacture_year||"",commission_date:a.commission_date||"",invoice_number:a.invoice_number||"",status:a.status||"Active",notes:a.notes||""})},[a]);const p=d=>{const{name:f,value:T}=d.target;u(b=>{const y={...b,[f]:T};if(f==="provider")y.cabinet="",y.game_mix="";else if(f==="cabinet"){y.game_mix="";const k=n.find(A=>A.name===T);k&&k.provider&&k.provider!==y.provider&&(y.provider=k.provider)}return y})};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-emerald-800 to-green-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-600/20 to-green-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-emerald-500 to-green-500 rounded-2xl shadow-lg",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Slot":"Adaugă Slot Nou"}),e("p",{className:"text-emerald-100 text-sm font-medium",children:"Completează informațiile despre slot"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:d=>{d.preventDefault(),r(c)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numărul de serie *"}),e("input",{type:"text",name:"serial_number",value:c.serial_number,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Serial number unic",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Locație *"}),t("select",{name:"location",value:c.location,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează locația"}),l==null?void 0:l.map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:c.provider,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),o==null?void 0:o.map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet"}),t("select",{name:"cabinet",value:c.cabinet,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează cabinetul"}),n.filter(d=>!c.provider||d.provider===c.provider).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix"}),t("select",{name:"game_mix",value:c.game_mix,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează game mix-ul"}),i.filter(d=>!(c.provider&&d.provider!==c.provider)).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:c.status,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Inactive",children:"Inactiv"}),e("option",{value:"Maintenance",children:"Mentenanță"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Denomination"}),e("input",{type:"number",step:"0.01",name:"denomination",value:c.denomination,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Max Bet"}),e("input",{type:"number",step:"0.01",name:"max_bet",value:c.max_bet,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Max bet"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"RTP (%)"}),e("input",{type:"number",step:"0.01",name:"rtp",value:c.rtp,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"RTP"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Gaming Places"}),e("input",{type:"number",name:"gaming_places",value:c.gaming_places,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"1"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-slate-700",children:["An Fabricat ",e("span",{className:"text-slate-400 text-xs",children:"(opțional)"})]}),e("input",{type:"number",name:"manufacture_year",value:c.manufacture_year,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"ex: 2020",min:"1990",max:"2030"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-end",children:[t("div",{className:"space-y-1",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip proprietate"}),e("input",{type:"text",value:"Se actualizează automat din Facturi",readOnly:!0,disabled:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-100 text-slate-500 cursor-not-allowed"})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-xs font-medium text-slate-600",children:"Data comisionării"}),e("input",{type:"text",value:c.commission_date||"Auto din Comisii",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg bg-slate-100 text-slate-600 cursor-not-allowed",readOnly:!0,disabled:!0})]}),t("div",{className:"space-y-1",children:[e("label",{className:"block text-xs font-medium text-slate-600",children:"Numărul facturii"}),e("input",{type:"text",value:c.invoice_number||"Se actualizează automat din Facturi",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg bg-slate-100 text-slate-600 cursor-not-allowed",readOnly:!0,disabled:!0})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:c.notes,onChange:p,rows:2,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Note adiționale despre slot"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(it,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Slot"]})]})]})]})})]})})},_o=()=>{const a=He(),s=h.useRef(null),[r,l]=h.useState([]),[n,i]=h.useState([]),[o,c]=h.useState([]),[u,p]=h.useState([]),[m,d]=h.useState([]),[f,T]=h.useState([]),[b,y]=h.useState([]),[k,A]=h.useState([]),[O,g]=h.useState([]),[$,_]=h.useState([]),[E,G]=h.useState([]),[j,N]=h.useState(!1),[D,S]=h.useState(""),[F,I]=h.useState(new Set),[x,v]=h.useState(new Set);h.useState(new Set),h.useState(new Set),h.useState(new Set);const[L,K]=h.useState(!1),[R,C]=h.useState("audit");h.useState(!0);const[z,J]=h.useState({provider:"",cabinet:"",gameMix:"",status:"Active"}),[P,Z]=h.useState({company:"",city:"",status:""}),se=async()=>{var w,V;try{N(!0),U.loading("Conectare la baza de date Cyber...",{id:"cyber-db"});const Y=await re.get("/api/cyber-direct/fetch-yesterday");if(Y.data.success){const we=Y.data.data;T(we),C("audit"),U.success(`✅ ${we.length} înregistrări din ${Y.data.date} încărcate din Cyber DB!`,{id:"cyber-db",duration:5e3}),console.log("✅ Yesterday data from Cyber DB:",we)}else throw new Error(Y.data.error||"Eroare la citirea datelor")}catch(Y){console.error("❌ Error fetching from Cyber DB:",Y),U.error(`Eroare la conectarea la Cyber DB: ${((V=(w=Y.response)==null?void 0:w.data)==null?void 0:V.error)||Y.message}`,{id:"cyber-db",duration:6e3})}finally{N(!1)}},oe=async()=>{try{N(!0);try{const w=await re.get("/api/cyber/machine-audit-summaries");T(w.data),console.log("✅ Machine audit summaries loaded from API:",w.data.length);return}catch(w){console.error("❌ API Error fetching machine audit summaries:",w),console.log("🔄 Falling back to local JSON file...")}try{const w=await re.get("/cyber-data/machine_audit_summaries.json");T(w.data),console.log("✅ Machine audit summaries loaded from local file:",w.data.length),U.success("Date încărcate din fișierul local (mod offline)")}catch(w){console.error("❌ Local file error:",w),T([{serial_number:"100388",location:"Craiova",cabinet:"AMS-ST-50",mix:"Amusebox",producator:"Amusnet",address:"Str. Infratirii, Nr.2",status:"Active",manufacture_year:2025},{serial_number:"149616",location:"București",cabinet:"P42V Curved ST",mix:"Union",producator:"EGT",address:"Sos. Nordului Nr.1",status:"Active",manufacture_year:2024}]),console.log("⚠️ Using sample data as last resort"),U.success("Date de test încărcate (mod offline)")}}catch(w){console.error("❌ Error in fetchMachineAuditSummaries:",w),U.error("Eroare la încărcarea datelor din machine_audit_summaries")}finally{N(!1)}},de=async()=>{if(window.confirm(`⚠️ ATENȚIE: Sincronizarea Cyber va ȘTERGE toate sloturile existente și va importa din nou!

Dacă vrei să păstrezi sloturile existente, folosește "Import Safe" în loc de "Sincronizează".

Continui cu sincronizarea completă?`))try{U.loading("Sincronizez sloturile din Cyber...",{id:"sync-slots"});try{const V=await re.post("/api/cyber/sync-slots");if(V.data.success){U.success(`Sincronizare completă! ${V.data.syncedCount} sloturi importate.`,{id:"sync-slots"}),Be();return}else U.error("Eroare la sincronizare: "+V.data.message,{id:"sync-slots"})}catch(V){console.error("❌ API Error syncing Cyber slots:",V);try{console.log("🔄 Falling back to offline Cyber sync mode..."),U.loading("Se încearcă sincronizarea în mod offline...",{id:"sync-slots"});const Y=await re.get("/cyber-slots.json"),we=Array.isArray(Y.data)?Y.data:[];if(we.length>0){setSlots(we),U.success(`${we.length} sloturi sincronizate în mod offline!`,{id:"sync-slots"}),Be();return}else U.error("Fișierul local nu conține date valide!",{id:"sync-slots"})}catch(Y){console.error("❌ Local file error during Cyber sync:",Y),U.error("Nu s-a putut încărca fișierul local pentru sincronizare!",{id:"sync-slots"})}}}catch(V){console.error("Error in handleSyncCyberSlots:",V),U.error("Eroare la sincronizarea sloturilor: "+V.message,{id:"sync-slots"})}},Se=async()=>{const w=window.prompt(`Ce vrei să importezi?

1 - Doar jocurile ACTIVE (recomandat)
2 - Toate jocurile (inclusiv inactive)

Introdu 1 sau 2:`);if(!w||w!=="1"&&w!=="2"){U.error("Operațiune anulată");return}const V=w==="1";try{U.loading(`Importez sloturile ${V?"ACTIVE":"TOATE"} din Cyber...`,{id:"sync-slots-safe"});const Y=await re.post("/api/cyber/sync-slots-safe",{onlyActive:V});Y.data.success?(U.success(`Import complet! ${Y.data.syncedCount} sloturi noi adăugate (${Y.data.existingCount} existau deja). + ${Y.data.entitiesPopulated.locations} locații + ${Y.data.entitiesPopulated.providers} furnizori + ${Y.data.entitiesPopulated.cabinets} cabinete + ${Y.data.entitiesPopulated.gameMixes} game mixes`,{id:"sync-slots-safe"}),Be()):U.error("Eroare la import: "+Y.data.message,{id:"sync-slots-safe"})}catch(Y){console.error("Error safe syncing Cyber slots:",Y),U.error("Eroare la importul sigur: "+Y.message,{id:"sync-slots-safe"})}},Oe=async()=>{var w,V;try{U.loading("Sincronizez locațiile din Cyber...",{id:"sync-locations"});const Y=await re.post("/api/cyber/sync-locations");Y.data.success?(U.success(`Locații sincronizate! ${Y.data.syncedCount} locații noi adăugate`,{id:"sync-locations"}),Ye()):U.error("Eroare la sincronizare locații: "+Y.data.message,{id:"sync-locations"})}catch(Y){console.error("Error syncing locations:",Y),U.error("Eroare la sincronizare locații: "+(((V=(w=Y.response)==null?void 0:w.data)==null?void 0:V.message)||Y.message),{id:"sync-locations"})}},Ue=async()=>{var w,V;try{U.loading("Sincronizez game mixurile din Cyber...",{id:"sync-game-mixes"});const Y=await re.post("/api/cyber/sync-game-mixes");Y.data.success?(U.success(`Game mixuri sincronizate! ${Y.data.syncedCount} game mixuri noi adăugate`,{id:"sync-game-mixes"}),ce()):U.error("Eroare la sincronizare game mixuri: "+Y.data.message,{id:"sync-game-mixes"})}catch(Y){console.error("Error syncing game mixes:",Y),U.error("Eroare la sincronizare game mixuri: "+(((V=(w=Y.response)==null?void 0:w.data)==null?void 0:V.message)||Y.message),{id:"sync-game-mixes"})}},Ze=async()=>{var w,V;try{U.loading("Sincronizez cabinetele din Cyber...",{id:"sync-cabinets"});const Y=await re.post("/api/cyber/sync-cabinets");Y.data.success?(U.success(`Cabinete sincronizate! ${Y.data.syncedCount} cabinete noi adăugate`,{id:"sync-cabinets"}),Q()):U.error("Eroare la sincronizare cabinete: "+Y.data.message,{id:"sync-cabinets"})}catch(Y){console.error("Error syncing cabinets:",Y),U.error("Eroare la sincronizare cabinete: "+(((V=(w=Y.response)==null?void 0:w.data)==null?void 0:V.message)||Y.message),{id:"sync-cabinets"})}},$e=async()=>{var w,V;try{U.loading("Sincronizez furnizorii din Cyber...",{id:"sync-providers"});const Y=await re.post("/api/cyber/sync-providers");Y.data.success?(U.success(`Furnizori sincronizați! ${Y.data.syncedCount} furnizori noi adăugați`,{id:"sync-providers"}),ue()):U.error("Eroare la sincronizare furnizori: "+Y.data.message,{id:"sync-providers"})}catch(Y){console.error("Error syncing providers:",Y),U.error("Eroare la sincronizare furnizori: "+(((V=(w=Y.response)==null?void 0:w.data)==null?void 0:V.message)||Y.message),{id:"sync-providers"})}},rt=w=>{const V=w.target.files[0];if(!V)return;const Y=new FileReader;Y.onload=we=>{try{const Ve=JSON.parse(we.target.result).map(je=>({id:je.id,serial_number:je.serial_number||je.slot_id,provider:je.provider||"N/A",cabinet:je.cabinet||"N/A",game_mix:wt(je.game_mix_name||je.game_mix),status:je.status||"Active",location:je.location||"N/A",last_updated:je.updated_at||je.created_at,created_at:je.created_at}));l(Ve),y(Ve),U.success(`Încărcate ${Ve.length} sloturi din fișier`)}catch(Le){console.error("Error parsing JSON:",Le),U.error("Eroare la citirea fișierului. Verifică că este un JSON valid.")}},Y.readAsText(V)},Be=async()=>{N(!0);try{const w=await re.get("/api/cyber/slots",{timeout:1e4}),V=Array.isArray(w.data)?w.data:[];l(V),y(V),U.success(`Încărcate ${V.length} sloturi din Cyber`)}catch(w){console.error("Error fetching Cyber slots from API, loading from JSON file:",w);try{const V=await re.get("/cyber-slots.json"),Y=Array.isArray(V.data)?V.data:[];l(Y),y(Y),U.success(`Încărcate ${Y.length} sloturi din fișierul Cyber`)}catch(V){console.error("Error loading from JSON file, using demo data:",V);const Y=[{id:1,serial_number:"149616",provider:"EGT",cabinet:"P42V Curved ST",game_mix:"EGT - Union",status:"Active",location:"Craiova",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-09-30T05:41:41.000Z"},{id:2,serial_number:"149597",provider:"EGT",cabinet:"P 32/32 H ST",game_mix:null,status:"Active",location:"Ploiești",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-09-25T08:14:46.000Z"},{id:3,serial_number:"823642",provider:"Novomatic",cabinet:"FV637C F2",game_mix:null,status:"Inactive",location:"București",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-10-01T10:00:00.000Z"}];l(Y),y(Y),U.success(`Încărcate ${Y.length} sloturi (date demo)`)}}finally{N(!1)}},Ye=async()=>{N(!0);try{const w=await re.get("/api/cyber/locations",{timeout:1e4}),V=Array.isArray(w.data)?w.data:[];i(V),A(V),U.success(`Încărcate ${V.length} locații din Cyber`)}catch(w){console.error("Error fetching Cyber locations from API, loading from JSON file:",w);try{const V=await re.get("/cyber-locations.json"),Y=Array.isArray(V.data)?V.data:[];i(Y),A(Y),U.success(`Încărcate ${Y.length} locații din fișierul Cyber`)}catch(V){console.error("Error loading from JSON file, using demo data:",V);const Y=[{id:1,name:"Craiova",location:"Craiova",address:"Str. Principală 123",city:"Craiova",company:"ENTERTAINMENT SOLUTIONS SRL",surface_area:100,status:"Active",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-01-01T10:00:00.000Z"},{id:2,name:"Ploiești",location:"Ploiești",address:"Bld. Republicii 21",city:"Ploiești",company:"SMARTFLIX SRL",surface_area:80,status:"Active",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-01-01T10:00:00.000Z"},{id:3,name:"București",location:"București",address:"Calea Victoriei 100",city:"București",company:"ENTERTAINMENT SOLUTIONS SRL",surface_area:150,status:"Active",last_updated:"2025-10-15T11:00:00.000Z",created_at:"2025-01-01T10:00:00.000Z"}];i(Y),A(Y),U.success(`Încărcate ${Y.length} locații (date demo)`)}}finally{N(!1)}},Q=async()=>{N(!0);try{const w=await re.get("/api/cyber/cabinets",{timeout:1e4}),V=Array.isArray(w.data)?w.data:[];c(V),g(V),U.success(`Încărcate ${V.length} cabinete din Cyber`)}catch(w){console.error("Error fetching Cyber cabinets:",w),U.error("Eroare la încărcarea cabinetelor din Cyber"),c([]),g([])}finally{N(!1)}},ce=async()=>{N(!0);try{const w=await re.get("/api/cyber/game-mixes",{timeout:1e4}),V=Array.isArray(w.data)?w.data:[];p(V),_(V),U.success(`Încărcate ${V.length} game mix-uri din Cyber`)}catch(w){console.error("Error fetching Cyber game mixes:",w),U.error("Eroare la încărcarea game mix-urilor din Cyber"),p([]),_([])}finally{N(!1)}},ue=async()=>{N(!0);try{const w=await re.get("/api/cyber/providers",{timeout:1e4}),V=Array.isArray(w.data)?w.data:[];d(V),G(V),U.success(`Încărcați ${V.length} furnizori din Cyber`)}catch(w){console.error("Error fetching Cyber providers:",w),U.error("Eroare la încărcarea furnizorilor din Cyber"),d([]),G([])}finally{N(!1)}};h.useEffect(()=>{oe(),Be(),Ye(),Q(),ce(),ue()},[]),h.useEffect(()=>{let w=r;D&&(w=w.filter(V=>{var Y,we,Le,Ve;return((Y=V.serial_number)==null?void 0:Y.toLowerCase().includes(D.toLowerCase()))||((we=V.provider)==null?void 0:we.toLowerCase().includes(D.toLowerCase()))||((Le=V.cabinet)==null?void 0:Le.toLowerCase().includes(D.toLowerCase()))||((Ve=V.game_mix)==null?void 0:Ve.toLowerCase().includes(D.toLowerCase()))})),z.provider&&(w=w.filter(V=>V.provider===z.provider)),z.cabinet&&(w=w.filter(V=>V.cabinet===z.cabinet)),z.gameMix&&(w=w.filter(V=>V.game_mix===z.gameMix)),z.status&&(w=w.filter(V=>V.status===z.status)),y(w)},[r,D,z]),h.useEffect(()=>{let w=n;D&&(w=w.filter(V=>{var Y,we,Le,Ve;return((Y=V.name)==null?void 0:Y.toLowerCase().includes(D.toLowerCase()))||((we=V.address)==null?void 0:we.toLowerCase().includes(D.toLowerCase()))||((Le=V.city)==null?void 0:Le.toLowerCase().includes(D.toLowerCase()))||((Ve=V.company)==null?void 0:Ve.toLowerCase().includes(D.toLowerCase()))})),P.company&&(w=w.filter(V=>V.company===P.company)),P.city&&(w=w.filter(V=>V.city===P.city)),P.status&&(w=w.filter(V=>V.status===P.status)),A(w)},[n,D,P]);const pe=w=>Array.isArray(r)?[...new Set(r.map(V=>V[w]).filter(Boolean))]:(console.warn("cyberData is not an array:",r),[]),Te=w=>Array.isArray(n)?[...new Set(n.map(V=>V[w]).filter(Boolean))]:(console.warn("cyberLocations is not an array:",n),[]),ee=w=>{const V=new Set(F);V.has(w)?V.delete(w):V.add(w),I(V)},me=w=>{const V=new Set(x);V.has(w)?V.delete(w):V.add(w),v(V)},fe=()=>{if(!Array.isArray(b)){console.warn("filteredData is not an array:",b),I(new Set);return}const w=b.map(V=>V.id);I(new Set(w))},ne=()=>{if(!Array.isArray(k)){console.warn("filteredLocations is not an array:",k),v(new Set);return}const w=k.map(V=>V.id);v(new Set(w))},le=()=>{I(new Set)},be=()=>{v(new Set)},te=async()=>{if(F.size===0){U.error("Selectează cel puțin un element pentru import");return}try{if(!Array.isArray(b)){console.warn("filteredData is not an array:",b),U.error("Date invalide pentru import");return}const w=b.filter(Y=>F.has(Y.id)),V=await re.post("/api/slots/import-marina",{items:w});U.success(`${V.data.imported} sloturi importate cu succes!`),I(new Set),Be()}catch(w){console.error("Error importing slots:",w),U.error("Eroare la importarea sloturilor")}},ie=async()=>{if(x.size===0){U.error("Selectează cel puțin o locație pentru import");return}try{if(!Array.isArray(k)){console.warn("filteredLocations is not an array:",k),U.error("Date invalide pentru import");return}const w=k.filter(Y=>x.has(Y.id)),V=await re.post("/api/locations/import-marina",{items:w});U.success(`${V.data.imported} locații importate cu succes!`),v(new Set),Ye()}catch(w){console.error("Error importing locations:",w),U.error("Eroare la importarea locațiilor")}},Ce=async()=>{if(b.length===0){U.error("Nu există date de importat");return}try{const w=await re.post("/api/slots/import-marina",{items:b});U.success(`${w.data.imported} sloturi importate cu succes!`),I(new Set),Be()}catch(w){console.error("Error importing all slots:",w),U.error("Eroare la importarea sloturilor")}},Pe=async()=>{if(k.length===0){U.error("Nu există locații de importat");return}try{const w=await re.post("/api/locations/import-marina",{items:k});U.success(`${w.data.imported} locații importate cu succes!`),v(new Set),Ye()}catch(w){console.error("Error importing all locations:",w),U.error("Eroare la importarea locațiilor")}};h.useEffect(()=>{Be(),Ye()},[]);const Ae=[{key:"select",title:"",sortable:!1,render:w=>e("input",{type:"checkbox",checked:F.has(w.id),onChange:()=>ee(w.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})},{key:"serial_number",title:"Serial Number",sortable:!0,render:w=>e("div",{className:"font-mono text-sm font-medium text-slate-800 dark:text-slate-200",children:w.serial_number||"N/A"})},{key:"provider",title:"Provider",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200 font-medium",children:w.provider||"N/A"})},{key:"cabinet",title:"Cabinet",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.cabinet||"N/A"})},{key:"game_mix",title:"Game Mix",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:wt(w.game_mix_name||w.game_mix)})},{key:"status",title:"Status",sortable:!0,render:w=>e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="Active"?"bg-green-100 text-green-800":w.status==="Inactive"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status||"N/A"})},{key:"location",title:"Location",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400",children:w.location||"N/A"})},{key:"address",title:"Adresă",sortable:!0,render:w=>t("div",{className:"text-slate-800 dark:text-slate-200",children:[e("div",{className:"text-sm",children:w.address||"N/A"}),w.city&&e("div",{className:"text-xs text-slate-500",children:w.city})]})},{key:"company",title:"Companie",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.company||"N/A"})},{key:"last_updated",title:"Last Updated",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.last_updated?new Date(w.last_updated).toLocaleDateString("ro-RO"):"N/A"})}],B=[{key:"select",title:"",sortable:!1,render:w=>e("input",{type:"checkbox",checked:F.has(w.serial_number),onChange:()=>ee(w.serial_number),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})},{key:"serial_number",title:"Serial Number",sortable:!0,render:w=>e("div",{className:"font-mono text-sm font-medium text-slate-800 dark:text-slate-200",children:w.serial_number||"N/A"})},{key:"producator",title:"Producător",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200 font-medium",children:w.producator||"N/A"})},{key:"cabinet",title:"Cabinet",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.cabinet||"N/A"})},{key:"mix",title:"Game Mix",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:wt(w.mix)})},{key:"location",title:"Locație",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400",children:w.location||"N/A"})},{key:"address",title:"Adresă",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:e("div",{className:"text-sm",children:w.address||"N/A"})})},{key:"status",title:"Status",sortable:!0,render:w=>e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="Active"?"bg-green-100 text-green-800":w.status==="Inactive"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status||"N/A"})},{key:"manufacture_year",title:"An Fabricat",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.manufacture_year||"N/A"})}],M=[{key:"select",title:"",sortable:!1,render:w=>e("input",{type:"checkbox",checked:x.has(w.id),onChange:()=>me(w.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})},{key:"name",title:"Nume Locație",sortable:!0,render:w=>e("div",{className:"font-medium text-slate-800 dark:text-slate-200",children:w.name||"N/A"})},{key:"address",title:"Adresă",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.address||"N/A"})},{key:"city",title:"Oraș",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200",children:w.city||"N/A"})},{key:"company",title:"Companie",sortable:!0,render:w=>e("div",{className:"text-slate-800 dark:text-slate-200 font-medium",children:w.company||"N/A"})},{key:"surface_area",title:"Suprafață (m²)",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400",children:w.surface_area?`${w.surface_area} m²`:"N/A"})},{key:"status",title:"Status",sortable:!0,render:w=>e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="Active"?"bg-green-100 text-green-800":w.status==="Inactive"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status||"N/A"})},{key:"last_updated",title:"Ultima Actualizare",sortable:!0,render:w=>e("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:w.last_updated?new Date(w.last_updated).toLocaleDateString("ro-RO"):"N/A"})}];return e(he,{children:t("div",{className:"p-6 space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>a("/slots"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5"})}),t("div",{children:[t("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 flex items-center space-x-2",children:[e(ot,{className:"w-6 h-6"}),e("span",{children:"Import Cyber"})]}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Importează datele din serverul Cyber"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>{var w;return(w=s.current)==null?void 0:w.click()},className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Hs,{className:"w-4 h-4"}),e("span",{children:"Încarcă JSON"})]}),e("input",{ref:s,type:"file",accept:".json",onChange:rt,className:"hidden"}),R==="audit"&&t("button",{onClick:se,className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg flex items-center space-x-2 transition-all font-medium shadow-lg",disabled:j,children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"📅 Cyber DB (Ieri)"})]}),R==="slots"&&t(De,{children:[t("button",{onClick:Se,className:"px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Import Safe"})]}),t("button",{onClick:de,className:"px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Cyber"})]})]}),R==="locations"&&t("button",{onClick:Oe,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Locații"})]}),R==="gameMixes"&&t("button",{onClick:Ue,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Game Mixuri"})]}),R==="cabinets"&&t("button",{onClick:Ze,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Cabinete"})]}),R==="providers"&&t("button",{onClick:$e,className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Sincronizează Furnizori"})]}),t("button",{onClick:()=>{R==="audit"?oe():R==="slots"?Be():R==="locations"?Ye():R==="cabinets"?Q():R==="gameMixes"?ce():R==="providers"&&ue()},disabled:j,className:"px-4 py-3 bg-slate-500 hover:bg-slate-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ht,{className:`w-4 h-4 ${j?"animate-spin":""}`}),e("span",{children:"Refresh Cyber DB"})]})]})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:e("div",{className:"border-b border-slate-200 dark:border-slate-700",children:t("nav",{className:"-mb-px flex space-x-8 px-6",children:[t("button",{onClick:()=>C("audit"),className:`py-4 px-1 border-b-2 font-medium text-sm ${R==="audit"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Machine Audit (",f.length,")"]}),t("button",{onClick:()=>C("slots"),className:`py-4 px-1 border-b-2 font-medium text-sm ${R==="slots"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Sloturi (",r.length,")"]}),t("button",{onClick:()=>C("locations"),className:`py-4 px-1 border-b-2 font-medium text-sm ${R==="locations"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Locații (",n.length,")"]}),t("button",{onClick:()=>C("cabinets"),className:`py-4 px-1 border-b-2 font-medium text-sm ${R==="cabinets"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Cabinete (",o.length,")"]}),t("button",{onClick:()=>C("gameMixes"),className:`py-4 px-1 border-b-2 font-medium text-sm ${R==="gameMixes"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Game Mixes (",u.length,")"]}),t("button",{onClick:()=>C("providers"),className:`py-4 px-1 border-b-2 font-medium text-sm ${R==="providers"?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:["Furnizori (",m.length,")"]})]})})}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200",children:R==="audit"?f.length:R==="slots"?r.length:n.length}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total înregistrări"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-blue-600",children:R==="audit"?f.length:R==="slots"?b.length:k.length}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Filtrate"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-green-600",children:R==="audit"||R==="slots"?F.size:x.size}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Selectate"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[e("div",{className:"text-2xl font-bold text-purple-600",children:R==="audit"?[...new Set(f.map(w=>w.producator))].length:R==="slots"?pe("provider").length:Te("company").length}),e("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:R==="audit"?"Producători":R==="slots"?"Provideri":"Companii"})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[t("div",{className:"flex flex-col lg:flex-row gap-4",children:[e("div",{className:"flex-1",children:t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e("input",{type:"text",placeholder:R==="audit"?"Caută după serial, producător, cabinet, locație...":R==="slots"?"Caută după serial, provider, cabinet...":"Caută după nume, adresă, oraș, companie...",value:D,onChange:w=>S(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})}),t("button",{onClick:()=>K(!L),className:"btn-secondary flex items-center space-x-2",children:[e(Xt,{className:"w-4 h-4"}),e("span",{children:"Filtre"})]})]}),L&&e("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:e("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:R==="slots"?t(De,{children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Provider"}),t("select",{value:z.provider,onChange:w=>J({...z,provider:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("provider").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Cabinet"}),t("select",{value:z.cabinet,onChange:w=>J({...z,cabinet:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("cabinet").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Game Mix"}),t("select",{value:z.gameMix,onChange:w=>J({...z,gameMix:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("game_mix").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Status"}),t("select",{value:z.status,onChange:w=>J({...z,status:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),pe("status").map(w=>e("option",{value:w,children:w},w))]})]})]}):t(De,{children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Companie"}),t("select",{value:P.company,onChange:w=>Z({...P,company:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),Te("company").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Oraș"}),t("select",{value:P.city,onChange:w=>Z({...P,city:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),Te("city").map(w=>e("option",{value:w,children:w},w))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Status"}),t("select",{value:P.status,onChange:w=>Z({...P,status:w.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Toate"}),Te("status").map(w=>e("option",{value:w,children:w},w))]})]}),e("div",{})]})})})]}),t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:R==="audit"||R==="slots"?fe:ne,className:"btn-secondary flex items-center space-x-2",children:[e(kt,{className:"w-4 h-4"}),e("span",{children:"Selectează toate"})]}),t("button",{onClick:R==="audit"||R==="slots"?le:be,className:"btn-secondary flex items-center space-x-2",children:[e(Ys,{className:"w-4 h-4"}),e("span",{children:"Deselectează toate"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:R==="audit"||R==="slots"?te:ie,disabled:R==="audit"||R==="slots"?F.size===0:x.size===0,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(ze,{className:"w-4 h-4"}),t("span",{children:["Importă selectate (",R==="audit"||R==="slots"?F.size:x.size,")"]})]}),t("button",{onClick:R==="audit"||R==="slots"?Ce:Pe,disabled:R==="audit"?f.length===0:R==="slots"?b.length===0:k.length===0,className:"btn-success flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(Je,{className:"w-4 h-4"}),t("span",{children:["Importă toate (",R==="audit"?f.length:R==="slots"?b.length:k.length,")"]})]})]})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e("tr",{children:(R==="audit"?B:R==="slots"?Ae:M).map(w=>e("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider",children:w.title},w.key))})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:j?e("tr",{children:e("td",{colSpan:(R==="audit"?B:R==="slots"?Ae:M).length,className:"px-6 py-12 text-center",children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ht,{className:"w-5 h-5 animate-spin text-blue-600"}),e("span",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă datele din Cyber..."})]})})}):(R==="audit"?f:R==="slots"?b:k).length===0?e("tr",{children:e("td",{colSpan:(R==="audit"?B:R==="slots"?Ae:M).length,className:"px-6 py-12 text-center",children:e("div",{className:"text-slate-500 dark:text-slate-400",children:R==="audit"?f.length===0?"Nu există date în Machine Audit Summaries":"Nu există rezultate pentru filtrele aplicate":R==="slots"?r.length===0?"Nu există sloturi în Cyber":"Nu există rezultate pentru filtrele aplicate":n.length===0?"Nu există locații în Cyber":"Nu există rezultate pentru filtrele aplicate"})})}):(R==="audit"?f:R==="slots"?b:k).map((w,V)=>e("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700",children:(R==="audit"?B:R==="slots"?Ae:M).map(Y=>e("td",{className:"px-6 py-4 whitespace-nowrap",children:Y.render?Y.render(w):w[Y.key]},Y.key))},w.id||V))})]})})})]})})},Ao=()=>{const{slots:a,invoices:s,warehouse:r,loading:l,createItem:n,updateItem:i,deleteItem:o,exportToExcel:c,exportToPDF:u}=ye(),{user:p}=Ot(),m=He(),[d,f]=h.useState(""),[T,b]=h.useState("all"),[y,k]=h.useState("all"),[A,O]=h.useState("all"),[g,$]=h.useState([]),[_,E]=h.useState(!1),[G,j]=h.useState(null),[N,D]=h.useState([]),[S,F]=h.useState(!1),[I,x]=h.useState(!1),[v,L]=h.useState(!1),[K,R]=h.useState(null);h.useState(!1);const[C,z]=h.useState({totalSlots:!1,activeSlots:!1,inactiveSlots:!1,maintenanceSlots:!1,ownedSlots:!1,rentedSlots:!1}),[J,P]=h.useState([]);h.useEffect(()=>{(async()=>{try{const M=await re.get("/api/commissions");P(M.data)}catch(M){console.error("Error loading commissions:",M)}})()},[]),h.useEffect(()=>{(async()=>{var M;if(p!=null&&p.id)try{const Y=(await re.get(`/api/users/${p.id}`)).data.preferences||{};(M=Y.slots)!=null&&M.cardVisibility&&z(Y.slots.cardVisibility)}catch(w){console.error("Error loading slots preferences:",w)}})()},[p==null?void 0:p.id]);const Z=async B=>{if(p!=null&&p.id)try{await re.put(`/api/users/${p.id}/preferences`,{preferences:{slots:{cardVisibility:B}}})}catch(M){console.error("Error saving slots preferences:",M)}},[se,oe]=h.useState(!1);h.useEffect(()=>{F(N.length>0)},[N]);const de=B=>{const M={...C,[B]:!C[B]};z(M),Z(M)},Se=()=>{const B={totalSlots:!0,activeSlots:!0,inactiveSlots:!0,maintenanceSlots:!0,ownedSlots:!0,rentedSlots:!0};z(B),Z(B)},Oe=()=>{const B={totalSlots:!1,activeSlots:!1,inactiveSlots:!1,maintenanceSlots:!1,ownedSlots:!1,rentedSlots:!1};z(B),Z(B)},Ue=a.filter(B=>{var Le,Ve,je,st,Dt;const M=((Le=B.name)==null?void 0:Le.toLowerCase().includes(d.toLowerCase()))||((Ve=B.model)==null?void 0:Ve.toLowerCase().includes(d.toLowerCase()))||((je=B.provider)==null?void 0:je.toLowerCase().includes(d.toLowerCase()))||((st=B.location)==null?void 0:st.toLowerCase().includes(d.toLowerCase()))||((Dt=B.serial_number)==null?void 0:Dt.toLowerCase().includes(d.toLowerCase())),w=T==="all"||B.status===T,V=y==="all"||B.provider===y,Y=A==="all"||B.property_type===A,we=g.length===0||g.some(Jt=>(B.commission_date?new Date(B.commission_date).toISOString().split("T")[0]:null)===Jt);return M&&w&&V&&Y&&we}),Ze=[...new Set(a.map(B=>B.provider).filter(Boolean))],$e=a.length,rt=a.filter(B=>B.status==="Active").length,Be=a.filter(B=>B.status==="Inactive").length,Ye=a.filter(B=>B.status==="Maintenance").length,Q=a.filter(B=>B.property_type==="Owned").length,ce=a.filter(B=>B.property_type==="Rented").length,ue=[{key:"serial_number",label:"SERIAL NUMBER",sortable:!0,render:B=>e("button",{onClick:()=>m(`/slots/${B.id}`),className:"text-blue-600 hover:text-blue-800 font-semibold text-base hover:underline transition-colors text-left",children:B.serial_number||"N/A"})},{key:"provider",label:"FURNIZOR",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:B.provider||"N/A"})},{key:"location",label:"LOCAȚIE",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:B.location||"N/A"})},{key:"cabinet",label:"CABINET",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:B.cabinet||"N/A"})},{key:"game_mix",label:"GAME MIX",sortable:!0,render:B=>e("div",{className:"text-slate-800 font-medium text-base",children:wt(B.game_mix_name||B.game_mix)})},{key:"commission_date",label:"DATA COMISIE",sortable:!0,render:B=>{const M=B.commission_date?new Date(B.commission_date):null,w=B.expiry_date?new Date(B.expiry_date):null,V=w?Math.ceil((w-new Date)/(1e3*60*60*24)):null;return e("div",{className:"text-slate-800 font-medium text-base",children:M?t("div",{children:[e("div",{children:M.toLocaleDateString("ro-RO")}),V!==null&&e("div",{className:`text-xs ${V<=0?"text-red-600":V<=30?"text-yellow-600":"text-green-600"}`,children:V<=0?"Expirat":`${V} zile până la expirare`})]}):"N/A"})}},{key:"invoice",label:"FACTURĂ",sortable:!1,render:B=>{const M=s==null?void 0:s.find(w=>{if(!w.serial_number||!B.serial_number)return!1;let V=[];try{typeof w.serial_number=="string"?V=JSON.parse(w.serial_number):Array.isArray(w.serial_number)?V=w.serial_number:V=[w.serial_number]}catch{V=[w.serial_number.toString()]}return V.some(Y=>Y.toString()===B.serial_number.toString())});return M?e("div",{className:"flex items-center space-x-2",children:e("button",{onClick:()=>m(`/invoices/${M.id}`),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-sm hover:underline transition-colors",children:M.invoice_number})}):e("span",{className:"text-slate-400 dark:text-slate-500 text-sm",children:"-"})}},{key:"status",label:"STATUS",sortable:!0,render:B=>{var Y;const M=async()=>{var je;const we=((je=B.status)==null?void 0:je.toLowerCase())||"",Ve=we==="activ"||we==="active"?"Inactive":"Active";try{Ve==="Inactive"?(await n("warehouse",{serial_number:B.serial_number,provider:B.provider,location:"Depozit",cabinet:B.cabinet,game_mix:B.game_mix,status:"Inactive",notes:"Mutat automat din sloturi când a devenit inactiv"}),await o("slots",B.id),U.success("Slot mutat în Depozit")):(await i("slots",B.id,{...B,status:Ve}),U.success(`Status schimbat în ${Ve}`))}catch(st){U.error("Eroare la actualizare status"),console.error("Error updating slot status:",st)}},w=((Y=B.status)==null?void 0:Y.toLowerCase())||"",V=w==="activ"||w==="active";return t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:M,className:`relative inline-flex h-5 w-10 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 ${V?"bg-green-500":"bg-gray-300"}`,children:e("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${V?"translate-x-6":"translate-x-1"}`})}),e("span",{className:`text-xs font-bold ${V?"text-green-600":"text-gray-600"}`,children:V?"ON":"OFF"})]})}},{key:"cvt_date",label:"DATA CVT",sortable:!0,render:B=>{const M=B.cvt_date?new Date(B.cvt_date):null,w=M?Math.ceil((M-new Date)/(1e3*60*60*24)):null;return e("div",{className:"text-slate-800 font-medium text-base",children:M?t("div",{children:[e("div",{children:M.toLocaleDateString("ro-RO")}),w!==null&&e("div",{className:`text-xs ${w<=0?"text-red-600":w<=30?"text-yellow-600":"text-green-600"}`,children:w<=0?"Expirat":`${w} zile rămase`})]}):"N/A"})}},{key:"address",label:"ADRESĂ",sortable:!0,render:B=>t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{className:"text-sm",children:B.address||"N/A"}),B.city&&e("div",{className:"text-xs text-slate-500",children:B.city})]})},{key:"jackpot",label:"JACKPOT",sortable:!1,render:B=>B.jackpot_name?t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{className:"text-sm font-semibold text-green-600",children:B.jackpot_name}),e("div",{className:"text-xs text-slate-500",children:B.current_amount?`${B.current_amount.toLocaleString("ro-RO")} RON`:"N/A"}),B.jackpot_type&&e("div",{className:"text-xs text-slate-400",children:B.jackpot_type})]}):e("span",{className:"text-slate-400 dark:text-slate-500 text-sm",children:"-"})}],pe=()=>{j(null),E(!0)},Te=B=>{j(B),E(!0)},ee=B=>{D(B?Ue.map(M=>M.id):[])},me=(B,M)=>{D(M?[...N,B]:N.filter(w=>w!==B))},fe=async()=>{N.length!==0&&L(!0)},ne=async()=>{L(!1);const B=N.length;let M=0,w=0;const V=[];try{const Y=U.loading(`Șterg ${B} sloturi...`,{duration:1/0}),we=10;for(let Le=0;Le<N.length;Le+=we){const je=N.slice(Le,Le+we).map(async Dt=>{try{await o("slots",Dt,!0),M++}catch(Jt){w++,V.push(`Slot ${Dt}: ${Jt.message}`)}});await Promise.all(je);const st=Math.min(Le+we,B);U.loading(`Șterg ${B} sloturi... (${st}/${B})`,{id:Y})}U.dismiss(Y),w===0?U.success(`✅ ${M} sloturi șterse cu succes!`,{duration:5e3}):M>0?U.success(`⚠️ ${M} sloturi șterse, ${w} erori`,{duration:5e3}):U.error(`❌ Eroare la ștergerea tuturor ${B} sloturi`,{duration:5e3}),D([]),F(!1)}catch(Y){console.error("Error bulk deleting slots:",Y),U.error("Eroare la ștergerea sloturilor!"),L(!1)}},le=async()=>{if(!(N.length===0||!window.confirm(`Sigur vrei să muți ${N.length} sloturi selectate în DEPOZIT?

Sloturile vor fi șterse din tabelul Sloturi și mutate în Warehouse.`)))try{U.loading(`Mutare ${N.length} sloturi în depozit...`,{id:"bulk-move"});const M=a.filter(w=>N.includes(w.id));for(const w of M)await n("warehouse",{serial_number:w.serial_number,provider:w.provider,cabinet:w.cabinet,game_mix:w.game_mix,status:"In Depozit",location:"Depozit",notes:`Mutat din ${w.location||"Unknown"} la ${new Date().toLocaleDateString("ro-RO")}`}),await o("slots",w.id);D([]),F(!1),U.success(`${M.length} sloturi mutate în Depozit cu succes!`,{id:"bulk-move"}),await refreshData()}catch(M){console.error("Error moving slots to warehouse:",M),U.error("Eroare la mutarea sloturilor în depozit!",{id:"bulk-move"})}},be=async B=>{R(B),x(!0)},te=async()=>{try{await o("slots",K),x(!1),R(null),U.success("Slot șters cu succes!")}catch(B){U.error("Eroare la ștergerea slotului"),console.error("Error deleting slot:",B)}},ie=async B=>{try{G?(await i("slots",G.id,B),U.success("Slot actualizat cu succes!")):(await n("slots",B),U.success("Slot adăugat cu succes!")),E(!1),j(null)}catch(M){U.error("Eroare la salvarea slotului"),console.error("Error saving slot:",M)}},Ce=()=>{try{c("slots")}catch(B){U.error("Eroare la exportarea în Excel"),console.error("Error exporting to Excel:",B)}},Pe=()=>{try{u("slots")}catch(B){U.error("Eroare la exportarea în PDF"),console.error("Error exporting to PDF:",B)}},Ae=()=>{U.info("Funcționalitatea de import va fi implementată în curând")};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-emerald-500 to-green-500 rounded-2xl shadow-lg shadow-emerald-500/25",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Sloturi"}),e("p",{className:"text-slate-600",children:"Gestionează sloturile de gaming din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>oe(!se),className:"px-4 py-3 bg-slate-500 hover:bg-slate-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Xt,{className:"w-4 h-4"}),e("span",{children:"Setări Carduri"})]}),e(ft,{onExportExcel:Ce,onExportPDF:Pe,entity:"slots"}),t("div",{className:"flex space-x-3",children:[S&&t(De,{children:[t("button",{onClick:le,className:"btn-secondary flex items-center space-x-2 bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white",children:[e(At,{className:"w-4 h-4"}),t("span",{children:["Mută în Depozit (",N.length,")"]})]}),t("button",{onClick:fe,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:()=>m("/slots/history"),className:"px-4 py-3 bg-slate-500 hover:bg-slate-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Za,{className:"w-4 h-4"}),e("span",{children:"Istoric Sloturi"})]}),t("button",{onClick:()=>m("/slots/cyber-import"),className:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(ot,{className:"w-4 h-4"}),e("span",{children:"Import Cyber"})]}),t("button",{onClick:pe,className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg flex items-center space-x-2 transition-all font-medium",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Slot"})]})]})]})]})}),se&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:[t("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Carduri"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Selectează ce carduri să afișezi"})]}),t("div",{className:"p-6 space-y-4",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Selectează tot"}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:Se,className:"text-xs px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",children:"Selectează tot"}),e("button",{onClick:Oe,className:"text-xs px-3 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:"Deselectează tot"})]})]}),e("div",{className:"space-y-3",children:[{key:"totalSlots",label:"Total Sloturi"},{key:"activeSlots",label:"Active"},{key:"inactiveSlots",label:"Inactive"},{key:"maintenanceSlots",label:"Mentenanță"},{key:"ownedSlots",label:"Proprietate"},{key:"rentedSlots",label:"Închiriate"}].map(B=>t("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:B.label}),e("input",{type:"checkbox",checked:C[B.key],onChange:()=>de(B.key),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})]},B.key))})]}),e("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e("button",{onClick:()=>oe(!1),className:"btn-primary px-6 py-2",children:"Salvează"})})]})}),C.totalSlots&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e(Tt,{title:"Total Sloturi",value:$e,icon:it,color:"blue",trend:null}),C.activeSlots&&e(Tt,{title:"Active",value:rt,icon:kt,color:"green",trend:null}),C.inactiveSlots&&e(Tt,{title:"Inactive",value:Be,icon:nt,color:"red",trend:null}),C.maintenanceSlots&&e(Tt,{title:"Mentenanță",value:Ye,icon:la,color:"yellow",trend:null})]}),(C.ownedSlots||C.rentedSlots)&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[C.ownedSlots&&e(Tt,{title:"Proprietate",value:Q,icon:kt,color:"emerald",trend:null}),C.rentedSlots&&e(Tt,{title:"Închiriate",value:ce,icon:nt,color:"orange",trend:null})]}),e("div",{className:"card p-6",children:t("div",{className:"flex flex-col lg:flex-row items-start lg:items-center space-y-4 lg:space-y-0 lg:space-x-4",children:[t("div",{className:"relative flex-1 lg:max-w-md",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după nume, model, furnizor, locație sau numărul de serie...",value:d,onChange:B=>f(B.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),t("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e(Xt,{className:"w-4 h-4 text-slate-500"}),e("span",{className:"text-sm font-semibold text-slate-700",children:"Filtre:"})]}),t("select",{value:T,onChange:B=>b(B.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",children:[e("option",{value:"all",children:"Toate Statusurile"}),e("option",{value:"Active",children:"Active"}),e("option",{value:"Inactive",children:"Inactive"}),e("option",{value:"Maintenance",children:"Mentenanță"})]}),t("select",{value:y,onChange:B=>k(B.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",children:[e("option",{value:"all",children:"Toți Furnizorii"}),Ze.map(B=>e("option",{value:B,children:B},B))]}),t("select",{value:A,onChange:B=>O(B.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm",children:[e("option",{value:"all",children:"Toate Tipurile"}),e("option",{value:"Owned",children:"Proprietate"}),e("option",{value:"Rented",children:"Închiriate"})]}),t("select",{value:g.length>0?g[0]:"all",onChange:B=>{B.target.value==="all"?$([]):$([B.target.value])},className:"px-4 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e("option",{value:"all",children:"Toate Comisiile"}),J.map(B=>{const M=new Date(B.commission_date).toISOString().split("T")[0];return t("option",{value:M,children:[B.name," (",new Date(B.commission_date).toLocaleDateString("ro-RO"),")"]},B.id)})]}),t("button",{onClick:Ae,className:"btn-secondary flex items-center space-x-2 text-sm",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})]})}),e("div",{className:"card p-6",children:l?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):Ue.length===0?t("div",{className:"text-center py-12",children:[e(it,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există sloturi"}),e("p",{className:"text-slate-500",children:"Adaugă primul slot pentru a începe"})]}):e(qe,{data:Ue,columns:ue,onEdit:Te,onDelete:be,searchTerm:d,onSearchChange:f,selectedItems:N,onSelectAll:ee,onSelectItem:me,moduleColor:"blue"})}),_&&e(So,{item:G,onClose:()=>E(!1),onSave:ie}),I&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(Fe,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[e("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Șterge Slot"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),e("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:"Ești sigur că vrei să ștergi acest slot? Toate datele asociate vor fi șterse permanent."}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>{x(!1),R(null)},className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),e("button",{onClick:te,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Șterge"})]})]})}),v&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(Fe,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Șterge ",N.length," Sloturi"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",N.length," sloturi selectate? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>L(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:ne,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",N.length," Sloturi"]})]})]})})]})})},Eo=()=>{const{id:a}=It(),s=He(),{slots:r,locations:l,companies:n,providers:i,cabinets:o,gameMixes:c,platforms:u,metrology:p,invoices:m,jackpots:d,loading:f}=ye();console.log("🔍 useData Debug:",{loading:f,slots:r==null?void 0:r.length,locations:l==null?void 0:l.length,companies:n==null?void 0:n.length,providers:i==null?void 0:i.length,cabinets:o==null?void 0:o.length,gameMixes:c==null?void 0:c.length,platforms:u==null?void 0:u.length,metrology:p==null?void 0:p.length,invoices:m==null?void 0:m.length,jackpots:d==null?void 0:d.length});const[T,b]=h.useState(!1),[y,k]=h.useState(!0),[A,O]=h.useState([]),g=r==null?void 0:r.find(x=>{const v=x.id==a,L=x.serial_number===a;return console.log(`🔍 Checking slot ${x.id}/${x.serial_number} against ${a}: ${v}/${L}`),v||L});console.log("🔍 SlotDetail Debug:",{id:a,idType:typeof a,slotsCount:r==null?void 0:r.length,slot:g,allSlots:r==null?void 0:r.map(x=>({id:x.id,serial_number:x.serial_number}))}),h.useEffect(()=>{k(JSON.parse(!1))},[]),h.useEffect(()=>{(async()=>{if(!(!(g!=null&&g.id)&&!(g!=null&&g.serial_number)))try{const v=await re.get("/api/slot-history",{params:{slot_id:g.id,limit:3,offset:0}});O(v.data.data||v.data||[])}catch(v){console.error("Error fetching slot history:",v),O([])}})()},[g==null?void 0:g.id,g==null?void 0:g.serial_number]);const $=x=>{k(x)};if(f)return e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă detaliile slotului..."})]})})});const _=x=>{const v=l.find(L=>L.id===x||L.name===x);return v?v.name:x},E=x=>{const v=i.find(L=>L.id===x||L.name===x);return v?v.name:x},G=x=>{const v=o.find(L=>L.id===x);return v?v.name||v.model:x},j=x=>{const v=c.find(L=>L.id===x||L.name===x);return v?v.name:x},N=x=>{const v=c.find(L=>L.id===x||L.name===x);return v&&v.platform?v.platform:"N/A"},D=(p==null?void 0:p.filter(x=>x.serial_number===(g==null?void 0:g.serial_number)))||[],S=(m==null?void 0:m.filter(x=>{if(!x.serial_number||!(g!=null&&g.serial_number))return!1;try{return(typeof x.serial_number=="string"?JSON.parse(x.serial_number):Array.isArray(x.serial_number)?x.serial_number:[x.serial_number]).includes(g.serial_number)}catch{return x.serial_number===g.serial_number}}))||[],F=(d==null?void 0:d.filter(x=>x.slot_id===(g==null?void 0:g.id)))||[],I=S.length>0&&S[0].invoice_type==="Vânzare"?"Owned":"Rented";return g?e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 mb-6",children:e("div",{className:"bg-gradient-to-r from-emerald-800 via-green-800 to-teal-800 px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("button",{onClick:()=>s("/slots"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-white"})}),e("div",{className:"p-2 bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[t("h1",{className:"text-2xl font-bold text-white",children:["Slot ",g.serial_number]}),t("p",{className:"text-emerald-100",children:["Serial: ",g.serial_number]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>b(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Setări",children:e(Lt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>s(`/slots/${g.id}/edit`),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Editează",children:e(tt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>{window.confirm("Sigur vrei să ștergi acest slot?")&&(U.success("Slot șters cu succes!"),s("/slots"))},className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Șterge",children:e(Fe,{className:"w-5 h-5 text-white"})})]})]})})}),T&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md",children:[e("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Afișare"})}),e("div",{className:"p-6 space-y-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"font-medium text-slate-800 dark:text-slate-200",children:"Afișare automată atașamente"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Afișează automat PDF-urile în pagina de detalii"})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:y,onChange:x=>$(x.target.checked),className:"sr-only peer"}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})}),e("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e("button",{onClick:()=>b(!1),className:"btn-primary",children:"Închide"})})]})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e("div",{children:t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-3 flex items-center",children:[e(Lt,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Informații Slot"]}),t("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t("div",{className:"space-y-2",children:[t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Serial Number"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:g.serial_number})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Locație"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:_(g.location)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Furnizor"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:E(g.provider)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Cabinet"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:G(g.cabinet)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Platformă"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:N(g.game_mix)})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Game Mix"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:j(g.game_mix)})]})]}),t("div",{className:"space-y-2",children:[t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Status"}),e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${g.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:g.status})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Denomination"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:g.denomination||"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"RTP"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:g.rtp||"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Gaming Places"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:g.gaming_places||"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Max Bet"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:g.max_bet||"N/A"})]})]})]}),e("div",{className:"border-t border-slate-200 dark:border-slate-700 my-4"}),t("div",{className:"grid grid-cols-3 gap-4",children:[t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Tip proprietate"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:I})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Data comisionării"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:g.commissioning_date?new Date(g.commissioning_date).toLocaleDateString("ro-RO"):"N/A"})]}),t("div",{children:[e("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Numărul facturii"}),e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:S.length>0?S[0].invoice_number:"N/A"}),S.length>0&&e("button",{onClick:()=>s(`/invoices/${S[0].id}`),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 mt-1",children:"Vezi factura →"})]})]})]})}),g.game_mix&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-3 flex items-center",children:[e(ct,{className:"w-4 h-4 mr-2 text-purple-600"}),"Jocuri din Game Mix"]}),t("div",{className:"p-3 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg border border-purple-200 dark:border-purple-700 mb-3",children:[e("h4",{className:"font-semibold text-purple-800 dark:text-purple-300 text-sm",children:g.game_mix}),e("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Game Mix activ"})]}),(()=>{const x=c.find(v=>v.name===g.game_mix);if(x&&x.games){const v=typeof x.games=="string"?JSON.parse(x.games):x.games;return t("div",{children:[e("div",{className:"mb-2 p-2 bg-gradient-to-r from-purple-100 to-indigo-100 dark:from-purple-900/30 dark:to-indigo-900/30 rounded",children:t("p",{className:"text-xs text-purple-700 dark:text-purple-300",children:[t("strong",{children:[v.length," jocuri"]})," în acest game mix",x.rtp&&t("span",{children:[" • RTP mediu: ",x.rtp,"%"]})]})}),e("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto",children:v.map((L,K)=>t("div",{className:"p-2 bg-white dark:bg-slate-700 rounded border border-slate-200 dark:border-slate-600",children:[e("p",{className:"font-medium text-slate-800 dark:text-slate-200 text-xs",children:L}),t("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Joc #",K+1]})]},K))})]})}return e("p",{className:"text-center py-4 text-slate-500 dark:text-slate-400 text-sm",children:"Nu s-au găsit jocuri pentru acest game mix"})})()]}),F.length>0&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-3 flex items-center",children:[e(it,{className:"w-4 h-4 mr-2 text-yellow-600"}),"Jackpots (",F.length,")"]}),e("div",{className:"space-y-2",children:F.map((x,v)=>e("div",{className:"p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:x.name}),t("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:[x.amount," ",x.currency]}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:x.triggered_date?`Declanșat: ${new Date(x.triggered_date).toLocaleDateString("ro-RO")}`:"Nu a fost declanșat"})]}),e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${x.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:x.status})]})},v))})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 flex items-center",children:[e(Za,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Istoric Modificări"]}),e("button",{onClick:()=>s("/slots/history"),className:"text-xs text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-300 font-medium",children:"Vezi toate →"})]}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full text-sm",children:[e("thead",{children:t("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Data"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Câmp"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Valoare veche"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Valoare nouă"}),e("th",{className:"text-left py-2 px-2 font-medium text-slate-700 dark:text-slate-300",children:"Utilizator"})]})}),e("tbody",{children:A.length===0?e("tr",{children:e("td",{colSpan:"5",className:"px-4 py-3 text-center text-slate-500 dark:text-slate-400",children:"Nu există modificări înregistrate pentru acest slot."})}):A.map((x,v)=>t("tr",{className:"border-b border-slate-100 dark:border-slate-700",children:[e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:new Date(x.created_at).toLocaleDateString("ro-RO")}),e("td",{className:"py-2 px-2",children:e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${x.field_name==="location"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":x.field_name==="status"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":x.field_name==="game_mix"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":x.field_name==="serial_number"?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-400":x.field_name==="provider"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":x.field_name==="cabinet"?"bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-400":"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}`,children:x.field_name})}),e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:x.old_value||"N/A"}),e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:x.new_value||"N/A"}),e("td",{className:"py-2 px-2 text-slate-600 dark:text-slate-400",children:x.username||"Sistem"})]},x.id||v))})]})}),e("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700",children:t("p",{className:"text-xs text-slate-500 dark:text-slate-400 text-center",children:["Afișate ultimele 3 modificări pentru slot ",g==null?void 0:g.serial_number," •",e("button",{onClick:()=>s("/slots/history"),className:"text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-300 ml-1",children:"Vezi istoricul complet"})]})})]})]}),(D.length>0||S.length>0)&&e("div",{className:"mt-6",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-4",children:[t("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Atașamente (",D.length+S.length,")"]}),y&&e("div",{className:"mb-4",children:t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[D.length>0&&D[0]&&D[0].cvtFile&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg p-3",children:[t("h4",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-orange-600"}),"CVT ",D[0].cvt_number]}),e("div",{className:"h-64 border border-slate-200 dark:border-slate-600 rounded overflow-hidden",children:e("iframe",{src:`http://localhost:5001/api/cvt-pdf/${D[0].id}`,className:"w-full h-full",title:`CVT Document ${D[0].cvt_number}`})})]}),S.length>0&&S[0]&&S[0].file_path&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg p-3",children:[t("h4",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-blue-600"}),"Factură ",S[0].invoice_number]}),e("div",{className:"h-64 border border-slate-200 dark:border-slate-600 rounded overflow-hidden",children:e("iframe",{src:S[0].file_path,className:"w-full h-full",title:`Factură ${S[0].invoice_number}`})})]})]})}),t("div",{className:"space-y-3",children:[D.length>0&&t("div",{children:[t("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-orange-600"}),"Certificat CVT"]}),e("div",{className:"space-y-2",children:D.map((x,v)=>t("div",{className:"p-2 bg-slate-50 dark:bg-slate-700 rounded-lg flex items-center justify-between",children:[t("div",{className:"flex-1",children:[e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:x.cvt_number}),t("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:["CVT: ",new Date(x.cvt_date).toLocaleDateString("ro-RO")," • Expirare: ",x.expiry_date?new Date(x.expiry_date).toLocaleDateString("ro-RO"):"N/A"]})]}),e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${x.status==="Active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:x.status})]},v))})]}),S.length>0&&t("div",{children:[t("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 flex items-center",children:[e(ge,{className:"w-3 h-3 mr-1 text-blue-600"}),"Facturi"]}),e("div",{className:"space-y-2",children:S.map((x,v)=>t("div",{className:"p-2 bg-slate-50 dark:bg-slate-700 rounded-lg flex items-center justify-between",children:[t("div",{className:"flex-1",children:[e("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200",children:x.invoice_number}),t("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:[x.amount," ",x.currency," • ",x.invoice_type]})]}),e("button",{onClick:()=>s(`/invoices/${x.id}`),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-xs",children:"Vezi →"})]},v))})]})]})]})})]})})}):e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă..."})]})})})},Do=()=>{const a=He(),{slots:s,users:r,loading:l}=ye(),[n,i]=h.useState([]),[o,c]=h.useState(!0),[u,p]=h.useState(null),[m,d]=h.useState(!1),[f,T]=h.useState({slot_id:"",serial_number:"",field_name:"",user_id:"",username:"",start_date:"",end_date:"",change_type:""}),[b,y]=h.useState({limit:50,offset:0,total:0,currentPage:1,totalPages:1}),[k,A]=h.useState("created_at"),[O,g]=h.useState("DESC"),$=h.useCallback(async()=>{c(!0),p(null);try{const v={...f,limit:b.limit,offset:(b.currentPage-1)*b.limit,sort_by:k,sort_order:O};Object.keys(v).forEach(K=>{(v[K]===""||v[K]===null||v[K]===void 0)&&delete v[K]});const L=await re.get("/api/slot-history",{params:v});i(L.data.data||L.data.history||[]),y(K=>{var R,C;return{...K,total:((R=L.data.pagination)==null?void 0:R.total)||L.data.total||0,totalPages:Math.ceil((((C=L.data.pagination)==null?void 0:C.total)||L.data.total||0)/K.limit)}})}catch(v){console.error("Error fetching slot history:",v),p("Eroare la încărcarea istoricului sloturilor."),U.error("Eroare la încărcarea istoricului sloturilor.")}finally{c(!1)}},[f,b.limit,b.currentPage,k,O]);h.useEffect(()=>{$()},[$]);const _=v=>{const{name:L,value:K}=v.target;T(R=>({...R,[L]:K})),y(R=>({...R,currentPage:1,offset:0}))},E=v=>{const L=v.getFullYear(),K=String(v.getMonth()+1).padStart(2,"0"),R=String(v.getDate()).padStart(2,"0");return`${L}-${K}-${R}`},G=()=>{if(!f.start_date||!f.end_date)return"all";const v=new Date,L=new Date(v.getFullYear(),v.getMonth(),v.getDate()),K=E(L);if(f.start_date===K&&f.end_date===K)return"today";const R=L.getDay(),C=R===0?-6:1-R,z=new Date(L);z.setDate(L.getDate()+C);const J=new Date(z);if(J.setDate(z.getDate()+6),f.start_date===E(z)&&f.end_date===E(J))return"thisWeek";const P=E(new Date(v.getFullYear(),v.getMonth(),1)),Z=E(new Date(v.getFullYear(),v.getMonth()+1,0));if(f.start_date===P&&f.end_date===Z)return"thisMonth";const se=E(new Date(v.getFullYear(),0,1)),oe=E(new Date(v.getFullYear(),11,31));if(f.start_date===se&&f.end_date===oe)return"thisYear";const de=E(new Date(v.getFullYear()-1,0,1)),Se=E(new Date(v.getFullYear()-1,11,31));return f.start_date===de&&f.end_date===Se?"lastYear":"custom"},j=v=>{const L=new Date,K=new Date(L.getFullYear(),L.getMonth(),L.getDate());let R="",C="";switch(v){case"today":R=E(K),C=E(K);break;case"thisWeek":const z=new Date(K),J=K.getDay(),P=J===0?-6:1-J;z.setDate(K.getDate()+P),R=E(z);const Z=new Date(z);Z.setDate(z.getDate()+6),C=E(Z);break;case"thisMonth":R=E(new Date(L.getFullYear(),L.getMonth(),1));const se=new Date(L.getFullYear(),L.getMonth()+1,0);C=E(se);break;case"thisYear":R=E(new Date(L.getFullYear(),0,1));const oe=new Date(L.getFullYear(),11,31);C=E(oe);break;case"lastYear":R=E(new Date(L.getFullYear()-1,0,1));const de=new Date(L.getFullYear()-1,11,31);C=E(de);break;case"all":R="",C="";break}T(z=>({...z,start_date:R,end_date:C})),y(z=>({...z,currentPage:1,offset:0}))},N=v=>{k===v?g(L=>L==="ASC"?"DESC":"ASC"):(A(v),g("ASC"))},D=v=>{v>0&&v<=b.totalPages&&y(L=>({...L,currentPage:v,offset:(v-1)*L.limit}))},S=(v,L=null)=>{if(L)return L;const K=s==null?void 0:s.find(R=>R.id===v);return K?K.serial_number:"N/A"},F=v=>{const L=r==null?void 0:r.find(K=>K.id===v);return L?L.username:"Sistem"},I=v=>{switch(v.toLowerCase()){case"location":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"status":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"game_mix":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400";case"serial_number":return"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-400";case"provider":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"cabinet":return"bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-400";default:return"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}},x=v=>v==null?"N/A":typeof v=="boolean"?v?"Da":"Nu":typeof v=="object"?JSON.stringify(v):String(v);return l||o?e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă istoricul modificărilor..."})]})})}):u?e(he,{children:e("div",{className:"flex items-center justify-center min-h-screen",children:t("div",{className:"text-center",children:[e("p",{className:"text-red-600 dark:text-red-400 text-lg",children:u}),e("button",{onClick:()=>$(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Reîncearcă"})]})})}):e(he,{children:t("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 bg-white dark:bg-slate-900 rounded-xl shadow-lg min-h-screen",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 flex items-center",children:[e(Za,{className:"w-6 h-6 mr-3 text-indigo-600"}),"Istoric Modificări Sloturi"]}),t("button",{onClick:()=>a(-1),className:"inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-700 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e(et,{className:"w-4 h-4 mr-2"}),"Înapoi"]})]}),t("div",{className:"flex items-center gap-3 mb-6",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",name:"serial_number",value:f.serial_number,onChange:_,placeholder:"Caută după număr serie slot...",className:"w-full pl-10 pr-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-800 dark:text-slate-200"})]}),e("button",{onClick:()=>d(!m),className:`p-3 rounded-full transition-all duration-200 shadow-lg hover:shadow-xl ${m?"bg-blue-600 text-white hover:bg-blue-700":"bg-blue-500 text-white hover:bg-blue-600"}`,title:"Filtre",children:e(Xt,{className:"w-5 h-5"})})]}),m&&t("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-lg shadow-inner mb-6",children:[t("div",{className:"mb-4",children:[e("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Filtre rapide:"}),t("div",{className:"flex flex-wrap gap-2",children:[e("button",{onClick:()=>j("today"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${G()==="today"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Azi"}),e("button",{onClick:()=>j("thisWeek"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${G()==="thisWeek"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Săptămâna curentă"}),e("button",{onClick:()=>j("thisMonth"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${G()==="thisMonth"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Luna curentă"}),e("button",{onClick:()=>j("thisYear"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${G()==="thisYear"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Anul curent"}),e("button",{onClick:()=>j("lastYear"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${G()==="lastYear"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Anul precedent"}),e("button",{onClick:()=>j("all"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${G()==="all"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-white text-slate-700 hover:bg-slate-100 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"} border border-slate-300 dark:border-slate-600`,children:"Toate"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[t("div",{children:[e("label",{htmlFor:"serial_number",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Număr Serie Slot"}),e("input",{type:"text",name:"serial_number",id:"serial_number",value:f.serial_number,onChange:_,placeholder:"Caută după număr serie",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"field_name",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Câmp Modificat"}),e("input",{type:"text",name:"field_name",id:"field_name",value:f.field_name,onChange:_,placeholder:"Ex: location, status",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Utilizator"}),e("input",{type:"text",name:"username",id:"username",value:f.username,onChange:_,placeholder:"Nume utilizator",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"change_type",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Tip Modificare"}),t("select",{name:"change_type",id:"change_type",value:f.change_type,onChange:_,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200",children:[e("option",{value:"",children:"Toate"}),e("option",{value:"CREATE",children:"Creare"}),e("option",{value:"UPDATE",children:"Actualizare"}),e("option",{value:"DELETE",children:"Ștergere"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{htmlFor:"start_date",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Data Început"}),e("input",{type:"date",name:"start_date",id:"start_date",value:f.start_date,onChange:_,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]}),t("div",{children:[e("label",{htmlFor:"end_date",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Data Sfârșit"}),e("input",{type:"date",name:"end_date",id:"end_date",value:f.end_date,onChange:_,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-slate-700 dark:text-slate-200"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow border border-slate-200 dark:border-slate-700 flex items-center",children:[e(dt,{className:"w-6 h-6 text-indigo-500 mr-3"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Total Modificări"}),e("p",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:b.total})]})]}),t("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow border border-slate-200 dark:border-slate-700 flex items-center",children:[e(ot,{className:"w-6 h-6 text-green-500 mr-3"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Sloturi Modificate"}),e("p",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:new Set(n.map(v=>v.slot_id)).size})]})]}),t("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow border border-slate-200 dark:border-slate-700 flex items-center",children:[e(yt,{className:"w-6 h-6 text-blue-500 mr-3"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Utilizatori Unici"}),e("p",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:new Set(n.map(v=>v.user_id)).size})]})]})]}),e("div",{className:"overflow-x-auto bg-white dark:bg-slate-800 rounded-lg shadow border border-slate-200 dark:border-slate-700",children:t("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-slate-700",children:[e("thead",{className:"bg-slate-50 dark:bg-slate-700",children:t("tr",{children:[t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>N("created_at"),children:["Data",k==="created_at"&&e("span",{className:"ml-1",children:O==="ASC"?"▲":"▼"})]}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>N("serial_number"),children:["Slot",k==="serial_number"&&e("span",{className:"ml-1",children:O==="ASC"?"▲":"▼"})]}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>N("field_name"),children:["Câmp",k==="field_name"&&e("span",{className:"ml-1",children:O==="ASC"?"▲":"▼"})]}),e("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider",children:"Valoare Veche"}),e("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider",children:"Valoare Nouă"}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>N("username"),children:["Utilizator",k==="username"&&e("span",{className:"ml-1",children:O==="ASC"?"▲":"▼"})]}),t("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider cursor-pointer",onClick:()=>N("change_type"),children:["Tip",k==="change_type"&&e("span",{className:"ml-1",children:O==="ASC"?"▲":"▼"})]})]})}),e("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:n.length===0?e("tr",{children:e("td",{colSpan:"7",className:"px-4 py-4 text-center text-slate-500 dark:text-slate-400",children:"Nu s-au găsit modificări."})}):n.map(v=>t("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700",children:[e("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300",children:new Date(v.created_at).toLocaleString("ro-RO")}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-indigo-600 dark:text-indigo-400",children:e("button",{onClick:()=>a(`/slots/${v.slot_id}`),className:"hover:underline",children:v.slot_serial||S(v.slot_id,v.serial_number)})}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${I(v.field_name)}`,children:v.field_name})}),e("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 max-w-xs truncate",children:x(v.old_value)}),e("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 max-w-xs truncate",children:x(v.new_value)}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300",children:v.username||F(v.user_id)}),e("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${v.change_type==="CREATE"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":v.change_type==="DELETE"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:v.change_type})})]},v.id))})]})}),t("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-700 dark:via-slate-800 dark:to-slate-700 px-6 md:px-8 py-4 md:py-6 border-t border-slate-200/50 dark:border-slate-600/50 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[t("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e("span",{className:"text-sm md:text-base font-semibold text-slate-700 dark:text-slate-200",children:"Înregistrări:"}),t("select",{value:b.limit,onChange:v=>{y(L=>({...L,limit:Number(v.target.value),currentPage:1}))},className:"border-2 border-slate-200 dark:border-slate-600 rounded-2xl px-4 py-2 text-sm font-medium bg-white/80 dark:bg-slate-700/80 backdrop-blur-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 transition-all duration-200 shadow-lg text-slate-900 dark:text-slate-100",children:[e("option",{value:15,children:"15"}),e("option",{value:25,children:"25"}),e("option",{value:50,children:"50"}),e("option",{value:100,children:"100"}),e("option",{value:200,children:"200"})]}),t("span",{className:"text-sm md:text-base text-slate-600 dark:text-slate-300 font-medium",children:[(b.currentPage-1)*b.limit+1,"-",Math.min(b.currentPage*b.limit,b.total)," din ",b.total]})]}),t("div",{className:"flex items-center justify-between sm:justify-start gap-3",children:[e("button",{onClick:()=>D(b.currentPage-1),disabled:b.currentPage===1,className:"relative inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(b.totalPages,10)},(v,L)=>{const K=L+1;return e("button",{onClick:()=>D(K),className:`relative inline-flex items-center px-3 py-2 text-sm font-medium ${K===b.currentPage?"z-10 bg-blue-50 border-blue-500 text-blue-600 dark:bg-blue-900/30 dark:border-blue-600 dark:text-blue-400":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-600"} border rounded-md`,children:K},K)})}),e("button",{onClick:()=>D(b.currentPage+1),disabled:b.currentPage===b.totalPages,className:"relative inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Următor"})]})]}),e("div",{className:"mt-6 text-right",children:t("button",{className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e(Je,{className:"w-4 h-4 mr-2"}),"Exportă CSV"]})})]})})},To=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",category:"",quantity:"",location:"",status:"Available",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",category:a.category||"",quantity:a.quantity||"",location:a.location||"",status:a.status||"Available",notes:a.notes||""})},[a]);const i=c=>{const{name:u,value:p}=c.target;n(m=>({...m,[u]:p}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-orange-800 to-amber-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-600/20 to-amber-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-amber-500 rounded-2xl shadow-lg",children:e(mr,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Produs":"Adaugă Produs în Depozit"}),e("p",{className:"text-orange-100 text-sm font-medium",children:"Completează informațiile despre produs"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Produs *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Nume produs",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Categorie *"}),e("input",{type:"text",name:"category",value:l.category,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Categoria produsului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cantitate *"}),e("input",{type:"number",name:"quantity",value:l.quantity,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Cantitatea",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Locație *"}),e("input",{type:"text",name:"location",value:l.location,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Locația în depozit",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",required:!0,children:[e("option",{value:"Available",children:"Disponibil"}),e("option",{value:"Out of Stock",children:"Stoc epuizat"}),e("option",{value:"Reserved",children:"Rezervat"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(mr,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Produs"]})]})]})]})})]})})},zo=()=>{const{warehouse:a,slots:s,loading:r,createItem:l,updateItem:n,deleteItem:i,exportToExcel:o,exportToPDF:c}=ye(),[u,p]=h.useState(""),[m,d]=h.useState([]),[f,T]=h.useState(!1),[b,y]=h.useState(!1);h.useEffect(()=>{T(m.length>0)},[m]);const k=C=>{d(C?N.map(z=>z.id):[])},A=(C,z)=>{d(z?[...m,C]:m.filter(J=>J!==C))},O=async()=>{m.length!==0&&y(!0)},g=async()=>{y(!1);const C=m.length;let z=0,J=0;try{const P=U.loading(`Șterg ${C} elemente...`,{duration:1/0}),Z=10;for(let se=0;se<m.length;se+=Z){const de=m.slice(se,se+Z).map(async Oe=>{try{await i("warehouse",Oe,!0),z++}catch{J++}});await Promise.all(de);const Se=Math.min(se+Z,C);U.loading(`Șterg ${C} elemente... (${Se}/${C})`,{id:P})}U.dismiss(P),J===0?U.success(`✅ ${z} elemente șterse cu succes!`,{duration:5e3}):z>0?U.success(`⚠️ ${z} elemente șterse, ${J} erori`,{duration:5e3}):U.error(`❌ Eroare la ștergerea tuturor ${C} elemente`,{duration:5e3}),d([]),T(!1)}catch(P){console.error("Error bulk deleting:",P),U.error("Eroare la ștergerea elementelor!"),y(!1)}},$=()=>{m.length!==0&&console.log("Bulk edit for:",m)},[_,E]=h.useState(!1),[G,j]=h.useState(null),N=a.filter(C=>{var z,J,P,Z,se;return((z=C.serial_number)==null?void 0:z.toLowerCase().includes(u.toLowerCase()))||((J=C.provider)==null?void 0:J.toLowerCase().includes(u.toLowerCase()))||((P=C.location)==null?void 0:P.toLowerCase().includes(u.toLowerCase()))||((Z=C.cabinet)==null?void 0:Z.toLowerCase().includes(u.toLowerCase()))||((se=C.game_mix)==null?void 0:se.toLowerCase().includes(u.toLowerCase()))}),D=a.length,S=a.filter(C=>C.status==="Inactive").length,F=[{key:"serial_number",label:"SERIAL NUMBER",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-semibold text-base",children:C.serial_number||"N/A"})},{key:"provider",label:"FURNIZOR",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-medium text-base",children:C.provider||"N/A"})},{key:"location",label:"LOCAȚIE",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-medium text-base",children:C.location||"N/A"})},{key:"cabinet",label:"CABINET",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-medium text-base",children:C.cabinet||"N/A"})},{key:"game_mix",label:"GAME MIX",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-medium text-base",children:wt(C.game_mix_name||C.game_mix)})},{key:"status",label:"STATUS",sortable:!0,render:C=>{var Z;const z=async()=>{var Se;const se=((Se=C.status)==null?void 0:Se.toLowerCase())||"",de=se==="activ"||se==="active"?"Inactive":"Active";try{de==="Active"?(await l("slots",{name:"Slot Machine",serial_number:C.serial_number,provider:C.provider,location:"Locație principală",game:"",cabinet:C.cabinet,game_mix:C.game_mix,denomination:.01,max_bet:null,rtp:null,gaming_places:1,property_type:"Owned",commission_date:null,invoice_number:null,status:"Active",notes:"Mutat automat din depozit când a devenit activ"}),await i("warehouse",C.id),U.success("Slot mutat înapoi în sloturi")):(await n("warehouse",C.id,{...C,status:de}),U.success(`Status schimbat în ${de}`))}catch(Oe){U.error("Eroare la actualizare status"),console.error("Error updating warehouse slot status:",Oe)}},J=((Z=C.status)==null?void 0:Z.toLowerCase())||"",P=J==="activ"||J==="active";return t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:z,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 ${P?"bg-green-500":"bg-gray-300"}`,children:e("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${P?"translate-x-9":"translate-x-1"}`})}),e("span",{className:`text-xs font-bold ${P?"text-green-600":"text-gray-600"}`,children:P?"ON":"OFF"})]})}},{key:"created_by",label:"CREAT DE",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-medium text-base",children:C.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:C=>e("div",{className:"text-slate-800 font-medium text-base",children:C.created_at?new Date(C.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"address",label:"ADRESĂ",sortable:!0,render:C=>t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{className:"text-sm",children:C.address||"N/A"}),C.city&&e("div",{className:"text-xs text-slate-500",children:C.city})]})}],I=C=>{j(C),E(!0)},x=async C=>{if(window.confirm("Sigur vrei să ștergi acest slot din depozit?"))try{await i("warehouse",C),U.success("Slot șters din depozit cu succes!")}catch(z){U.error("Eroare la ștergerea slotului"),console.error("Error deleting slot from warehouse:",z)}},v=()=>{j(null),E(!0)},L=async C=>{try{G?(await n("warehouse",G.id,C),U.success("Slot actualizat cu succes!")):(await l("warehouse",C),U.success("Slot adăugat în depozit cu succes!")),E(!1),j(null)}catch(z){U.error("Eroare la salvarea slotului"),console.error("Error saving slot to warehouse:",z)}};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-slate-500 to-gray-500 rounded-2xl shadow-lg shadow-slate-500/25",children:e(At,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Depozit Sloturi"}),e("p",{className:"text-slate-600",children:"Sloturile inactive din depozit"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{o("warehouse")}catch(C){console.error("Error exporting to Excel:",C)}},onExportPDF:()=>{try{c("warehouse")}catch(C){console.error("Error exporting to PDF:",C)}},entity:"warehouse"}),f&&t(De,{children:[t("button",{onClick:$,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:O,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:v,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Slot"})]})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e(Tt,{title:"Total Sloturi",value:D,icon:it,color:"blue",trend:null}),e(Tt,{title:"Inactive",value:S,icon:nt,color:"red",trend:null})]}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după numărul de serie, furnizor, locație, cabinet sau game mix...",value:u,onChange:C=>p(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:r?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-500"})}):N.length===0?t("div",{className:"text-center py-12",children:[e(At,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există sloturi în depozit"}),e("p",{className:"text-slate-500",children:"Sloturile inactive vor apărea aici automat"})]}):e(qe,{data:N,columns:F,onEdit:I,onDelete:x,searchTerm:u,selectedItems:m,onSelectAll:k,onSelectItem:A,moduleColor:"blue"})}),_&&e(To,{item:G,onClose:()=>E(!1),onSave:L}),b&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e(Fe,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Șterge ",m.length," Elemente"]}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Această acțiune nu poate fi anulată"})]})]}),t("p",{className:"text-slate-700 dark:text-slate-300 mb-6",children:["Ești sigur că vrei să ștergi ",m.length," elemente selectate din depozit? Toate datele asociate vor fi șterse permanent."]}),t("div",{className:"flex space-x-3 justify-end",children:[e("button",{onClick:()=>y(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"Anulează"}),t("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:["Șterge ",m.length," Elemente"]})]})]})})]})})},Po=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState([]),[i,o]=h.useState([]),[c,u]=h.useState([]),[p,m]=h.useState([]),[d,f]=h.useState([]),[T,b]=h.useState([]),[y,k]=h.useState({cvt_number:"",serial_number:"",cvt_type:"Periodică",cvt_date:"",expiry_date:"",issuing_authority:"",provider:"",cabinet:"",game_mix:"",approval_type:"",software:"",cvtFile:null,cvtPreview:null,notes:""});h.useEffect(()=>{if((async()=>{try{const[D,S,F,I,x,v]=await Promise.all([fetch("/api/authorities"),fetch("/api/providers"),fetch("/api/cabinets"),fetch("/api/gameMixes"),fetch("/api/approvals"),fetch("/api/software")]),[L,K,R,C,z,J]=await Promise.all([D.json(),S.json(),F.json(),I.json(),x.json(),v.json()]);n(Array.isArray(L)?L:[]),o(Array.isArray(K)?K:[]),u(Array.isArray(R)?R:[]),m(Array.isArray(C)?C:[]),f(Array.isArray(z)?z:[]),b(Array.isArray(J)?J:[])}catch(D){console.error("Error loading data:",D)}})(),a){const D=S=>{if(!S)return"";const F=new Date(S);return isNaN(F.getTime())?"":F.toISOString().split("T")[0]};k({cvt_number:a.cvt_number||"",serial_number:a.serial_number||"",cvt_type:a.cvt_type||"Periodică",cvt_date:D(a.cvt_date),expiry_date:D(a.expiry_date),issuing_authority:a.issuing_authority||"",provider:a.provider||"",cabinet:a.cabinet||"",game_mix:a.game_mix||"",approval_type:a.approval_type||"",software:a.software||"",cvtFile:a.cvtFile||null,cvtPreview:a.cvtFile||null,notes:a.notes||""})}},[a]);const A=()=>y.provider?c.filter(N=>N.provider===y.provider||N.provider_name===y.provider):c,O=()=>y.provider?p.filter(N=>N.provider===y.provider||N.provider_name===y.provider):p,g=()=>{if(!y.cabinet)return d;const N=c.find(D=>D.name===y.cabinet||D.model===y.cabinet);return N?d.filter(D=>D.cabinet===y.cabinet||D.model===N.model):d},$=()=>{if(!y.game_mix)return T;const N=p.find(D=>D.name===y.game_mix);return N?T.filter(D=>D.game_mix===y.game_mix||D.provider===N.provider):T},_=N=>{const{name:D,value:S}=N.target;k(F=>{const I={...F,[D]:S};if(D==="provider"?(I.cabinet="",I.game_mix="",I.approval_type="",I.software=""):D==="cabinet"?(I.approval_type="",I.software=""):D==="game_mix"&&(I.software=""),(D==="cvt_type"||D==="cvt_date")&&(I.cvt_type==="Periodică"||I.cvt_type==="Inițială")&&I.cvt_date){const x=new Date(I.cvt_date),v=new Date(x);v.setFullYear(v.getFullYear()+1),v.setDate(v.getDate()-1),I.expiry_date=v.toISOString().split("T")[0]}return I})},E=N=>{const D=N.target.files[0];if(D){const S=new FileReader;S.onload=F=>{k(I=>({...I,cvtFile:F.target.result,cvtPreview:F.target.result}))},S.readAsDataURL(D)}},G=()=>{window.confirm("Sigur doriți să ștergeți documentul CVT?")&&k(N=>({...N,cvtFile:null,cvtPreview:null}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-cyan-800 to-teal-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-600/20 to-teal-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-cyan-500 to-teal-500 rounded-2xl shadow-lg",children:e(Yt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Certificat":"Adaugă Certificat Nou"}),e("p",{className:"text-cyan-100 text-sm font-medium",children:"Completează informațiile despre certificatul de metrologie"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:N=>{N.preventDefault(),r(y)},className:"p-6 space-y-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații CVT"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Număr CVT *"}),e("input",{type:"text",name:"cvt_number",value:y.cvt_number,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Numărul CVT",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Număr de Serie *"}),e("input",{type:"text",name:"serial_number",value:y.serial_number,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Serial number slot",required:!0}),e("p",{className:"text-xs text-slate-500",children:"Numărul de serie care leagă CVT-ul cu slot-ul din aplicație"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip CVT *"}),t("select",{name:"cvt_type",value:y.cvt_type,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0,children:[e("option",{value:"Periodică",children:"Periodică"}),e("option",{value:"Inițială",children:"Inițială"}),e("option",{value:"Reparație",children:"Reparație"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data CVT *"}),e("input",{type:"date",name:"cvt_date",value:y.cvt_date,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data expirării *"}),e("input",{type:"date",name:"expiry_date",value:y.expiry_date,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0,disabled:y.cvt_type==="Periodică"||y.cvt_type==="Inițială"}),y.cvt_type==="Periodică"||y.cvt_type==="Inițială"?e("p",{className:"text-xs text-slate-500",children:"Calculat automat: 1 an - 1 zi"}):e("p",{className:"text-xs text-slate-500",children:"Completează manual pentru Reparație"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Autoritatea emitentă"}),t("select",{name:"issuing_authority",value:y.issuing_authority,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează autoritatea emitentă"}),l.map(N=>e("option",{value:N.name,children:N.name},N.id))]})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații Dispozitiv"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor"}),t("select",{name:"provider",value:y.provider,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează furnizorul"}),i.map(N=>e("option",{value:N.name,children:N.name},N.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet"}),t("select",{name:"cabinet",value:y.cabinet,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!y.provider,children:[e("option",{value:"",children:y.provider?"Selectează cabinetul":"Selectează mai întâi furnizorul"}),A().map(N=>e("option",{value:N.name,children:N.name},N.id))]}),!y.provider&&e("p",{className:"text-xs text-slate-500",children:"Cabinetul depinde de furnizorul selectat"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix"}),t("select",{name:"game_mix",value:y.game_mix,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!y.provider,children:[e("option",{value:"",children:y.provider?"Selectează game mix-ul":"Selectează mai întâi furnizorul"}),O().map(N=>e("option",{value:N.name,children:N.name},N.id))]}),!y.provider&&e("p",{className:"text-xs text-slate-500",children:"Game mix-ul depinde de furnizorul selectat"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Aprobare de Tip"}),t("select",{name:"approval_type",value:y.approval_type,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!y.cabinet,children:[e("option",{value:"",children:y.cabinet?"Selectează aprobarea de tip":"Selectează mai întâi cabinetul"}),g().map(N=>e("option",{value:N.name,children:N.name},N.id))]}),!y.cabinet&&e("p",{className:"text-xs text-slate-500",children:"Aprobarea de tip depinde de cabinetul selectat"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Software"}),t("select",{name:"software",value:y.software,onChange:_,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:!y.game_mix,children:[e("option",{value:"",children:y.game_mix?"Selectează software-ul":"Selectează mai întâi game mix-ul"}),$().map(N=>e("option",{value:N.name,children:N.name},N.id))]}),!y.game_mix&&e("p",{className:"text-xs text-slate-500",children:"Software-ul depinde de game mix-ul selectat"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Document CVT (PDF)"}),e("input",{type:"file",name:"cvtFile",accept:".pdf",onChange:E,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100"}),y.cvtPreview&&t("div",{className:"mt-4 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(pt,{className:"w-5 h-5 text-cyan-600"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:typeof y.cvtPreview=="string"&&y.cvtPreview.includes("data:")?"Document CVT încărcat":"Document CVT existent"}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"PDF Document"})]})]}),e("button",{type:"button",onClick:G,className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Șterge documentul",children:e(ve,{className:"w-4 h-4"})})]}),e(Ct,{pdfUrl:y.cvtPreview,title:`CVT Document ${y.cvt_number}`,placeholder:"Documentul CVT nu este disponibil",placeholderSubtext:"Atașează documentul CVT pentru vizualizare"})]}),e("p",{className:"text-xs text-slate-500",children:"Încărcați documentul CVT în format PDF"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:y.notes,onChange:_,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(Yt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Certificat"]})]})]})]})})]})})},Lo=({item:a,onClose:s})=>{if(!a)return null;const r=a.name&&a.serial_numbers,l=a.name&&(a.provider||a.cabinet)&&!a.serial_numbers&&!a.cvt_number;a.cvt_number,a.software_name,a.authority_name;const i=(()=>{if(!a.expiry_date)return null;const m=new Date,f=new Date(a.expiry_date)-m;return Math.ceil(f/(1e3*60*60*24))})(),o=()=>i===null?"text-slate-400":i<0?"text-red-600":i<=30?"text-orange-600":"text-green-600",c=()=>i===null?"N/A":i<0?`Expirat (${Math.abs(i)} zile)`:`${i} zile rămase`,p=(()=>!r||!a.serial_numbers?[]:typeof a.serial_numbers=="string"?a.serial_numbers.split(",").map(m=>m.trim()).filter(m=>m):Array.isArray(a.serial_numbers)?a.serial_numbers:[])();return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-3xl w-full max-w-6xl max-h-[90vh] overflow-hidden shadow-2xl",children:[t("div",{className:`px-6 py-4 flex justify-between items-center ${l?"bg-gradient-to-r from-green-500 to-emerald-500":r?"bg-gradient-to-r from-blue-500 to-indigo-500":"bg-gradient-to-r from-cyan-500 to-teal-500"}`,children:[t("h3",{className:"text-xl font-bold text-white flex items-center",children:[e(ge,{className:"w-6 h-6 mr-2"}),l?`Detalii Aprobare de Tip - ${a.name}`:r?`Detalii Comisie - ${a.name}`:`Detalii Certificat CVT - ${a.cvt_number}`]}),e("button",{onClick:s,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:e(ve,{className:"w-6 h-6"})})]}),e("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:l?t("div",{className:"space-y-6",children:[t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Informații Aprobare de Tip"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Numele Aprobării"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.name})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Furnizor"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.provider||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Cabinet"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.cabinet||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Game Mix"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:wt(a.game_mix_name||a.game_mix)})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Autoritate Emitentă"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.issuing_authority||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Creat de"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.created_by||"N/A"})]})]})]}),t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Checksums"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"MD5"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:a.checksum_md5||a.checksumMD5||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"SHA256"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:a.checksum_sha256||a.checksumSHA256||"N/A"})]})]})]}),a.notes&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Note"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:a.notes})]})]}):r?t("div",{className:"space-y-6",children:[t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[e("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Informații Comisie"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Numele Comisiei"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.name})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Numărul de Sloturi"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:[p.length," sloturi"]})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Data Comisiei"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-semibold",children:a.commission_date?new Date(a.commission_date).toLocaleDateString("ro-RO"):"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Data Valabilității"}),t("p",{className:`font-semibold ${o()}`,children:[a.expiry_date?new Date(a.expiry_date).toLocaleDateString("ro-RO"):"N/A",i!==null&&t("span",{className:"ml-2 text-sm",children:["(",c(),")"]})]})]})]})]}),t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6",children:[t("h4",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:["Detalii Sloturi (",p.length,")"]}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{children:t("tr",{className:"border-b border-slate-200 dark:border-slate-600",children:[e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Serial Number"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Furnizor"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Cabinet"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Game Mix"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Locație"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Factură"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Data CVT"}),e("th",{className:"text-left py-2 text-sm font-semibold text-slate-600 dark:text-slate-400",children:"Data Comisie"})]})}),e("tbody",{children:p.map((m,d)=>t("tr",{className:"border-b border-slate-100 dark:border-slate-600",children:[e("td",{className:"py-2 text-sm text-slate-800 dark:text-slate-200 font-mono",children:m}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"}),e("td",{className:"py-2 text-sm text-slate-600 dark:text-slate-400",children:"-"})]},d))})]})}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"* Detaliile complete vor fi afișate când vor fi conectate cu baza de date de sloturi"})]})]}):t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-6",children:[t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Informații CVT"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Număr CVT"}),e("p",{className:"text-base font-medium text-slate-900",children:a.cvt_number})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Tip CVT"}),e("p",{className:"text-base font-medium text-slate-900",children:a.cvt_type})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Autoritatea Emitentă"}),e("p",{className:"text-base font-medium text-slate-900",children:a.issuing_authority||"N/A"})]})]})]}),t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Informații Dispozitiv"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Furnizor"}),e("p",{className:"text-base font-medium text-slate-900",children:a.provider||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Cabinet"}),e("p",{className:"text-base font-medium text-slate-900",children:a.cabinet||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Game Mix"}),e("p",{className:"text-base font-medium text-slate-900",children:wt(a.game_mix_name||a.game_mix)})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Aprobare de Tip"}),e("p",{className:"text-base font-medium text-slate-900",children:a.approval_type||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Software"}),e("p",{className:"text-base font-medium text-slate-900",children:a.software||"N/A"})]})]})]}),t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Date & Status"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Data CVT"}),t("p",{className:"text-base font-medium text-slate-900 flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2 text-cyan-500"}),a.cvt_date?new Date(a.cvt_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A"]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Data Expirării"}),t("p",{className:"text-base font-medium text-slate-900 flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2 text-orange-500"}),a.expiry_date?new Date(a.expiry_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A"]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Status"}),t("p",{className:`text-base font-bold flex items-center ${o()}`,children:[i!==null&&i>=0?e(kt,{className:"w-4 h-4 mr-2"}):e(nt,{className:"w-4 h-4 mr-2"}),c()]})]})]})]}),a.notes&&t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-4",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Note"}),e("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.notes})]})]}),t("div",{className:"space-y-4",children:[t("div",{className:"bg-slate-50 rounded-2xl p-6",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2 mb-4",children:"Document CVT"}),e(Ct,{pdfUrl:a.cvtFile||null,title:"CVT Document",placeholder:"Nu există document CVT",placeholderSubtext:"Atașează documentul CVT pentru vizualizare"})]}),t("div",{className:"bg-slate-50 rounded-2xl p-6 space-y-3",children:[e("h4",{className:"text-lg font-bold text-slate-800 border-b border-slate-200 pb-2",children:"Informații Adiționale"}),t("div",{className:"space-y-2",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Creat de"}),e("p",{className:"text-base font-medium text-slate-900",children:a.created_by||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Data creării"}),e("p",{className:"text-base font-medium text-slate-900",children:a.created_at?new Date(a.created_at).toLocaleDateString("ro-RO"):"N/A"})]})]})]})]})]})})]})})},Ts=({item:a,onClose:s,onSave:r})=>{const{providers:l,cabinets:n,gameMixes:i}=ye(),[o,c]=h.useState([]),[u,p]=h.useState([]),[m,d]=h.useState({name:"",provider:"",cabinet:"",gameMix:"",software:"",issuingAuthority:"",checksumMD5:"",checksumSHA256:"",attachments:[],notes:""}),[f,T]=h.useState(!1);h.useEffect(()=>{(async()=>{try{const G=await(await fetch("/api/authorities")).json();c(Array.isArray(G)?G:[]);const N=await(await fetch("/api/software")).json();p(Array.isArray(N)?N:[])}catch(E){console.error("Error loading data:",E)}})(),a&&d({name:a.name||"",provider:a.provider||"",cabinet:a.cabinet||"",gameMix:a.game_mix||a.gameMix||"",software:a.software||"",issuingAuthority:a.issuing_authority||a.issuingAuthority||"",checksumMD5:a.checksum_md5||a.checksumMD5||"",checksumSHA256:a.checksum_sha256||a.checksumSHA256||"",attachments:a.attachments||[],notes:a.notes||""})},[a]);const b=_=>{const{name:E,value:G}=_.target;d(j=>{const N={...j,[E]:G};return E==="provider"&&(N.gameMix="",N.software=""),E==="cabinet"&&(N.software=""),N})},y=i.filter(_=>!(m.provider&&_.provider!==m.provider)),k=async _=>{if(!_||_.length===0)return;T(!0);const E=Array.from(_).map(async G=>{const j=new FormData;j.append("file",G);try{const N=await re.post("/api/upload",j,{headers:{"Content-Type":"multipart/form-data"}});return{name:G.name,url:N.data.url,size:G.size,type:G.type}}catch(N){return console.error("Upload error:",N),U.error(`Eroare la upload pentru ${G.name}`),null}});try{const j=(await Promise.all(E)).filter(N=>N!==null);d(N=>({...N,attachments:[...N.attachments,...j]})),U.success(`${j.length} fișiere încărcate cu succes`)}catch{U.error("Eroare la încărcarea fișierelor")}finally{T(!1)}},A=_=>{_.preventDefault();const E=_.dataTransfer.files;k(E)},O=_=>{_.preventDefault()},g=_=>{d(E=>({...E,attachments:E.attachments.filter((G,j)=>j!==_)}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(pt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează Aprobare de Tip":"Adaugă Aprobare de Tip"}),e("p",{className:"text-green-100",children:a?"Modifică datele aprobării":"Adaugă o aprobare de tip nouă"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:_=>{_.preventDefault();const E={name:m.name,provider:m.provider,cabinet:m.cabinet,game_mix:m.gameMix,software:m.software,issuing_authority:m.issuingAuthority,checksum_md5:m.checksumMD5,checksum_sha256:m.checksumSHA256,attachments:m.attachments,notes:m.notes};r(E)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:m.name,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introdu numele aprobării",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:m.provider,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),l.map(_=>e("option",{value:_.name,children:_.name},_.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet *"}),t("select",{name:"cabinet",value:m.cabinet,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează cabinetul"}),n.filter(_=>!m.provider||_.provider===m.provider).map(_=>e("option",{value:_.name,children:_.name},_.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix"}),t("select",{name:"gameMix",value:m.gameMix,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:!m.provider,children:[e("option",{value:"",children:"Selectează game mix-ul"}),y.map(_=>e("option",{value:_.name,children:_.name},_.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Software"}),t("select",{name:"software",value:m.software,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:!m.provider||!m.cabinet,children:[e("option",{value:"",children:"Selectează software-ul"}),u.filter(_=>(!m.provider||_.provider===m.provider)&&(!m.cabinet||_.cabinet===m.cabinet)).map(_=>t("option",{value:_.name,children:[_.name," - ",_.version]},_.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Autoritate emitentă"}),t("select",{name:"issuingAuthority",value:m.issuingAuthority,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează autoritatea"}),o.map(_=>e("option",{value:_.name,children:_.name},_.id))]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Checksum MD5"}),e("input",{type:"text",name:"checksumMD5",value:m.checksumMD5,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introdu checksum MD5"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Checksum SHA256"}),e("input",{type:"text",name:"checksumSHA256",value:m.checksumSHA256,onChange:b,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Introdu checksum SHA256"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Atașamente"}),t("div",{onDrop:A,onDragOver:O,className:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-green-500 transition-colors",children:[e(ze,{className:"w-8 h-8 text-slate-400 mx-auto mb-2"}),e("p",{className:"text-slate-600 mb-2",children:"Trage și plasează fișierele aici sau"}),e("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:_=>k(_.target.files),className:"hidden",id:"file-upload"}),t("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 cursor-pointer transition-colors",children:[e(ze,{className:"w-4 h-4 mr-2"}),f?"Se încarcă...":"Selectează fișiere"]}),e("p",{className:"text-xs text-slate-500 mt-2",children:"Suportă: PDF, DOC, DOCX, JPG, PNG"})]}),m.attachments.length>0&&t("div",{className:"mt-4 space-y-2",children:[e("p",{className:"text-sm font-medium text-slate-700",children:"Fișiere atașate:"}),m.attachments.map((_,E)=>t("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t("div",{className:"flex items-center space-x-3",children:[e(pt,{className:"w-5 h-5 text-green-500"}),t("div",{children:[e("p",{className:"text-sm font-medium text-slate-900",children:_.name}),t("p",{className:"text-xs text-slate-500",children:[(_.size/1024/1024).toFixed(2)," MB"]})]})]}),e("button",{type:"button",onClick:()=>g(E),className:"p-1 text-red-500 hover:text-red-700 transition-colors",children:e(Fe,{className:"w-4 h-4"})})]},E))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:m.notes,onChange:b,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Adaugă note suplimentare"})]}),t("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg hover:shadow-green-500/25",children:t("div",{className:"flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Salvează"})]})})]})]})]})})},Io=({item:a,onClose:s,onSave:r})=>{ye();const[l,n]=h.useState({name:"",serial_numbers:"",commission_date:"",expiry_date:"",notes:""});h.useEffect(()=>{if(a){const c=u=>{if(!u)return"";try{return new Date(u).toISOString().split("T")[0]}catch{return""}};n({name:a.name||"",serial_numbers:a.serial_numbers||"",commission_date:c(a.commission_date),expiry_date:c(a.expiry_date),notes:a.notes||""})}},[a]);const i=c=>{const{name:u,value:p}=c.target;if(n(m=>({...m,[u]:p})),u==="commission_date"&&p){const m=new Date(p),d=new Date(m);d.setFullYear(d.getFullYear()+1),d.setDate(d.getDate()-1),n(f=>({...f,expiry_date:d.toISOString().split("T")[0]}))}};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(Lt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează Comisie":"Adaugă Comisie"}),e("p",{className:"text-blue-100",children:a?"Modifică datele comisiei":"Adaugă o comisie nouă"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Introdu numele comisiei",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data Comisiei *"}),e("input",{type:"date",name:"commission_date",value:l.commission_date,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data Valabilității *"}),e("input",{type:"date",name:"expiry_date",value:l.expiry_date,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numerele de Serie *"}),e("textarea",{name:"serial_numbers",value:l.serial_numbers,onChange:i,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Introdu numerele de serie separate prin rânduri nouă",required:!0}),e("p",{className:"text-sm text-slate-500",children:"Separă numerele de serie prin rânduri nouă"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Adaugă note suplimentare"})]}),t("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-lg hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg hover:shadow-blue-500/25",children:t("div",{className:"flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Salvează"})]})})]})]})]})})},Ro=({item:a,onClose:s,onSave:r})=>{const{providers:l,cabinets:n,gameMixes:i,approvals:o}=ye(),[c,u]=h.useState({name:"",provider:"",cabinet:"",game_mix:"",approval:"",version:"",notes:""});h.useEffect(()=>{a&&u({name:a.name||"",provider:a.provider||"",cabinet:a.cabinet||"",game_mix:a.game_mix||"",approval:a.approval||"",version:a.version||"",notes:a.notes||""})},[a]);const p=d=>{const{name:f,value:T}=d.target;u(b=>{const y={...b,[f]:T};return f==="provider"?(y.cabinet="",y.game_mix=""):f==="cabinet"&&(y.game_mix=""),y})};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-purple-500 to-violet-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(la,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează Software":"Adaugă Software"}),e("p",{className:"text-purple-100",children:a?"Modifică datele software-ului":"Adaugă un software nou"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:d=>{d.preventDefault(),r(c)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:c.name,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Introdu numele software-ului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Versiunea"}),e("input",{type:"text",name:"version",value:c.version,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ex: v1.0.0"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Furnizor *"}),t("select",{name:"provider",value:c.provider,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),l.map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cabinet *"}),t("select",{name:"cabinet",value:c.cabinet,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează cabinetul"}),n.filter(d=>!c.provider||d.provider===c.provider).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Game Mix *"}),t("select",{name:"game_mix",value:c.game_mix,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează game mix-ul"}),i.filter(d=>!(c.provider&&d.provider!==c.provider)).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Aprobare de Tip"}),t("select",{name:"approval",value:c.approval,onChange:p,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e("option",{value:"",children:"Selectează aprobarea"}),o.filter(d=>!(c.provider&&d.provider!==c.provider||c.cabinet&&d.cabinet!==c.cabinet)).map(d=>e("option",{value:d.name,children:d.name},d.id))]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:c.notes,onChange:p,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Adaugă note suplimentare"})]}),t("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Anulează"}),e("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-violet-500 text-white rounded-lg hover:from-purple-600 hover:to-violet-600 transition-all shadow-lg hover:shadow-purple-500/25",children:t("div",{className:"flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Salvează"})]})})]})]})]})})},Oo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",address:"",price_initiala:"",price_reparatie:"",price_periodica:"",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",address:a.address||"",price_initiala:a.price_initiala||"",price_reparatie:a.price_reparatie||"",price_periodica:a.price_periodica||"",notes:a.notes||""})},[a]);const i=c=>{const{name:u,value:p}=c.target;n(m=>({...m,[u]:p}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[t("div",{className:"relative bg-gradient-to-r from-orange-500 to-red-500 p-8 text-white",children:[t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm",children:e(pt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Autoritatea Emitentă":"Adaugă Autoritate Emitentă"}),e("p",{className:"text-orange-100 text-sm font-medium",children:"Completează informațiile despre autoritatea emitentă"})]})]}),e("button",{onClick:s,className:"absolute top-4 right-4 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații de bază"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numele *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Numele autorității",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Adresa"}),e("input",{type:"text",name:"address",value:l.address,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Adresa autorității"})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Prețuri (opțional)"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Preț Inițială (LEI)"}),e("input",{type:"number",name:"price_initiala",value:l.price_initiala,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0",min:"0",step:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Preț Reparație (LEI)"}),e("input",{type:"number",name:"price_reparatie",value:l.price_reparatie,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0",min:"0",step:"0.01"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Preț Periodică (LEI)"}),e("input",{type:"number",name:"price_periodica",value:l.price_periodica,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0",min:"0",step:"0.01"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[t("button",{type:"button",onClick:s,className:"btn-secondary",children:[e(ve,{className:"w-4 h-4"}),"Anulează"]}),t("button",{type:"submit",className:"btn-primary",children:[e(qt,{className:"w-4 h-4"}),a?"Actualizează":"Adaugă"," Autoritate"]})]})]})})]})})},Fo=({isOpen:a,onClose:s})=>{const[r,l]=h.useState([]),[n,i]=h.useState(!1),[o,c]=h.useState(null),[u,p]=h.useState(new Date().getMonth()),[m,d]=h.useState(new Date().getFullYear()),f=["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],T=[{id:1,title:"Comisia de Autorizare - Sloturi Electronice",date:"2025-10-15",time:"09:00",location:"București, Bd. Magheru 28-30",type:"Autorizare",status:"Programată",description:"Examinarea cererilor de autorizare pentru sloturi electronice"},{id:2,title:"Comisia de Metrologie - Verificare CVT",date:"2025-10-22",time:"10:30",location:"București, Bd. Magheru 28-30",type:"Metrologie",status:"Programată",description:"Verificarea certificatelor de verificare tehnică"},{id:3,title:"Comisia de Control - Inspecții Teren",date:"2025-11-05",time:"08:00",location:"Cluj-Napoca, Str. Memorandumului 28",type:"Control",status:"Programată",description:"Inspecții de control la operatorii de jocuri de noroc"},{id:4,title:"Comisia de Autorizare - Licențe",date:"2025-11-12",time:"14:00",location:"București, Bd. Magheru 28-30",type:"Autorizare",status:"Programată",description:"Examinarea cererilor de licențiere pentru operatori"}];h.useEffect(()=>{a&&b()},[a,u,m]);const b=async()=>{i(!0),c(null);try{await new Promise($=>setTimeout($,1e3));const g=T.filter($=>{const _=new Date($.date);return _.getMonth()===u&&_.getFullYear()===m});l(g)}catch(g){c("Eroare la încărcarea calendarului ONJN"),console.error("Error loading ONJN calendar:",g)}finally{i(!1)}},y=g=>{switch(g){case"Programată":return"bg-blue-100 text-blue-800";case"În desfășurare":return"bg-yellow-100 text-yellow-800";case"Finalizată":return"bg-green-100 text-green-800";case"Anulată":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=g=>{switch(g){case"Autorizare":return"bg-purple-100 text-purple-800";case"Metrologie":return"bg-indigo-100 text-indigo-800";case"Control":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},A=g=>new Date(g).toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit",year:"numeric"}),O=g=>g;return a?e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[e("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-xl",children:e(Me,{className:"w-6 h-6"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Calendar ONJN"}),e("p",{className:"text-blue-100",children:"Comisiile organizate de Oficiul Național pentru Jocuri de Noroc"})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-xl transition-colors",children:e(ve,{className:"w-6 h-6"})})]})}),e("div",{className:"p-6 border-b border-gray-200",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Luna:"}),e("select",{value:u,onChange:g=>p(parseInt(g.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:f.map((g,$)=>e("option",{value:$,children:g},$))})]}),t("div",{className:"flex items-center space-x-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Anul:"}),e("select",{value:m,onChange:g=>d(parseInt(g.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[2024,2025,2026].map(g=>e("option",{value:g,children:g},g))})]})]}),t("button",{onClick:b,disabled:n,className:"btn-secondary flex items-center space-x-2",children:[e(ht,{className:`w-4 h-4 ${n?"animate-spin":""}`}),e("span",{children:"Actualizează"})]})]})}),e("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:n?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o?e("div",{className:"flex items-center justify-center py-12",children:t("div",{className:"text-center",children:[e(nt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Eroare la încărcare"}),e("p",{className:"text-gray-500 mb-4",children:o}),e("button",{onClick:b,className:"btn-primary",children:"Încearcă din nou"})]})}):r.length===0?t("div",{className:"text-center py-12",children:[e(Me,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Nu există comisii programate"}),t("p",{className:"text-gray-500",children:["Pentru luna ",f[u]," ",m]})]}):e("div",{className:"space-y-4",children:r.map(g=>e("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:t("div",{className:"flex items-start justify-between",children:[t("div",{className:"flex-1",children:[t("div",{className:"flex items-center space-x-3 mb-3",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:g.title}),e("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${k(g.type)}`,children:g.type}),e("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y(g.status)}`,children:g.status})]}),e("p",{className:"text-gray-600 mb-4",children:g.description}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{className:"flex items-center space-x-2 text-gray-600",children:[e(Me,{className:"w-4 h-4"}),e("span",{className:"text-sm font-medium",children:A(g.date)})]}),t("div",{className:"flex items-center space-x-2 text-gray-600",children:[e(dt,{className:"w-4 h-4"}),e("span",{className:"text-sm font-medium",children:O(g.time)})]}),t("div",{className:"flex items-center space-x-2 text-gray-600",children:[e(We,{className:"w-4 h-4"}),e("span",{className:"text-sm font-medium",children:g.location})]})]})]}),e("button",{onClick:()=>window.open("https://onjn.gov.ro/structura-organizatorica/autorizare/","_blank"),className:"ml-4 p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Vezi pe site-ul ONJN",children:e(Kt,{className:"w-5 h-5"})})]})},g.id))})}),e("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:t("div",{className:"flex items-center justify-between",children:[e("div",{className:"text-sm text-gray-500",children:"Datele sunt preluate de pe site-ul oficial ONJN"}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>window.open("https://onjn.gov.ro/structura-organizatorica/autorizare/","_blank"),className:"btn-secondary flex items-center space-x-2",children:[e(Kt,{className:"w-4 h-4"}),e("span",{children:"Site ONJN"})]}),e("button",{onClick:s,className:"btn-primary",children:"Închide"})]})]})})]})}):null},jo=()=>{const{metrology:a,approvals:s,providers:r,cabinets:l,gameMixes:n,loading:i,createItem:o,updateItem:c,deleteItem:u,exportToExcel:p,exportToPDF:m}=ye(),d=He(),[f,T]=h.useState(""),[b,y]=h.useState([]),[k,A]=h.useState(!1),[O,g]=h.useState(null),[$,_]=h.useState(!1),[E,G]=h.useState(null),[j,N]=h.useState(!1),[D,S]=h.useState(null),[F,I]=h.useState([]),[x,v]=h.useState([]),[L,K]=h.useState([]),[R,C]=h.useState(!1),[z,J]=h.useState(!1),[P,Z]=h.useState(!1),[se,oe]=h.useState(!1),[de,Se]=h.useState(null),[Oe,Ue]=h.useState(null),[Ze,$e]=h.useState(null),[rt,Be]=h.useState(null),[Ye,Q]=h.useState(!1);h.useEffect(()=>{A(b.length>0)},[b]),h.useEffect(()=>{O&&(async()=>{try{if(O==="commissions"){const V=await(await fetch("/api/commissions")).json();I(V)}else if(O==="software"){const V=await(await fetch("/api/software")).json();v(V)}else if(O==="authorities"){const V=await(await fetch("/api/authorities")).json();K(V)}}catch(w){console.error("Error loading sub-page data:",w)}})()},[O]);const ce=a.filter(M=>{var V,Y,we;return((V=M.serial_number)==null?void 0:V.toLowerCase().includes(f.toLowerCase()))||((Y=M.provider)==null?void 0:Y.toLowerCase().includes(f.toLowerCase()))||((we=M.cabinet)==null?void 0:we.toLowerCase().includes(f.toLowerCase()))}),ue=M=>{y(M?ce.map(w=>w.id):[])},pe=(M,w)=>{y(w?[...b,M]:b.filter(V=>V!==M))},Te=()=>{G(null),_(!0)},ee=M=>{G(M),_(!0)},me=async M=>{window.confirm("Sigur vrei să ștergi acest element?")&&await u("metrology",M.id)},fe=async M=>{E?await c("metrology",E.id,M):await o("metrology",M),_(!1),G(null)},ne=async M=>{try{de?await c("approvals",de.id,M):await o("approvals",M),C(!1),Se(null)}catch(w){console.error("Error saving approval:",w)}},le=async M=>{try{const w=Oe?`/api/commissions/${Oe.id}`:"/api/commissions";if((await fetch(w,{method:Oe?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok){J(!1),Ue(null);const Le=await(await fetch("/api/commissions")).json();I(Le)}}catch(w){console.error("Error saving commission:",w)}},be=async M=>{try{const w=Ze?`/api/software/${Ze.id}`:"/api/software";if((await fetch(w,{method:Ze?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok){Z(!1),$e(null);const Le=await(await fetch("/api/software")).json();v(Le)}}catch(w){console.error("Error saving software:",w)}};h.useState(!1),h.useState(null);const te=async M=>{try{if((await fetch("/api/authorities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok){const Y=await(await fetch("/api/authorities")).json();K(Y),oe(!1)}}catch(w){console.error("Error saving authority:",w)}},ie=[{key:"cvt_number",label:"NUMĂR CVT",sortable:!0,render:M=>e("button",{onClick:()=>{S(M),N(!0)},className:"text-cyan-600 hover:text-cyan-800 font-semibold hover:underline transition-colors",children:M.cvt_number})},{key:"cvt_type",label:"TIP CVT",sortable:!0},{key:"approval_type",label:"APROBARE DE TIP",sortable:!0},{key:"software",label:"SOFTWARE",sortable:!0},{key:"cvt_dates_combined",label:"DATE CVT & EXPIRARE",sortable:!0,render:M=>{const w=M.cvt_date?new Date(M.cvt_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",V=M.expiry_date?new Date(M.expiry_date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A";let Y="N/A",we="text-green-600 bg-green-50";if(M.expiry_date){const Le=new Date,je=new Date(M.expiry_date)-Le,st=Math.ceil(je/(1e3*60*60*24));st<0?(we="text-red-600 bg-red-50",Y=`Expirat (${Math.abs(st)} zile)`):st<=30?(we="text-orange-600 bg-orange-50",Y=`${st} zile`):(we="text-green-600 bg-green-50",Y=`${st} zile`)}return t("div",{className:"space-y-2",children:[t("div",{className:"text-slate-600 text-sm space-y-1",children:[t("div",{children:["CVT: ",w]}),t("div",{children:["Expirare: ",V]})]}),Y!=="N/A"&&e("div",{className:`text-sm ${we.split(" ")[0]}`,children:Y})]})}},{key:"issuing_authority",label:"AUTORITATEA EMITENTĂ",sortable:!0},{key:"cvtFile",label:"DOCUMENT CVT",sortable:!1,render:M=>e("div",{className:"flex items-center justify-center",children:M.cvtFile?e("button",{onClick:()=>window.open(M.cvtFile,"_blank"),className:"p-2 bg-cyan-50 hover:bg-cyan-100 dark:bg-cyan-900/20 dark:hover:bg-cyan-900/30 text-cyan-600 dark:text-cyan-400 rounded-lg transition-colors",title:"Vizualizează documentul CVT",children:e(Qe,{className:"w-5 h-5"})}):e("span",{className:"text-slate-400 text-sm",children:"-"})})},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Ce=[{key:"approval_number",label:"NUMĂR APROBARE",sortable:!0,render:M=>e("button",{onClick:()=>d(`/approval-detail/${M.id}`),className:"text-blue-600 hover:text-blue-800 font-semibold hover:underline transition-colors",children:M.approval_number})},{key:"approval_type",label:"TIP APROBARE",sortable:!0},{key:"provider",label:"FURNIZOR",sortable:!0},{key:"cabinet",label:"CABINET",sortable:!0},{key:"approval_date",label:"DATA APROBARE",sortable:!0,render:M=>e("div",{className:"text-slate-600",children:M.approval_date?new Date(M.approval_date).toLocaleDateString("ro-RO"):"N/A"})},{key:"expiry_date",label:"DATA EXPIRARE",sortable:!0,render:M=>{if(!M.expiry_date)return e("span",{className:"text-slate-400",children:"N/A"});const w=new Date(M.expiry_date),Y=w-new Date,we=Math.ceil(Y/(1e3*60*60*24));let Le="text-green-600";return we<0?Le="text-red-600":we<=30&&(Le="text-orange-600"),e("div",{className:Le,children:w.toLocaleDateString("ro-RO")})}},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Pe=[{key:"commission_number",label:"NUMĂR COMISIE",sortable:!0},{key:"members",label:"MEMBRI",sortable:!1,render:M=>{const w=M.members?typeof M.members=="string"?M.members.split(","):M.members:[];return e("div",{className:"text-sm",children:w.length>0?w.join(", "):"N/A"})}},{key:"date_formed",label:"DATA FORMARE",sortable:!0,render:M=>e("div",{className:"text-slate-600",children:M.date_formed?new Date(M.date_formed).toLocaleDateString("ro-RO"):"N/A"})},{key:"status",label:"STATUS",sortable:!0},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],Ae=[{key:"software_name",label:"NUME SOFTWARE",sortable:!0},{key:"version",label:"VERSIUNE",sortable:!0},{key:"provider",label:"FURNIZOR",sortable:!0},{key:"release_date",label:"DATA LANSARE",sortable:!0,render:M=>e("div",{className:"text-slate-600",children:M.release_date?new Date(M.release_date).toLocaleDateString("ro-RO"):"N/A"})},{key:"status",label:"STATUS",sortable:!0},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],B=[{key:"authority_name",label:"NUME AUTORITATE",sortable:!0},{key:"contact_person",label:"PERSOANĂ CONTACT",sortable:!0},{key:"contact_email",label:"EMAIL",sortable:!0},{key:"contact_phone",label:"TELEFON",sortable:!0},{key:"address",label:"ADRESĂ",sortable:!0},{key:"created_info",label:"CREAT DE / DATA",sortable:!0,render:M=>t("div",{className:"space-y-1",children:[e("div",{className:"text-slate-800 dark:text-slate-200 font-medium text-sm",children:M.created_by||"Necunoscut"}),e("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:M.created_at?new Date(M.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}];if(!O)return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-2xl shadow-lg shadow-cyan-500/25",children:e(Yt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Metrologie"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare certificate și verificări tehnice"})]})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:()=>Q(!0),className:"btn-secondary flex items-center space-x-2",children:[e(Me,{className:"w-4 h-4"}),e("span",{children:"Calendar ONJN"})]}),t("button",{onClick:Te,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă CVT"})]})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>g(null),className:"px-4 py-2 bg-cyan-100 text-cyan-700 rounded-lg font-medium whitespace-nowrap",children:"CVT-uri"}),e("button",{onClick:()=>g("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>g("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>g("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>g("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după număr CVT, furnizor, cabinet...",value:f,onChange:M=>T(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e(ft,{data:ce,filename:"metrology",onExportExcel:()=>p(ce,"metrology"),onExportPDF:()=>m(ce,"metrology")})]})}),e("div",{className:"card p-6",children:i?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"})}):ce.length===0?t("div",{className:"text-center py-12",children:[e(Yt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există certificate"}),e("p",{className:"text-slate-500",children:"Adaugă primul certificat pentru a începe"})]}):e(qe,{data:ce,columns:ie,onEdit:ee,onDelete:me,searchTerm:f,selectedItems:b,onSelectAll:ue,onSelectItem:pe,moduleColor:"cyan"})}),$&&e(Po,{item:E,onClose:()=>{_(!1),G(null)},onSave:fe,providers:r,cabinets:l,gameMixes:n}),j&&e(Lo,{item:D,onClose:()=>{N(!1),S(null)}}),Ye&&e(Fo,{onClose:()=>Q(!1)})]})});if(O==="approvals")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>g(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(pt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Aprobări de Tip"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare aprobări echipamente"})]})]}),t("button",{onClick:()=>{Se(null),C(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Aprobare"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>g(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>g("approvals"),className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg font-medium whitespace-nowrap",children:"Aprobări"}),e("button",{onClick:()=>g("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>g("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>g("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:i?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):s.length===0?t("div",{className:"text-center py-12",children:[e(pt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există aprobări"}),e("p",{className:"text-slate-500",children:"Adaugă prima aprobare pentru a începe"})]}):e(qe,{data:s,columns:Ce,onEdit:M=>{Se(M),C(!0)},onDelete:async M=>{window.confirm("Sigur vrei să ștergi această aprobare?")&&await u("approvals",M.id)},moduleColor:"blue"})}),R&&e(Ts,{item:de,onClose:()=>{C(!1),Se(null)},onSave:ne,providers:r,cabinets:l})]})});if(O==="commissions")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>g(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(bt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Comisii Metrologie"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare comisii de verificare"})]})]}),t("button",{onClick:()=>{Ue(null),J(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Comisie"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>g(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>g("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>g("commissions"),className:"px-4 py-2 bg-purple-100 text-purple-700 rounded-lg font-medium whitespace-nowrap",children:"Comisii"}),e("button",{onClick:()=>g("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>g("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:i?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):F.length===0?t("div",{className:"text-center py-12",children:[e(bt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există comisii"}),e("p",{className:"text-slate-500",children:"Adaugă prima comisie pentru a începe"})]}):e(qe,{data:F,columns:Pe,onEdit:M=>{Ue(M),J(!0)},onDelete:async M=>{if(window.confirm("Sigur vrei să ștergi această comisie?")&&(await fetch(`/api/commissions/${M.id}`,{method:"DELETE"})).ok){const Y=await(await fetch("/api/commissions")).json();I(Y)}},moduleColor:"purple"})}),z&&e(Io,{item:Oe,onClose:()=>{J(!1),Ue(null)},onSave:le})]})});if(O==="software")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>g(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-lg shadow-green-500/25",children:e(Lt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Software Jocuri"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare versiuni software"})]})]}),t("button",{onClick:()=>{$e(null),Z(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Software"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>g(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>g("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>g("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>g("software"),className:"px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium whitespace-nowrap",children:"Software"}),e("button",{onClick:()=>g("authorities"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Autorități"})]})}),e("div",{className:"card p-6",children:i?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"})}):x.length===0?t("div",{className:"text-center py-12",children:[e(Lt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există software"}),e("p",{className:"text-slate-500",children:"Adaugă primul software pentru a începe"})]}):e(qe,{data:x,columns:Ae,onEdit:M=>{$e(M),Z(!0)},onDelete:async M=>{if(window.confirm("Sigur vrei să ștergi acest software?")&&(await fetch(`/api/software/${M.id}`,{method:"DELETE"})).ok){const Y=await(await fetch("/api/software")).json();v(Y)}},moduleColor:"green"})}),P&&e(Ro,{item:Ze,onClose:()=>{Z(!1),$e(null)},onSave:be,providers:r})]})});if(O==="authorities")return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>g(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),e("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl shadow-lg shadow-orange-500/25",children:e(la,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Autorități Metrologie"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Gestionare autorități de verificare"})]})]}),t("button",{onClick:()=>{Be(null),oe(!0)},className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Autoritate"})]})]})}),e("div",{className:"card p-4",children:t("div",{className:"flex space-x-2 overflow-x-auto",children:[e("button",{onClick:()=>g(null),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"CVT-uri"}),e("button",{onClick:()=>g("approvals"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Aprobări"}),e("button",{onClick:()=>g("commissions"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Comisii"}),e("button",{onClick:()=>g("software"),className:"px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400 rounded-lg font-medium whitespace-nowrap transition-colors",children:"Software"}),e("button",{onClick:()=>g("authorities"),className:"px-4 py-2 bg-orange-100 text-orange-700 rounded-lg font-medium whitespace-nowrap",children:"Autorități"})]})}),e("div",{className:"card p-6",children:i?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):L.length===0?t("div",{className:"text-center py-12",children:[e(la,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există autorități"}),e("p",{className:"text-slate-500",children:"Adaugă prima autoritate pentru a începe"})]}):e(qe,{data:L,columns:B,onEdit:M=>{Be(M),oe(!0)},onDelete:async M=>{if(window.confirm("Sigur vrei să ștergi această autoritate?")&&(await fetch(`/api/authorities/${M.id}`,{method:"DELETE"})).ok){const Y=await(await fetch("/api/authorities")).json();K(Y)}},moduleColor:"orange"})}),se&&e(Oo,{item:rt,onClose:()=>{oe(!1),Be(null)},onSave:te})]})})},Mo=()=>{const{id:a}=It(),s=He(),{approvals:r,providers:l,cabinets:n,gameMixes:i,updateItem:o,deleteItem:c}=ye(),[u,p]=h.useState(null),[m,d]=h.useState(!0),[f,T]=h.useState(!1),[b,y]=h.useState(!1),[k,A]=h.useState(!1),[O,g]=h.useState(!0),[$,_]=h.useState([]);h.useEffect(()=>{const F=r.find(I=>I.id===parseInt(a));if(F){if(p(F),F.attachments)try{const I=typeof F.attachments=="string"?JSON.parse(F.attachments):F.attachments;_(Array.isArray(I)?I:[])}catch{_([])}d(!1)}else U.error("Aprobarea nu a fost găsită"),s("/approvals")},[a,r,s]);const E=async()=>{try{await c("approvals",u.id),U.success("Aprobarea a fost ștearsă cu succes"),s("/approvals")}catch{U.error("Eroare la ștergerea aprobării")}},G=async F=>{try{await o("approvals",u.id,F),U.success("Aprobarea a fost actualizată cu succes"),y(!1),p({...u,...F})}catch{U.error("Eroare la actualizarea aprobării")}},j=async F=>{const I=Array.from(F.target.files);for(const x of I){const v=new FormData;v.append("file",x),v.append("entityType","approval"),v.append("entityId",u.id.toString());try{const L=await fetch("/api/upload",{method:"POST",body:v});if(L.ok){const K=await L.json(),R={id:Date.now()+Math.random(),name:x.name,size:x.size,type:x.type,url:K.fileUrl,uploaded:!0},C=[...$,R];_(C),await o("approvals",u.id,{attachments:JSON.stringify(C)}),U.success(`${x.name} încărcat cu succes`)}else U.error(`Eroare la încărcarea ${x.name}`)}catch{U.error(`Eroare la încărcarea ${x.name}`)}}},N=async F=>{const I=$.filter(x=>x.id!==F);_(I);try{await o("approvals",u.id,{attachments:JSON.stringify(I)}),U.success("Atașament șters")}catch{U.error("Eroare la ștergerea atașamentului")}},D=F=>{const I=l.find(x=>x.id===F||x.name===F);return I?I.name:F},S=F=>{const I=n.find(x=>x.id===F||x.name===F);return I?I.name:F};return m?e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Se încarcă..."})]})})}):u?t(he,{children:[e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 mb-6",children:[e("div",{className:"bg-gradient-to-r from-emerald-800 via-green-800 to-teal-800 px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("button",{onClick:()=>s("/approvals"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(et,{className:"w-5 h-5 text-white"})}),e("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h1",{className:"text-2xl font-bold text-white",children:u.name}),t("p",{className:"text-emerald-100",children:[u.provider," | ",u.cabinet]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>A(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Setări",children:e(Lt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>y(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Editează",children:e(tt,{className:"w-5 h-5 text-white"})}),e("button",{onClick:()=>T(!0),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Șterge",children:e(Fe,{className:"w-5 h-5 text-white"})})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-6",children:[t("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(_e,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Furnizor"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:D(u.provider)||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(la,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Cabinet"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:S(u.cabinet)||"N/A"})]}),t("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(At,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Game Mix"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:ko(u.game_mix_name||u.game_mix,i)})]}),t("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-4 rounded-lg border border-amber-200 dark:border-amber-800",children:[e("div",{className:"flex items-center justify-between mb-2",children:e(kt,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),e("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Autoritate"}),e("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:u.issuing_authority||"N/A"})]})]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"lg:col-span-2 space-y-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(kt,{className:"w-5 h-5 mr-2 text-blue-500"}),"Checksums"]}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"MD5"}),e("div",{className:"mt-1 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:u.checksum_md5||"N/A"})})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"SHA256"}),e("div",{className:"mt-1 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:e("p",{className:"text-slate-800 dark:text-slate-200 font-mono text-sm break-all",children:u.checksum_sha256||"N/A"})})]})]})]}),u.notes&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-green-500"}),"Note"]}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.notes})]})]}),t("div",{className:"space-y-6",children:[O&&t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ze,{className:"w-5 h-5 mr-2 text-blue-500"}),"Atașamente"]}),t("div",{className:"space-y-4",children:[t("label",{className:"block",children:[e("input",{type:"file",multiple:!0,onChange:j,className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),t("div",{className:"w-full p-4 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg hover:border-green-500 transition-colors cursor-pointer text-center",children:[e(ze,{className:"w-8 h-8 text-slate-400 mx-auto mb-2"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Apasă pentru a adăuga fișiere"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-500",children:"PDF, DOC, JPG, PNG"})]})]}),$.length>0&&e("div",{className:"space-y-2",children:$.map(F=>t("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[t("div",{className:"flex items-center space-x-3 flex-1",children:[e(ge,{className:"w-4 h-4 text-slate-500"}),t("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 truncate",children:F.name}),t("p",{className:"text-xs text-slate-500 dark:text-slate-500",children:[(F.size/1024).toFixed(1)," KB"]})]})]}),t("div",{className:"flex items-center space-x-2",children:[F.url&&e("a",{href:F.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 transition-colors",children:e(Je,{className:"w-4 h-4"})}),e("button",{onClick:()=>N(F.id),className:"text-red-500 hover:text-red-700 transition-colors",children:e(Fe,{className:"w-4 h-4"})})]})]},F.id))})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-slate-200 dark:border-slate-700 p-6",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4",children:"Metadata"}),t("div",{className:"space-y-3",children:[t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Creat de"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.created_by||"N/A"})]}),t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Creat la"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.created_at?new Date(u.created_at).toLocaleString("ro-RO"):"N/A"})]}),u.updated_at&&t("div",{children:[e("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Actualizat la"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:new Date(u.updated_at).toLocaleString("ro-RO")})]})]})]})]})]})]})}),f&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-md p-6",children:[t("div",{className:"flex items-center space-x-3 mb-4",children:[e("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-lg",children:e(nt,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Confirmă ștergerea"})]}),t("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:['Ești sigur că vrei să ștergi aprobarea "',u.name,'"? Această acțiune nu poate fi anulată.']}),t("div",{className:"flex space-x-3",children:[e("button",{onClick:()=>T(!1),className:"flex-1 px-4 py-2 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"Anulează"}),e("button",{onClick:E,className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Șterge"})]})]})}),b&&e(Ts,{item:u,onClose:()=>y(!1),onSave:G}),k&&e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-md p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Setări Vizualizare"}),e("button",{onClick:()=>A(!1),className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e(nt,{className:"w-5 h-5"})})]}),e("div",{className:"space-y-4",children:t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-slate-700 dark:text-slate-300",children:"Afișează Atașamente"}),e("button",{onClick:()=>{g(!O)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${O?"bg-green-600":"bg-slate-300 dark:bg-slate-600"}`,children:e("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${O?"translate-x-6":"translate-x-1"}`})})]})}),e("div",{className:"mt-6 flex justify-end",children:e("button",{onClick:()=>A(!1),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Închide"})})]})})]}):e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e(nt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Aprobarea nu a fost găsită"}),e("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Aprobarea pe care o căutați nu există sau a fost ștearsă."}),e("button",{onClick:()=>s("/approvals"),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-colors",children:"Înapoi la Metrologie"})]})})})},$o=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({serial_number:"",jackpot_name:"",jackpot_type:"Progressive",current_amount:0,max_amount:"",progress_percentage:0,status:"Active",winner:"",triggered_date:"",notes:""});h.useEffect(()=>{a&&n({serial_number:a.serial_number||"",jackpot_name:a.jackpot_name||"",jackpot_type:a.jackpot_type||"Progressive",current_amount:a.current_amount||0,max_amount:a.max_amount||"",progress_percentage:a.progress_percentage||0,status:a.status||"Active",winner:a.winner||"",triggered_date:a.triggered_date||"",notes:a.notes||""})},[a]);const i=c=>{const{name:u,value:p}=c.target;n(m=>({...m,[u]:p}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-yellow-800 to-amber-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-600/20 to-amber-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-2xl shadow-lg",children:e(Gt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Jackpot":"Adaugă Jackpot Nou"}),e("p",{className:"text-yellow-100 text-sm font-medium",children:"Completează informațiile despre jackpot"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații de bază"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Numărul de serie *"}),e("input",{type:"text",name:"serial_number",value:l.serial_number,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Serial number slot",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Jackpot *"}),e("input",{type:"text",name:"jackpot_name",value:l.jackpot_name,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"ex: Mega Jackpot",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip Jackpot"}),t("select",{name:"jackpot_type",value:l.jackpot_type,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[e("option",{value:"Progressive",children:"Progresiv"}),e("option",{value:"Fixed",children:"Fix"}),e("option",{value:"Mystery",children:"Mystery"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status"}),t("select",{name:"status",value:l.status,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[e("option",{value:"Active",children:"Activ"}),e("option",{value:"Triggered",children:"Declanșat"}),e("option",{value:"Reset",children:"Resetat"}),e("option",{value:"Maintenance",children:"Mentenanță"})]})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații financiare"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Suma curentă"}),e("input",{type:"number",step:"0.01",name:"current_amount",value:l.current_amount,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Suma maximă"}),e("input",{type:"number",step:"0.01",name:"max_amount",value:l.max_amount,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"1000000.00"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Progres (%)"}),e("input",{type:"number",step:"0.01",name:"progress_percentage",value:l.progress_percentage,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-semibold text-slate-800 border-b border-slate-200 pb-2",children:"Informații câștigător"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Câștigător"}),e("input",{type:"text",name:"winner",value:l.winner,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Numele câștigătorului"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data declanșării"}),e("input",{type:"datetime-local",name:"triggered_date",value:l.triggered_date,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Note adiționale despre jackpot..."})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(Gt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Jackpot"]})]})]})]})})]})})},Bo=()=>{const{jackpots:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:i,exportToPDF:o}=ye(),[c,u]=h.useState(""),[p,m]=h.useState([]),[d,f]=h.useState(!1);h.useEffect(()=>{f(p.length>0)},[p]);const T=I=>{m(I?_.map(x=>x.id):[])},b=(I,x)=>{m(x?[...p,I]:p.filter(v=>v!==I))},y=async()=>{if(p.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${p.length} elemente?`))try{for(const I of p)await n("jackpots",I);m([]),f(!1)}catch(I){console.error("Error bulk deleting:",I)}},k=()=>{p.length!==0&&console.log("Bulk edit for:",p)},[A,O]=h.useState(!1),[g,$]=h.useState(null),_=a.filter(I=>{var x,v,L;return((x=I.name)==null?void 0:x.toLowerCase().includes(c.toLowerCase()))||((v=I.game)==null?void 0:v.toLowerCase().includes(c.toLowerCase()))||((L=I.location)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))}),E=[{key:"id",label:"#",sortable:!0},{key:"name",label:"NUME JACKPOT",sortable:!0},{key:"game",label:"JOC",sortable:!0},{key:"amount",label:"SUMA",sortable:!0},{key:"location",label:"LOCAȚIE",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"created_by",label:"CREAT DE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_at?new Date(I.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"actions",label:"ACȚIUNI",sortable:!1}],G=I=>{$(I),O(!0)},j=async I=>{window.confirm("Sigur vrei să ștergi acest jackpot?")&&await n("jackpots",I)},N=()=>{$(null),O(!0)},D=async I=>{g?await l("jackpots",g.id,I):await r("jackpots",I),O(!1),$(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-2xl shadow-lg shadow-yellow-500/25",children:e(Gt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Jackpots"}),e("p",{className:"text-slate-600",children:"Gestionează jackpot-urile din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{i("jackpots")}catch(I){console.error("Error exporting to Excel:",I)}},onExportPDF:()=>{try{o("jackpots")}catch(I){console.error("Error exporting to PDF:",I)}},entity:"jackpots"}),d&&t(De,{children:[t("button",{onClick:k,className:"btn-secondary flex items-center space-x-2",children:[e(Edit,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:y,className:"btn-danger flex items-center space-x-2",children:[e(Trash2,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:N,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Jackpot"})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută jackpot-uri...",value:c,onChange:I=>u(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500"})}):_.length===0?t("div",{className:"text-center py-12",children:[e(Gt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există jackpot-uri"}),e("p",{className:"text-slate-500",children:"Adaugă primul jackpot pentru a începe"})]}):e(qe,{data:_,columns:E,onEdit:G,onDelete:j,searchTerm:c,selectedItems:p,onSelectAll:T,onSelectItem:b,moduleColor:"blue"})}),A&&e($o,{item:g,onClose:()=>O(!1),onSave:D})]})})},Uo=({item:a,onClose:s,onSave:r})=>{const{companies:l,locations:n,providers:i}=ye(),[o,c]=h.useState({invoice_number:"",serial_numbers:"",buyer:"",seller:"",type:"Sale",amount:"",currency:"RON",rates:"",locations:[],pdf_file:null});h.useEffect(()=>{a&&c({invoice_number:a.invoice_number||"",serial_numbers:a.serial_number?typeof a.serial_number=="string"?JSON.parse(a.serial_number).join(`
`):a.serial_number.join(`
`):"",buyer:a.company||"",seller:a.seller||"",type:a.invoice_type||"Sale",amount:a.amount||"",currency:a.currency||"RON",rates:a.rates||"",locations:a.location?typeof a.location=="string"?JSON.parse(a.location):a.location:[],pdf_file:a.pdf_file||null})},[a]);const u=m=>{const{name:d,value:f,type:T,checked:b,files:y}=m.target;T==="checkbox"?d==="location"&&c(k=>({...k,locations:b?[...k.locations,f]:k.locations.filter(A=>A!==f)})):c(T==="file"?k=>({...k,[d]:y[0]||null}):k=>({...k,[d]:f}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-indigo-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(Xs,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Factură":"Adaugă Factură Nouă"}),e("p",{className:"text-blue-100 text-sm font-medium",children:"Completează informațiile despre factură"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:m=>{m.preventDefault();const d=new FormData;Object.keys(o).forEach(f=>{f==="locations"?d.append(f,JSON.stringify(o[f])):f==="pdf_file"?o[f]&&d.append(f,o[f]):d.append(f,o[f])}),r(d)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Număr Factură *"}),e("input",{type:"text",name:"invoice_number",value:o.invoice_number,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ex: INV-2024-001",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Serii"}),e("textarea",{name:"serial_numbers",value:o.serial_numbers,onChange:u,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Introduceți seriile, câte una pe rând"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Cumpărător *"}),t("select",{name:"buyer",value:o.buyer,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează compania"}),l==null?void 0:l.map(m=>e("option",{value:m.name,children:m.name},m.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Vânzător *"}),t("select",{name:"seller",value:o.seller,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează furnizorul"}),i==null?void 0:i.map(m=>e("option",{value:m.name,children:m.name},m.id))]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip *"}),t("select",{name:"type",value:o.type,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e("option",{value:"Sale",children:"Vânzare"}),e("option",{value:"Rental",children:"Chirie"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Suma *"}),e("input",{type:"number",name:"amount",value:o.amount,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",step:"0.01",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Valută"}),t("select",{name:"currency",value:o.currency,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e("option",{value:"RON",children:"RON"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Rate (opțional)"}),e("input",{type:"text",name:"rates",value:o.rates,onChange:u,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ex: 3 rate de 1000 RON"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"PDF Factură *"}),e("input",{type:"file",name:"pdf_file",onChange:u,accept:".pdf",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),o.pdf_file&&t("p",{className:"text-sm text-green-600",children:["Fișier selectat: ",o.pdf_file.name]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Locații"}),e("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n==null?void 0:n.map(m=>t("label",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",name:"location",value:m.name,checked:o.locations.includes(m.name),onChange:u,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e("span",{className:"text-sm text-slate-700",children:m.name})]},m.id))}),o.locations.length===n.length&&e("p",{className:"text-sm text-blue-600 font-medium",children:"Toate locațiile"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Factură"]})]})]})]})})]})})},Go=()=>{const a=He(),{invoices:s,loading:r,createItem:l,updateItem:n,deleteItem:i,exportToExcel:o,exportToPDF:c}=ye(),[u,p]=h.useState(""),[m,d]=h.useState([]),[f,T]=h.useState(!1);h.useEffect(()=>{T(m.length>0)},[m]);const b=x=>{d(x?E.map(v=>v.id):[])},y=(x,v)=>{d(v?[...m,x]:m.filter(L=>L!==x))},k=async()=>{if(m.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${m.length} elemente?`))try{for(const x of m)await i("invoices",x);d([]),T(!1)}catch(x){console.error("Error bulk deleting:",x)}},A=()=>{m.length!==0&&console.log("Bulk edit for:",m)},[O,g]=h.useState(!1),[$,_]=h.useState(null),E=s.filter(x=>{var v,L,K;return((v=x.invoice_number)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))||((L=x.company)==null?void 0:L.toLowerCase().includes(u.toLowerCase()))||((K=x.status)==null?void 0:K.toLowerCase().includes(u.toLowerCase()))}),G=[{key:"id",label:"#",sortable:!0},{key:"invoice_number",label:"NUMĂR FACTURĂ",sortable:!0,render:x=>e("button",{onClick:()=>a(`/invoices/${x.id}`),className:"text-blue-600 hover:text-blue-800 font-medium underline",children:x.invoice_number})},{key:"company",label:"COMPANIE",sortable:!0},{key:"amount",label:"SUMA",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"created_by",label:"CREAT DE",sortable:!0,render:x=>e("div",{className:"text-slate-800 font-medium text-base",children:x.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:x=>e("div",{className:"text-slate-800 font-medium text-base",children:x.created_at?new Date(x.created_at).toLocaleDateString("ro-RO"):"N/A"})}],j=x=>{_(x),g(!0)},N=async x=>{window.confirm("Sigur vrei să ștergi această factură?")&&await i("invoices",x)},D=()=>{_(null),g(!0)},S=async x=>{$?await n("invoices",$.id,x):await l("invoices",x),g(!1),_(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl shadow-lg shadow-red-500/25",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Facturi"}),e("p",{className:"text-slate-600",children:"Gestionează facturile din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{o("invoices")}catch(x){console.error("Error exporting to Excel:",x)}},onExportPDF:()=>{try{c("invoices")}catch(x){console.error("Error exporting to PDF:",x)}},entity:"invoices"}),f&&t(De,{children:[t("button",{onClick:A,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:k,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:D,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Factură"})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută facturi...",value:u,onChange:x=>p(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:r?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"})}):E.length===0?t("div",{className:"text-center py-12",children:[e(ge,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există facturi"}),e("p",{className:"text-slate-500",children:"Adaugă prima factură pentru a începe"})]}):e(qe,{data:E,columns:G,onEdit:j,onDelete:N,searchTerm:u,selectedItems:m,onSelectAll:b,onSelectItem:y,moduleColor:"blue"})}),O&&e(Uo,{item:$,onClose:()=>g(!1),onSave:S})]})})},Vo=()=>{const{id:a}=It(),s=He(),{slots:r,companies:l,locations:n,providers:i,cabinets:o,gameMixes:c}=ye(),[u,p]=h.useState(null),[m,d]=h.useState(!0);h.useEffect(()=>{f()},[a]);const f=async()=>{try{const A=await fetch(`/api/invoices/${a}`);if(A.ok){const O=await A.json();p(O)}}catch(A){console.error("Error fetching invoice:",A)}finally{d(!1)}},T=A=>r.find(O=>O.serial_number===A)||null,b=()=>{if(u!=null&&u.file_path){const A=document.createElement("a");A.href=u.file_path,A.download=`factura_${u.invoice_number}.pdf`,A.target="_blank",A.click()}};if(m)return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e("p",{className:"mt-4 text-slate-600",children:"Se încarcă..."})]})});if(!u)return e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("h1",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Factura nu a fost găsită"}),e("button",{onClick:()=>s("/invoices"),className:"btn-primary",children:"Înapoi la Facturi"})]})});const y=u.serial_number?typeof u.serial_number=="string"?JSON.parse(u.serial_number):u.serial_number:[],k=u.location?typeof u.location=="string"?(()=>{try{const A=JSON.parse(u.location);return typeof A=="string"?JSON.parse(A):A}catch{return[]}})():u.location:[];return e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-8",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 mb-8 overflow-hidden",children:e("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>s("/invoices"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e(et,{className:"w-6 h-6 text-white"})}),e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(ge,{className:"w-8 h-8 text-white"})}),t("div",{children:[t("h1",{className:"text-3xl font-bold text-white mb-1",children:["Factura ",u.invoice_number]}),e("p",{className:"text-blue-100",children:"Detalii complete despre factură"})]})]}),t("button",{onClick:b,className:"btn-primary flex items-center space-x-2",children:[e(Je,{className:"w-5 h-5"}),e("span",{children:"Descarcă PDF"})]})]})})}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t("div",{className:"lg:col-span-1",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6 mb-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-blue-600"}),"Informații Factură"]}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Număr Factură"}),e("p",{className:"text-slate-800 font-medium",children:u.invoice_number})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Cumpărător"}),e("p",{className:"text-slate-800",children:u.company})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Vânzător"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.invoice_type})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Tip"}),e("p",{className:"text-slate-800 dark:text-slate-200",children:u.invoice_type})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Suma"}),t("p",{className:"text-slate-800 font-bold text-lg",children:[u.amount," ",u.currency]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Status"}),e("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${u.status==="Paid"?"bg-green-100 text-green-800":u.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:u.status})]}),u.description&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600",children:"Descriere"}),e("p",{className:"text-slate-800",children:u.description})]})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(We,{className:"w-5 h-5 mr-2 text-green-600"}),"Locații"]}),e("div",{className:"space-y-2",children:Array.isArray(k)&&k.length>0?k.map((A,O)=>t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("span",{className:"text-slate-700",children:A})]},O)):e("p",{className:"text-slate-500",children:"Toate locațiile"})})]})]}),t("div",{className:"lg:col-span-2",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6 mb-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-red-600"}),"PDF Factură"]}),e(Ct,{pdfUrl:u.file_path,title:`PDF ${u.invoice_number}`,placeholder:"PDF-ul facturii nu este disponibil",placeholderSubtext:"Atașează PDF-ul facturii pentru vizualizare"})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e(it,{className:"w-5 h-5 mr-2 text-purple-600"}),"Serii Asociate (",y.length,")"]}),y.length>0?e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full",children:[e("thead",{className:"bg-slate-50 border-b border-slate-200",children:t("tr",{children:[e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Serial Number"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Locație"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Furnizor"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Cabinet"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Game Mix"}),e("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-700",children:"Status"})]})}),e("tbody",{className:"divide-y divide-slate-200",children:y.map((A,O)=>{const g=T(A);return t("tr",{className:"hover:bg-slate-50",children:[e("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:A}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:g?g.location:"Necunoscută"}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:g?g.provider:"Necunoscut"}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:g?g.cabinet:"Necunoscut"}),e("td",{className:"px-4 py-3 text-sm text-slate-600",children:g?g.game_mix:"Necunoscut"}),e("td",{className:"px-4 py-3",children:g?e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g.status==="Active"?"bg-green-100 text-green-800":g.status==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.status}):e("span",{className:"text-slate-400",children:"N/A"})})]},O)})})]})}):t("div",{className:"text-center py-8 text-slate-500",children:[e(it,{className:"w-12 h-12 mx-auto mb-4 text-slate-300"}),e("p",{children:"Nu există serii asociate cu această factură"})]})]})]})]})]})})})},qo=()=>{var j,N,D;const{id:a}=It(),s=He(),{companies:r,loading:l,updateItem:n,refreshData:i}=ye(),[o,c]=h.useState(null),[u,p]=h.useState(!1),[m,d]=h.useState(!1),[f,T]=h.useState("overview"),[b,y]=h.useState([]),[k,A]=h.useState(!1),[O,g]=h.useState({name:"",type:"Contract",file:null});h.useEffect(()=>{const S=r.find(F=>F.id===parseInt(a));S&&c(S)},[a,r]),h.useEffect(()=>{const S=r.find(F=>F.id===parseInt(a));S&&c(S)},[r,a]);const $=async()=>{if(!(!o||k))try{A(!0);const F=(await re.get("/api/onjn-operators/stats")).data,x=(await re.get("/api/brands")).data,v=[],K=(await re.get("/api/onjn-operators")).data,R={};K.forEach(z=>{z.company_name&&(R[z.company_name]||(R[z.company_name]={company_name:z.company_name,total_slots:0,active_slots:0,expired_slots:0,cities:new Set,counties:new Set}),R[z.company_name].total_slots++,z.status==="În exploatare"&&R[z.company_name].active_slots++,z.is_expired&&R[z.company_name].expired_slots++,z.city&&R[z.company_name].cities.add(z.city),z.county&&R[z.company_name].counties.add(z.county))});const C=Object.values(R).filter(z=>z.company_name!==o.name).map(z=>({...z,cities_count:z.cities.size,counties_count:z.counties.size,cities:Array.from(z.cities),counties:Array.from(z.counties)})).sort((z,J)=>J.total_slots-z.total_slots);y(C)}catch(S){console.error("Error loading competitors:",S),U.error("Eroare la încărcarea datelor concurenților!")}finally{A(!1)}};h.useEffect(()=>{f==="competition"&&o&&$()},[f,o]);const _=async S=>{if(S.preventDefault(),!(!O.file||!O.name)){d(!0);try{const F=new FormData;F.append("file",O.file),F.append("name",O.name),F.append("type",O.type);const I=await fetch(`/api/companies/${o.id}/documents`,{method:"POST",body:F});if(I.ok){const x=await I.json();if(c(x),p(!1),g({name:"",type:"Contract",file:null}),x.compression){const{originalSize:v,compressedSize:L,compressionRatio:K,savedBytes:R}=x.compression,C=(v/1024/1024).toFixed(2),z=(L/1024/1024).toFixed(2),J=(R/1024).toFixed(2);U.success(`Document încărcat cu succes! PDF comprimat: ${C}MB → ${z}MB (${K}% reducere, ${J}KB economisite)`,{duration:6e3})}else U.success("Document încărcat cu succes!");setTimeout(()=>{i()},500)}}catch(F){console.error("Error uploading document:",F)}finally{d(!1)}}},E=S=>{const F=S.createElement("a");F.href=S.file_path,F.download=S.name,F.target="_blank",F.click()},G=async S=>{if(window.confirm("Sigur vrei să ștergi acest document?"))try{const F=await fetch(`/api/companies/${o.id}/documents/${S}`,{method:"DELETE"});if(F.ok){const I=await F.json();c(I),setTimeout(()=>{i()},500)}}catch(F){console.error("Error deleting document:",F)}};return l?e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{className:"text-slate-600 dark:text-slate-300",children:"Se încarcă..."})]})}):o?t(he,{children:[e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:t("div",{className:"container mx-auto px-4 py-8",children:[t("div",{className:"mb-8",children:[t("button",{onClick:()=>s("/companies"),className:"btn-secondary flex items-center space-x-2 mb-4",children:[e(et,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Companii"})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:t("div",{className:"flex items-start justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(_e,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:o.name}),e("p",{className:"text-slate-600 dark:text-slate-300 text-lg",children:"Detalii complete despre companie"})]})]}),t("button",{onClick:()=>p(!0),className:"btn-primary flex items-center space-x-2",children:[e(ze,{className:"w-5 h-5"}),e("span",{children:"Atașează Document"})]})]})})]}),e("div",{className:"mb-6",children:e("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700",children:t("div",{className:"flex border-b border-slate-200 dark:border-slate-700",children:[e("button",{onClick:()=>T("overview"),className:`flex-1 px-6 py-4 text-left font-medium transition-colors ${f==="overview"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:t("div",{className:"flex items-center space-x-2",children:[e(_e,{className:"w-4 h-4"}),e("span",{children:"Prezentare"})]})}),e("button",{onClick:()=>T("competition"),className:`flex-1 px-6 py-4 text-left font-medium transition-colors ${f==="competition"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:t("div",{className:"flex items-center space-x-2",children:[e(lt,{className:"w-4 h-4"}),e("span",{children:"Concurență"})]})})]})})}),f==="overview"&&t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t("div",{className:"lg:col-span-1",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6 mb-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(_e,{className:"w-5 h-5 mr-2 text-blue-600"}),"Informații Companie"]}),t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Nume Companie"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-medium",children:o.name})]}),o.cui&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"CUI"}),e("p",{className:"text-slate-800 dark:text-slate-200 font-medium",children:o.cui}),o.cuiFile&&t("div",{className:"mt-2 flex items-center space-x-2",children:[t("button",{onClick:()=>{if(o.cui_file){const S=document.createElement("a");S.href=o.cui_file,S.download=`CUI-${o.name}.pdf`,S.click()}},className:"inline-flex items-center px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors text-sm font-medium",title:"Previzualizează CUI",children:[e(Qe,{className:"w-4 h-4 mr-1"}),"Vezi Document"]}),t("button",{onClick:()=>{if(o.cui_file){const S=document.createElement("a");S.href=o.cui_file,S.download=`CUI-${o.name}.pdf`,S.click()}},className:"inline-flex items-center px-3 py-1.5 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm font-medium",title:"Descarcă CUI",children:[e(Je,{className:"w-4 h-4 mr-1"}),"Descarcă"]})]})]}),o.contact_person&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Persoană de Contact"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(yt,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),o.contact_person]})]}),o.phone&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Telefon"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(na,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),o.phone]})]}),o.email&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Email"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(Qt,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),o.email]})]}),o.address&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Adresă"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(We,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),o.address]})]}),t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Data Creării"}),t("p",{className:"text-slate-800 dark:text-slate-200 font-medium flex items-center",children:[e(Me,{className:"w-4 h-4 mr-2 text-slate-500 dark:text-slate-400"}),new Date(o.created_at).toLocaleDateString("ro-RO")]})]}),o.status&&t("div",{children:[e("label",{className:"text-sm font-semibold text-slate-600 dark:text-slate-400 block mb-1",children:"Status"}),e("span",{className:`px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm ${o.status==="Active"?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800":"bg-gradient-to-r from-red-100 to-pink-100 text-red-800"}`,children:o.status})]})]})]}),o.notes&&t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-amber-600"}),"Note"]}),e("p",{className:"text-slate-700 dark:text-slate-300 leading-relaxed",children:o.notes})]})]}),e("div",{className:"lg:col-span-2",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-red-600"}),"Documente Atașate"]}),o.documents&&o.documents.length>0||o.cuiFile?t("div",{className:"space-y-6",children:[(o.cuiFile||o.documents&&o.documents.length>0)&&t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-blue-600"}),"Vizualizare Document"]}),e("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-lg p-4 mb-4",children:e(Ct,{pdfUrl:o.cui_file||(o.documents&&((j=o.documents[0])!=null&&j.file_path)?o.documents[0].file_path:null),title:o.cui_file?`CUI Document ${o.name}`:o.documents&&o.documents[0]?`PDF ${o.documents[0].name}`:"Document PDF",placeholder:"Nu există documente de afișat",placeholderSubtext:"Atașează primul document sau CUI pentru a începe"})}),t("div",{className:"flex items-center justify-between",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:o.cuiFile?`Document: CUI ${o.name}`:`Document: ${(N=o.documents[0])==null?void 0:N.name} (${(D=o.documents[0])==null?void 0:D.type})`}),t("button",{onClick:()=>{if(o.cui_file){const S=document.createElement("a");S.href=o.cui_file,S.download=`CUI-${o.name}.pdf`,S.click()}else o.documents&&o.documents[0]&&E(o.documents[0])},className:"btn-primary flex items-center space-x-2",children:[e(Je,{className:"w-4 h-4"}),e("span",{children:"Descarcă PDF"})]})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center",children:[e(ge,{className:"w-5 h-5 mr-2 text-green-600"}),"Toate Documentele (",o.cuiFile?1:0," + ",o.documents?o.documents.length:0,")"]}),t("div",{className:"space-y-4",children:[o.cuiFile&&e("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e(ge,{className:"w-5 h-5 text-blue-600"})}),t("div",{children:[t("h3",{className:"font-semibold text-slate-800 dark:text-slate-200",children:["CUI ",o.name]}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Document CUI • ",new Date(o.created_at).toLocaleDateString("ro-RO")]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>{const S=document.querySelector("iframe");S&&(S.src=o.cuiFile)},className:"p-2 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:"Vezi în viewer",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const S=document.createElement("a");S.href=o.cuiFile,S.download=`CUI_${o.name||"company"}.pdf`,S.click()},className:"p-2 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors",title:"Descarcă",children:e(Je,{className:"w-4 h-4"})})]})]})}),o.documents&&o.documents.map((S,F)=>e("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e(ge,{className:"w-5 h-5 text-red-600"})}),t("div",{children:[e("h3",{className:"font-semibold text-slate-800 dark:text-slate-200",children:S.name}),t("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[S.type," • ",new Date(S.uploadedAt||S.uploaded_at).toLocaleDateString("ro-RO")]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>{const I=document.querySelector("iframe");I&&(I.src=S.url||S.file_path)},className:"p-2 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:"Vezi în viewer",children:e(Qe,{className:"w-4 h-4"})}),e("button",{onClick:()=>{const I=document.createElement("a");I.href=S.url||S.file_path,I.download=S.name,I.click()},className:"p-2 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors",title:"Descarcă",children:e(Je,{className:"w-4 h-4"})}),e("button",{onClick:()=>G(S._id||S.id),className:"p-2 text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 rounded-lg transition-colors",title:"Șterge",children:e(Fe,{className:"w-4 h-4"})})]})]})},S._id||S.id||F))]})]})]}):t("div",{className:"text-center py-12 text-slate-500",children:[e(ge,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),e("p",{className:"text-lg font-medium mb-2",children:"Nu există documente atașate"}),e("p",{className:"text-sm",children:"Atașează primul document sau CUI pentru a începe"})]})]})})]}),f==="competition"&&e("div",{className:"space-y-6",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"p-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl",children:e(lt,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Analiză Concurență"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"Top companii concurente din piață"})]})]}),t("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:[b.length," companii active"]})]}),k?t("div",{className:"flex items-center justify-center py-12",children:[e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e("span",{className:"ml-3 text-slate-600 dark:text-slate-400",children:"Se încarcă concurenții..."})]}):b.length>0?e("div",{className:"space-y-4",children:b.slice(0,10).map((S,F)=>e("div",{className:"border border-slate-200 dark:border-slate-700 rounded-xl p-4 hover:shadow-md transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-bold text-sm",children:F+1}),t("div",{children:[e("h3",{className:"font-semibold text-slate-800 dark:text-white",children:S.company_name}),t("div",{className:"flex items-center space-x-4 text-sm text-slate-600 dark:text-slate-400",children:[t("span",{className:"flex items-center space-x-1",children:[e(_e,{className:"w-4 h-4"}),t("span",{children:[S.total_slots.toLocaleString("ro-RO")," sloturi"]})]}),t("span",{className:"flex items-center space-x-1",children:[e(lt,{className:"w-4 h-4"}),t("span",{children:[S.active_slots.toLocaleString("ro-RO")," active"]})]}),t("span",{className:"flex items-center space-x-1",children:[e(We,{className:"w-4 h-4"}),t("span",{children:[S.counties_count," județe"]})]})]})]})]}),t("div",{className:"text-right",children:[t("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[S.cities_count," orașe"]}),e("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:S.expired_slots>0&&`${S.expired_slots} expirate`})]})]})},S.company_name))}):t("div",{className:"text-center py-12 text-slate-500",children:[e(lt,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),e("p",{className:"text-lg font-medium mb-2",children:"Nu există date de concurență"}),e("p",{className:"text-sm",children:"Datele vor fi actualizate după sincronizarea ONJN"})]})]})})]})}),u&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-6 w-full max-w-md mx-4",children:[e("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-200 mb-4",children:"Atașează Document"}),t("form",{onSubmit:_,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Nume Document"}),e("input",{type:"text",value:O.name,onChange:S=>g({...O,name:S.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ex: Contract de Colaborare",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Fișier PDF"}),e("input",{type:"file",accept:".pdf",onChange:S=>g({...O,file:S.target.files[0]}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{className:"flex space-x-3 pt-4",children:[e("button",{type:"button",onClick:()=>p(!1),className:"flex-1 btn-secondary",disabled:m,children:"Anulează"}),e("button",{type:"submit",className:"flex-1 btn-primary flex items-center justify-center space-x-2",disabled:m,children:m?t(De,{children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e("span",{children:"Se încarcă..."})]}):t(De,{children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Atașează"})]})})]})]})]})})]}):e(he,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:t("div",{className:"text-center",children:[e(_e,{className:"w-16 h-16 text-slate-400 dark:text-slate-500 mx-auto mb-4"}),e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Compania nu a fost găsită"}),e("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Compania pe care o căutați nu există în sistem."}),t("button",{onClick:()=>s("/companies"),className:"btn-primary flex items-center space-x-2 mx-auto",children:[e(et,{className:"w-4 h-4"}),e("span",{children:"Înapoi la Companii"})]})]})})})},Jo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",type:"",period:"",status:"Draft",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",type:a.type||"",period:a.period||"",status:a.status||"Draft",notes:a.notes||""})},[a]);const i=c=>{const{name:u,value:p}=c.target;n(m=>({...m,[u]:p}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-indigo-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg",children:e(it,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Raport ONJN":"Adaugă Raport ONJN Nou"}),e("p",{className:"text-blue-100 text-sm font-medium",children:"Completează informațiile despre raportul ONJN"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Raport *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Numele raportului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip *"}),t("select",{name:"type",value:l.type,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează tipul"}),e("option",{value:"Monthly",children:"Lunar"}),e("option",{value:"Quarterly",children:"Trimestrial"}),e("option",{value:"Annual",children:"Anual"}),e("option",{value:"Special",children:"Special"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Perioada *"}),e("input",{type:"text",name:"period",value:l.period,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"ex: Ianuarie 2025",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e("option",{value:"Draft",children:"Draft"}),e("option",{value:"Submitted",children:"Trimis"}),e("option",{value:"Approved",children:"Aprobat"}),e("option",{value:"Rejected",children:"Respins"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"px-6 py-3 text-slate-600 hover:text-slate-800 font-semibold transition-colors",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(qt,{className:"w-4 h-4"}),e("span",{children:a?"Actualizează":"Adaugă"})]})]})]})})]})})},Wo=()=>{const{onjnReports:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:i,exportToPDF:o}=ye(),c=He(),[u,p]=h.useState(""),[m,d]=h.useState([]),[f,T]=h.useState(!1);h.useEffect(()=>{T(m.length>0)},[m]);const b=x=>{d(x?E.map(v=>v.id):[])},y=(x,v)=>{d(v?[...m,x]:m.filter(L=>L!==x))},k=async()=>{if(m.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${m.length} elemente?`))try{for(const x of m)await n("onjnReports",x);d([]),T(!1)}catch(x){console.error("Error bulk deleting:",x)}},A=()=>{m.length!==0&&console.log("Bulk edit for:",m)},[O,g]=h.useState(!1),[$,_]=h.useState(null),E=a.filter(x=>{var v,L,K;return((v=x.name)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))||((L=x.type)==null?void 0:L.toLowerCase().includes(u.toLowerCase()))||((K=x.status)==null?void 0:K.toLowerCase().includes(u.toLowerCase()))}),G=[{key:"id",label:"#",sortable:!0},{key:"name",label:"NUME RAPORT",sortable:!0},{key:"type",label:"TIP",sortable:!0},{key:"period",label:"PERIOADA",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"created_by",label:"CREAT DE",sortable:!0,render:x=>e("div",{className:"text-slate-800 font-medium text-base",children:x.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:x=>e("div",{className:"text-slate-800 font-medium text-base",children:x.created_at?new Date(x.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"actions",label:"ACȚIUNI",sortable:!1}],j=x=>{_(x),g(!0)},N=async x=>{window.confirm("Sigur vrei să ștergi acest raport ONJN?")&&await n("onjnReports",x)},D=()=>{_(null),g(!0)},S=async x=>{$?await l("onjnReports",$.id,x):await r("onjnReports",x),g(!1),_(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg shadow-blue-500/25",children:e(ya,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Rapoarte ONJN"}),e("p",{className:"text-slate-600",children:"Generează și gestionează rapoartele ONJN"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{i("onjnreports")}catch(x){console.error("Error exporting to Excel:",x)}},onExportPDF:()=>{try{o("onjnreports")}catch(x){console.error("Error exporting to PDF:",x)}},entity:"onjnreports"}),f&&t(De,{children:[t("button",{onClick:A,className:"btn-secondary flex items-center space-x-2",children:[e(Edit,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:k,className:"btn-danger flex items-center space-x-2",children:[e(Trash2,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:D,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Raport"})]})]})]})}),t("div",{className:"card p-6 hover:shadow-xl transition-shadow cursor-pointer",onClick:()=>c("/onjn-operators"),children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl shadow-lg shadow-indigo-500/25",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Operatori ONJN"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"TOȚI operatorii din Registrul Public ONJN (până la 25,000 sloturi)"})]})]}),e(Kt,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})]}),t("div",{className:"mt-4 grid grid-cols-4 gap-4",children:[t("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Total Sloturi"}),e("div",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:"25K+"})]}),t("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"În Exploatare"}),e("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:"Live"})]}),t("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Filtre Avansate"}),e("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"✓"})]}),t("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3",children:[e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Auto Refresh"}),e("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:"✓"})]})]})]}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută rapoarte...",value:u,onChange:x=>p(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):E.length===0?t("div",{className:"text-center py-12",children:[e(ya,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există rapoarte ONJN"}),e("p",{className:"text-slate-500",children:"Adaugă primul raport pentru a începe"})]}):e(qe,{data:E,columns:G,onEdit:j,onDelete:N,searchTerm:u,selectedItems:m,onSelectAll:b,onSelectItem:y,moduleColor:"blue"})}),O&&e(Jo,{item:$,onClose:()=>g(!1),onSave:S})]})})},Ho=()=>{var R;const a=He(),[s,r]=h.useState([]),[l,n]=h.useState(null),[i,o]=h.useState(!0),[c,u]=h.useState(!1),[p,m]=h.useState(null),[d,f]=h.useState(null),[T,b]=h.useState(null),[y,k]=h.useState(""),[A,O]=h.useState({company:"",brand:"",county:"",city:"",status:"",license:""});h.useEffect(()=>{(async()=>{var z;try{const J=await re.get("/api/onjn-operators/refresh-status");if(J.data&&J.data.status==="running"){f(J.data),u(!0);const P=setInterval(()=>{re.get("/api/onjn-operators/refresh-status").then(Z=>{f(Z.data),Z.data&&(Z.data.status==="completed"||Z.data.status==="failed")&&(clearInterval(P),u(!1))}).catch(Z=>{var se;((se=Z.response)==null?void 0:se.status)!==404&&console.error("Error polling refresh status:",Z)})},2e3);b(P)}}catch(J){((z=J.response)==null?void 0:z.status)!==404&&console.error("Error checking refresh status:",J)}})(),g(),$()},[]);const g=async(C=1e3)=>{try{o(!0);const z=await re.get(`/api/onjn-operators?limit=${C}`);if(r(z.data),z.data.length>0){const J=z.data.map(P=>P.last_scraped_at).filter(Boolean).sort((P,Z)=>new Date(Z)-new Date(P))[0];J&&m(new Date(J))}}catch(z){console.error("Error loading ONJN operators:",z),U.error("Eroare la încărcarea datelor ONJN!")}finally{o(!1)}},$=async()=>{try{const C=await re.get("/api/onjn-operators/stats");n(C.data)}catch(C){console.error("Error loading stats:",C)}},_=async()=>{var C,z;try{const J=await re.get("/api/onjn-operators/refresh-status");f(J.data),J.data&&(J.data.status==="completed"||J.data.status==="failed")&&(T&&(clearInterval(T),b(null)),J.data.status==="completed"?(U.success(`✅ Sincronizare completă!
${(C=J.data.slotsFound)==null?void 0:C.toLocaleString("ro-RO")} sloturi scanate
${J.data.inserted} adăugate, ${J.data.updated} actualizate`,{id:"refresh",duration:8e3}),await g(),await $()):U.error(`❌ Sincronizare eșuată: ${J.data.currentStep}`,{id:"refresh"}),u(!1))}catch(J){((z=J.response)==null?void 0:z.status)===404?f(P=>({...P,currentStep:"Sincronizare în curs... (status endpoint indisponibil)",currentPage:P!=null&&P.currentPage?P.currentPage+1:1})):console.error("Error fetching progress:",J)}},E=async()=>{var C;if(d&&d.status==="running"){U.error("Sincronizare deja în curs. Vă rugăm să așteptați finalizarea.",{id:"refresh-warning"});return}try{u(!0),f({status:"running",currentPage:0,totalPages:500,currentStep:"Pornire sincronizare...",slotsFound:0,inserted:0,updated:0,errors:0,startTime:new Date}),U.loading("Sincronizare ONJN în curs...",{id:"refresh"});const z=await re.post("/api/onjn-operators/refresh",{companyId:null,maxPages:1200});if(z.data.success){f(P=>({...P,currentStep:"Sincronizare în curs...",slotsFound:z.data.scraped||0}));const J=setInterval(_,2e3);b(J),setTimeout(_,500)}}catch(z){console.error("Error starting refresh:",z),((C=z.response)==null?void 0:C.status)===400?U.error("Sincronizare deja în curs. Vă rugăm să așteptați finalizarea.",{id:"refresh"}):U.error("Eroare la pornirea sincronizării ONJN!",{id:"refresh"}),u(!1),f(null)}},G=async()=>{var C,z;if(d&&d.status==="running"){U.error("Import deja în curs. Vă rugăm să așteptați finalizarea.",{id:"import-warning"});return}try{u(!0),f({status:"running",currentPage:0,totalPages:0,currentStep:"Pornire import din JSON...",slotsFound:0,inserted:0,updated:0,errors:0,startTime:new Date}),U.loading("Import din JSON în curs...",{id:"import"});const J=await re.post("/api/onjn-operators/import-json");if(J.data.success){f(Z=>({...Z,currentStep:"Import în curs...",slotsFound:J.data.total||0}));const P=setInterval(_,2e3);b(P),setTimeout(_,500),U.success(`✅ Import completat!
${J.data.inserted} adăugate, ${J.data.updated} actualizate`,{id:"import",duration:8e3}),await g(),await $(),u(!1)}}catch(J){console.error("Error importing from JSON:",J),((C=J.response)==null?void 0:C.status)===400?U.error("Import deja în curs. Vă rugăm să așteptați finalizarea.",{id:"import"}):((z=J.response)==null?void 0:z.status)===404?U.error("Fișierul JSON nu a fost găsit. Rulați mai întâi scriptul de scraping.",{id:"import"}):U.error("Eroare la importul din JSON!",{id:"import"}),u(!1),f(null)}};h.useEffect(()=>()=>{T&&clearInterval(T)},[T]),h.useEffect(()=>{if(c&&(d==null?void 0:d.status)==="running"){const C=setTimeout(()=>{T&&(clearInterval(T),b(null)),f(z=>({...z,status:"completed",currentStep:"Sincronizare finalizată (timeout automat)"})),u(!1),U.success("Sincronizare completată! (timeout automat)",{id:"refresh",duration:5e3}),g(),$()},9e5);return()=>clearTimeout(C)}},[c,d,T]);const j=()=>{O({}),U.success("Toate filtrele au fost resetate",{duration:2e3})},N=Object.keys(A).length,D=s.filter(C=>{var Se,Oe,Ue;const z=!y||((Se=C.serial_number)==null?void 0:Se.toLowerCase().includes(y.toLowerCase()))||((Oe=C.slot_address)==null?void 0:Oe.toLowerCase().includes(y.toLowerCase()))||((Ue=C.city)==null?void 0:Ue.toLowerCase().includes(y.toLowerCase())),J=!A.company||C.company_name===A.company,P=!A.brand||C.brand_name===A.brand,Z=!A.county||C.county===A.county,se=!A.city||C.city===A.city,oe=!A.status||C.status===A.status,de=!A.license||C.license_number===A.license;return z&&J&&P&&Z&&se&&oe&&de}),S=[...new Set(s.map(C=>C.company_name).filter(Boolean))].sort(),F=[...new Set(s.map(C=>C.brand_name).filter(Boolean))].sort(),I=[...new Set(s.map(C=>C.county).filter(Boolean))].sort();[...new Set(s.map(C=>C.city).filter(Boolean))].sort();const x=[...new Set(s.map(C=>C.license_number).filter(Boolean))].sort(),v=S.map(C=>{const z=D.filter(se=>se.company_name===C),J=[...new Set(z.map(se=>se.brand_name).filter(Boolean))],P=[...new Set(z.map(se=>se.city).filter(Boolean))],Z=P.map(se=>{const oe=z.filter(de=>de.city===se);return{location:se,slots:oe.length}});return{company:C,totalSlots:z.length,brandsCount:J.length,locationsCount:P.length,brands:J,locations:P,slotsPerLocation:Z.sort((se,oe)=>oe.slots-se.slots)}}).sort((C,z)=>z.totalSlots-C.totalSlots),L={total:D.length,byStatus:[{status:"În exploatare",count:D.filter(C=>C.status==="În exploatare").length},{status:"Scos din funcțiune",count:D.filter(C=>C.status==="Scos din funcțiune").length},{status:"Suspendat",count:D.filter(C=>C.status==="Suspendat").length}],active:D.filter(C=>C.status==="În exploatare").length,inactive:D.filter(C=>C.status==="Scos din funcțiune").length,expired:0,expiringSoon:0},K=[{key:"serial_number",label:"SERIE",sortable:!0,render:C=>t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>window.open(C.onjn_details_url,"_blank"),className:"text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 font-semibold hover:underline transition-colors",children:C.serial_number}),e("a",{href:C.onjn_details_url,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-indigo-600 transition-colors",title:"Vezi detalii ONJN",children:e(Kt,{className:"w-4 h-4"})})]})},{key:"equipment_type",label:"TIP",sortable:!0,render:C=>e("div",{className:"text-slate-700 dark:text-slate-300",children:C.equipment_type||"-"})},{key:"company_name",label:"COMPANIE",sortable:!0,render:C=>e("div",{className:"font-medium text-slate-800 dark:text-slate-200",children:C.company_name||"-"})},{key:"brand_name",label:"BRAND",sortable:!0,render:C=>C.brand_name?t("button",{onClick:()=>a(`/onjn-operators/brand/${encodeURIComponent(C.brand_name)}`),className:`text-indigo-600 dark:text-indigo-400 font-semibold hover:text-indigo-800 dark:hover:text-indigo-300 
                     hover:underline transition-colors flex items-center space-x-1`,title:`Vezi toate sloturile ${C.brand_name}`,children:[e(_e,{className:"w-4 h-4"}),e("span",{children:C.brand_name})]}):e("span",{className:"text-slate-400",children:"-"})},{key:"slot_address",label:"ADRESĂ SLOT",sortable:!0,render:C=>t("div",{className:"text-sm",children:[e("div",{className:"text-slate-700 dark:text-slate-300",children:C.slot_address||"-"}),C.city&&t("div",{className:"text-slate-500 dark:text-slate-400 text-xs mt-1 flex items-center",children:[e(We,{className:"w-3 h-3 mr-1"}),C.city]})]})},{key:"county",label:"JUDEȚ",sortable:!0},{key:"license_number",label:"LICENȚĂ",sortable:!0,render:C=>e("div",{className:"text-xs text-slate-600 dark:text-slate-400 font-mono",children:C.license_number||"-"})},{key:"authorization_date",label:"AUTORIZARE",sortable:!0,render:C=>e("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:C.authorization_date?new Date(C.authorization_date).toLocaleDateString("ro-RO"):"-"})},{key:"expiry_date",label:"EXPIRARE",sortable:!0,render:C=>{if(!C.expiry_date)return e("span",{className:"text-slate-400",children:"-"});const z=new Date(C.expiry_date),P=z-new Date,Z=Math.ceil(P/(1e3*60*60*24));let se="text-green-600 dark:text-green-400",oe=null;return C.is_expired||Z<0?(se="text-red-600 dark:text-red-400",oe=e(nt,{className:"w-4 h-4 inline mr-1"})):Z<=30&&(se="text-orange-600 dark:text-orange-400",oe=e(nt,{className:"w-4 h-4 inline mr-1"})),t("div",{className:`text-sm font-medium ${se}`,children:[oe,z.toLocaleDateString("ro-RO")]})}},{key:"status",label:"STATUS",sortable:!0,render:C=>{const z=C.status==="În exploatare";return e("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${z?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}`,children:C.status})}}];return e(he,{children:t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl shadow-lg shadow-indigo-500/25",children:e(_e,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Operatori ONJN"}),e("p",{className:"text-slate-600 dark:text-slate-400",children:"TOȚI operatorii din Registrul Public ONJN (până la 25,000 sloturi)"}),p&&t("div",{className:"mt-2 flex items-center space-x-2",children:[e(Me,{className:"w-4 h-4 text-slate-500"}),t("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Ultima actualizare: ",p.toLocaleString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})]}),t("div",{className:"flex space-x-3",children:[t("button",{onClick:E,disabled:c||d&&d.status==="running",className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(ht,{className:`w-4 h-4 ${c?"animate-spin":""}`}),e("span",{children:c?"Sincronizare...":"Refresh ONJN"})]}),t("button",{onClick:G,disabled:c||d&&d.status==="running",className:"btn-secondary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(pt,{className:"w-4 h-4"}),e("span",{children:"📁 Import JSON"})]}),t("button",{onClick:j,disabled:N===0,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${N>0?"bg-red-500 hover:bg-red-600 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-500"}`,title:`${N} filtre active`,children:[e(X,{className:"w-4 h-4"}),t("span",{children:["Reset Filtre ",N>0&&`(${N})`]})]})]})]}),(d||c)&&t("div",{className:"mt-4 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl p-6 text-white",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("div",{className:"flex items-center space-x-3",children:[e(ht,{className:"w-6 h-6 animate-spin"}),t("div",{children:[e("h3",{className:"font-bold text-lg",children:"Sincronizare ONJN în curs..."}),e("p",{className:"text-indigo-100 text-sm",children:(d==null?void 0:d.currentStep)||"Se pregătește sincronizarea..."})]})]}),t("div",{className:"text-right",children:[t("div",{className:"text-2xl font-bold",children:[(d==null?void 0:d.currentPage)||0,"/",(d==null?void 0:d.totalPages)||500]}),e("div",{className:"text-indigo-100 text-sm",children:"pagini"})]})]}),t("div",{className:"mb-4",children:[t("div",{className:"flex justify-between text-sm text-indigo-100 mb-2",children:[e("span",{children:"Progres"}),t("span",{children:[((d==null?void 0:d.totalPages)||500)>0?Math.round(((d==null?void 0:d.currentPage)||0)/((d==null?void 0:d.totalPages)||500)*100):0,"%"]})]}),e("div",{className:"w-full bg-indigo-300 bg-opacity-30 rounded-full h-3",children:e("div",{className:"bg-white rounded-full h-3 transition-all duration-500 ease-out",style:{width:`${((d==null?void 0:d.totalPages)||500)>0?Math.min(((d==null?void 0:d.currentPage)||0)/((d==null?void 0:d.totalPages)||500)*100,100):0}%`}})})]}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:((d==null?void 0:d.slotsFound)||0).toLocaleString("ro-RO")}),e("div",{className:"text-indigo-100",children:"Sloturi găsite"})]}),t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:(d==null?void 0:d.inserted)||0}),e("div",{className:"text-indigo-100",children:"Adăugate"})]}),t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:(d==null?void 0:d.updated)||0}),e("div",{className:"text-indigo-100",children:"Actualizate"})]}),t("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 text-center",children:[e("div",{className:"font-bold text-lg",children:(d==null?void 0:d.errors)||0}),e("div",{className:"text-indigo-100",children:"Erori"})]})]}),(d==null?void 0:d.startTime)&&t("div",{className:"mt-4 text-center text-indigo-100 text-sm",children:["Sincronizarea a început la: ",new Date(d.startTime).toLocaleTimeString("ro-RO"),d.duration&&t("span",{className:"ml-4",children:["Durată: ",Math.round(d.duration/1e3/60)," minute"]})]})]}),!i&&s.length===0&&e("div",{className:"mt-4 bg-yellow-50 dark:bg-yellow-900/20 border-2 border-yellow-200 dark:border-yellow-700 rounded-xl p-4",children:t("div",{className:"flex items-center space-x-3",children:[e(nt,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"}),t("div",{children:[e("h3",{className:"font-semibold text-yellow-800 dark:text-yellow-300",children:"Baza de date este goală"}),e("p",{className:"text-sm text-yellow-700 dark:text-yellow-400",children:'Apasă butonul "Refresh ONJN" pentru a sincroniza datele (8-10 minute, ~25,000 sloturi)'})]})]})})]}),L&&t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/30 rounded-xl",children:e(lt,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total Sloturi"}),e("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:L.total.toLocaleString("ro-RO")}),N>0&&t("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Filtru aplicat (",N," filtre)"]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e(pt,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"În exploatare"}),e("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:L.active.toLocaleString("ro-RO")})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-xl",children:e(nt,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Scos din funcțiune"}),e("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:L.inactive.toLocaleString("ro-RO")})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-xl",children:e(Me,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),t("div",{children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Suspendat"}),e("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:((R=L.byStatus.find(C=>C.status==="Suspendat"))==null?void 0:R.count)||0})]})]})})]}),e("div",{className:"card p-6",children:i?t("div",{className:"flex items-center justify-center py-12",children:[e(ht,{className:"w-8 h-8 animate-spin text-indigo-500"}),e("span",{className:"ml-2 text-slate-600",children:"Se încarcă datele..."})]}):D.length===0?t("div",{className:"text-center py-12",children:[e(_e,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:s.length===0?"Nu există date ONJN":"Nu există rezultate"}),e("p",{className:"text-slate-500 mb-4",children:s.length===0?'Apasă pe "Refresh ONJN" pentru a sincroniza datele':"Încearcă să modifici filtrele"})]}):t(De,{children:[t("div",{className:"mb-4 text-sm text-slate-600 dark:text-slate-400",children:["Afișare ",D.length," din ",s.length," înregistrări"]}),e(qe,{data:D,columns:K,searchTerm:y,moduleColor:"indigo",itemsPerPage:25})]})}),e("div",{className:"card p-6",children:t("div",{className:"space-y-4",children:[t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută după serie, adresă sau oraș...",value:y,onChange:C=>k(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[t("select",{value:A.company,onChange:C=>O({...A,company:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate companiile"}),S.map(C=>e("option",{value:C,children:C},C))]}),t("select",{value:A.brand,onChange:C=>O({...A,brand:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate brandurile"}),F.map(C=>e("option",{value:C,children:C},C))]}),t("select",{value:A.county,onChange:C=>O({...A,county:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate județele"}),I.map(C=>e("option",{value:C,children:C},C))]}),t("select",{value:A.status,onChange:C=>O({...A,status:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate statusurile"}),e("option",{value:"În exploatare",children:"În exploatare"}),e("option",{value:"Scos din funcțiune",children:"Scos din funcțiune"})]}),t("select",{value:A.license,onChange:C=>O({...A,license:C.target.value}),className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-white",children:[e("option",{value:"",children:"Toate licențele"}),x.map(C=>e("option",{value:C,children:C},C))]})]}),(y||A.company||A.brand||A.county||A.status||A.license)&&e("div",{className:"flex justify-end",children:e("button",{onClick:()=>{k(""),O({company:"",brand:"",county:"",status:"",license:""})},className:"btn-secondary text-sm",children:"Resetează filtrele"})})]})}),v.length>0&&t("div",{className:"card p-6",children:[t("div",{className:"flex items-center space-x-3 mb-6",children:[e("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-xl shadow-lg shadow-purple-500/25",children:e(it,{className:"w-5 h-5 text-white"})}),t("div",{children:[e("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Statistici per Operator"}),e("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Câte branduri, locații și sloturi pe locație pentru fiecare operator"})]})]}),e("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 max-h-[400px] overflow-y-auto",children:v.slice(0,12).map((C,z)=>t("div",{className:`bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-900 
                           rounded-xl border border-slate-200 dark:border-slate-600 p-4 hover:shadow-lg transition-all`,children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("div",{className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg flex items-center justify-center text-white font-bold text-sm",children:z+1}),e("h4",{className:"font-bold text-slate-800 dark:text-white text-sm truncate max-w-[200px]",title:C.company,children:C.company})]}),t("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[C.totalSlots," sloturi"]})]}),t("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[t("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3 text-center",children:[e("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:C.brandsCount}),e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Branduri"})]}),t("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-center",children:[e("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:C.locationsCount}),e("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Locații"})]})]}),C.slotsPerLocation.length>0&&t("div",{className:"space-y-2",children:[t("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400 flex items-center",children:[e(We,{className:"w-3 h-3 mr-1"}),"Top locații:"]}),t("div",{className:"space-y-1",children:[C.slotsPerLocation.slice(0,3).map((J,P)=>t("div",{className:"flex justify-between items-center text-xs",children:[e("span",{className:"text-slate-700 dark:text-slate-300 truncate max-w-[120px]",title:J.location,children:J.location}),t("span",{className:"font-bold text-indigo-600 dark:text-indigo-400 flex items-center",children:[e(Ks,{className:"w-3 h-3 mr-1"}),J.slots]})]},J.location)),C.slotsPerLocation.length>3&&t("div",{className:"text-xs text-slate-500 dark:text-slate-400 text-center",children:["+",C.slotsPerLocation.length-3," mai multe"]})]})]}),C.brands.length>0&&t("div",{className:"mt-3 pt-2 border-t border-slate-200 dark:border-slate-600",children:[t("div",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400 mb-1 flex items-center",children:[e(_e,{className:"w-3 h-3 mr-1"}),"Branduri:"]}),t("div",{className:"flex flex-wrap gap-1",children:[C.brands.slice(0,2).map((J,P)=>e("span",{className:`px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 
                                     text-xs rounded-full truncate max-w-[100px]`,title:J,children:J},J)),C.brands.length>2&&t("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400 text-xs rounded-full",children:["+",C.brands.length-2]})]})]})]},C.company))}),v.length>12&&e("div",{className:"mt-4 text-center",children:t("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Afișare primele 12 din ",v.length," operatori"]})})]})]})})},Yo=({brand:a,onClose:s,onSave:r})=>{const[l,n]=h.useState("url"),[i,o]=h.useState((a==null?void 0:a.brand_logo)||""),[c,u]=h.useState(null),[p,m]=h.useState((a==null?void 0:a.brand_logo)||""),[d,f]=h.useState((a==null?void 0:a.brand_name)||""),[T,b]=h.useState(!1),[y,k]=h.useState(!1),A=_=>{const E=_.target.files[0];if(E){u(E);const G=new FileReader;G.onloadend=()=>{m(G.result)},G.readAsDataURL(E)}},O=_=>{const E=_.target.value;o(E),m(E)},g=async()=>{b(!0);try{const _=`${d.toLowerCase().replace(/\s+/g,"")}.ro`,E=`https://logo.clearbit.com/${_}`,G=new Image;G.onload=()=>{o(E),m(E),U.success("Logo găsit automat!")},G.onerror=()=>{const j=`https://logo.clearbit.com/${_.replace(".ro",".com")}`,N=new Image;N.onload=()=>{o(j),m(j),U.success("Logo găsit automat!")},N.onerror=()=>{U.error("Nu s-a găsit logo automat. Încarcă manual sau adaugă URL.")},N.src=j},G.src=E}catch(_){console.error("Auto search error:",_),U.error("Eroare la căutarea automată!")}finally{b(!1)}},$=async()=>{try{k(!0);const _=new FormData;_.append("brand_name",a.brand_name),_.append("company_name",a.company_name||""),_.append("description",a.description||""),_.append("website_url",a.website_url||""),l==="upload"&&c?(_.append("logo",c),_.append("logo_source","upload")):l==="url"&&i?(_.append("logo_url",i),_.append("logo_source","url")):l==="search"&&i&&(_.append("logo_url",i),_.append("logo_source","auto-search")),(await re.post("/api/brands",_,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(U.success("Logo actualizat cu succes!"),r())}catch(_){console.error("Error saving logo:",_),U.error("Eroare la salvarea logo-ului!")}finally{k(!1)}};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(_t,{className:"w-8 h-8 text-white"})}),t("div",{children:[t("h2",{className:"text-2xl font-bold text-white",children:["Logo Brand: ",a.brand_name]}),e("p",{className:"text-indigo-100 text-sm",children:a.company_name})]})]}),e("button",{onClick:s,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"flex space-x-2 bg-slate-100 dark:bg-slate-700 rounded-xl p-1",children:[t("button",{onClick:()=>n("url"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center space-x-2 ${l==="url"?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-400 shadow":"text-slate-600 dark:text-slate-400"}`,children:[e(ra,{className:"w-4 h-4"}),e("span",{children:"URL Link"})]}),t("button",{onClick:()=>n("upload"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center space-x-2 ${l==="upload"?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-400 shadow":"text-slate-600 dark:text-slate-400"}`,children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Încarcă Fișier"})]}),t("button",{onClick:()=>n("search"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center space-x-2 ${l==="search"?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-400 shadow":"text-slate-600 dark:text-slate-400"}`,children:[e(Ge,{className:"w-4 h-4"}),e("span",{children:"Căutare Automată"})]})]}),p&&t("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6 text-center",children:[e("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:"Previzualizare Logo:"}),e("img",{src:p,alt:"Logo preview",className:"max-h-32 mx-auto object-contain",onError:_=>{_.target.style.display="none",U.error("Eroare la încărcarea imaginii!")}})]}),l==="url"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"URL Logo (ex: https://exemple.com/logo.png)"}),e("input",{type:"url",value:i,onChange:O,placeholder:"https://exemple.com/logo.png",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all`}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Copiază URL-ul direct al imaginii logo-ului"})]}),l==="upload"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Încarcă Logo (PNG, JPG, SVG, max 5MB)"}),e("input",{type:"file",accept:"image/*",onChange:A,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all
                         file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 
                         file:bg-indigo-50 file:text-indigo-600 hover:file:bg-indigo-100`}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Logo-ul va fi încărcat pe AWS S3 și va fi accesibil public"})]}),l==="search"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Caută Logo Automat"}),t("div",{className:"flex space-x-2",children:[e("input",{type:"text",value:d,onChange:_=>f(_.target.value),placeholder:"Numele brandului (ex: MAX BET, ADMIRAL)",className:`flex-1 px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                           bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                           focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all`}),e("button",{onClick:g,disabled:T||!d,className:`px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 
                           disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium
                           flex items-center space-x-2`,children:T?e("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t(De,{children:[e(Ge,{className:"w-4 h-4"}),e("span",{children:"Caută"})]})})]}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Utilizează Clearbit Logo API pentru căutare automată"})]}),t("div",{className:"flex justify-end space-x-4 pt-4 border-t-2 border-slate-200 dark:border-slate-600",children:[e("button",{onClick:s,className:`px-6 py-3 rounded-xl border-2 border-slate-300 dark:border-slate-600 
                       text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 
                       transition-all font-medium`,children:"Anulează"}),e("button",{onClick:$,disabled:y||!i&&!c,className:`px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl 
                       hover:from-indigo-600 hover:to-purple-600 transition-all shadow-lg font-medium
                       disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2`,children:y?t(De,{children:[e("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("span",{children:"Se încarcă..."})]}):t(De,{children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Salvează Logo"})]})})]})]})]})})},Xo=()=>{const{brandName:a}=It(),s=He(),r=decodeURIComponent(a),[l,n]=h.useState(null),[i,o]=h.useState([]),[c,u]=h.useState(!0),[p,m]=h.useState(!1);h.useEffect(()=>{d()},[a]);const d=async()=>{try{u(!0);const g=await re.get(`/api/brands/${encodeURIComponent(r)}`);n(g.data.brand),o(g.data.slots)}catch(g){console.error("Error loading brand data:",g),U.error("Eroare la încărcarea datelor brandului!")}finally{u(!1)}},f=()=>{m(!1),d()},T=i.length,b=i.filter(g=>g.status==="În exploatare").length,y=i.filter(g=>g.is_expired).length,k=[...new Set(i.map(g=>g.city).filter(Boolean))].length,A=[...new Set(i.map(g=>g.county).filter(Boolean))].length,O=[{key:"serial_number",label:"SERIE",sortable:!0,render:g=>t("a",{href:g.onjn_details_url,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-800 font-semibold hover:underline transition-colors flex items-center space-x-1",title:"Vezi detalii pe ONJN",children:[e("span",{children:g.serial_number}),e(Kt,{className:"w-3 h-3"})]})},{key:"equipment_type",label:"TIP",sortable:!0,render:g=>e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:g.equipment_type})},{key:"slot_address",label:"ADRESĂ",sortable:!0,render:g=>t("div",{className:"flex items-start space-x-2",children:[e(We,{className:"w-4 h-4 text-slate-400 mt-0.5 flex-shrink-0"}),t("div",{className:"text-sm",children:[e("div",{className:"text-slate-700 dark:text-slate-300",children:g.slot_address}),t("div",{className:"text-slate-500 dark:text-slate-400 text-xs",children:[g.city,", ",g.county]})]})]})},{key:"license_number",label:"LICENȚĂ",sortable:!0,render:g=>e("span",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:g.license_number})},{key:"authorization_date",label:"AUTORIZARE",sortable:!0,render:g=>g.authorization_date?t("div",{className:"flex items-center space-x-1 text-sm",children:[e(Me,{className:"w-3 h-3 text-slate-400"}),e("span",{children:new Date(g.authorization_date).toLocaleDateString("ro-RO")})]}):e("span",{className:"text-slate-400",children:"N/A"})},{key:"expiry_date",label:"EXPIRARE",sortable:!0,render:g=>{if(!g.expiry_date)return e("span",{className:"text-slate-400",children:"N/A"});const $=new Date(g.expiry_date),_=new Date;_.setHours(0,0,0,0),$.setHours(0,0,0,0);let E="text-green-600",G=$.toLocaleDateString("ro-RO");if($<_)E="text-red-600 font-bold",G+=" (Expirat)";else{const j=$.getTime()-_.getTime(),N=Math.ceil(j/(1e3*60*60*24));N<=30&&(E="text-orange-600 font-bold",G+=` (${N} zile)`)}return t("div",{className:"flex items-center space-x-1 text-sm",children:[e(Me,{className:"w-3 h-3 text-slate-400"}),e("span",{className:E,children:G})]})}},{key:"status",label:"STATUS",sortable:!0,render:g=>{const $=g.status==="În exploatare"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";return e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${$}`,children:g.status})}}];return c?e(he,{children:e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})})}):l?t(he,{children:[t("div",{className:"space-y-6",children:[t("div",{className:"card p-6",children:[e("div",{className:"flex items-center justify-between mb-6",children:t("div",{className:"flex items-center space-x-4",children:[e("button",{onClick:()=>s("/onjn-operators"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Înapoi la Operatori ONJN",children:e(et,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})}),t("div",{className:"relative group cursor-pointer",onClick:()=>m(!0),title:"Click pentru a edita logo",children:[l.brand_logo?e("img",{src:l.brand_logo,alt:l.brand_name,className:"w-20 h-20 object-contain rounded-xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-2"}):e("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center",children:e(_e,{className:"w-10 h-10 text-white"})}),e("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e(tt,{className:"w-6 h-6 text-white"})})]}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:l.brand_name}),e("p",{className:"text-lg text-slate-600 dark:text-slate-400",children:l.company_name}),l.description&&e("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:l.description}),l.website_url&&t("a",{href:l.website_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center space-x-1 mt-1",children:[e(Zs,{className:"w-3 h-3"}),e("span",{children:"Website"}),e(Kt,{className:"w-3 h-3"})]})]})]})}),t("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(At,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total Sloturi"})]}),e("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:T})]}),t("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(pt,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"În Exploatare"})]}),e("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:b})]}),t("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(Me,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Expirate"})]}),e("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:y})]}),t("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(We,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Orașe"})]}),e("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:k})]}),t("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-4",children:[t("div",{className:"flex items-center space-x-2 mb-2",children:[e(We,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Județe"})]}),e("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:A})]})]})]}),t("div",{className:"card p-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4",children:["Toate Sloturile (",T,")"]}),e(qe,{data:i,columns:O,loading:c,moduleColor:"indigo"})]})]}),p&&e(Yo,{brand:l,onClose:()=>m(!1),onSave:f})]}):e(he,{children:t("div",{className:"card p-12 text-center",children:[e("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-4",children:"Brand negăsit"}),e("button",{onClick:()=>s("/onjn-operators"),className:"btn-primary",children:"Înapoi la Operatori ONJN"})]})})},Ko=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({name:"",type:"",status:"Valid",expiry_date:"",notes:""});h.useEffect(()=>{a&&n({name:a.name||"",type:a.type||"",status:a.status||"Valid",expiry_date:a.expiry_date||"",notes:a.notes||""})},[a]);const i=c=>{const{name:u,value:p}=c.target;n(m=>({...m,[u]:p}))};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-red-800 to-rose-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/20 to-rose-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-red-500 to-rose-500 rounded-2xl shadow-lg",children:e(ur,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Document Legal":"Adaugă Document Legal Nou"}),e("p",{className:"text-red-100 text-sm font-medium",children:"Completează informațiile despre documentul legal"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:c=>{c.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Document *"}),e("input",{type:"text",name:"name",value:l.name,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Numele documentului",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Tip *"}),t("select",{name:"type",value:l.type,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e("option",{value:"",children:"Selectează tipul"}),e("option",{value:"License",children:"Licență"}),e("option",{value:"Permit",children:"Autorizație"}),e("option",{value:"Contract",children:"Contract"}),e("option",{value:"Certificate",children:"Certificat"}),e("option",{value:"Other",children:"Altele"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Data Expirării"}),e("input",{type:"date",name:"expiry_date",value:l.expiry_date,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:i,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e("option",{value:"Valid",children:"Valid"}),e("option",{value:"Expired",children:"Expirat"}),e("option",{value:"Expiring Soon",children:"Expiră în curând"}),e("option",{value:"Invalid",children:"Invalid"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:i,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(ur,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Document"]})]})]})]})})]})})},Zo=()=>{const{legalDocuments:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:i,exportToPDF:o}=ye(),[c,u]=h.useState(""),[p,m]=h.useState([]),[d,f]=h.useState(!1);h.useEffect(()=>{f(p.length>0)},[p]);const T=I=>{m(I?_.map(x=>x.id):[])},b=(I,x)=>{m(x?[...p,I]:p.filter(v=>v!==I))},y=async()=>{if(p.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${p.length} elemente?`))try{for(const I of p)await n("legalDocuments",I);m([]),f(!1)}catch(I){console.error("Error bulk deleting:",I)}},k=()=>{p.length!==0&&console.log("Bulk edit for:",p)},[A,O]=h.useState(!1),[g,$]=h.useState(null),_=a.filter(I=>{var x,v,L;return((x=I.name)==null?void 0:x.toLowerCase().includes(c.toLowerCase()))||((v=I.type)==null?void 0:v.toLowerCase().includes(c.toLowerCase()))||((L=I.status)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))}),E=[{key:"id",label:"#",sortable:!0},{key:"name",label:"NUME DOCUMENT",sortable:!0},{key:"type",label:"TIP",sortable:!0},{key:"status",label:"STATUS",sortable:!0},{key:"expiry_date",label:"DATA EXPIRARE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.expiry_date?new Date(I.expiry_date).toLocaleDateString("ro-RO"):"N/A"})},{key:"created_by",label:"CREAT DE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_by||"N/A"})},{key:"created_at",label:"DATA CREARE",sortable:!0,render:I=>e("div",{className:"text-slate-800 font-medium text-base",children:I.created_at?new Date(I.created_at).toLocaleDateString("ro-RO"):"N/A"})},{key:"actions",label:"ACȚIUNI",sortable:!1}],G=I=>{$(I),O(!0)},j=async I=>{window.confirm("Sigur vrei să ștergi acest document legal?")&&await n("legalDocuments",I)},N=()=>{$(null),O(!0)},D=async I=>{g?await l("legalDocuments",g.id,I):await r("legalDocuments",I),O(!1),$(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-gray-500 to-slate-500 rounded-2xl shadow-lg shadow-gray-500/25",children:e(ge,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Documente Legale"}),e("p",{className:"text-slate-600",children:"Gestionează documentele legale din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{i("legaldocuments")}catch(I){console.error("Error exporting to Excel:",I)}},onExportPDF:()=>{try{o("legaldocuments")}catch(I){console.error("Error exporting to PDF:",I)}},entity:"legaldocuments"}),d&&t(De,{children:[t("button",{onClick:k,className:"btn-secondary flex items-center space-x-2",children:[e(Edit,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:y,className:"btn-danger flex items-center space-x-2",children:[e(Trash2,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:N,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Document"})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută documente...",value:c,onChange:I=>u(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-500"})}):_.length===0?t("div",{className:"text-center py-12",children:[e(ge,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există documente legale"}),e("p",{className:"text-slate-500",children:"Adaugă primul document pentru a începe"})]}):e(qe,{data:_,columns:E,onEdit:G,onDelete:j,searchTerm:c,selectedItems:p,onSelectAll:T,onSelectItem:b,moduleColor:"blue"})}),A&&e(Ko,{item:g,onClose:()=>O(!1),onSave:D})]})})},Qo=({item:a,onClose:s,onSave:r})=>{const[l,n]=h.useState({username:"",full_name:"",email:"",password:"",role:"user",status:"active",notes:"",avatar:null,avatarPreview:null,permissions:Na("user")}),[i,o]=h.useState(!1);h.useEffect(()=>{a&&n({username:a.username||"",full_name:a.full_name||"",email:a.email||"",role:a.role||"user",status:a.status||"active",notes:a.notes||"",avatar:a.avatar||null,avatarPreview:a.avatar||null,permissions:a.permissions||Na(a.role||"user")})},[a]);const c=f=>{const{name:T,value:b}=f.target;n(y=>{const k={...y,[T]:b};return T==="role"&&(k.permissions=Na(b)),k})},u=(f,T)=>{n(b=>{var y;return{...b,permissions:{...b.permissions,[f]:{...b.permissions[f],[T]:!((y=b.permissions[f])!=null&&y[T])}}}})},p=(f,T)=>{const b=fa[f];n(y=>({...y,permissions:{...y.permissions,[f]:b.actions.reduce((k,A)=>(k[A]=T,k),{})}}))},m=f=>{const T=f.target.files[0];if(T){const b=new FileReader;b.onload=y=>{n(k=>({...k,avatar:y.target.result,avatarPreview:y.target.result}))},b.readAsDataURL(T)}};return e("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white/90 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl w-full max-w-4xl overflow-hidden shadow-2xl shadow-slate-500/20 border border-white/30 dark:border-slate-700/50",children:[t("div",{className:"bg-gradient-to-r from-slate-800 via-indigo-800 to-blue-800 px-8 py-6 flex justify-between items-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 to-blue-600/20"}),t("div",{className:"relative z-10 flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-blue-500 rounded-2xl shadow-lg",children:e(yt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-3xl font-bold text-white mb-1",children:a?"Editează Utilizator":"Adaugă Utilizator Nou"}),e("p",{className:"text-indigo-100 text-sm font-medium",children:"Completează informațiile despre utilizator"})]})]}),e("button",{onClick:s,className:"relative z-10 text-white hover:bg-white/20 rounded-2xl p-3 transition-all duration-200 group",children:e(ve,{size:24,className:"group-hover:rotate-90 transition-transform duration-300"})})]}),e("div",{className:"p-8 max-h-[calc(100vh-200px)] overflow-y-auto",children:t("form",{onSubmit:f=>{f.preventDefault(),r(l)},className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Username *"}),e("input",{type:"text",name:"username",value:l.username,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Username",required:!0})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Nume Complet *"}),e("input",{type:"text",name:"full_name",value:l.full_name,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Numele complet",required:!0})]}),t("div",{className:"space-y-2 md:col-span-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Avatar"}),t("div",{className:"flex items-center space-x-4",children:[l.avatarPreview?t("div",{className:"relative",children:[e("img",{src:l.avatarPreview,alt:"Avatar preview",className:"w-16 h-16 rounded-full object-cover border-2 border-slate-300"}),e("button",{type:"button",onClick:()=>n(f=>({...f,avatar:null,avatarPreview:null})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]}):e("div",{className:"w-16 h-16 rounded-full bg-slate-200 flex items-center justify-center",children:e(yt,{className:"w-8 h-8 text-slate-400"})}),t("div",{className:"flex-1",children:[e("input",{type:"file",accept:"image/*",onChange:m,className:"hidden",id:"avatar-upload"}),t("label",{htmlFor:"avatar-upload",className:"inline-flex items-center px-4 py-2 border border-slate-300 rounded-lg cursor-pointer hover:bg-slate-50 transition-colors",children:[e(ze,{className:"w-4 h-4 mr-2"}),l.avatarPreview?"Schimbă Avatar":"Upload Avatar"]}),e("p",{className:"text-xs text-slate-500 mt-1",children:"JPG, PNG sau GIF (max 2MB)"})]})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Email *"}),e("input",{type:"email",name:"email",value:l.email,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Adresa de email",required:!0})]}),t("div",{className:"space-y-2",children:[t("label",{className:"block text-sm font-semibold text-slate-700",children:["Parolă ",!a&&"*"]}),e("input",{type:"password",name:"password",value:l.password,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:a?"Lasă gol pentru a păstra parola actuală":"Minim 6 caractere",required:!a,minLength:a?void 0:6})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Rol *"}),t("select",{name:"role",value:l.role,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",required:!0,children:[e("option",{value:"admin",children:"Administrator"}),e("option",{value:"manager",children:"Manager"}),e("option",{value:"user",children:"Utilizator"}),e("option",{value:"marketing",children:"Marketing"}),e("option",{value:"operational",children:"Operational"}),e("option",{value:"financiar",children:"Financiar"})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Status *"}),t("select",{name:"status",value:l.status,onChange:c,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",required:!0,children:[e("option",{value:"active",children:"Activ"}),e("option",{value:"inactive",children:"Inactiv"}),e("option",{value:"suspended",children:"Suspendat"})]})]})]}),t("div",{className:"space-y-3 border-t border-slate-200 pt-6",children:[t("div",{className:"flex items-center justify-between",children:[t("label",{className:"block text-sm font-semibold text-slate-700 flex items-center space-x-2",children:[e(ya,{className:"w-5 h-5 text-indigo-600"}),e("span",{children:"Permisiuni Detaliate"})]}),t("button",{type:"button",onClick:()=>o(!i),className:"flex items-center space-x-2 px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:[e("span",{children:i?"Ascunde":"Arată"}),i?e(Qs,{className:"w-4 h-4"}):e(el,{className:"w-4 h-4"})]})]}),i&&t("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4 space-y-4 max-h-96 overflow-y-auto",children:[e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:"Bifează permisiunile pentru fiecare modul. Permisiunile se actualizează automat când schimbi rolul."}),e("div",{className:"grid grid-cols-1 gap-4",children:Object.keys(fa).map(f=>{const T=fa[f],b=l.permissions[f]||{};return T.actions.every(y=>b[y]),T.actions.some(y=>b[y]),t("div",{className:"bg-white dark:bg-slate-700 rounded-lg p-3 border border-slate-200 dark:border-slate-600",children:[t("div",{className:"flex items-center justify-between mb-2",children:[e("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200",children:T.label}),t("div",{className:"flex space-x-2",children:[e("button",{type:"button",onClick:()=>p(f,!0),className:"text-xs px-2 py-1 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Selectează toate",children:"Toate"}),e("button",{type:"button",onClick:()=>p(f,!1),className:"text-xs px-2 py-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Deselectează toate",children:"Niciuna"})]})]}),e("div",{className:"flex flex-wrap gap-2",children:T.actions.map(y=>t("label",{className:"flex items-center space-x-2 px-3 py-1.5 bg-slate-50 dark:bg-slate-600 rounded-lg cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-500 transition-colors",children:[e("input",{type:"checkbox",checked:b[y]||!1,onChange:()=>u(f,y),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),e("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-200",children:Ii[y]})]},y))})]},f)})})]})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e("textarea",{name:"notes",value:l.notes,onChange:c,rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent",placeholder:"Note adiționale"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t border-slate-200",children:[e("button",{type:"button",onClick:s,className:"btn-secondary",children:"Anulează"}),t("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e(yt,{className:"w-4 h-4"}),t("span",{children:[a?"Actualizează":"Creează"," Utilizator"]})]})]})]})})]})})},ec=()=>{const{users:a,loading:s,createItem:r,updateItem:l,deleteItem:n,exportToExcel:i,exportToPDF:o}=ye(),{user:c}=Ot(),[u,p]=h.useState(""),[m,d]=h.useState([]),[f,T]=h.useState(!1),[b,y]=h.useState(!1),[k,A]=h.useState(null);h.useEffect(()=>{T(m.length>0)},[m]);const O=x=>{d(x?E.map(v=>v.id):[])},g=(x,v)=>{d(v?[...m,x]:m.filter(L=>L!==x))},$=async()=>{if(m.length!==0&&window.confirm(`Ești sigur că vrei să ștergi ${m.length} utilizatori?`))try{for(const x of m)await n("users",x);d([]),T(!1)}catch(x){console.error("Error bulk deleting users:",x)}},_=()=>{m.length!==0&&console.log("Bulk edit for users:",m)},E=a.filter(x=>{var v,L,K,R;return((v=x.username)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))||((L=x.full_name)==null?void 0:L.toLowerCase().includes(u.toLowerCase()))||((K=x.email)==null?void 0:K.toLowerCase().includes(u.toLowerCase()))||((R=x.role)==null?void 0:R.toLowerCase().includes(u.toLowerCase()))}),G=[{key:"full_name",label:"NUME COMPLET",sortable:!0,render:x=>t("div",{className:"flex items-center space-x-3",children:[e("div",{className:"flex-shrink-0",children:x.avatar?e("img",{src:x.avatar,alt:x.full_name||x.username,className:"w-10 h-10 rounded-full object-cover border-2 border-slate-200"}):e("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-semibold text-sm",children:(x.full_name||x.username||"U").charAt(0).toUpperCase()})}),t("div",{className:"min-w-0 flex-1",children:[e("p",{className:"text-sm font-medium text-slate-900 truncate",children:x.full_name||"N/A"}),t("p",{className:"text-sm text-slate-500 truncate",children:["@",x.username]})]})]})},{key:"email",label:"EMAIL",sortable:!0},{key:"role",label:"ROL",sortable:!0},{key:"created_info",label:"CREAT DE / DATA CREARE",sortable:!0,render:x=>t("div",{className:"text-slate-800 font-medium text-base",children:[e("div",{children:x.created_by||"N/A"}),e("div",{className:"text-sm text-slate-500",children:x.created_at?new Date(x.created_at).toLocaleDateString("ro-RO"):"N/A"})]})}],j=x=>{A(x),y(!0)},N=async x=>{if(window.confirm("Sigur vrei să ștergi acest utilizator?"))try{(await n("users",x.id)).success||ke.error("Eroare la ștergerea utilizatorului")}catch(L){console.error("Error deleting user:",L),ke.error("Eroare la ștergerea utilizatorului")}},D=()=>{A(null),y(!0)},S=async x=>{if(k)await l("users",k.id,x);else{const v={...x,created_by:(c==null?void 0:c.fullName)||(c==null?void 0:c.username)||"System"};await r("users",v)}y(!1),A(null)};return e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-violet-500 rounded-2xl shadow-lg shadow-purple-500/25",children:e(bt,{className:"w-6 h-6 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-slate-800",children:"Management Utilizatori"}),e("p",{className:"text-slate-600",children:"Gestionează utilizatorii din sistem"})]})]}),t("div",{className:"flex items-center space-x-3",children:[e(ft,{onExportExcel:()=>{try{i("users")}catch(x){console.error("Error exporting to Excel:",x)}},onExportPDF:()=>{try{o("users")}catch(x){console.error("Error exporting to PDF:",x)}},entity:"users"}),t("div",{className:"flex space-x-3",children:[f&&t(De,{children:[t("button",{onClick:_,className:"btn-secondary flex items-center space-x-2",children:[e(tt,{className:"w-4 h-4"}),e("span",{children:"Bulk Edit"})]}),t("button",{onClick:$,className:"btn-danger flex items-center space-x-2",children:[e(Fe,{className:"w-4 h-4"}),e("span",{children:"Bulk Delete"})]})]}),t("button",{onClick:D,className:"btn-primary flex items-center space-x-2",children:[e(Ie,{className:"w-4 h-4"}),e("span",{children:"Adaugă Utilizator"})]})]})]})]})}),e("div",{className:"card p-6",children:t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex-1 relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),e("input",{type:"text",placeholder:"Caută utilizatori...",value:u,onChange:x=>p(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),t("button",{className:"btn-secondary flex items-center space-x-2",children:[e(ze,{className:"w-4 h-4"}),e("span",{children:"Importă"})]})]})}),e("div",{className:"card p-6",children:s?e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):E.length===0?t("div",{className:"text-center py-12",children:[e(bt,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"Nu există utilizatori"}),e("p",{className:"text-slate-500",children:"Adaugă primul utilizator pentru a începe"})]}):e(qe,{data:E,columns:G,onEdit:j,onDelete:N,searchTerm:u,selectedItems:m,onSelectAll:O,onSelectItem:g,moduleColor:"blue"})}),b&&e(Qo,{item:k,onClose:()=>y(!1),onSave:S})]})})},tc=()=>{var G,j,N,D,S,F,I,x,v,L,K,R,C,z,J,P,Z,se,oe,de,Se,Oe,Ue,Ze,$e,rt,Be,Ye,Q,ce,ue,pe,Te,ee,me,fe,ne,le,be,te,ie,Ce,Pe,Ae,B,M,w,V,Y,we,Le,Ve,je,st,Dt,Jt;const[a,s]=h.useState("header"),[r,l]=h.useState({logo:{type:"upload",url:"",file:null},favicon:{type:"upload",url:"",file:null},headerColor:{primary:"#2563eb",secondary:"#4f46e5",useGradient:!0},background:{type:"color",color:"#f1f5f9",imageUrl:"",imageFile:null},loginImage:{type:"upload",url:"",file:null},loginButtonColor:{primary:"#FF7A00",secondary:"#FF9500",useGradient:!1},loginPageColor:{primary:"#FFFFFF",secondary:"#F5F5F5",useGradient:!1},loginCardColor:{primary:"#8B5CF6",secondary:"#A855F7",useGradient:!0},loginTextColor:{title:"#1e293b",labels:"#334155",text:"#64748b"},appTitle:"CASHPOT V7",appSubtitle:"Gaming Management System",loginTexts:{title:"Login",emailLabel:"Email",passwordLabel:"Password",buttonText:"Log In",forgotPassword:"Forgot Password?",termsText:"By clicking login you agree to the terms of the Club Membership Agreement and the Independent Partner Agreement",joinText:"Got an invitation? Join Now",supportText:"Need help? Contact us at login-support@in.group"}});h.useEffect(()=>{n()},[]);const n=async()=>{try{const xe=await re.get("/api/auth/verify");if(xe.data.success&&xe.data.user){const Xe=xe.data.user.preferences||{};if(Xe.appSettings){l(Xe.appSettings),console.log("✅ Loaded app settings from server");return}}}catch{console.log("⚠️ Could not load settings from server")}const W=sessionStorage.getItem("appSettings");if(W)try{const xe=JSON.parse(W);l(xe),console.log("📱 Loaded app settings from sessionStorage")}catch(xe){console.error("Error parsing sessionStorage settings:",xe)}},i=W=>{l({...r,logo:{...r.logo,type:W}})},o=W=>{l({...r,logo:{...r.logo,url:W}})},c=W=>{const xe=W.target.files[0];if(xe){const Xe=new FileReader;Xe.onloadend=()=>{l({...r,logo:{...r.logo,file:Xe.result}})},Xe.readAsDataURL(xe)}},u=W=>{l({...r,favicon:{...r.favicon,type:W}})},p=W=>{l({...r,favicon:{...r.favicon,url:W}})},m=W=>{const xe=W.target.files[0];if(xe){const Xe=new FileReader;Xe.onloadend=()=>{l({...r,favicon:{...r.favicon,file:Xe.result}});const ir=document.querySelector("link[rel~='icon']");ir&&(ir.href=Xe.result)},Xe.readAsDataURL(xe)}},d=(W,xe)=>{l({...r,headerColor:{...r.headerColor,[W]:xe}})},f=W=>{l({...r,background:{...r.background,type:W}})},T=W=>{l({...r,background:{...r.background,color:W}}),document.body.style.backgroundColor=W},b=W=>{l({...r,background:{...r.background,imageUrl:W}})},y=W=>{const xe=W.target.files[0];if(xe){const Xe=new FileReader;Xe.onloadend=()=>{l({...r,background:{...r.background,imageFile:Xe.result}}),document.body.style.backgroundImage=`url(${Xe.result})`,document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center",document.body.style.backgroundAttachment="fixed"},Xe.readAsDataURL(xe)}},k=W=>{l({...r,loginImage:{...r.loginImage,type:W}})},A=W=>{l({...r,loginImage:{...r.loginImage,url:W}})},O=W=>{const xe=W.target.files[0];if(xe){const Xe=new FileReader;Xe.onloadend=()=>{l({...r,loginImage:{...r.loginImage,file:Xe.result}})},Xe.readAsDataURL(xe)}},g=(W,xe)=>{l({...r,loginButtonColor:{...r.loginButtonColor,[W]:xe}})},$=async()=>{sessionStorage.setItem("appSettings",JSON.stringify(r));try{const W=await re.get("/api/auth/verify");W.data.success&&W.data.user&&(await re.put(`/api/users/${W.data.user.id}/preferences`,{preferences:{appSettings:r}}),console.log("✅ App settings saved to server"))}catch(W){console.error("❌ Error saving to server:",W)}if(r.favicon.file){const W=document.querySelector("link[rel~='icon']");if(W)W.href=r.favicon.file;else{const xe=document.createElement("link");xe.rel="icon",xe.type="image/x-icon",xe.href=r.favicon.file,document.head.appendChild(xe)}}E(),alert("Setările au fost salvate cu succes!")},_=async()=>{if(window.confirm("Sigur doriți să resetați toate setările la valorile implicite?")){const W={logo:{type:"upload",url:"",file:null},favicon:{type:"upload",url:"",file:null},headerColor:{primary:"#2563eb",secondary:"#4f46e5",useGradient:!0},background:{type:"color",color:"#f1f5f9",imageUrl:"",imageFile:null},loginImage:{type:"upload",url:"",file:null},loginButtonColor:{primary:"#FF7A00",secondary:"#FF9500",useGradient:!1},loginPageColor:{primary:"#FFFFFF",secondary:"#F5F5F5",useGradient:!1},loginCardColor:{primary:"#8B5CF6",secondary:"#A855F7",useGradient:!0},loginTextColor:{title:"#1e293b",labels:"#334155",text:"#64748b"},appTitle:"CASHPOT V7",appSubtitle:"Gaming Management System",loginTexts:{title:"Login",emailLabel:"Email",passwordLabel:"Password",buttonText:"Log In",forgotPassword:"Forgot Password?",termsText:"By clicking login you agree to the terms of the Club Membership Agreement and the Independent Partner Agreement",joinText:"Got an invitation? Join Now",supportText:"Need help? Contact us at login-support@in.group"}};l(W);try{const xe=await re.get("/api/auth/verify");xe.data.success&&xe.data.user&&(await re.put(`/api/users/${xe.data.user.id}/preferences`,{preferences:{appSettings:W}}),console.log("✅ Reset settings saved to server"))}catch(xe){console.error("❌ Error saving reset settings to server:",xe)}document.body.style.backgroundColor="#f1f5f9",document.body.style.backgroundImage="none",alert("Setările au fost resetate!")}},E=()=>{if(r.headerColor.useGradient){const xe=document.querySelector("header");xe&&(xe.style.background=`linear-gradient(to right, ${r.headerColor.primary}, ${r.headerColor.secondary})`)}else{const xe=document.querySelector("header");xe&&(xe.style.background=r.headerColor.primary)}if(r.background.type==="color")document.body.style.backgroundColor=r.background.color,document.body.style.backgroundImage="none";else if(r.background.type==="image"){const xe=r.background.imageFile||r.background.imageUrl;xe&&(document.body.style.backgroundImage=`url(${xe})`,document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center",document.body.style.backgroundAttachment="fixed")}const W=r.favicon.file||r.favicon.url;if(W){const xe=document.querySelector("link[rel~='icon']");xe&&(xe.href=W)}};return h.useEffect(()=>{E()},[r]),e(he,{children:t("div",{className:"space-y-6",children:[e("div",{className:"card p-6",children:t("div",{className:"flex space-x-1 bg-slate-100 rounded-xl p-1",children:[e("button",{onClick:()=>s("header"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="header"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(tl,{size:20}),e("span",{children:"Header"})]})}),e("button",{onClick:()=>s("main"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="main"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(Ur,{size:20}),e("span",{children:"Pagina Principală"})]})}),e("button",{onClick:()=>s("login"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="login"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(al,{size:20}),e("span",{children:"Login Page"})]})}),e("button",{onClick:()=>s("backup"),className:`flex-1 py-3 px-6 rounded-lg font-bold transition-all duration-200 ${a==="backup"?"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:t("div",{className:"flex items-center justify-center space-x-2",children:[e(ot,{size:20}),e("span",{children:"Backup BD"})]})})]})}),a==="header"&&e("div",{className:"space-y-6",children:t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(_t,{className:"w-5 h-5 text-blue-600"}),e("span",{children:"Logo Aplicație"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-4",children:[t("button",{onClick:()=>i("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.logo.type==="upload"?"bg-blue-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ze,{className:"w-4 h-4 inline mr-2"}),"Upload"]}),t("button",{onClick:()=>i("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.logo.type==="link"?"bg-blue-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ra,{className:"w-4 h-4 inline mr-2"}),"Link"]})]}),r.logo.type==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Logo"}),e("input",{type:"file",accept:"image/*",onChange:c,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900/30 dark:file:text-blue-300 dark:hover:file:bg-blue-800/40"}),r.logo.file&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.logo.file,alt:"Logo Preview",className:"h-16 object-contain"})})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Logo"}),e("input",{type:"text",value:r.logo.url,onChange:W=>o(W.target.value),className:"input-field",placeholder:"https://example.com/logo.png"}),r.logo.url&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.logo.url,alt:"Logo Preview",className:"h-16 object-contain"})})]})]})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-purple-600"}),e("span",{children:"Culoare Header"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"gradientToggle",checked:r.headerColor.useGradient,onChange:W=>d("useGradient",W.target.checked),className:"form-checkbox rounded text-purple-600"}),e("label",{htmlFor:"gradientToggle",className:"text-sm font-semibold text-slate-700",children:"Folosește Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:r.headerColor.primary,onChange:W=>d("primary",W.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:r.headerColor.primary,onChange:W=>d("primary",W.target.value),className:"input-field flex-1",placeholder:"#2563eb"})]})]}),r.headerColor.useGradient&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:r.headerColor.secondary,onChange:W=>d("secondary",W.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:r.headerColor.secondary,onChange:W=>d("secondary",W.target.value),className:"input-field flex-1",placeholder:"#4f46e5"})]})]}),e("div",{className:"p-4 rounded-lg",style:{background:r.headerColor.useGradient?`linear-gradient(to right, ${r.headerColor.primary}, ${r.headerColor.secondary})`:r.headerColor.primary},children:e("p",{className:"text-white font-bold text-center",children:"Preview Header"})})]})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-teal-600"}),e("span",{children:"Texte Header"})]}),e("div",{className:"space-y-4",children:t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Titlu Aplicație"}),e("input",{type:"text",value:r.appTitle,onChange:W=>l({...r,appTitle:W.target.value}),className:"input-field",placeholder:"CASHPOT V7"}),e("p",{className:"text-xs text-slate-500",children:"Textul afișat în header"})]})})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(_t,{className:"w-5 h-5 text-green-600"}),e("span",{children:"Favicon"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-4",children:[t("button",{onClick:()=>u("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.favicon.type==="upload"?"bg-green-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ze,{className:"w-4 h-4 inline mr-2"}),"Upload"]}),t("button",{onClick:()=>u("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${r.favicon.type==="link"?"bg-green-500 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e(ra,{className:"w-4 h-4 inline mr-2"}),"Link"]})]}),r.favicon.type==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Favicon"}),e("input",{type:"file",accept:"image/*,.ico",onChange:m,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100 dark:file:bg-green-900/30 dark:file:text-green-300 dark:hover:file:bg-green-800/40"}),r.favicon.file&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.favicon.file,alt:"Favicon Preview",className:"h-8 w-8 object-contain"})})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Favicon"}),e("input",{type:"text",value:r.favicon.url,onChange:W=>p(W.target.value),className:"input-field",placeholder:"https://example.com/favicon.ico"}),r.favicon.url&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.favicon.url,alt:"Favicon Preview",className:"h-8 w-8 object-contain"})})]})]})]})]})}),a==="main"&&e("div",{className:"space-y-6",children:t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(_t,{className:"w-5 h-5 text-orange-600"}),e("span",{children:"Fundal Pagină"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>f("color"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${r.background.type==="color"?"bg-orange-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Culoare"}),e("button",{onClick:()=>f("image"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${r.background.type==="image"?"bg-orange-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Imagine"})]}),r.background.type==="color"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Fundal"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:r.background.color,onChange:W=>T(W.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:r.background.color,onChange:W=>T(W.target.value),className:"input-field flex-1",placeholder:"#f1f5f9"})]})]}):t("div",{className:"space-y-4",children:[t("div",{className:"flex space-x-4",children:[t("button",{onClick:()=>l({...r,background:{...r.background,imageType:"upload"}}),className:"flex-1 py-2 px-3 text-sm rounded-lg bg-slate-100 hover:bg-slate-200 font-semibold",children:[e(ze,{className:"w-4 h-4 inline mr-1"}),"Upload"]}),t("button",{onClick:()=>l({...r,background:{...r.background,imageType:"link"}}),className:"flex-1 py-2 px-3 text-sm rounded-lg bg-slate-100 hover:bg-slate-200 font-semibold",children:[e(ra,{className:"w-4 h-4 inline mr-1"}),"Link"]})]}),r.background.imageType==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Imagine"}),e("input",{type:"file",accept:"image/*",onChange:y,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100 dark:file:bg-orange-900/30 dark:file:text-orange-300 dark:hover:file:bg-orange-800/40"})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Imagine"}),e("input",{type:"text",value:r.background.imageUrl,onChange:W=>b(W.target.value),className:"input-field",placeholder:"https://example.com/background.jpg"})]})]})]})]})}),a==="login"&&t("div",{className:"space-y-6",children:[t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-teal-600"}),e("span",{children:"Texte Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Titlu Login"}),e("input",{type:"text",value:((G=r.loginTexts)==null?void 0:G.title)||"Login",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},title:W.target.value}}),className:"input-field",placeholder:"Login"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Etichetă Email"}),e("input",{type:"text",value:((j=r.loginTexts)==null?void 0:j.emailLabel)||"Email",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},emailLabel:W.target.value}}),className:"input-field",placeholder:"Email"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Etichetă Parolă"}),e("input",{type:"text",value:((N=r.loginTexts)==null?void 0:N.passwordLabel)||"Password",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},passwordLabel:W.target.value}}),className:"input-field",placeholder:"Password"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Text Buton"}),e("input",{type:"text",value:((D=r.loginTexts)==null?void 0:D.buttonText)||"Log In",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},buttonText:W.target.value}}),className:"input-field",placeholder:"Log In"})]}),t("div",{className:"space-y-2 lg:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:'Text "Forgot Password"'}),e("input",{type:"text",value:((S=r.loginTexts)==null?void 0:S.forgotPassword)||"Forgot Password?",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},forgotPassword:W.target.value}}),className:"input-field",placeholder:"Forgot Password?"})]}),t("div",{className:"space-y-2 lg:col-span-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Text Termeni"}),e("textarea",{value:((F=r.loginTexts)==null?void 0:F.termsText)||"",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},termsText:W.target.value}}),className:"input-field min-h-[60px] resize-none",placeholder:"By clicking login you agree to the terms..."})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:'Text "Join Now"'}),e("input",{type:"text",value:((I=r.loginTexts)==null?void 0:I.joinText)||"Got an invitation? Join Now",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},joinText:W.target.value}}),className:"input-field",placeholder:"Got an invitation? Join Now"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"block text-sm font-bold text-slate-700",children:"Text Support"}),e("input",{type:"text",value:((x=r.loginTexts)==null?void 0:x.supportText)||"Need help? Contact us at...",onChange:W=>l({...r,loginTexts:{...r.loginTexts||{},supportText:W.target.value}}),className:"input-field",placeholder:"Need help? Contact us at..."})]})]})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-pink-600"}),e("span",{children:"Culori Text Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Titlu"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((v=r.loginTextColor)==null?void 0:v.title)||"#1e293b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},title:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((L=r.loginTextColor)==null?void 0:L.title)||"#1e293b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},title:W.target.value}}),className:"input-field flex-1",placeholder:"#1e293b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-bold text-2xl text-center",style:{color:((K=r.loginTextColor)==null?void 0:K.title)||"#1e293b"},children:"Login"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Etichete"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((R=r.loginTextColor)==null?void 0:R.labels)||"#334155",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((C=r.loginTextColor)==null?void 0:C.labels)||"#334155",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:W.target.value}}),className:"input-field flex-1",placeholder:"#334155"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-semibold text-sm",style:{color:((z=r.loginTextColor)==null?void 0:z.labels)||"#334155"},children:"Email *"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Text Secundar"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((J=r.loginTextColor)==null?void 0:J.text)||"#64748b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},text:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((P=r.loginTextColor)==null?void 0:P.text)||"#64748b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},text:W.target.value}}),className:"input-field flex-1",placeholder:"#64748b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"text-xs text-center",style:{color:((Z=r.loginTextColor)==null?void 0:Z.text)||"#64748b"},children:"Terms & Support"})})]})]})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-indigo-600"}),e("span",{children:"Culori Fundal Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Fundal Formular"}),t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"loginPageGradient",checked:((se=r.loginPageColor)==null?void 0:se.useGradient)||!1,onChange:W=>l({...r,loginPageColor:{...r.loginPageColor,useGradient:W.target.checked}}),className:"form-checkbox rounded text-indigo-600"}),e("label",{htmlFor:"loginPageGradient",className:"text-sm font-semibold text-slate-700",children:"Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((oe=r.loginPageColor)==null?void 0:oe.primary)||"#FFFFFF",onChange:W=>l({...r,loginPageColor:{...r.loginPageColor,primary:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((de=r.loginPageColor)==null?void 0:de.primary)||"#FFFFFF",onChange:W=>l({...r,loginPageColor:{...r.loginPageColor,primary:W.target.value}}),className:"input-field flex-1"})]})]}),((Se=r.loginPageColor)==null?void 0:Se.useGradient)&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((Oe=r.loginPageColor)==null?void 0:Oe.secondary)||"#F5F5F5",onChange:W=>l({...r,loginPageColor:{...r.loginPageColor,secondary:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Ue=r.loginPageColor)==null?void 0:Ue.secondary)||"#F5F5F5",onChange:W=>l({...r,loginPageColor:{...r.loginPageColor,secondary:W.target.value}}),className:"input-field flex-1"})]})]}),e("div",{className:"p-4 rounded-lg",style:{background:(Ze=r.loginPageColor)!=null&&Ze.useGradient?`linear-gradient(to right, ${r.loginPageColor.primary}, ${r.loginPageColor.secondary})`:(($e=r.loginPageColor)==null?void 0:$e.primary)||"#FFFFFF"},children:e("p",{className:"text-slate-800 font-bold text-center",children:"Preview Fundal"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Card Sub Logo"}),t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"loginCardGradient",checked:((rt=r.loginCardColor)==null?void 0:rt.useGradient)||!1,onChange:W=>l({...r,loginCardColor:{...r.loginCardColor,useGradient:W.target.checked}}),className:"form-checkbox rounded text-purple-600"}),e("label",{htmlFor:"loginCardGradient",className:"text-sm font-semibold text-slate-700",children:"Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((Be=r.loginCardColor)==null?void 0:Be.primary)||"#8B5CF6",onChange:W=>l({...r,loginCardColor:{...r.loginCardColor,primary:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Ye=r.loginCardColor)==null?void 0:Ye.primary)||"#8B5CF6",onChange:W=>l({...r,loginCardColor:{...r.loginCardColor,primary:W.target.value}}),className:"input-field flex-1",placeholder:"#8B5CF6"})]})]}),((Q=r.loginCardColor)==null?void 0:Q.useGradient)&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((ce=r.loginCardColor)==null?void 0:ce.secondary)||"#A855F7",onChange:W=>l({...r,loginCardColor:{...r.loginCardColor,secondary:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((ue=r.loginCardColor)==null?void 0:ue.secondary)||"#A855F7",onChange:W=>l({...r,loginCardColor:{...r.loginCardColor,secondary:W.target.value}}),className:"input-field flex-1",placeholder:"#A855F7"})]})]}),e("div",{className:"rounded-2xl shadow-2xl p-8",style:{background:(pe=r.loginCardColor)!=null&&pe.useGradient?`linear-gradient(to right, ${r.loginCardColor.primary}, ${r.loginCardColor.secondary})`:((Te=r.loginCardColor)==null?void 0:Te.primary)||"#8B5CF6"},children:e("p",{className:"text-white font-bold text-2xl text-center",children:"Login"})})]})]})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-orange-600"}),e("span",{children:"Culoare Buton Login"})]}),e("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Buton"}),t("div",{className:"flex items-center space-x-2",children:[e("input",{type:"checkbox",id:"loginButtonGradient",checked:((ee=r.loginButtonColor)==null?void 0:ee.useGradient)||!1,onChange:W=>g("useGradient",W.target.checked),className:"form-checkbox rounded text-indigo-600"}),e("label",{htmlFor:"loginButtonGradient",className:"text-sm font-semibold text-slate-700",children:"Gradient"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Primară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((me=r.loginButtonColor)==null?void 0:me.primary)||"#FF7A00",onChange:W=>g("primary",W.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((fe=r.loginButtonColor)==null?void 0:fe.primary)||"#FF7A00",onChange:W=>g("primary",W.target.value),className:"input-field flex-1"})]})]}),((ne=r.loginButtonColor)==null?void 0:ne.useGradient)&&t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Culoare Secundară"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((le=r.loginButtonColor)==null?void 0:le.secondary)||"#FF9500",onChange:W=>g("secondary",W.target.value),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((be=r.loginButtonColor)==null?void 0:be.secondary)||"#FF9500",onChange:W=>g("secondary",W.target.value),className:"input-field flex-1"})]})]}),e("div",{className:"p-4 rounded-lg",style:{background:(te=r.loginButtonColor)!=null&&te.useGradient?`linear-gradient(to right, ${r.loginButtonColor.primary}, ${r.loginButtonColor.secondary})`:((ie=r.loginButtonColor)==null?void 0:ie.primary)||"#FF7A00"},children:e("p",{className:"text-white font-bold text-center",children:"Preview Button"})})]})})]}),t("div",{className:"card p-6 space-y-6",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(Ft,{className:"w-5 h-5 text-pink-600"}),e("span",{children:"Culori Text Login"})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Titlu"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((Ce=r.loginTextColor)==null?void 0:Ce.title)||"#1e293b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},title:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Pe=r.loginTextColor)==null?void 0:Pe.title)||"#1e293b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},title:W.target.value}}),className:"input-field flex-1",placeholder:"#1e293b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-bold text-2xl text-center",style:{color:((Ae=r.loginTextColor)==null?void 0:Ae.title)||"#1e293b"},children:"Login"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Culoare Etichete"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((B=r.loginTextColor)==null?void 0:B.labels)||"#334155",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((M=r.loginTextColor)==null?void 0:M.labels)||"#334155",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},labels:W.target.value}}),className:"input-field flex-1",placeholder:"#334155"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"font-semibold text-sm text-center",style:{color:((w=r.loginTextColor)==null?void 0:w.labels)||"#334155"},children:"Email *"})})]}),t("div",{className:"space-y-4",children:[e("h4",{className:"font-bold text-slate-700",children:"Text Secundar"}),t("div",{className:"flex items-center space-x-3",children:[e("input",{type:"color",value:((V=r.loginTextColor)==null?void 0:V.text)||"#64748b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},text:W.target.value}}),className:"h-12 w-20 rounded-lg border-2 border-slate-200 cursor-pointer"}),e("input",{type:"text",value:((Y=r.loginTextColor)==null?void 0:Y.text)||"#64748b",onChange:W=>l({...r,loginTextColor:{...r.loginTextColor||{},text:W.target.value}}),className:"input-field flex-1",placeholder:"#64748b"})]}),e("div",{className:"p-4 rounded-lg bg-slate-50",children:e("p",{className:"text-xs text-center",style:{color:((we=r.loginTextColor)==null?void 0:we.text)||"#64748b"},children:"Terms"})})]})]})]}),t("div",{className:"card p-6 space-y-4",children:[t("h3",{className:"text-xl font-bold text-slate-800 flex items-center space-x-2 border-b border-slate-200 pb-4",children:[e(_t,{className:"w-5 h-5 text-indigo-600"}),e("span",{children:"Imagine Fundal Login"})]}),t("div",{className:"flex space-x-4 mb-4",children:[t("button",{onClick:()=>k("upload"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${((Le=r.loginImage)==null?void 0:Le.type)==="upload"?"bg-indigo-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e(ze,{className:"w-4 h-4 inline mr-2"}),"Upload"]}),t("button",{onClick:()=>k("link"),className:`flex-1 py-2 px-4 rounded-lg font-semibold transition-all ${((Ve=r.loginImage)==null?void 0:Ve.type)==="link"?"bg-indigo-500 text-white shadow-lg":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[e(ra,{className:"w-4 h-4 inline mr-2"}),"Link"]})]}),((je=r.loginImage)==null?void 0:je.type)==="upload"?t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Încarcă Imagine"}),e("input",{type:"file",accept:"image/*",onChange:O,className:"input-field file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 dark:file:bg-indigo-900/30 dark:file:text-indigo-300 dark:hover:file:bg-indigo-800/40"}),((st=r.loginImage)==null?void 0:st.file)&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.loginImage.file,alt:"Login Preview",className:"h-32 w-full object-cover rounded"})})]}):t("div",{children:[e("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"URL Imagine"}),e("input",{type:"text",value:((Dt=r.loginImage)==null?void 0:Dt.url)||"",onChange:W=>A(W.target.value),className:"input-field",placeholder:"https://example.com/login-bg.jpg"}),((Jt=r.loginImage)==null?void 0:Jt.url)&&e("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e("img",{src:r.loginImage.url,alt:"Login Preview",className:"h-32 w-full object-cover rounded"})})]})]})]}),a==="backup"&&e(Oi,{compact:!1}),a!=="backup"&&e("div",{className:"card p-6",children:t("div",{className:"flex justify-end space-x-4",children:[t("button",{onClick:_,className:"btn-secondary flex items-center space-x-2",children:[e(ht,{size:18}),e("span",{children:"Resetează"})]}),t("button",{onClick:$,className:"btn-primary flex items-center space-x-2",children:[e(qt,{size:18}),e("span",{children:"Salvează Setări"})]})]})})]})})},ac=({task:a,users:s,onSubmit:r,onClose:l})=>{const n=()=>new Date().toISOString().split("T")[0],[i,o]=h.useState({title:"",description:"",priority:"medium",assigned_to:[],due_date:n()});h.useEffect(()=>{o(a?{title:a.title||"",description:a.description||"",priority:a.priority||"medium",assigned_to:a.assigned_users?a.assigned_users.map(m=>m.id):[],due_date:a.due_date?new Date(a.due_date).toISOString().split("T")[0]:n()}:{title:"",description:"",priority:"medium",assigned_to:[],due_date:n()})},[a]);const c=m=>{m.preventDefault(),r(i)},u=m=>{const{name:d,value:f}=m.target;o(T=>({...T,[d]:f}))},p=m=>{const d=Array.from(m.target.selectedOptions,f=>parseInt(f.value));o(f=>({...f,assigned_to:d}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-6 rounded-t-2xl",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"p-3 bg-white bg-opacity-20 rounded-2xl backdrop-blur-sm",children:e(zt,{className:"w-8 h-8 text-white"})}),t("div",{children:[e("h2",{className:"text-2xl font-bold text-white",children:a?"Editează sarcina":"Sarcină nouă"}),e("p",{className:"text-blue-100 text-sm",children:"Gestionare sarcini echipă"})]})]}),e("button",{onClick:l,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all",children:e(ve,{className:"w-6 h-6 text-white"})})]})}),t("form",{onSubmit:c,className:"p-6 space-y-6",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(zt,{className:"w-4 h-4 inline mr-2"}),"Titlu *"]}),e("input",{type:"text",name:"title",value:i.title,onChange:u,required:!0,placeholder:"Titlul sarcinii...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Descriere"}),e("textarea",{name:"description",value:i.description,onChange:u,rows:3,placeholder:"Descrierea sarcinii...",className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(nt,{className:"w-4 h-4 inline mr-2"}),"Prioritate"]}),t("select",{name:"priority",value:i.priority,onChange:u,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,children:[e("option",{value:"low",children:"Mică"}),e("option",{value:"medium",children:"Medie"}),e("option",{value:"high",children:"Mare"}),e("option",{value:"urgent",children:"Urgent"})]})]}),t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(Me,{className:"w-4 h-4 inline mr-2"}),"Termen limită"]}),e("input",{type:"date",name:"due_date",value:i.due_date,onChange:u,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                         bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                         focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`})]})]}),t("div",{children:[t("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[e(bt,{className:"w-4 h-4 inline mr-2"}),"Responsabili"]}),e("select",{multiple:!0,value:i.assigned_to,onChange:p,className:`w-full px-4 py-3 rounded-xl border-2 border-slate-200 dark:border-slate-600 
                       bg-white dark:bg-slate-700 text-slate-900 dark:text-white
                       focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all`,size:4,children:s.map(m=>e("option",{value:m.id,children:m.full_name||m.username},m.id))}),e("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"Ține apăsat Ctrl pentru a selecta mai mulți utilizatori"})]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t-2 border-slate-200 dark:border-slate-600",children:[e("button",{type:"button",onClick:l,className:`px-6 py-3 rounded-xl border-2 border-slate-300 dark:border-slate-600 
                       text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 
                       transition-all font-medium`,children:"Anulează"}),e("button",{type:"submit",className:`px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl 
                       hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg font-medium`,children:a?"Actualizează":"Creează"})]})]})]})})},rc=()=>{const{tasks:a,users:s,loading:r,refreshData:l}=ye(),{user:n}=Ot(),[i,o]=h.useState(!1),[c,u]=h.useState(null),[p,m]=h.useState(""),[d,f]=h.useState("all"),[T,b]=h.useState("all"),[y,k]=h.useState([]),A=a.filter(v=>{var C,z;const L=((C=v.title)==null?void 0:C.toLowerCase().includes(p.toLowerCase()))||((z=v.description)==null?void 0:z.toLowerCase().includes(p.toLowerCase())),K=d==="all"||v.status===d,R=T==="all"||v.priority===T;return L&&K&&R}),O=v=>{switch(v){case"urgent":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-blue-600 bg-blue-50 border-blue-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},g=v=>{switch(v){case"completed":return"text-green-600 bg-green-50 border-green-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"pending":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},$=v=>{switch(v){case"completed":return"Finalizată";case"in_progress":return"În progres";case"pending":return"Așteaptă";case"cancelled":return"Anulată";default:return v}},_=v=>{switch(v){case"urgent":return"Urgent";case"high":return"Mare";case"medium":return"Medie";case"low":return"Mică";default:return v}},E=async v=>{var L,K;try{const R=await re.put(`/api/tasks/${v.id}/toggle-check`);R.data.allChecked?ke.success("Toți utilizatorii au bifat! Sarcină completată!"):ke.success(R.data.message),l()}catch(R){console.error("Error toggling check:",R),ke.error(((K=(L=R.response)==null?void 0:L.data)==null?void 0:K.error)||"Eroare la bifarea sarcinii!")}},G=async v=>{if(window.confirm("Ești sigur că vrei să ștergi această sarcină?"))try{await re.delete(`/api/tasks/${v.id}`),ke.success("Sarcina a fost ștearsă!"),l()}catch(L){console.error("Error deleting task:",L),ke.error("Eroare la ștergerea sarcinii!")}},j=async v=>{try{c?(await re.put(`/api/tasks/${c.id}`,v),ke.success("Sarcina a fost actualizată!")):(await re.post("/api/tasks",v),ke.success("Sarcina a fost creată!")),o(!1),u(null),l()}catch(L){console.error("Error saving task:",L),ke.error("Eroare la salvarea sarcinii!")}},N=[{key:"check",label:"BIFARE",sortable:!1,render:v=>{const L=v.assigned_users||[],K=v.checked_users||[],R=L.some(z=>z.id===(n==null?void 0:n.userId)),C=K.some(z=>z.id===(n==null?void 0:n.userId));return R?t("div",{className:"flex flex-col items-center space-y-1",children:[e("button",{onClick:()=>E(v),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:C?"Debifează":"Bifează ca îndeplinit",children:C?e(zt,{className:"w-5 h-5 text-green-600"}):e(Br,{className:"w-5 h-5 text-gray-400"})}),t("span",{className:"text-xs text-gray-500",children:[K.length,"/",L.length]})]}):e("span",{className:"text-gray-400 text-xs",children:"-"})}},{key:"title",label:"TITLU",sortable:!0,render:v=>t("div",{children:[e("div",{className:"font-semibold text-gray-900",children:v.title}),v.description&&e("div",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:v.description})]})},{key:"priority",label:"PRIORITATE",sortable:!0,render:v=>e("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${O(v.priority)}`,children:_(v.priority)})},{key:"status",label:"STATUS",sortable:!0,render:v=>e("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${g(v.status)}`,children:$(v.status)})},{key:"assigned_users",label:"RESPONSABILI",sortable:!1,render:v=>e("div",{className:"flex flex-wrap gap-1",children:v.assigned_users&&v.assigned_users.length>0?v.assigned_users.map((L,K)=>e("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:L.full_name||L.username},K)):e("span",{className:"text-gray-400 text-sm",children:"Niciun responsabil"})})},{key:"due_date",label:"TERMEN",sortable:!0,render:v=>{if(!v.due_date)return e("span",{className:"text-gray-400",children:"-"});const L=new Date(v.due_date),K=new Date,R=L<K&&v.status!=="completed",C=L.toDateString()===K.toDateString();return t("div",{className:`text-sm ${R?"text-red-600 font-semibold":C?"text-orange-600 font-semibold":"text-gray-600"}`,children:[L.toLocaleDateString("ro-RO"),R&&e(Bt,{className:"w-4 h-4 inline ml-1"}),C&&e(dt,{className:"w-4 h-4 inline ml-1"})]})}},{key:"created_by_name",label:"CREAT DE",sortable:!1,render:v=>e("span",{className:"text-sm text-gray-600",children:v.created_by_full_name||v.created_by_name||"Unknown"})},{key:"created_at",label:"CREAT",sortable:!0,render:v=>e("span",{className:"text-sm text-gray-500",children:new Date(v.created_at).toLocaleDateString("ro-RO")})},{key:"actions",label:"ACȚIUNI",sortable:!1,render:v=>{var L;return t("div",{className:"flex items-center space-x-2",children:[((L=v.assigned_to)==null?void 0:L.includes(n==null?void 0:n.userId))&&v.status!=="completed"&&t("button",{onClick:()=>F(v),className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md hover:bg-green-700 transition-colors",children:[e(zt,{className:"w-4 h-4 inline mr-1"}),"Complete"]}),v.status==="completed"&&!v.approved_by&&(v.created_by===(n==null?void 0:n.userId)||(n==null?void 0:n.role)==="admin")&&t("button",{onClick:()=>I(v),className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 transition-colors",children:[e(zt,{className:"w-4 h-4 inline mr-1"}),"Aprobă"]}),v.completed_by&&t("span",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:["Finalizat de: ",v.completed_by_full_name||v.completed_by_name]}),v.approved_by&&t("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:["Aprobat de: ",v.approved_by_full_name||v.approved_by_name]})]})}}],D=v=>{u(v),o(!0)},S=()=>{u(null),o(!0)},F=async v=>{if(window.confirm("Confirmă finalizarea acestei sarcini?"))try{const L=prompt("Adaugă nota de finalizare (opțional):");await re.put(`/api/tasks/${v.id}/complete`,{completion_notes:L}),ke.success("Sarcina a fost marcată ca finalizată!"),l()}catch(L){console.error("Error completing task:",L),ke.error("Eroare la finalizarea sarcinii!")}},I=async v=>{if(window.confirm("Confirmă aprobarea finalizării acestei sarcini?"))try{const L=prompt("Adaugă nota de aprobare (opțional):");await re.put(`/api/tasks/${v.id}/approve`,{approval_notes:L}),ke.success("Finalizarea sarcinii a fost aprobată!"),l()}catch(L){console.error("Error approving task:",L),ke.error("Eroare la aprobarea sarcinii!")}},x={total:a.length,pending:a.filter(v=>v.status==="pending").length,inProgress:a.filter(v=>v.status==="in_progress").length,completed:a.filter(v=>v.status==="completed").length,overdue:a.filter(v=>!v.due_date||v.status==="completed"?!1:new Date(v.due_date)<new Date).length};return t(he,{children:[t("div",{className:"space-y-6",children:[t("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Sarcini"}),e("p",{className:"text-gray-600",children:"Gestionează sarcinile echipei"})]}),t("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e(Ie,{className:"w-4 h-4"}),"Sarcină nouă"]})]}),t("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e(zt,{className:"w-5 h-5 text-blue-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:x.total}),e("div",{className:"text-sm text-gray-500",children:"Total"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:e(dt,{className:"w-5 h-5 text-yellow-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:x.pending}),e("div",{className:"text-sm text-gray-500",children:"Așteaptă"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e(dt,{className:"w-5 h-5 text-blue-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:x.inProgress}),e("div",{className:"text-sm text-gray-500",children:"În progres"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e(zt,{className:"w-5 h-5 text-green-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:x.completed}),e("div",{className:"text-sm text-gray-500",children:"Finalizate"})]})]})}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e(Bt,{className:"w-5 h-5 text-red-600"})}),t("div",{children:[e("div",{className:"text-2xl font-bold text-gray-900",children:x.overdue}),e("div",{className:"text-sm text-gray-500",children:"Întârziate"})]})]})})]}),e("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t("div",{className:"flex flex-col sm:flex-row gap-4",children:[e("div",{className:"flex-1",children:e("input",{type:"text",placeholder:"Caută sarcini...",value:p,onChange:v=>m(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),t("select",{value:d,onChange:v=>f(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"all",children:"Toate statusurile"}),e("option",{value:"pending",children:"Așteaptă"}),e("option",{value:"in_progress",children:"În progres"}),e("option",{value:"completed",children:"Finalizată"}),e("option",{value:"cancelled",children:"Anulată"})]}),t("select",{value:T,onChange:v=>b(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"all",children:"Toate prioritățile"}),e("option",{value:"urgent",children:"Urgent"}),e("option",{value:"high",children:"Mare"}),e("option",{value:"medium",children:"Medie"}),e("option",{value:"low",children:"Mică"})]})]})}),e(qe,{data:A,columns:N,onEdit:D,onDelete:G,loading:r,searchTerm:p,onSearchChange:m,moduleColor:"blue",selectedItems:y,onSelectionChange:k})]}),i&&e(ac,{task:c,users:s,onSubmit:j,onClose:()=>{o(!1),u(null)}})]})},sc=()=>{const{messages:a,users:s,loading:r,refreshData:l}=ye(),{user:n}=Ot(),[i,o]=h.useState(null),[c,u]=h.useState(""),[p,m]=h.useState(!1),[d,f]=h.useState(""),[T,b]=h.useState([]),y=h.useRef(null),k=h.useRef(null),O=(()=>{const N=new Map;return a.forEach(D=>{const S=D.sender_id===(n==null?void 0:n.userId)?D.recipient_id:D.sender_id,F=s.find(v=>v.id===S);if(!F)return;const I=`${Math.min(D.sender_id,D.recipient_id)}-${Math.max(D.sender_id,D.recipient_id)}`;N.has(I)||N.set(I,{otherUser:F,lastMessage:D,unreadCount:0,messages:[]});const x=N.get(I);x.messages.push(D),D.recipient_id===(n==null?void 0:n.userId)&&!D.is_read&&x.unreadCount++,new Date(D.created_at)>new Date(x.lastMessage.created_at)&&(x.lastMessage=D)}),Array.from(N.values()).sort((D,S)=>new Date(S.lastMessage.created_at)-new Date(D.lastMessage.created_at))})(),g=O.filter(N=>{var D,S,F,I;return((D=N.otherUser.full_name)==null?void 0:D.toLowerCase().includes(d.toLowerCase()))||((S=N.otherUser.username)==null?void 0:S.toLowerCase().includes(d.toLowerCase()))||((F=N.lastMessage.subject)==null?void 0:F.toLowerCase().includes(d.toLowerCase()))||((I=N.lastMessage.content)==null?void 0:I.toLowerCase().includes(d.toLowerCase()))}),$=i?a.filter(N=>N.sender_id===(n==null?void 0:n.userId)&&N.recipient_id===i.otherUser.id||N.recipient_id===(n==null?void 0:n.userId)&&N.sender_id===i.otherUser.id).sort((N,D)=>new Date(N.created_at)-new Date(D.created_at)):[];h.useEffect(()=>{var N;(N=k.current)==null||N.scrollIntoView({behavior:"smooth"})},[$]),h.useEffect(()=>{if(i){const N=$.filter(D=>D.recipient_id===(n==null?void 0:n.userId)&&!D.is_read);N.forEach(async D=>{try{await re.put(`/api/messages/${D.id}/read`)}catch(S){console.error("Error marking message as read:",S)}}),N.length>0&&l()}},[i,$,n==null?void 0:n.userId,l]);const _=async()=>{if(!(!c.trim()||!i))try{await re.post("/api/messages",{recipient_id:i.otherUser.id,subject:`Mesaj pentru ${i.otherUser.full_name||i.otherUser.username}`,content:c,file_attachments:T.map(N=>N.name)}),u(""),b([]),ke.success("Mesajul a fost trimis!"),l()}catch(N){console.error("Error sending message:",N),ke.error("Eroare la trimiterea mesajului!")}},E=async N=>{try{await re.post("/api/messages",N),ke.success("Mesajul a fost trimis!"),m(!1),l()}catch(D){console.error("Error sending message:",D),ke.error("Eroare la trimiterea mesajului!")}},G=N=>{const D=Array.from(N.target.files);b(D)},j=N=>{const D=new Date(N);return(new Date-D)/(1e3*60*60)<24?D.toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit"}):D.toLocaleDateString("ro-RO",{day:"2-digit",month:"2-digit"})};return O.reduce((N,D)=>N+D.unreadCount,0),t(he,{children:[t("div",{className:"flex h-[calc(100vh-8rem)] bg-white rounded-lg border border-gray-200 overflow-hidden",children:[t("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[t("div",{className:"p-4 border-b border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h1",{className:"text-xl font-bold",children:"Mesaje"}),t("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e(Ie,{className:"w-4 h-4"}),"Nou"]})]}),t("div",{className:"relative",children:[e(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e("input",{type:"text",placeholder:"Caută conversații...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e("div",{className:"flex-1 overflow-y-auto",children:g.length===0?e("div",{className:"p-4 text-center text-gray-500",children:d?"Nu s-au găsit conversații.":"Nu ai mesaje încă."}):g.map(N=>{const D=N.lastMessage,S=N.unreadCount>0;return e("button",{onClick:()=>o(N),className:`w-full p-4 text-left border-b border-gray-100 hover:bg-gray-50 transition-colors ${(i==null?void 0:i.otherUser.id)===N.otherUser.id?"bg-blue-50 border-blue-200":""}`,children:t("div",{className:"flex items-start gap-3",children:[e("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:e(yt,{className:"w-5 h-5 text-blue-600"})}),t("div",{className:"flex-1 min-w-0",children:[t("div",{className:"flex items-center justify-between",children:[e("h3",{className:`font-semibold truncate ${S?"text-gray-900":"text-gray-700"}`,children:N.otherUser.full_name||N.otherUser.username}),e("span",{className:"text-xs text-gray-500 flex-shrink-0 ml-2",children:j(D.created_at)})]}),e("p",{className:`text-sm truncate mt-1 ${S?"text-gray-900 font-medium":"text-gray-600"}`,children:D.content}),S&&e("div",{className:"flex justify-end mt-2",children:e("span",{className:"bg-blue-600 text-white text-xs px-2 py-1 rounded-full",children:N.unreadCount})})]})]})},`${N.otherUser.id}`)})})]}),e("div",{className:"flex-1 flex flex-col",children:i?t(De,{children:[e("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:t("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e(yt,{className:"w-4 h-4 text-blue-600"})}),t("div",{children:[e("h2",{className:"font-semibold text-gray-900",children:i.otherUser.full_name||i.otherUser.username}),e("p",{className:"text-sm text-gray-500",children:i.otherUser.email})]})]})}),t("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[$.map(N=>{const D=N.sender_id===(n==null?void 0:n.userId);return e("div",{className:`flex ${D?"justify-end":"justify-start"}`,children:t("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${D?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e("p",{className:"text-sm",children:N.content}),N.file_attachments&&N.file_attachments.length>0&&e("div",{className:"mt-2 space-y-1",children:N.file_attachments.map((S,F)=>t("div",{className:"flex items-center gap-2 text-xs opacity-90",children:[e(Ra,{className:"w-3 h-3"}),e("span",{className:"truncate",children:S})]},F))}),t("div",{className:`text-xs mt-1 ${D?"text-blue-100":"text-gray-500"}`,children:[j(N.created_at),D&&N.is_read&&e("span",{className:"ml-1",children:"✓"})]})]})},N.id)}),e("div",{ref:k})]}),t("div",{className:"p-4 border-t border-gray-200",children:[T.length>0&&e("div",{className:"mb-3",children:e("div",{className:"flex flex-wrap gap-2",children:T.map((N,D)=>t("div",{className:"flex items-center gap-2 bg-gray-100 px-3 py-1 rounded-lg text-sm",children:[e(Ra,{className:"w-4 h-4"}),e("span",{children:N.name})]},D))})}),t("div",{className:"flex gap-2",children:[e("input",{type:"file",ref:y,onChange:G,multiple:!0,className:"hidden"}),e("button",{onClick:()=>{var N;return(N=y.current)==null?void 0:N.click()},className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:e(Ra,{className:"w-4 h-4"})}),e("input",{type:"text",value:c,onChange:N=>u(N.target.value),onKeyPress:N=>N.key==="Enter"&&_(),placeholder:"Scrie un mesaj...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e("button",{onClick:_,disabled:!c.trim(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e(rl,{className:"w-4 h-4"})})]})]})]}):e("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:t("div",{className:"text-center",children:[e(Qt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e("h3",{className:"text-lg font-medium mb-2",children:"Selectează o conversație"}),e("p",{children:"Choose a conversation from the list to start messaging"})]})})})]}),p&&e(lc,{users:s.filter(N=>N.id!==(n==null?void 0:n.userId)),onSubmit:E,onClose:()=>m(!1)})]})},lc=({users:a,onSubmit:s,onClose:r})=>{const[l,n]=h.useState({recipient_id:"",subject:"",content:"",file_attachments:[]}),i=h.useRef(null),o=u=>{if(u.preventDefault(),!l.recipient_id||!l.content.trim()){ke.error("Recipient și conținut sunt obligatorii!");return}s(l)},c=u=>{const p=Array.from(u.target.files);n({...l,file_attachments:p})};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:t("div",{className:"p-6",children:[e("h2",{className:"text-xl font-bold mb-4",children:"Mesaj nou"}),t("form",{onSubmit:o,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destinatar *"}),t("select",{required:!0,value:l.recipient_id,onChange:u=>n({...l,recipient_id:parseInt(u.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Selectează utilizator"}),a.map(u=>e("option",{value:u.id,children:u.full_name||u.username},u.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subiect"}),e("input",{type:"text",value:l.subject,onChange:u=>n({...l,subject:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mesaj *"}),e("textarea",{required:!0,value:l.content,onChange:u=>n({...l,content:u.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Atașamente"}),e("input",{type:"file",ref:i,onChange:c,multiple:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),l.file_attachments.length>0&&t("div",{className:"mt-2",children:[e("p",{className:"text-sm text-gray-600",children:"Fișiere selectate:"}),e("div",{className:"flex flex-wrap gap-2 mt-1",children:l.file_attachments.map((u,p)=>e("span",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:u.name},p))})]})]}),t("div",{className:"flex gap-3 pt-4",children:[e("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Trimite"}),e("button",{type:"button",onClick:r,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Anulează"})]})]})]})})})};function nc(){return e(Pi,{children:e(Li,{children:e("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:t(Is,{children:[e(Ee,{path:"/login",element:e(Ri,{})}),e(Ee,{path:"/",element:e(Ht,{to:"/onjn-operators",replace:!0})}),e(Ee,{path:"/dashboard",element:e(Ht,{to:"/onjn-operators",replace:!0})}),e(Ee,{path:"/companies",element:e(Re,{module:q.COMPANIES,children:e(Ki,{})})}),e(Ee,{path:"/companies/:id",element:e(Re,{module:q.COMPANIES,children:e(qo,{})})}),e(Ee,{path:"/locations",element:e(Re,{module:q.LOCATIONS,children:e(so,{})})}),e(Ee,{path:"/locations/:id",element:e(Re,{module:q.LOCATIONS,children:e(lo,{})})}),e(Ee,{path:"/providers",element:e(Re,{module:q.PROVIDERS,children:e(oo,{})})}),e(Ee,{path:"/cabinets",element:e(Re,{module:q.CABINETS,children:e(ho,{})})}),e(Ee,{path:"/game-mixes",element:e(Re,{module:q.GAME_MIXES,children:e(go,{})})}),e(Ee,{path:"/games/:gameId",element:e(Re,{module:q.SLOTS,children:e(Co,{})})}),e(Ee,{path:"/slots",element:e(Re,{module:q.SLOTS,children:e(Ao,{})})}),e(Ee,{path:"/slots/history",element:e(Re,{module:q.SLOTS,children:e(Do,{})})}),e(Ee,{path:"/slots/cyber-import",element:e(Re,{module:q.CYBER_IMPORT,children:e(_o,{})})}),e(Ee,{path:"/slots/:id",element:e(Re,{module:q.SLOTS,children:e(Eo,{})})}),e(Ee,{path:"/warehouse",element:e(Re,{module:q.WAREHOUSE,children:e(zo,{})})}),e(Ee,{path:"/metrology",element:e(Re,{module:q.METROLOGY,children:e(jo,{})})}),e(Ee,{path:"/approval-detail/:id",element:e(Re,{module:q.METROLOGY,children:e(Mo,{})})}),e(Ee,{path:"/jackpots",element:e(Re,{module:q.JACKPOTS,children:e(Bo,{})})}),e(Ee,{path:"/invoices",element:e(Re,{module:q.INVOICES,children:e(Go,{})})}),e(Ee,{path:"/invoices/:id",element:e(Re,{module:q.INVOICES,children:e(Vo,{})})}),e(Ee,{path:"/onjn-reports",element:e(Re,{module:q.ONJN,children:e(Wo,{})})}),e(Ee,{path:"/onjn-operators",element:e(Re,{module:q.ONJN,children:e(Ho,{})})}),e(Ee,{path:"/onjn-operators/brand/:brandName",element:e(Re,{module:q.ONJN,children:e(Xo,{})})}),e(Ee,{path:"/legal-documents",element:e(Re,{module:q.LEGAL,children:e(Zo,{})})}),e(Ee,{path:"/marketing",element:e(Re,{module:q.MARKETING,children:e(vo,{})})}),e(Ee,{path:"/marketing-ai",element:e(Re,{module:q.MARKETING,children:e(yo,{})})}),e(Ee,{path:"/marketing/:id",element:e(Re,{module:q.MARKETING,children:e(wo,{})})}),e(Ee,{path:"/tasks",element:e(zr,{children:e(rc,{})})}),e(Ee,{path:"/messages",element:e(zr,{children:e(sc,{})})}),e(Ee,{path:"/users",element:e(Re,{requiredRole:"admin",children:e(ec,{})})}),e(Ee,{path:"/settings",element:e(Re,{module:q.SETTINGS,children:e(tc,{})})}),e(Ee,{path:"*",element:e(Ht,{to:"/login",replace:!0})})]})})})})}$a.createRoot(document.getElementById("root")).render(e(va.StrictMode,{children:e(Ql,{children:t(Rs,{children:[e(nc,{}),e(Kl,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff",borderRadius:"12px",padding:"16px",fontSize:"14px",fontWeight:"500"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}));
